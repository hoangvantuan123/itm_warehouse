import{j as e,F as z,b as bt,C as F,I as V,B as L,R as Ne,r as t,M as Re,a as it,H as ct,u as wt,c as vt,d as qt,T as Tt,e as Dt}from"./index-Bs9yWD0t.js";import{A as ke}from"./index-1TNXHxP6.js";import{d as at}from"./dayjs.min-Dv7_HJOV.js";import{D as lt,G as Te,s as nt}from"./getCodeHelpCombo-CaeqAGEw.js";import{l as Rt}from"./lodash-Ce-vbS9w.js";import{C as A,G as s,D as Ce,a as It}from"./index-OBdMMgIc.js";import"./moment-C0yF_v6Q.js";import{S as G}from"./index-B0nsmOCQ.js";import{R as Pt}from"./FileDoneOutlined-B7kzfAs5.js";import{R as Ot}from"./TableOutlined-Dem2elRe.js";import{R as ye}from"./FilterOutlined-DaTDNfc6.js";import{E as ot}from"./constants-BUjU6TAr.js";import"./DownOutlined-DarA9UQs.js";function Mt({formData:l,setFormData:r,setToDate:b,toDate:y,dataUnit:h,setBizUnit:C,handleSearch1:I,handleSearch2:q,handleSearch3:j,minorName:N,setFactUnit:p,setProgStatus:T,minorName2:w,setUseType:P,deptName:O,empName:D,custName:n,prodPlanNo:m,setProdPlanNo:d,setWorkOrderNo:k,workOrderNo:i,prodReqNo:R,setProdReqNo:M,outReqNo:S,setOutReqNo:u,setDeptName:c,setDeptSeq:f,resetTable:v,setEmpName:U,setEmpSeq:E,resetTable2:Q,setCustSeq:$,setCustName:Y,resetTable3:de}){const J=a=>{r(a)},H=a=>{b(a)},X=a=>{p(a)},ue=a=>{T(a)},Z=a=>{P(a)},ae=a=>{c(a.target.value),f(""),v()},le=a=>{U(a.target.value),E(""),Q()},me=a=>{Y(a.target.value),$(""),de()};return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(z,{layout:"vertical",onKeyDown:a=>{a.key==="Enter"&&a.preventDefault()},children:e.jsxs(bt,{className:"gap-4 flex items-center ",children:[e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Ngày yêu cầu 1"}),className:"mb-0",children:e.jsx(lt,{className:"w-full text-sm p-2",value:l,onChange:J,format:"YYYY-MM-DD"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Ngày yêu cầu 2"}),className:"mb-0",children:e.jsx(lt,{className:"w-full text-sm p-2",value:y,onChange:H,format:"YYYY-MM-DD"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Nơi sản xuất"}),className:"mb-0",children:e.jsx(G,{defaultValue:"",size:"large",style:{width:190},allowClear:!0,onChange:X,options:[{label:"All",value:""},...(h==null?void 0:h.map(a=>({label:a==null?void 0:a.AccUnitName,value:a==null?void 0:a.FactUnit})))||[]]})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Bộ phận yêu cầu"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&I()},value:O,onChange:ae,onDoubleClick:I})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Người yêu cầu"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&q()},value:D,onChange:le,onDoubleClick:q})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Khách hàng"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&j()},value:n,onChange:me,onDoubleClick:j})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số yêu cầu"}),className:"mb-0",children:e.jsx(V,{value:S,onChange:a=>u(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số kế hoạch"}),className:"mb-0",children:e.jsx(V,{value:m,onChange:a=>d(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số lệnh sản xuất"}),className:"mb-0",children:e.jsx(V,{value:i,onChange:a=>k(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số yêu cầu sản xuất"}),className:"mb-0",children:e.jsx(V,{value:R,onChange:a=>M(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Phân loại kho"}),className:"mb-0",children:e.jsx(G,{id:"typeSelect",defaultValue:"All",size:"large",style:{width:240},allowClear:!0,onChange:Z,options:[{label:"All",value:""},...(w==null?void 0:w.map(a=>({label:a==null?void 0:a.MinorName,value:a==null?void 0:a.Value})))||[]]})})}),e.jsx(F,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Trạng thái"}),className:"mb-0",children:e.jsx(G,{id:"typeSelect",defaultValue:"All",size:"large",style:{width:240},allowClear:!0,onChange:ue,options:[{label:"All",value:""},...(N==null?void 0:N.map(a=>({label:a==null?void 0:a.MinorName,value:a==null?void 0:a.Value})))||[]]})})})]})})})}function Et({nextPage:l,debouncedFetchSPDMMOutReqListQueryWeb:r}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{type:"default",icon:e.jsx(Pt,{}),size:"middle",className:"uppercase",color:"default",variant:"filled",onClick:l,style:{backgroundColor:"#f0f0f0",borderColor:"#d9d9d9"},children:"XỬ LÝ XUẤT KHO"},"Reset"),e.jsx(L,{type:"primary",icon:e.jsx(Ne,{}),size:"middle",onClick:r,className:"uppercase",children:"SEARCH"},"Save")]})}function Ut({data:l,onCellClicked:r,gridData:b,setGridData:y,loading:h}){const[C,I]=t.useState(!1),q=t.useCallback(()=>I(!1),[]);t.useState([!1,!1,!1]);const[j,N]=t.useState({columns:A.empty(),rows:A.empty()}),p=t.useMemo(()=>[{title:"IsStop"},{title:"IsConfirm"},{title:"FactUnitName"},{title:"ReqDate"},{title:"OutReqNo"},{title:"DeptName"},{title:"EmpName"},{title:"CustName"},{title:"UseTypeName"},{title:"WorkOrderNo"},{title:"AssyItemName"},{title:"AssyItemNo"},{title:"AssyItemSpec"},{title:"AssyUnitName"},{title:"ProcName"},{title:"AssyQty"},{title:"AssyProgQty"},{title:"ItemName"},{title:"ItemNo"},{title:"ItemSpec"},{title:"UnitName"},{title:"Qty"},{title:"ProgQty"},{title:"IsReturn"},{title:"Remark"},{title:"ItemSeq"},{title:"ItemUnitSeq"},{title:"AssyItemSeq"},{title:"PJTSeq"},{title:"WBSSeq"},{title:"FactUnit"},{title:"OutReqSeq"},{title:"UseType"},{title:"OSPPOSeq"},{title:"ProgStatus"},{title:"ProgStatusName"},{title:"ProdPlanNo"},{title:"ProdPlanSeq"},{title:"ProdReqNo"}],[]),[T,w]=t.useState(p),P=t.useCallback((m,d)=>{const k=T.indexOf(m);if(k!==-1){const i={...m,width:d},R=[...T];R.splice(k,1,i),w(R)}},[T]),O=t.useCallback(([m,d])=>{const k=b[d]||{},{IsStop:i="",IsConfirm:R="",FactUnitName:M="",ReqDate:S="",OutReqNo:u="",DeptName:c="",EmpName:f="",CustName:v="",UseTypeName:U="",WorkOrderNo:E="",AssyItemName:Q="",AssyItemNo:$="",AssyItemSpec:Y="",AssyUnitName:de="",ProcName:J="",AssyQty:H="",AssyProgQty:X="",ItemName:ue="",ItemNo:Z="",ItemSpec:ae="",UnitName:le="",Qty:me="",ProgQty:a="",IsReturn:xe="",Remark:ne="",ItemSeq:je="",ItemUnitSeq:oe="",AssyItemSeq:be="",PJTSeq:he="",WBSSeq:we="",FactUnit:pe="",OutReqSeq:Se="",UseType:ie="",OSPPOSeq:ve="",ProgStatus:fe="",ProgStatusName:ee="",ProdPlanNo:ce="",ProdPlanSeq:_="",ProdReqNo:re=""}=k,o=B=>B!=null?String(B):"",te={0:{kind:s.Boolean,data:i},1:{kind:s.Boolean,data:R},2:{kind:s.Text,data:o(M)},3:{kind:s.Text,data:o(S)},4:{kind:s.Text,data:o(u)},5:{kind:s.Text,data:o(c)},6:{kind:s.Text,data:o(f)},7:{kind:s.Text,data:o(v)},8:{kind:s.Text,data:o(U)},9:{kind:s.Text,data:o(E)},10:{kind:s.Text,data:o(Q)},11:{kind:s.Text,data:o($)},12:{kind:s.Text,data:o(Y)},13:{kind:s.Text,data:o(de)},14:{kind:s.Text,data:o(J)},15:{kind:s.Text,data:o(H)},16:{kind:s.Text,data:o(X)},17:{kind:s.Text,data:o(ue)},18:{kind:s.Text,data:o(Z)},19:{kind:s.Text,data:o(ae)},20:{kind:s.Text,data:o(le)},21:{kind:s.Text,data:o(me)},22:{kind:s.Text,data:o(a)},23:{kind:s.Boolean,data:xe},24:{kind:s.Text,data:o(ne)},25:{kind:s.Text,data:o(je)},26:{kind:s.Text,data:o(oe)},27:{kind:s.Text,data:o(be)},28:{kind:s.Text,data:o(he)},29:{kind:s.Text,data:o(we)},30:{kind:s.Text,data:o(pe)},31:{kind:s.Text,data:o(Se)},32:{kind:s.Text,data:o(ie)},33:{kind:s.Text,data:o(ve)},34:{kind:s.Text,data:o(fe)},35:{kind:s.Text,data:o(ee)},36:{kind:s.Text,data:o(ce)},37:{kind:s.Text,data:o(_)},38:{kind:s.Text,data:o(re)}};if(te.hasOwnProperty(m)){const{kind:B,data:se}=te[m];return{kind:B,data:se,displayData:se}}return{kind:"",data:"",displayData:""}},[b]),[D,n]=t.useState(void 0);return t.useCallback(m=>{console.log("cell",m),n(m)},[]),t.useEffect(()=>{y(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8  overflow-hidden",children:e.jsxs("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 p-2 text-blue-600 uppercase",children:[e.jsx(Ot,{}),"DATA SHEET"]}),e.jsx(Ce,{columns:T,getCellContent:O,rows:b.length,showSearch:C,getCellsForSelection:!0,onSearchClose:q,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:P,smoothScrollY:!0,smoothScrollX:!0,rowSelect:"single",onCellClicked:r,gridSelection:j,onGridSelectionChange:N,getRowThemeOverride:m=>m%2===0?void 0:{bgCell:"#FBFBFB"}})]})})}function At({data:l,onCellClicked:r,setSelection:b,selection:y}){const[h,C]=t.useState([]),[I,q]=t.useState(!1),j=t.useCallback(()=>q(!1),[]),N=t.useMemo(()=>[{title:"BeDeptName"},{title:"BeBegDate"},{title:"BeEndDate"},{title:"DeptRemark"}],[]),[p,T]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),T(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{BeDeptName:k="",BeBegDate:i="",BeEndDate:R="",DeptRemark:M=""}=d,S=c=>c!=null?String(c):"",u={0:{kind:s.Text,data:S(k)},1:{kind:s.Text,data:S(i)},2:{kind:s.Text,data:S(R)},3:{kind:s.Text,data:S(M)}};if(u.hasOwnProperty(n)){const{kind:c,data:f}=u[n];return{kind:c,data:f,displayData:f}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(Ce,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"single",gridSelection:y,onGridSelectionChange:b})})})}const{Search:zt}=V;function Bt({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,fetchCodehelpData1:h,handleSearch:C,setSubConditionSql:I,setDeptName:q,setDeptSeq:j,deptName:N,selection:p,setSelection:T,resetTable:w}){const[P,O]=t.useState(!1),[D,n]=t.useState(null),[m,d]=t.useState(null);t.useState(null);const k=u=>{l(u)},i=u=>{I(u)},R=(u,c)=>{let f;if(u[0]!==-1){console.log("onCellClicked");return}if(u[0]===-1?(f=u[1],O(!0)):(f=u[0],O(!1)),D&&D[0]===u[0]&&D[1]===u[1]){q(""),j(""),n(null),d(null);return}if(f>=0&&f<r.length){const v=r[f];q(v==null?void 0:v.BeDeptName),j(v==null?void 0:v.BeDeptSeq),d(v),n(u)}},M=()=>{y(!1),q(""),j(""),w()},S=u=>{q(u.target.value),j(""),w()};return e.jsx("div",{children:e.jsxs(Re,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(ye,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(ke,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{id:"typeSelect",defaultValue:"Bộ phận",style:{width:120},size:"middle",onChange:k,options:[{value:1,label:"Bộ phận"},{value:0,label:"Mã bộ phận"}]})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{id:"typeSelect",defaultValue:"Sử dụng",style:{width:300},size:"middle",options:[{value:"IsUse = 1",label:"Sử dụng"},{value:"IsUse = 0",label:"Chưa sử dụng"}],onChange:i})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx(zt,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:N,onKeyDown:u=>{u.key==="Enter"&&C()},onChange:S,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(Ne,{}),size:"middle",onClick:h,children:"Truy vấn"})})]})]}),e.jsx(At,{data:r,onCellClicked:R,setSelection:T,selection:p})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:M,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}function Ft({data:l,onCellClicked:r,setSelection:b,selection:y}){const[h,C]=t.useState([]),[I,q]=t.useState(!1),j=t.useCallback(()=>q(!1),[]),N=t.useMemo(()=>[{title:"EmpName"},{title:"EmpID"},{title:"DeptName"},{title:"WkDeptName"},{title:"UMJoName"},{title:"PosName"},{title:"UMJpName"},{title:"UMJdName"},{title:"TypeName"},{title:"SMSexName"}],[]),[p,T]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),T(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{EmpName:k="",EmpID:i="",DeptName:R="",WkDeptName:M="",UMJoName:S="",PosName:u="",UMJpName:c="",UMJdName:f="",TypeName:v="",SMSexName:U=""}=d,E=$=>$!=null?String($):"",Q={0:{kind:s.Text,data:E(k)},1:{kind:s.Text,data:E(i)},2:{kind:s.Text,data:E(R)},3:{kind:s.Text,data:E(M)},4:{kind:s.Text,data:E(S)},5:{kind:s.Text,data:E(u)},6:{kind:s.Text,data:E(c)},7:{kind:s.Text,data:E(f)},8:{kind:s.Text,data:E(v)},9:{kind:s.Text,data:E(U)}};if(Q.hasOwnProperty(n)){const{kind:$,data:Y}=Q[n];return{kind:$,data:Y,displayData:Y}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{console.log("cell",n),D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(Ce,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"multi",gridSelection:y,onGridSelectionChange:b})})})}const{Search:$t}=V;function Wt({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,empName:h,handleSearch:C,setSubConditionSql:I,fetchCodehelpData2:q,setEmpSeq:j,setEmpName:N,setSelection:p,selection:T,resetTable:w}){const[P,O]=t.useState(!1),[D,n]=t.useState(null),[m,d]=t.useState(null);t.useState(null);const k=S=>{l(S)},i=(S,u)=>{let c;if(S[0]===-1){if(S[0]===-1?(c=S[1],O(!0)):(c=S[0],O(!1)),D&&D[0]===S[0]&&D[1]===S[1]){N(""),j(""),n(null),d(null);return}if(c>=0&&c<r.length){const f=r[c];N(f==null?void 0:f.EmpName),j(f==null?void 0:f.EmpSeq),d(f),n(S)}}},R=()=>{y(!1),N(""),j(""),w()},M=S=>{N(S.target.value),j(""),w()};return e.jsx("div",{children:e.jsxs(Re,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(ye,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(ke,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{id:"typeSelect",defaultValue:"Nhân viên",style:{width:180},size:"middle",options:[{value:1,label:"Nhân viên"},{value:2,label:"Mã nhân viên"}],onChange:k})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx($t,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:h,onKeyDown:S=>{S.key==="Enter"&&C()},onChange:M,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(Ne,{}),size:"middle",onClick:q,children:"Truy vấn"})})]})]}),e.jsx(Ft,{data:r,onCellClicked:i,setSelection:p,selection:T})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:R,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}function Lt({data:l,onCellClicked:r,selection:b,setSelection:y}){const[h,C]=t.useState([]),[I,q]=t.useState(!1),j=t.useCallback(()=>q(!1),[]),N=t.useMemo(()=>[{title:"CustSeq"},{title:"FullName"},{title:"CustNo"},{title:"BizNo"},{title:"UMCustClassName"}],[]),[p,T]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),T(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{CustSeq:k="",FullName:i="",CustNo:R="",BizNo:M="",UMCustClassName:S=""}=d,u=f=>f!=null?String(f):"",c={0:{kind:s.Text,data:u(k)},1:{kind:s.Text,data:u(i)},2:{kind:s.Text,data:u(R)},3:{kind:s.Text,data:u(M)},4:{kind:s.Text,data:u(S)}};if(c.hasOwnProperty(n)){const{kind:f,data:v}=c[n];return{kind:f,data:v,displayData:v}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{console.log("cell",n),D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(Ce,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"multi",gridSelection:b,onGridSelectionChange:y})})})}const{Search:Qt}=V;function Vt({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,setKeyword:h,keyword:C,handleSearch:I,setSubConditionSql:q,fetchCodehelpData3:j,setCustSeq:N,setCustName:p,custName:T,resetTable:w,setSelection:P,selection:O}){const[D,n]=t.useState(!1),[m,d]=t.useState(null),[k,i]=t.useState(null);t.useState(null);const R=c=>{l(c)},M=(c,f)=>{let v;if(c[0]===-1){if(c[0]===-1?(v=c[1],n(!0)):(v=c[0],n(!1)),m&&m[0]===c[0]&&m[1]===c[1]){p(""),N(""),d(null),i(null);return}if(v>=0&&v<r.length){const U=r[v];p(U==null?void 0:U.FullName),N(U==null?void 0:U.CustSeq),i(U),d(c)}}},S=()=>{y(!1),p(""),N(""),w()},u=c=>{p(c.target.value),N(""),w()};return e.jsx("div",{children:e.jsxs(Re,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(ye,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(ke,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{id:"typeSelect",defaultValue:"Điểm gia công bên ngoài",style:{width:220},size:"middle",options:[{value:1,label:"Điểm gia công bên ngoài"},{value:2,label:"Số đơn vị gia công"},{value:3,label:"Mã số kinh doanh"},{value:4,label:"Tương hiệu"}],onChange:R})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx(Qt,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:T,onKeyDown:c=>{c.key==="Enter"&&I()},onChange:u,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(Ne,{}),size:"middle",onClick:j,children:"Truy vấn"})})]})]}),e.jsx(Lt,{data:r,onCellClicked:M,setSelection:P,selection:O})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:S,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}const Yt=l=>`
       <DataBlock1>
    <WorkingTag>A</WorkingTag>
    <IDX_NO>1</IDX_NO>
    <Status>0</Status>
    <DataSeq>1</DataSeq>
    <Selected>1</Selected>
    <TABLE_NAME>DataBlock1</TABLE_NAME>
    <IsChangedMst>${l.IsChangedMst}</IsChangedMst>
    <FactUnit>${l.FactUnit}</FactUnit>
    <ReqDate>${l.ReqDate}</ReqDate>
    <ReqDateTo>${l.ReqDateTo}</ReqDateTo>
    <OutReqNo>${l.OutReqNo}</OutReqNo>
    <UseType>${l.UseType}</UseType>
    <DeptSeq>${l.DeptSeq}</DeptSeq>
    <DeptName>${l.DeptName} </DeptName>
    <EmpSeq>${l.EmpSeq} </EmpSeq>
    <EmpName>${l.EmpName}</EmpName>
    <CustSeq>${l.CustSeq}</CustSeq>
    <CustName>${l.CustName}</CustName>
    <ProgStatus>${l.ProgStatus}</ProgStatus>
    <ProdPlanNo>${l.ProdPlanNo}</ProdPlanNo>
    <WorkOrderNo>${l.WorkOrderNo}</WorkOrderNo>
    <ProdReqNo>${l.ProdReqNo}</ProdReqNo>
  </DataBlock1>
    `,_t={xmlFlags:2,serviceSeq:4594,workingTag:"",companySeq:1,languageSeq:6,userSeq:3106,pgmSeq:1036085},Kt=l=>{const r={..._t,...l},y={xmlDocument:Yt(r),xmlFlags:r.xmlFlags,serviceSeq:r.serviceSeq,workingTag:r.workingTag,companySeq:r.companySeq,languageSeq:r.languageSeq,userSeq:r.userSeq,pgmSeq:r.pgmSeq};return it.post(`${ct}/mssql/stock-out/sp-dmm-out-req-list`,y,{headers:{"Content-Type":"application/json"}}).then(h=>{if(h.status===200||h.status===201)return h.data;throw new Error("Error from API: "+h.data.message)}).catch(h=>{const C=h.response?h.response.data.message||"Error from API":"Unknown error occurred";throw new Error(C)})},De=async(l,r,b,y,h,C,I,q,j,N,p,T,w,P,O,D,n,m,d,k)=>{try{const i=`${ct}/mssql/code-help-query`,R=await it.get(i,{params:{workingTag:l,languageSeq:r,codeHelpSeq:b,companySeq:y,keyword:h,param1:C,param2:I,param3:q,param4:j,conditionSeq:N,pageCount:p,pageSize:T,subConditionSql:w,accUnit:P,bizUnit:O,factUnit:D,deptSeq:n,wkDeptSeq:m,empSeq:d,userSeq:k},headers:{"Content-Type":"application/json"}});return R.status===200?{success:!0,data:R.data.data}:{success:!1,message:ot.ERROR}}catch(i){return{success:!1,message:i.response?i.response.data.message:ot.ERROR}}},{Title:Ht,Text:ds}=Tt;function us({permissions:l,isMobile:r}){const{t:b}=wt();t.useRef(null);const y=vt(),[h,C]=t.useState(!1),[I,q]=t.useState(null),[j,N]=t.useState(!1),[p,T]=t.useState([]),[w,P]=t.useState([]),[O,D]=t.useState([]),[n,m]=t.useState([]),[d,k]=t.useState(at().startOf("month")||""),[i,R]=t.useState(at()),[M,S]=t.useState(4),[u,c]=t.useState(""),[f,v]=t.useState(""),[U,E]=t.useState(""),[Q,$]=t.useState(null),Y=t.useCallback(x=>x.format("YYYYMMDD"),""),[de,J]=t.useState(!1),[H,X]=t.useState(null),[ue,Z]=t.useState(null),[ae,le]=t.useState([]),[me,a]=t.useState(!1),[xe,ne]=t.useState(!1),[je,oe]=t.useState([]),[be,he]=t.useState([]),[we,pe]=t.useState([]),[Se,ie]=t.useState(!1),[ve,fe]=t.useState(!1),[ee,ce]=t.useState(!1),[_,re]=t.useState(1),[o,te]=t.useState(1),[B,se]=t.useState(""),[ge,Ie]=t.useState(""),[rt,Pe]=t.useState(""),[Oe,Me]=t.useState(""),[dt,Ee]=t.useState(""),[ut,Ue]=t.useState(""),[Ae,ze]=t.useState(""),[Be,mt]=t.useState(""),[Fe,xt]=t.useState(""),[$e,ht]=t.useState(""),[We,pt]=t.useState(""),[St,Le]=t.useState({columns:A.empty(),rows:A.empty()}),[ft,Qe]=t.useState({columns:A.empty(),rows:A.empty()}),[gt,Ve]=t.useState({columns:A.empty(),rows:A.empty()});t.useEffect(()=>{const x=localStorage.getItem("detailsStateStockOut");a(x==="open")},[]);const Ye=async()=>{q(!0);try{const x={IsChangedMst:"1",FactUnit:u,ReqDate:d?Y(d):"",ReqDateTo:i?Y(i):"",OutReqNo:We,UseType:U,DeptName:"",DeptSeq:rt,EmpSeq:dt,EmpName:"",CustSeq:ut,CustName:"",ProgStatus:f,ProdPlanNo:Be,WorkOrderNo:Fe,ProdReqNo:$e},K=await Kt(x),W=(K==null?void 0:K.data)||[];T(W)}catch{N(!0),nt.destroy(),nt.error({message:"Lỗi",description:"Có lỗi xảy ra khi tải dữ liệu."})}finally{q(!1)}},_e=t.useCallback(async()=>{C(!0);try{const x=await De("Q",6,10010,1,ge,"","","","",_,1,1e5,o,"1",0,0,0,0,0,18770);oe((x==null?void 0:x.data)||[])}catch{oe([])}finally{C(!1)}},[_,o,ge]),Ke=t.useCallback(async()=>{C(!0);try{const x=await De("Q",6,10009,1,B,"","","","",_,1,1e5,o,"1",0,0,0,0,0,18770);he((x==null?void 0:x.data)||[])}catch{he([])}finally{C(!1)}},[_,o,B]),He=t.useCallback(async()=>{C(!0);try{const x=await De("Q",6,17071,1,B,"","","","",_,1,1e5,"SMCustStatus=2004001","1",0,0,0,0,0,18770);pe((x==null?void 0:x.data)||[])}catch{pe([])}finally{C(!1)}},[_,o,B]),Ge=t.useCallback(async()=>{C(!0);try{const[x,K,W]=await Promise.all([Te("",6,60001,1,"%","","","",""),Te("",6,19998,1,"%","6036","","",""),Te("",6,19998,1,"%","6044","","","")]);P((x==null?void 0:x.data)||[]),D((K==null?void 0:K.data)||[]),m((W==null?void 0:W.data)||[])}catch{P([]),D([])}finally{C(!1)}},[]),qe=t.useMemo(()=>Rt.debounce(Ge,100),[Ge]),Nt=t.useCallback(()=>{Q&&y(`/u/warehouse/material/stock-out-request/${Q}`)},[Q,y]),kt=(x,K)=>{let W;if(x[0]===-1){if(x[0]===-1?(W=x[1],J(!0)):(W=x[0],J(!1)),H&&H[0]===x[0]&&H[1]===x[1]){$(null),X(null),Z(null);return}if(W>=0&&W<p.length){const g=p[W],Ct={IDX_NO:g.IDX_NO,EmpName:g.EmpName,FactUnit:g.FactUnit,FactUnitName:g.FactUnitName,IsConfirm:g.IsConfirm,IsReturn:g.IsReturn,IsStop:g.IsStop,ItemName:g.ItemName,ItemNo:g.ItemNo,ItemSeq:g.ItemSeq,ItemSpec:g.ItemSpec,ItemUnitSeq:g.ItemUnitSeq,OSPPOSeq:g.OSPPOSeq,OutReqNo:g.OutReqNo,OutReqSeq:g.OutReqSeq,PJTSeq:g.PJTSeq,ProdPlanSeq:g.ProdPlanSeq,ProdReqNo:g.ProdReqNo,ProgQty:g.ProgQty,ProgStatus:g.ProgStatus,ProgStatusName:g.ProgStatusName,Qty:g.Qty,Remark:g.Remark,ReqDate:g.ReqDate,UnitName:g.UnitName,UseType:g.UseType,UseTypeName:g.UseTypeName,WBSSeq:g.WBSSeq,WorkOrderNo:g.WorkOrderNo},yt=It.AES.encrypt(JSON.stringify(Ct),"TEST_ACCESS_KEY").toString(),jt=Dt(yt);$(jt),Z(g),X(x)}}},Je=async()=>{ce(!0),ne(!0),_e()},Xe=async()=>{ce(!0),ie(!0),Ke()},Ze=async()=>{ce(!0),fe(!0),He()};t.useEffect(()=>(qe(),()=>{qe.cancel()}),[qe]),t.useEffect(()=>{Ye()},[]);const et=()=>{Le({columns:A.empty(),rows:A.empty()})},tt=()=>{Qe({columns:A.empty(),rows:A.empty()})},st=()=>{Ve({columns:A.empty(),rows:A.empty()})};return e.jsxs(e.Fragment,{children:[e.jsx(qt,{children:e.jsxs("title",{children:["ITM - ",b("Stock Out Request")]})}),e.jsx("div",{className:"bg-slate-50 p-3 h-screen overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-4 md:grid-rows-[auto_1fr] md:gap-4 h-full",children:[e.jsxs("div",{className:"col-start-1 col-end-5 row-start-1 w-full rounded-lg ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ht,{level:4,className:"mt-2 uppercase opacity-85 ",children:b("Stock Out Request")}),e.jsx(Et,{nextPage:Nt,debouncedFetchSPDMMOutReqListQueryWeb:Ye})]}),e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600 uppercase",children:[e.jsx(ye,{}),b("Điều kiện truy vấn")]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(ke,{})})]}),e.jsx("div",{className:"flex p-2 gap-4",children:e.jsx(Mt,{formData:d,setFormData:k,setToDate:R,toDate:i,dataUnit:w,setBizUnit:S,deptName:ge,setDeptName:Ie,setDeptSeq:Pe,handleSearch1:Je,handleSearch2:Xe,handleSearch3:Ze,setModalVisible1:ne,setModalVisible2:ie,loadingCodeHelp:ee,modalVisible1:xe,modalVisible2:Se,setMinorName:D,minorName:O,setFactUnit:c,setProgStatus:v,minorName2:n,setUseType:E,empName:Oe,custName:Ae,setProdPlanNo:mt,prodPlanNo:Be,setWorkOrderNo:xt,workOrderNo:Fe,setProdReqNo:ht,prodReqNo:$e,setOutReqNo:pt,outReqNo:We,resetTable:et,setEmpName:Me,setEmpSeq:Ee,resetTable2:tt,resetTable3:st,setCustName:ze,setCustSeq:Ue})})]})]}),e.jsx("div",{className:"col-start-1 col-end-5 row-start-2 w-full h-full rounded-lg",children:e.jsx(Ut,{data:p,loading:h,setData:T,onCellClicked:kt,setGridData:le,gridData:ae})})]})}),e.jsx(Bt,{setModalVisible:ne,modalVisible:xe,loadingCodeHelp:ee,handleSearch:Je,data:je,setConditionSeq:re,setSubConditionSql:te,fetchCodehelpData1:_e,keyword:B,setKeyword:se,setDeptSeq:Pe,setDeptName:Ie,deptName:ge,setData1:oe,setSelection:Le,selection:St,resetTable:et}),e.jsx(Wt,{setModalVisible:ie,modalVisible:Se,loadingCodeHelp:ee,handleSearch:Xe,data:be,setConditionSeq:re,setSubConditionSql:te,fetchCodehelpData2:Ke,keyword:B,setKeyword:se,setEmpName:Me,setEmpSeq:Ee,setSelection:Qe,selection:ft,resetTable:tt,empName:Oe}),e.jsx(Vt,{setModalVisible:fe,modalVisible:ve,loadingCodeHelp:ee,handleSearch:Ze,data:we,setConditionSeq:re,setSubConditionSql:te,fetchCodehelpData3:He,keyword:B,setKeyword:se,setCustName:ze,setCustSeq:Ue,resetTable:st,setSelection:Ve,selection:gt,custName:Ae})]})}export{us as default};
