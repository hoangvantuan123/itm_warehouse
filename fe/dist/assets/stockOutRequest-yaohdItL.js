import{j as e,F as z,b as wt,C as $,I as V,B as L,R as ke,r as t,M as Ie,a as ct,H as rt,u as vt,c as Tt,d as qt,T as Dt,e as Rt}from"./index-CH1Hwwgx.js";import{A as Ce}from"./index-UcH0C-KJ.js";import{d as nt}from"./dayjs.min-CcT_u-J9.js";import{D as ot,G as De,s as G}from"./getCodeHelpCombo-aa2G8fCH.js";import{l as It}from"./lodash-mC-ok4mC.js";import{C as A,G as s,D as ye,a as Pt}from"./index-DOW1G361.js";import"./moment-CKpJ3YZT.js";import{S as J}from"./index-wrMrSeEs.js";import{R as Ot}from"./FileDoneOutlined-cdbIcIHg.js";import{R as Mt}from"./TableOutlined-DyNz5-WS.js";import{R as je}from"./FilterOutlined-CuCXCfZZ.js";import{E as it}from"./constants-BUjU6TAr.js";import"./DownOutlined-Cd5RM64i.js";function Et({formData:l,setFormData:r,setToDate:b,toDate:y,dataUnit:h,setBizUnit:C,handleSearch1:I,handleSearch2:T,handleSearch3:j,minorName:N,setFactUnit:p,setProgStatus:q,minorName2:w,setUseType:P,deptName:O,empName:D,custName:n,prodPlanNo:m,setProdPlanNo:d,setWorkOrderNo:k,workOrderNo:i,prodReqNo:R,setProdReqNo:M,outReqNo:S,setOutReqNo:u,setDeptName:c,setDeptSeq:f,resetTable:v,setEmpName:U,setEmpSeq:E,resetTable2:Q,setCustSeq:W,setCustName:K,resetTable3:ue}){const X=a=>{r(a)},H=a=>{b(a)},Z=a=>{p(a)},me=a=>{q(a)},ee=a=>{P(a)},le=a=>{c(a.target.value),f(""),v()},ne=a=>{U(a.target.value),E(""),Q()},xe=a=>{K(a.target.value),W(""),ue()};return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(z,{layout:"vertical",onKeyDown:a=>{a.key==="Enter"&&a.preventDefault()},children:e.jsxs(wt,{className:"gap-4 flex items-center ",children:[e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Ngày yêu cầu 1"}),className:"mb-0",children:e.jsx(ot,{className:"w-full text-sm p-2",value:l,onChange:X,format:"YYYY-MM-DD"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Ngày yêu cầu 2"}),className:"mb-0",children:e.jsx(ot,{className:"w-full text-sm p-2",value:y,onChange:H,format:"YYYY-MM-DD"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Nơi sản xuất"}),className:"mb-0",children:e.jsx(J,{defaultValue:"",size:"large",style:{width:190},allowClear:!0,onChange:Z,options:[{label:"All",value:""},...(h==null?void 0:h.map(a=>({label:a==null?void 0:a.AccUnitName,value:a==null?void 0:a.FactUnit})))||[]]})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Bộ phận yêu cầu"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&I()},value:O,onChange:le,onDoubleClick:I})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Người yêu cầu"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&T()},value:D,onChange:ne,onDoubleClick:T})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Khách hàng"}),className:"mb-0",children:e.jsx(V,{size:"small",className:" text-sm p-2 bg-blue-50",onKeyDown:a=>{a.key==="Enter"&&j()},value:n,onChange:xe,onDoubleClick:j})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số yêu cầu"}),className:"mb-0",children:e.jsx(V,{value:S,onChange:a=>u(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số kế hoạch"}),className:"mb-0",children:e.jsx(V,{value:m,onChange:a=>d(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số lệnh sản xuất"}),className:"mb-0",children:e.jsx(V,{value:i,onChange:a=>k(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Số yêu cầu sản xuất"}),className:"mb-0",children:e.jsx(V,{value:R,onChange:a=>M(a.target.value),size:"small",className:" text-sm p-2"})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Phân loại kho"}),className:"mb-0",children:e.jsx(J,{id:"typeSelect",defaultValue:"All",size:"large",style:{width:240},allowClear:!0,onChange:ee,options:[{label:"All",value:""},...(w==null?void 0:w.map(a=>({label:a==null?void 0:a.MinorName,value:a==null?void 0:a.Value})))||[]]})})}),e.jsx($,{children:e.jsx(z.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Trạng thái"}),className:"mb-0",children:e.jsx(J,{id:"typeSelect",defaultValue:"All",size:"large",style:{width:240},allowClear:!0,onChange:me,options:[{label:"All",value:""},...(N==null?void 0:N.map(a=>({label:a==null?void 0:a.MinorName,value:a==null?void 0:a.Value})))||[]]})})})]})})})}function Ut({nextPage:l,debouncedFetchSPDMMOutReqListQueryWeb:r}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{type:"default",icon:e.jsx(Ot,{}),size:"middle",className:"uppercase",color:"default",variant:"filled",onClick:l,style:{backgroundColor:"#f0f0f0",borderColor:"#d9d9d9"},children:"XỬ LÝ XUẤT KHO"},"Reset"),e.jsx(L,{type:"primary",icon:e.jsx(ke,{}),size:"middle",onClick:r,className:"uppercase",children:"SEARCH"},"Save")]})}function At({data:l,onCellClicked:r,gridData:b,setGridData:y,loading:h}){const[C,I]=t.useState(!1),T=t.useCallback(()=>I(!1),[]);t.useState([!1,!1,!1]);const[j,N]=t.useState({columns:A.empty(),rows:A.empty()}),p=t.useMemo(()=>[{title:"IsStop"},{title:"IsConfirm"},{title:"FactUnitName"},{title:"ReqDate"},{title:"OutReqNo"},{title:"DeptName"},{title:"EmpName"},{title:"CustName"},{title:"UseTypeName"},{title:"WorkOrderNo"},{title:"AssyItemName"},{title:"AssyItemNo"},{title:"AssyItemSpec"},{title:"AssyUnitName"},{title:"ProcName"},{title:"AssyQty"},{title:"AssyProgQty"},{title:"ItemName"},{title:"ItemNo"},{title:"ItemSpec"},{title:"UnitName"},{title:"Qty"},{title:"ProgQty"},{title:"IsReturn"},{title:"Remark"},{title:"ItemSeq"},{title:"ItemUnitSeq"},{title:"AssyItemSeq"},{title:"PJTSeq"},{title:"WBSSeq"},{title:"FactUnit"},{title:"OutReqSeq"},{title:"UseType"},{title:"OSPPOSeq"},{title:"ProgStatus"},{title:"ProgStatusName"},{title:"ProdPlanNo"},{title:"ProdPlanSeq"},{title:"ProdReqNo"}],[]),[q,w]=t.useState(p),P=t.useCallback((m,d)=>{const k=q.indexOf(m);if(k!==-1){const i={...m,width:d},R=[...q];R.splice(k,1,i),w(R)}},[q]),O=t.useCallback(([m,d])=>{const k=b[d]||{},{IsStop:i="",IsConfirm:R="",FactUnitName:M="",ReqDate:S="",OutReqNo:u="",DeptName:c="",EmpName:f="",CustName:v="",UseTypeName:U="",WorkOrderNo:E="",AssyItemName:Q="",AssyItemNo:W="",AssyItemSpec:K="",AssyUnitName:ue="",ProcName:X="",AssyQty:H="",AssyProgQty:Z="",ItemName:me="",ItemNo:ee="",ItemSpec:le="",UnitName:ne="",Qty:xe="",ProgQty:a="",IsReturn:he="",Remark:oe="",ItemSeq:be="",ItemUnitSeq:ie="",AssyItemSeq:we="",PJTSeq:pe="",WBSSeq:ve="",FactUnit:Se="",OutReqSeq:fe="",UseType:ce="",OSPPOSeq:Te="",ProgStatus:ge="",ProgStatusName:te="",ProdPlanNo:re="",ProdPlanSeq:Y="",ProdReqNo:de=""}=k,o=B=>B!=null?String(B):"",se={0:{kind:s.Boolean,data:i},1:{kind:s.Boolean,data:R},2:{kind:s.Text,data:o(M)},3:{kind:s.Text,data:o(S)},4:{kind:s.Text,data:o(u)},5:{kind:s.Text,data:o(c)},6:{kind:s.Text,data:o(f)},7:{kind:s.Text,data:o(v)},8:{kind:s.Text,data:o(U)},9:{kind:s.Text,data:o(E)},10:{kind:s.Text,data:o(Q)},11:{kind:s.Text,data:o(W)},12:{kind:s.Text,data:o(K)},13:{kind:s.Text,data:o(ue)},14:{kind:s.Text,data:o(X)},15:{kind:s.Text,data:o(H)},16:{kind:s.Text,data:o(Z)},17:{kind:s.Text,data:o(me)},18:{kind:s.Text,data:o(ee)},19:{kind:s.Text,data:o(le)},20:{kind:s.Text,data:o(ne)},21:{kind:s.Text,data:o(xe)},22:{kind:s.Text,data:o(a)},23:{kind:s.Boolean,data:he},24:{kind:s.Text,data:o(oe)},25:{kind:s.Text,data:o(be)},26:{kind:s.Text,data:o(ie)},27:{kind:s.Text,data:o(we)},28:{kind:s.Text,data:o(pe)},29:{kind:s.Text,data:o(ve)},30:{kind:s.Text,data:o(Se)},31:{kind:s.Text,data:o(fe)},32:{kind:s.Text,data:o(ce)},33:{kind:s.Text,data:o(Te)},34:{kind:s.Text,data:o(ge)},35:{kind:s.Text,data:o(te)},36:{kind:s.Text,data:o(re)},37:{kind:s.Text,data:o(Y)},38:{kind:s.Text,data:o(de)}};if(se.hasOwnProperty(m)){const{kind:B,data:ae}=se[m];return{kind:B,data:ae,displayData:ae}}return{kind:"",data:"",displayData:""}},[b]),[D,n]=t.useState(void 0);return t.useCallback(m=>{console.log("cell",m),n(m)},[]),t.useEffect(()=>{y(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8  overflow-hidden",children:e.jsxs("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 p-2 text-blue-600 uppercase",children:[e.jsx(Mt,{}),"DATA SHEET"]}),e.jsx(ye,{columns:q,getCellContent:O,rows:b.length,showSearch:C,getCellsForSelection:!0,onSearchClose:T,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:P,smoothScrollY:!0,smoothScrollX:!0,rowSelect:"single",onCellClicked:r,gridSelection:j,onGridSelectionChange:N,getRowThemeOverride:m=>m%2===0?void 0:{bgCell:"#FBFBFB"}})]})})}function zt({data:l,onCellClicked:r,setSelection:b,selection:y}){const[h,C]=t.useState([]),[I,T]=t.useState(!1),j=t.useCallback(()=>T(!1),[]),N=t.useMemo(()=>[{title:"BeDeptName"},{title:"BeBegDate"},{title:"BeEndDate"},{title:"DeptRemark"}],[]),[p,q]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),q(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{BeDeptName:k="",BeBegDate:i="",BeEndDate:R="",DeptRemark:M=""}=d,S=c=>c!=null?String(c):"",u={0:{kind:s.Text,data:S(k)},1:{kind:s.Text,data:S(i)},2:{kind:s.Text,data:S(R)},3:{kind:s.Text,data:S(M)}};if(u.hasOwnProperty(n)){const{kind:c,data:f}=u[n];return{kind:c,data:f,displayData:f}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(ye,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"single",gridSelection:y,onGridSelectionChange:b})})})}const{Search:Bt}=V;function Ft({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,fetchCodehelpData1:h,handleSearch:C,setSubConditionSql:I,setDeptName:T,setDeptSeq:j,deptName:N,selection:p,setSelection:q,resetTable:w}){const[P,O]=t.useState(!1),[D,n]=t.useState(null),[m,d]=t.useState(null);t.useState(null);const k=u=>{l(u)},i=u=>{I(u)},R=(u,c)=>{let f;if(u[0]!==-1){console.log("onCellClicked");return}if(u[0]===-1?(f=u[1],O(!0)):(f=u[0],O(!1)),D&&D[0]===u[0]&&D[1]===u[1]){T(""),j(""),n(null),d(null);return}if(f>=0&&f<r.length){const v=r[f];T(v==null?void 0:v.BeDeptName),j(v==null?void 0:v.BeDeptSeq),d(v),n(u)}},M=()=>{y(!1),T(""),j(""),w()},S=u=>{T(u.target.value),j(""),w()};return e.jsx("div",{children:e.jsxs(Ie,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(je,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(Ce,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(J,{id:"typeSelect",defaultValue:"Bộ phận",style:{width:120},size:"middle",onChange:k,options:[{value:1,label:"Bộ phận"},{value:0,label:"Mã bộ phận"}]})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(J,{id:"typeSelect",defaultValue:"Sử dụng",style:{width:300},size:"middle",options:[{value:"IsUse = 1",label:"Sử dụng"},{value:"IsUse = 0",label:"Chưa sử dụng"}],onChange:i})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx(Bt,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:N,onKeyDown:u=>{u.key==="Enter"&&C()},onChange:S,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(ke,{}),size:"middle",onClick:h,children:"Truy vấn"})})]})]}),e.jsx(zt,{data:r,onCellClicked:R,setSelection:q,selection:p})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:M,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}function $t({data:l,onCellClicked:r,setSelection:b,selection:y}){const[h,C]=t.useState([]),[I,T]=t.useState(!1),j=t.useCallback(()=>T(!1),[]),N=t.useMemo(()=>[{title:"EmpName"},{title:"EmpID"},{title:"DeptName"},{title:"WkDeptName"},{title:"UMJoName"},{title:"PosName"},{title:"UMJpName"},{title:"UMJdName"},{title:"TypeName"},{title:"SMSexName"}],[]),[p,q]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),q(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{EmpName:k="",EmpID:i="",DeptName:R="",WkDeptName:M="",UMJoName:S="",PosName:u="",UMJpName:c="",UMJdName:f="",TypeName:v="",SMSexName:U=""}=d,E=W=>W!=null?String(W):"",Q={0:{kind:s.Text,data:E(k)},1:{kind:s.Text,data:E(i)},2:{kind:s.Text,data:E(R)},3:{kind:s.Text,data:E(M)},4:{kind:s.Text,data:E(S)},5:{kind:s.Text,data:E(u)},6:{kind:s.Text,data:E(c)},7:{kind:s.Text,data:E(f)},8:{kind:s.Text,data:E(v)},9:{kind:s.Text,data:E(U)}};if(Q.hasOwnProperty(n)){const{kind:W,data:K}=Q[n];return{kind:W,data:K,displayData:K}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{console.log("cell",n),D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(ye,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"multi",gridSelection:y,onGridSelectionChange:b})})})}const{Search:Wt}=V;function Lt({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,empName:h,handleSearch:C,setSubConditionSql:I,fetchCodehelpData2:T,setEmpSeq:j,setEmpName:N,setSelection:p,selection:q,resetTable:w}){const[P,O]=t.useState(!1),[D,n]=t.useState(null),[m,d]=t.useState(null);t.useState(null);const k=S=>{l(S)},i=(S,u)=>{let c;if(S[0]===-1){if(S[0]===-1?(c=S[1],O(!0)):(c=S[0],O(!1)),D&&D[0]===S[0]&&D[1]===S[1]){N(""),j(""),n(null),d(null);return}if(c>=0&&c<r.length){const f=r[c];N(f==null?void 0:f.EmpName),j(f==null?void 0:f.EmpSeq),d(f),n(S)}}},R=()=>{y(!1),N(""),j(""),w()},M=S=>{N(S.target.value),j(""),w()};return e.jsx("div",{children:e.jsxs(Ie,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(je,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(Ce,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(J,{id:"typeSelect",defaultValue:"Nhân viên",style:{width:180},size:"middle",options:[{value:1,label:"Nhân viên"},{value:2,label:"Mã nhân viên"}],onChange:k})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx(Wt,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:h,onKeyDown:S=>{S.key==="Enter"&&C()},onChange:M,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(ke,{}),size:"middle",onClick:T,children:"Truy vấn"})})]})]}),e.jsx($t,{data:r,onCellClicked:i,setSelection:p,selection:q})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:R,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}function Qt({data:l,onCellClicked:r,selection:b,setSelection:y}){const[h,C]=t.useState([]),[I,T]=t.useState(!1),j=t.useCallback(()=>T(!1),[]),N=t.useMemo(()=>[{title:"CustSeq"},{title:"FullName"},{title:"CustNo"},{title:"BizNo"},{title:"UMCustClassName"}],[]),[p,q]=t.useState(N),w=t.useCallback((n,m)=>{const d=p.indexOf(n);if(d!==-1){const k={...n,width:m},i=[...p];i.splice(d,1,k),q(i)}},[p]),P=t.useCallback(([n,m])=>{const d=h[m]||{},{CustSeq:k="",FullName:i="",CustNo:R="",BizNo:M="",UMCustClassName:S=""}=d,u=f=>f!=null?String(f):"",c={0:{kind:s.Text,data:u(k)},1:{kind:s.Text,data:u(i)},2:{kind:s.Text,data:u(R)},3:{kind:s.Text,data:u(M)},4:{kind:s.Text,data:u(S)}};if(c.hasOwnProperty(n)){const{kind:f,data:v}=c[n];return{kind:f,data:v,displayData:v}}return{kind:s.Text,data:"",displayData:""}},[h]),[O,D]=t.useState(void 0);return t.useCallback(n=>{console.log("cell",n),D(n)},[]),t.useEffect(()=>{C(l)},[l]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsx("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:e.jsx(ye,{columns:p,getCellContent:P,rows:h.length,showSearch:I,getCellsForSelection:!0,onSearchClose:j,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:w,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:r,rowSelect:"multi",gridSelection:b,onGridSelectionChange:y})})})}const{Search:Vt}=V;function Kt({setConditionSeq:l,data:r,modalVisible:b,setModalVisible:y,setKeyword:h,keyword:C,handleSearch:I,setSubConditionSql:T,fetchCodehelpData3:j,setCustSeq:N,setCustName:p,custName:q,resetTable:w,setSelection:P,selection:O}){const[D,n]=t.useState(!1),[m,d]=t.useState(null),[k,i]=t.useState(null);t.useState(null);const R=c=>{l(c)},M=(c,f)=>{let v;if(c[0]===-1){if(c[0]===-1?(v=c[1],n(!0)):(v=c[0],n(!1)),m&&m[0]===c[0]&&m[1]===c[1]){p(""),N(""),d(null),i(null);return}if(v>=0&&v<r.length){const U=r[v];p(U==null?void 0:U.FullName),N(U==null?void 0:U.CustSeq),i(U),d(c)}}},S=()=>{y(!1),p(""),N(""),w()},u=c=>{p(c.target.value),N(""),w()};return e.jsx("div",{children:e.jsxs(Ie,{open:b,width:"80%",maskClosable:!1,footer:null,closable:!1,style:{top:50},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"75vh"},className:"gap-4",children:[e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600",children:[e.jsx(je,{}),"Điều kiện truy vấn"]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(Ce,{})})]}),e.jsxs("div",{className:"flex p-2 gap-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(J,{id:"typeSelect",defaultValue:"Điểm gia công bên ngoài",style:{width:220},size:"middle",options:[{value:1,label:"Điểm gia công bên ngoài"},{value:2,label:"Số đơn vị gia công"},{value:3,label:"Mã số kinh doanh"},{value:4,label:"Tương hiệu"}],onChange:R})}),e.jsx("div",{className:"flex flex-col w-full",children:e.jsx(Vt,{allowClear:!0,size:"middle",placeholder:"Tìm kiếm",value:q,onKeyDown:c=>{c.key==="Enter"&&I()},onChange:u,className:" w-full"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(L,{type:"primary",icon:e.jsx(ke,{}),size:"middle",onClick:j,children:"Truy vấn"})})]})]}),e.jsx(Qt,{data:r,onCellClicked:M,setSelection:P,selection:O})]}),e.jsxs("div",{className:"flex justify-end gap-4 ",children:[e.jsx(L,{onClick:S,children:"Cancel"}),e.jsx(L,{type:"primary",onClick:()=>y(!1),children:"Save"})]})]})})}const Yt=l=>`
       <DataBlock1>
    <WorkingTag>A</WorkingTag>
    <IDX_NO>1</IDX_NO>
    <Status>0</Status>
    <DataSeq>1</DataSeq>
    <Selected>1</Selected>
    <TABLE_NAME>DataBlock1</TABLE_NAME>
    <IsChangedMst>${l.IsChangedMst}</IsChangedMst>
    <FactUnit>${l.FactUnit}</FactUnit>
    <ReqDate>${l.ReqDate}</ReqDate>
    <ReqDateTo>${l.ReqDateTo}</ReqDateTo>
    <OutReqNo>${l.OutReqNo}</OutReqNo>
    <UseType>${l.UseType}</UseType>
    <DeptSeq>${l.DeptSeq}</DeptSeq>
    <DeptName>${l.DeptName} </DeptName>
    <EmpSeq>${l.EmpSeq} </EmpSeq>
    <EmpName>${l.EmpName}</EmpName>
    <CustSeq>${l.CustSeq}</CustSeq>
    <CustName>${l.CustName}</CustName>
    <ProgStatus>${l.ProgStatus}</ProgStatus>
    <ProdPlanNo>${l.ProdPlanNo}</ProdPlanNo>
    <WorkOrderNo>${l.WorkOrderNo}</WorkOrderNo>
    <ProdReqNo>${l.ProdReqNo}</ProdReqNo>
  </DataBlock1>
    `,_t={xmlFlags:2,serviceSeq:4594,workingTag:"",companySeq:1,languageSeq:6,userSeq:3106,pgmSeq:1036085},Ht=l=>{const r={..._t,...l},y={xmlDocument:Yt(r),xmlFlags:r.xmlFlags,serviceSeq:r.serviceSeq,workingTag:r.workingTag,companySeq:r.companySeq,languageSeq:r.languageSeq,userSeq:r.userSeq,pgmSeq:r.pgmSeq};return ct.post(`${rt}/mssql/stock-out/sp-dmm-out-req-list`,y,{headers:{"Content-Type":"application/json"}}).then(h=>{if(h.status===200||h.status===201)return h.data;throw new Error("Error from API: "+h.data.message)}).catch(h=>{const C=h.response?h.response.data.message||"Error from API":"Unknown error occurred";throw new Error(C)})},Re=async(l,r,b,y,h,C,I,T,j,N,p,q,w,P,O,D,n,m,d,k)=>{try{const i=`${rt}/mssql/code-help-query`,R=await ct.get(i,{params:{workingTag:l,languageSeq:r,codeHelpSeq:b,companySeq:y,keyword:h,param1:C,param2:I,param3:T,param4:j,conditionSeq:N,pageCount:p,pageSize:q,subConditionSql:w,accUnit:P,bizUnit:O,factUnit:D,deptSeq:n,wkDeptSeq:m,empSeq:d,userSeq:k},headers:{"Content-Type":"application/json"}});return R.status===200?{success:!0,data:R.data.data}:{success:!1,message:it.ERROR}}catch(i){return{success:!1,message:i.response?i.response.data.message:it.ERROR}}},{Title:Gt,Text:us}=Dt;function ms({permissions:l,isMobile:r}){const{t:b}=vt();t.useRef(null);const y=Tt(),[h,C]=t.useState(!1),[I,T]=t.useState(null),[j,N]=t.useState(!1),[p,q]=t.useState([]),[w,P]=t.useState([]),[O,D]=t.useState([]),[n,m]=t.useState([]),[d,k]=t.useState(nt().startOf("month")||""),[i,R]=t.useState(nt()),[M,S]=t.useState(4),[u,c]=t.useState(""),[f,v]=t.useState(""),[U,E]=t.useState(""),[Q,W]=t.useState(null),K=t.useCallback(x=>x.format("YYYYMMDD"),""),[ue,X]=t.useState(!1),[H,Z]=t.useState(null),[me,ee]=t.useState(null),[le,ne]=t.useState([]),[xe,a]=t.useState(!1),[he,oe]=t.useState(!1),[be,ie]=t.useState([]),[we,pe]=t.useState([]),[ve,Se]=t.useState([]),[fe,ce]=t.useState(!1),[Te,ge]=t.useState(!1),[te,re]=t.useState(!1),[Y,de]=t.useState(1),[o,se]=t.useState(1),[B,ae]=t.useState(""),[Ne,Pe]=t.useState(""),[dt,Oe]=t.useState(""),[Me,Ee]=t.useState(""),[ut,Ue]=t.useState(""),[mt,Ae]=t.useState(""),[ze,Be]=t.useState(""),[Fe,xt]=t.useState(""),[$e,ht]=t.useState(""),[We,pt]=t.useState(""),[Le,St]=t.useState(""),[ft,Qe]=t.useState({columns:A.empty(),rows:A.empty()}),[gt,Ve]=t.useState({columns:A.empty(),rows:A.empty()}),[Nt,Ke]=t.useState({columns:A.empty(),rows:A.empty()});t.useEffect(()=>{const x=localStorage.getItem("detailsStateStockOut");a(x==="open")},[]);let Ye;const _e=async()=>{T(!0),Ye&&G.destroy(),Ye=G.info({message:"Đang tải dữ liệu",description:"Dữ liệu đang được tải.",duration:0});try{const x={IsChangedMst:"1",FactUnit:u,ReqDate:d?K(d):"",ReqDateTo:i?K(i):"",OutReqNo:Le,UseType:U,DeptName:"",DeptSeq:dt,EmpSeq:ut,EmpName:"",CustSeq:mt,CustName:"",ProgStatus:f,ProdPlanNo:Fe,WorkOrderNo:$e,ProdReqNo:We},_=await Ht(x),F=(_==null?void 0:_.data)||[];q(F),G.destroy(),F.length>0?G.success({message:"Thành công",description:"Dữ liệu đã được tải thành công."}):G.success({message:"Thành công",description:"Không có dữ liệu phù hợp được tìm thấy."})}catch{N(!0),G.destroy(),G.error({message:"Lỗi",description:"Có lỗi xảy ra khi tải dữ liệu."})}finally{T(!1)}},He=t.useCallback(async()=>{C(!0);try{const x=await Re("Q",6,10010,1,Ne,"","","","",Y,1,1e5,o,"1",0,0,0,0,0,18770);ie((x==null?void 0:x.data)||[])}catch{ie([])}finally{C(!1)}},[Y,o,Ne]),Ge=t.useCallback(async()=>{C(!0);try{const x=await Re("Q",6,10009,1,B,"","","","",Y,1,1e5,o,"1",0,0,0,0,0,18770);pe((x==null?void 0:x.data)||[])}catch{pe([])}finally{C(!1)}},[Y,o,B]),Je=t.useCallback(async()=>{C(!0);try{const x=await Re("Q",6,17071,1,B,"","","","",Y,1,1e5,"SMCustStatus=2004001","1",0,0,0,0,0,18770);Se((x==null?void 0:x.data)||[])}catch{Se([])}finally{C(!1)}},[Y,o,B]),Xe=t.useCallback(async()=>{C(!0);try{const[x,_,F]=await Promise.all([De("",6,60001,1,"%","","","",""),De("",6,19998,1,"%","6036","","",""),De("",6,19998,1,"%","6044","","","")]);P((x==null?void 0:x.data)||[]),D((_==null?void 0:_.data)||[]),m((F==null?void 0:F.data)||[])}catch{P([]),D([])}finally{C(!1)}},[]),qe=t.useMemo(()=>It.debounce(Xe,100),[Xe]),kt=t.useCallback(()=>{Q&&y(`/u/warehouse/material/stock-out-request/${Q}`)},[Q,y]),Ct=(x,_)=>{let F;if(x[0]===-1){if(x[0]===-1?(F=x[1],X(!0)):(F=x[0],X(!1)),H&&H[0]===x[0]&&H[1]===x[1]){W(null),Z(null),ee(null);return}if(F>=0&&F<p.length){const g=p[F],yt={IDX_NO:g.IDX_NO,EmpName:g.EmpName,FactUnit:g.FactUnit,FactUnitName:g.FactUnitName,IsConfirm:g.IsConfirm,IsReturn:g.IsReturn,IsStop:g.IsStop,ItemName:g.ItemName,ItemNo:g.ItemNo,ItemSeq:g.ItemSeq,ItemSpec:g.ItemSpec,ItemUnitSeq:g.ItemUnitSeq,OSPPOSeq:g.OSPPOSeq,OutReqNo:g.OutReqNo,OutReqSeq:g.OutReqSeq,PJTSeq:g.PJTSeq,ProdPlanSeq:g.ProdPlanSeq,ProdReqNo:g.ProdReqNo,ProgQty:g.ProgQty,ProgStatus:g.ProgStatus,ProgStatusName:g.ProgStatusName,Qty:g.Qty,Remark:g.Remark,ReqDate:g.ReqDate,UnitName:g.UnitName,UseType:g.UseType,UseTypeName:g.UseTypeName,WBSSeq:g.WBSSeq,WorkOrderNo:g.WorkOrderNo},jt=Pt.AES.encrypt(JSON.stringify(yt),"TEST_ACCESS_KEY").toString(),bt=Rt(jt);W(bt),ee(g),Z(x)}}},Ze=async()=>{re(!0),oe(!0),He()},et=async()=>{re(!0),ce(!0),Ge()},tt=async()=>{re(!0),ge(!0),Je()};t.useEffect(()=>(qe(),()=>{qe.cancel()}),[qe]),t.useEffect(()=>{_e()},[]);const st=()=>{Qe({columns:A.empty(),rows:A.empty()})},at=()=>{Ve({columns:A.empty(),rows:A.empty()})},lt=()=>{Ke({columns:A.empty(),rows:A.empty()})};return e.jsxs(e.Fragment,{children:[e.jsx(qt,{children:e.jsxs("title",{children:["ITM - ",b("Stock Out Request")]})}),e.jsx("div",{className:"bg-slate-50 p-3 h-screen overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-4 md:grid-rows-[auto_1fr] md:gap-4 h-full",children:[e.jsxs("div",{className:"col-start-1 col-end-5 row-start-1 w-full rounded-lg ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Gt,{level:4,className:"mt-2 uppercase opacity-85 ",children:b("Stock Out Request")}),e.jsx(Ut,{nextPage:kt,debouncedFetchSPDMMOutReqListQueryWeb:_e})]}),e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:!0,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600 uppercase",children:[e.jsx(je,{}),b("Điều kiện truy vấn")]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(Ce,{})})]}),e.jsx("div",{className:"flex p-2 gap-4",children:e.jsx(Et,{formData:d,setFormData:k,setToDate:R,toDate:i,dataUnit:w,setBizUnit:S,deptName:Ne,setDeptName:Pe,setDeptSeq:Oe,handleSearch1:Ze,handleSearch2:et,handleSearch3:tt,setModalVisible1:oe,setModalVisible2:ce,loadingCodeHelp:te,modalVisible1:he,modalVisible2:fe,setMinorName:D,minorName:O,setFactUnit:c,setProgStatus:v,minorName2:n,setUseType:E,empName:Me,custName:ze,setProdPlanNo:xt,prodPlanNo:Fe,setWorkOrderNo:ht,workOrderNo:$e,setProdReqNo:pt,prodReqNo:We,setOutReqNo:St,outReqNo:Le,resetTable:st,setEmpName:Ee,setEmpSeq:Ue,resetTable2:at,resetTable3:lt,setCustName:Be,setCustSeq:Ae})})]})]}),e.jsx("div",{className:"col-start-1 col-end-5 row-start-2 w-full h-full rounded-lg",children:e.jsx(At,{data:p,loading:h,setData:q,onCellClicked:Ct,setGridData:ne,gridData:le})})]})}),e.jsx(Ft,{setModalVisible:oe,modalVisible:he,loadingCodeHelp:te,handleSearch:Ze,data:be,setConditionSeq:de,setSubConditionSql:se,fetchCodehelpData1:He,keyword:B,setKeyword:ae,setDeptSeq:Oe,setDeptName:Pe,deptName:Ne,setData1:ie,setSelection:Qe,selection:ft,resetTable:st}),e.jsx(Lt,{setModalVisible:ce,modalVisible:fe,loadingCodeHelp:te,handleSearch:et,data:we,setConditionSeq:de,setSubConditionSql:se,fetchCodehelpData2:Ge,keyword:B,setKeyword:ae,setEmpName:Ee,setEmpSeq:Ue,setSelection:Ve,selection:gt,resetTable:at,empName:Me}),e.jsx(Kt,{setModalVisible:ge,modalVisible:Te,loadingCodeHelp:te,handleSearch:tt,data:ve,setConditionSeq:de,setSubConditionSql:se,fetchCodehelpData3:Je,keyword:B,setKeyword:ae,setCustName:Be,setCustSeq:Ae,resetTable:lt,setSelection:Ke,selection:Nt,custName:ze})]})}export{ms as default};
