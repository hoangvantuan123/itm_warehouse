import{j as e,B as ee,R as re,r as t,H as ie,a as oe,F as q,b as ce,C as F,I as de,u as me,c as ue,d as pe,T as xe,e as he}from"./index-BWNGbzMT.js";import{A as fe}from"./index-BjysB1K-.js";import{d as te}from"./dayjs.min-BoJTjgW-.js";import{R as De}from"./SaveOutlined-6uJwnyMm.js";import{C as se,G as n,D as ge,a as ye}from"./index-6AS5S1kS.js";import{R as Se}from"./TableOutlined-Dq09ekA2.js";import{D as ae,G as Ce,N as Ne}from"./noneData-D5XOaVuN.js";import{E as le}from"./constants-BUjU6TAr.js";import"./moment-RJj39j5D.js";import{S as ke}from"./index-Cj7EOr8Z.js";import{l as ne}from"./lodash-B79OEnJp.js";import{R as je}from"./FilterOutlined-DLYuFGyO.js";import"./vi-DzcY_adS.js";import"./DownOutlined-DDVFEjpU.js";function ve({fetchData:c,nextPageStockIn:x}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{type:"default",icon:e.jsx(De,{}),size:"middle",className:"uppercase",color:"default",variant:"filled",style:{backgroundColor:"#f0f0f0",borderColor:"#d9d9d9"},onClick:x,children:"STOCK IN (IQC)"},"Reset"),e.jsx(ee,{type:"primary",icon:e.jsx(re,{}),size:"middle",className:"uppercase",onClick:c,children:"SEARCH"},"Save")]})}function Te({data:c,loading:x,handleCheck:u,gridRef:h,setKeyPath:d,checkedPath:o,setCheckedPath:z,onCellClicked:f,gridData:m,setGridData:N}){const[D,j]=t.useState(!1),r=t.useCallback(()=>j(!1),[]),[U,v]=t.useState({columns:se.empty(),rows:se.empty()}),Y=t.useMemo(()=>[{title:"DelvNo"},{title:"DelvMngNo"},{title:"ImpType"},{title:"TotalQty"},{title:"OkQty"},{title:"RemainQty"},{title:"DelvDate"},{title:"CustSeq"},{title:"CustNm"},{title:"DomOrImp"},{title:"PurchaseType"},{title:"BizUnitName"},{title:"BizUnit"},{title:"EmpSeq"},{title:"EmpName"},{title:"DeptSeq"},{title:"DeptName"},{title:"CurrSeq"},{title:"CurrName"},{title:"ExRate"}],[]),[p,L]=t.useState(Y),T=t.useCallback((i,M)=>{const g=p.indexOf(i);if(g!==-1){const y={...i,width:M},S=[...p];S.splice(g,1,y),L(S)}},[p]),b=t.useCallback(([i,M])=>{const g=m[M]||{},{DelvNo:y="",DelvMngNo:S="",ImpType:W="",TotalQty:A="",OkQty:w="",RemainQty:_="",DelvDate:H="",CustSeq:B="",CustNm:K="",DomOrImp:R="",PurchaseType:P="",BizUnitName:E="",BizUnit:I="",EmpSeq:$="",EmpName:J="",DeptSeq:s="",DeptName:O="",CurrSeq:C="",CurrName:a="",ExRate:V=""}=g,l=k=>k!=null?String(k):"",Q={0:{kind:n.Text,data:l(y)},1:{kind:n.Text,data:l(S)},2:{kind:n.Text,data:l(W)},3:{kind:n.Text,data:l(A)},4:{kind:n.Text,data:l(w)},5:{kind:n.Text,data:l(_)},6:{kind:n.Text,data:l(H)},7:{kind:n.Text,data:l(B)},8:{kind:n.Text,data:l(K)},9:{kind:n.Text,data:l(R)},10:{kind:n.Text,data:l(P)},11:{kind:n.Text,data:l(E)},12:{kind:n.Text,data:l(I)},13:{kind:n.Text,data:l($)},14:{kind:n.Text,data:l(J)},15:{kind:n.Text,data:l(s)},16:{kind:n.Text,data:l(O)},17:{kind:n.Text,data:l(C)},18:{kind:n.Text,data:l(a)},19:{kind:n.Text,data:l(V)}};if(Q.hasOwnProperty(i)){const{kind:k,data:Z}=Q[i];return{kind:k,data:Z,displayData:Z}}return{kind:n.Text,data:"",displayData:""}},[m]),[X,G]=t.useState(void 0);return t.useCallback(i=>{console.log("cell",i),G(i)},[]),t.useEffect(()=>{N(c)},[c]),e.jsx("div",{className:"w-full gap-1 h-full flex items-center justify-center pb-8",children:e.jsxs("div",{className:"w-full h-full flex flex-col border bg-white rounded-lg overflow-hidden ",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 p-2 text-blue-600 uppercase",children:[e.jsx(Se,{}),"DATA SHEET"]}),e.jsx(ge,{columns:p,getCellContent:b,rows:m.length,showSearch:D,getCellsForSelection:!0,onSearchClose:r,width:"100%",height:"100%",rowMarkers:"both",useRef:t.useRef,onColumnResize:T,smoothScrollY:!0,smoothScrollX:!0,onCellClicked:f,rowSelect:"single",gridSelection:U,onGridSelectionChange:v,getRowThemeOverride:i=>i%2===0?void 0:{bgCell:"#FBFBFB"}})]})})}const be=async(c,x,u,h)=>{try{const d=`${ie}/mssql/deliverry-list/itm-sug-get-active-delivery-web`,o=await oe.get(d,{params:{fromDate:c,toDate:x,deliveryNo:u,delivbizUniteryNo:h},headers:{"Content-Type":"application/json"}});return o.status===200?{success:!0,data:o.data.data}:{success:!1,message:le.ERROR}}catch(d){return{success:!1,message:d.response?d.response.data.message:le.ERROR}}};function we({formData:c,setFormData:x,setDeliveryNo:u,setToDate:h,toDate:d,deliveryNo:o,bizUnit:z,setBizUnit:f,dataUnit:m}){const N=r=>{x(r)},D=r=>{h(r)},j=r=>{f(r)};return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(q,{layout:"vertical",children:e.jsxs(ce,{className:"gap-4 flex items-center ",children:[e.jsx(F,{children:e.jsx(q.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Date 1"}),className:"mb-0",children:e.jsx(ae,{className:"w-full text-sm p-2",value:c,onChange:N})})}),e.jsx(F,{children:e.jsx(q.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Date 2"}),className:"mb-0",children:e.jsx(ae,{className:"w-full text-sm p-2",value:d,onChange:D,format:"YYYY-MM-DD"})})}),e.jsx(F,{children:e.jsx(q.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Delivery No"}),className:"mb-0",children:e.jsx(de,{placeholder:"Input placeholder",value:o,size:"small",onChange:r=>u(r.target.value),className:" text-sm p-2"})})}),e.jsx(F,{children:e.jsx(q.Item,{label:e.jsx("span",{className:"uppercase text-[10px]",children:"Acc Unit"}),className:"mb-0",children:e.jsx(ke,{id:"typeSelect",defaultValue:"All",size:"large",style:{width:190},onChange:j,options:m==null?void 0:m.map(r=>({label:r==null?void 0:r.AccUnitName,value:r==null?void 0:r.BizUnit}))})})})]})})})}const{Title:Re,Text:Ge}=xe;function _e({permissions:c,isMobile:x}){const{t:u}=me();t.useRef(null);const h=ue(),[d,o]=t.useState(!1),[z,f]=t.useState([]),[m,N]=t.useState([]),[D,j]=t.useState(te().startOf("month")),[r,U]=t.useState(te()),[v,Y]=t.useState(""),[p,L]=t.useState(4);t.useState(null);const[T,b]=t.useState(null),[X,G]=t.useState(!1),i=t.useCallback(s=>s.format("YYYYMMDD"),[]),[M,g]=t.useState(!1),[y,S]=t.useState(null),[W,A]=t.useState(null);t.useState([]);const[w,_]=t.useState([]),[H,B]=t.useState(!1);t.useEffect(()=>{const s=localStorage.getItem("detailsStateDelist");B(s==="open")},[]);const K=s=>{const O=s.target.open;B(O),localStorage.setItem("detailsStateDelist",O?"open":"closed")},R=t.useCallback(async()=>{o(!0);try{const s=await be(i(D),i(r),v,p);f((s==null?void 0:s.data)||[])}catch{f([])}finally{o(!1)}},[D,r,v,p,i]),P=t.useCallback(async()=>{o(!0);try{const s=await Ce("",6,10003,1,"%","","","","");N((s==null?void 0:s.data)||[])}catch{N([])}finally{o(!1)}},[]),E=t.useMemo(()=>ne.debounce(R,100),[R]),I=t.useMemo(()=>ne.debounce(P,100),[P]),$=t.useCallback(()=>{T&&h(`/u/warehouse/material/waiting-iqc-stock-in/${T}`)},[T,h]),J=(s,O)=>{let C;if(s[0]===-1){if(s[0]===-1?(C=s[1],g(!0)):(C=s[0],g(!1)),y&&y[0]===s[0]&&y[1]===s[1]){b(null),S(null),A(null);return}if(C>=0&&C<w.length){const a=w[C],V={DelvNo:a.DelvNo,DelvMngNo:a.DelvMngNo,ImpType:a.ImpType,TotalQty:a.TotalQty,OkQty:a.OkQty,RemainQty:a.RemainQty,DelvDate:a.DelvDate,CustSeq:a.CustSeq,CustNm:a.CustNm,DomOrImp:a.DomOrImp,PurchaseType:a.PurchaseType,BizUnitName:a.BizUnitName,BizUnit:a.BizUnit,EmpSeq:a.EmpSeq,EmpName:a.EmpName,DeptSeq:a.DeptSeq,DeptName:a.DeptName,CurrSeq:a.CurrSeq,CurrName:a.CurrName,ExRate:a.ExRate},Q=ye.AES.encrypt(JSON.stringify(V),"TEST_ACCESS_KEY").toString(),k=he(Q);b(k),A(a),S(s)}}};return t.useEffect(()=>(E(),()=>{E.cancel()}),[E]),t.useEffect(()=>(I(),()=>{I.cancel()}),[I]),e.jsxs(e.Fragment,{children:[e.jsx(pe,{children:e.jsxs("title",{children:["ITM - ",u("Delivery List")]})}),e.jsx("div",{className:"bg-slate-50 p-3 h-screen overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-4 md:grid-rows-[auto_1fr] md:gap-4 h-full",children:[e.jsxs("div",{className:"col-start-1 col-end-5 row-start-1 w-full rounded-lg ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Re,{level:4,className:"mt-2 uppercase opacity-85 ",children:u("Delivery List")}),e.jsx(ve,{fetchData:R,nextPageStockIn:$})]}),e.jsxs("details",{className:"group p-2 [&_summary::-webkit-details-marker]:hidden border rounded-lg bg-white",open:H,onToggle:K,children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between gap-1.5 text-gray-900",children:[e.jsxs("h2",{className:"text-xs font-medium flex items-center gap-2 text-blue-600 uppercase",children:[e.jsx(je,{}),u("Điều kiện truy vấn")]}),e.jsx("span",{className:"relative size-5 shrink-0",children:e.jsx(fe,{})})]}),e.jsx("div",{className:"flex p-2 gap-4",children:e.jsx(we,{formData:D,setFormData:j,setDeliveryNo:Y,setToDate:U,toDate:r,deliveryNo:v,bizUnit:p,setBizUnit:L,dataUnit:m})})]})]}),e.jsx("div",{className:"col-start-1 col-end-5 row-start-2 w-full h-full rounded-lg  overflow-auto",children:z.length>0?e.jsx(e.Fragment,{children:e.jsx(Te,{data:z,setCheckedPath:G,checkedPath:X,setKeyPath:b,loading:d,setData:f,onCellClicked:J,setGridData:_,gridData:w})}):e.jsx(e.Fragment,{children:e.jsx(Ne,{})})})]})})]})}export{_e as default};
