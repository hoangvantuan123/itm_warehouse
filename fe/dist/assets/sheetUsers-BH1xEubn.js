import{an as uh,k as At,aE as DT,ao as BA,r as as,aA as um}from"./index-CLga5zNi.js";import{h as Je}from"./users-odAeYwxJ.js";var Wl=function(n){return n&&n.Math===Math&&n},cn=Wl(typeof globalThis=="object"&&globalThis)||Wl(typeof window=="object"&&window)||Wl(typeof self=="object"&&self)||Wl(typeof uh=="object"&&uh)||Wl(typeof uh=="object"&&uh)||function(){return this}()||Function("return this")(),Wv={},Yn=function(n){try{return!!n()}catch{return!0}},WA=Yn,Zi=!WA(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),jA=Yn,vg=!jA(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),UA=vg,ch=Function.prototype.call,Qi=UA?ch.bind(ch):function(){return ch.apply(ch,arguments)},LT={},$T={}.propertyIsEnumerable,kT=Object.getOwnPropertyDescriptor,zA=kT&&!$T.call({1:2},1);LT.f=zA?function(e){var t=kT(this,e);return!!t&&t.enumerable}:$T;var Cg=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},FT=vg,VT=Function.prototype,Lw=VT.call,GA=FT&&VT.bind.bind(Lw,Lw),Gt=FT?GA:function(n){return function(){return Lw.apply(n,arguments)}},BT=Gt,YA=BT({}.toString),KA=BT("".slice),fa=function(n){return KA(YA(n),8,-1)},XA=Gt,qA=Yn,ZA=fa,cm=Object,QA=XA("".split),JA=qA(function(){return!cm("z").propertyIsEnumerable(0)})?function(n){return ZA(n)==="String"?QA(n,""):cm(n)}:cm,bg=function(n){return n==null},ex=bg,tx=TypeError,Lc=function(n){if(ex(n))throw new tx("Can't call method on "+n);return n},nx=JA,ix=Lc,yg=function(n){return nx(ix(n))},hm=typeof document=="object"&&document.all,hn=typeof hm>"u"&&hm!==void 0?function(n){return typeof n=="function"||n===hm}:function(n){return typeof n=="function"},ox=hn,Lo=function(n){return typeof n=="object"?n!==null:ox(n)},dm=cn,rx=hn,sx=function(n){return rx(n)?n:void 0},xl=function(n,e){return arguments.length<2?sx(dm[n]):dm[n]&&dm[n][e]},ax=Gt,Sg=ax({}.isPrototypeOf),lx=cn,nS=lx.navigator,iS=nS&&nS.userAgent,Rg=iS?String(iS):"",WT=cn,fm=Rg,oS=WT.process,rS=WT.Deno,sS=oS&&oS.versions||rS&&rS.version,aS=sS&&sS.v8,zi,yf;aS&&(zi=aS.split("."),yf=zi[0]>0&&zi[0]<4?1:+(zi[0]+zi[1]));!yf&&fm&&(zi=fm.match(/Edge\/(\d+)/),(!zi||zi[1]>=74)&&(zi=fm.match(/Chrome\/(\d+)/),zi&&(yf=+zi[1])));var ux=yf,lS=ux,cx=Yn,hx=cn,dx=hx.String,jv=!!Object.getOwnPropertySymbols&&!cx(function(){var n=Symbol("symbol detection");return!dx(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&lS&&lS<41}),fx=jv,jT=fx&&!Symbol.sham&&typeof Symbol.iterator=="symbol",gx=xl,mx=hn,px=Sg,wx=jT,vx=Object,Uv=wx?function(n){return typeof n=="symbol"}:function(n){var e=gx("Symbol");return mx(e)&&px(e.prototype,vx(n))},Cx=String,Eg=function(n){try{return Cx(n)}catch{return"Object"}},bx=hn,yx=Eg,Sx=TypeError,$c=function(n){if(bx(n))return n;throw new Sx(yx(n)+" is not a function")},Rx=$c,Ex=bg,Tg=function(n,e){var t=n[e];return Ex(t)?void 0:Rx(t)},gm=Qi,mm=hn,pm=Lo,Tx=TypeError,Mx=function(n,e){var t,i;if(e==="string"&&mm(t=n.toString)&&!pm(i=gm(t,n))||mm(t=n.valueOf)&&!pm(i=gm(t,n))||e!=="string"&&mm(t=n.toString)&&!pm(i=gm(t,n)))return i;throw new Tx("Can't convert object to primitive value")},UT={exports:{}},uS=cn,Ix=Object.defineProperty,zv=function(n,e){try{Ix(uS,n,{value:e,configurable:!0,writable:!0})}catch{uS[n]=e}return e},Px=cn,Ox=zv,cS="__core-js_shared__",hS=UT.exports=Px[cS]||Ox(cS,{});(hS.versions||(hS.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Gv=UT.exports,dS=Gv,zT=function(n,e){return dS[n]||(dS[n]=e||{})},Ax=Lc,xx=Object,kc=function(n){return xx(Ax(n))},Hx=Gt,_x=kc,Nx=Hx({}.hasOwnProperty),$o=Object.hasOwn||function(e,t){return Nx(_x(e),t)},Dx=Gt,Lx=0,$x=Math.random(),kx=Dx(1 .toString),GT=function(n){return"Symbol("+(n===void 0?"":n)+")_"+kx(++Lx+$x,36)},Fx=cn,Vx=zT,fS=$o,Bx=GT,Wx=jv,jx=jT,hl=Fx.Symbol,wm=Vx("wks"),Ux=jx?hl.for||hl:hl&&hl.withoutSetter||Bx,ts=function(n){return fS(wm,n)||(wm[n]=Wx&&fS(hl,n)?hl[n]:Ux("Symbol."+n)),wm[n]},zx=Qi,gS=Lo,mS=Uv,Gx=Tg,Yx=Mx,Kx=ts,Xx=TypeError,qx=Kx("toPrimitive"),Zx=function(n,e){if(!gS(n)||mS(n))return n;var t=Gx(n,qx),i;if(t){if(e===void 0&&(e="default"),i=zx(t,n,e),!gS(i)||mS(i))return i;throw new Xx("Can't convert object to primitive value")}return e===void 0&&(e="number"),Yx(n,e)},Qx=Zx,Jx=Uv,YT=function(n){var e=Qx(n,"string");return Jx(e)?e:e+""},eH=cn,pS=Lo,$w=eH.document,tH=pS($w)&&pS($w.createElement),Yv=function(n){return tH?$w.createElement(n):{}},nH=Zi,iH=Yn,oH=Yv,KT=!nH&&!iH(function(){return Object.defineProperty(oH("div"),"a",{get:function(){return 7}}).a!==7}),rH=Zi,sH=Qi,aH=LT,lH=Cg,uH=yg,cH=YT,hH=$o,dH=KT,wS=Object.getOwnPropertyDescriptor;Wv.f=rH?wS:function(e,t){if(e=uH(e),t=cH(t),dH)try{return wS(e,t)}catch{}if(hH(e,t))return lH(!sH(aH.f,e,t),e[t])};var ns={},fH=Zi,gH=Yn,XT=fH&&gH(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),mH=Lo,pH=String,wH=TypeError,mr=function(n){if(mH(n))return n;throw new wH(pH(n)+" is not an object")},vH=Zi,CH=KT,bH=XT,hh=mr,vS=YT,yH=TypeError,vm=Object.defineProperty,SH=Object.getOwnPropertyDescriptor,Cm="enumerable",bm="configurable",ym="writable";ns.f=vH?bH?function(e,t,i){if(hh(e),t=vS(t),hh(i),typeof e=="function"&&t==="prototype"&&"value"in i&&ym in i&&!i[ym]){var o=SH(e,t);o&&o[ym]&&(e[t]=i.value,i={configurable:bm in i?i[bm]:o[bm],enumerable:Cm in i?i[Cm]:o[Cm],writable:!1})}return vm(e,t,i)}:vm:function(e,t,i){if(hh(e),t=vS(t),hh(i),CH)try{return vm(e,t,i)}catch{}if("get"in i||"set"in i)throw new yH("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var RH=Zi,EH=ns,TH=Cg,Fc=RH?function(n,e,t){return EH.f(n,e,TH(1,t))}:function(n,e,t){return n[e]=t,n},qT={exports:{}},kw=Zi,MH=$o,ZT=Function.prototype,IH=kw&&Object.getOwnPropertyDescriptor,Kv=MH(ZT,"name"),PH=Kv&&(function(){}).name==="something",OH=Kv&&(!kw||kw&&IH(ZT,"name").configurable),AH={EXISTS:Kv,PROPER:PH,CONFIGURABLE:OH},xH=Gt,HH=hn,Fw=Gv,_H=xH(Function.toString);HH(Fw.inspectSource)||(Fw.inspectSource=function(n){return _H(n)});var NH=Fw.inspectSource,DH=cn,LH=hn,CS=DH.WeakMap,$H=LH(CS)&&/native code/.test(String(CS)),kH=zT,FH=GT,bS=kH("keys"),QT=function(n){return bS[n]||(bS[n]=FH(n))},Xv={},VH=$H,JT=cn,BH=Lo,WH=Fc,Sm=$o,Rm=Gv,jH=QT,UH=Xv,yS="Object already initialized",Vw=JT.TypeError,zH=JT.WeakMap,Sf,wc,Rf,GH=function(n){return Rf(n)?wc(n):Sf(n,{})},YH=function(n){return function(e){var t;if(!BH(e)||(t=wc(e)).type!==n)throw new Vw("Incompatible receiver, "+n+" required");return t}};if(VH||Rm.state){var to=Rm.state||(Rm.state=new zH);to.get=to.get,to.has=to.has,to.set=to.set,Sf=function(n,e){if(to.has(n))throw new Vw(yS);return e.facade=n,to.set(n,e),e},wc=function(n){return to.get(n)||{}},Rf=function(n){return to.has(n)}}else{var Ra=jH("state");UH[Ra]=!0,Sf=function(n,e){if(Sm(n,Ra))throw new Vw(yS);return e.facade=n,WH(n,Ra,e),e},wc=function(n){return Sm(n,Ra)?n[Ra]:{}},Rf=function(n){return Sm(n,Ra)}}var KH={set:Sf,get:wc,has:Rf,enforce:GH,getterFor:YH},qv=Gt,XH=Yn,qH=hn,dh=$o,Bw=Zi,ZH=AH.CONFIGURABLE,QH=NH,eM=KH,JH=eM.enforce,e_=eM.get,SS=String,Zd=Object.defineProperty,t_=qv("".slice),n_=qv("".replace),i_=qv([].join),o_=Bw&&!XH(function(){return Zd(function(){},"length",{value:8}).length!==8}),r_=String(String).split("String"),s_=qT.exports=function(n,e,t){t_(SS(e),0,7)==="Symbol("&&(e="["+n_(SS(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!dh(n,"name")||ZH&&n.name!==e)&&(Bw?Zd(n,"name",{value:e,configurable:!0}):n.name=e),o_&&t&&dh(t,"arity")&&n.length!==t.arity&&Zd(n,"length",{value:t.arity});try{t&&dh(t,"constructor")&&t.constructor?Bw&&Zd(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var i=JH(n);return dh(i,"source")||(i.source=i_(r_,typeof e=="string"?e:"")),n};Function.prototype.toString=s_(function(){return qH(this)&&e_(this).source||QH(this)},"toString");var a_=qT.exports,l_=hn,u_=ns,c_=a_,h_=zv,d_=function(n,e,t,i){i||(i={});var o=i.enumerable,r=i.name!==void 0?i.name:e;if(l_(t)&&c_(t,r,i),i.global)o?n[e]=t:h_(e,t);else{try{i.unsafe?n[e]&&(o=!0):delete n[e]}catch{}o?n[e]=t:u_.f(n,e,{value:t,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return n},tM={},f_=Math.ceil,g_=Math.floor,m_=Math.trunc||function(e){var t=+e;return(t>0?g_:f_)(t)},p_=m_,Vc=function(n){var e=+n;return e!==e||e===0?0:p_(e)},w_=Vc,v_=Math.max,C_=Math.min,b_=function(n,e){var t=w_(n);return t<0?v_(t+e,0):C_(t,e)},y_=Vc,S_=Math.min,R_=function(n){var e=y_(n);return e>0?S_(e,9007199254740991):0},E_=R_,Bc=function(n){return E_(n.length)},T_=yg,M_=b_,I_=Bc,RS=function(n){return function(e,t,i){var o=T_(e),r=I_(o);if(r===0)return!n&&-1;var s=M_(i,r),a;if(n&&t!==t){for(;r>s;)if(a=o[s++],a!==a)return!0}else for(;r>s;s++)if((n||s in o)&&o[s]===t)return n||s||0;return!n&&-1}},P_={includes:RS(!0),indexOf:RS(!1)},O_=Gt,Em=$o,A_=yg,x_=P_.indexOf,H_=Xv,ES=O_([].push),nM=function(n,e){var t=A_(n),i=0,o=[],r;for(r in t)!Em(H_,r)&&Em(t,r)&&ES(o,r);for(;e.length>i;)Em(t,r=e[i++])&&(~x_(o,r)||ES(o,r));return o},Zv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],__=nM,N_=Zv,D_=N_.concat("length","prototype");tM.f=Object.getOwnPropertyNames||function(e){return __(e,D_)};var iM={};iM.f=Object.getOwnPropertySymbols;var L_=xl,$_=Gt,k_=tM,F_=iM,V_=mr,B_=$_([].concat),W_=L_("Reflect","ownKeys")||function(e){var t=k_.f(V_(e)),i=F_.f;return i?B_(t,i(e)):t},TS=$o,j_=W_,U_=Wv,z_=ns,oM=function(n,e,t){for(var i=j_(e),o=z_.f,r=U_.f,s=0;s<i.length;s++){var a=i[s];!TS(n,a)&&!(t&&TS(t,a))&&o(n,a,r(e,a))}},G_=Yn,Y_=hn,K_=/#|\.prototype\./,Wc=function(n,e){var t=q_[X_(n)];return t===Q_?!0:t===Z_?!1:Y_(e)?G_(e):!!e},X_=Wc.normalize=function(n){return String(n).replace(K_,".").toLowerCase()},q_=Wc.data={},Z_=Wc.NATIVE="N",Q_=Wc.POLYFILL="P",J_=Wc,fh=cn,e1=Wv.f,t1=Fc,n1=d_,i1=zv,o1=oM,r1=J_,dn=function(n,e){var t=n.target,i=n.global,o=n.stat,r,s,a,l,u,c;if(i?s=fh:o?s=fh[t]||i1(t,{}):s=fh[t]&&fh[t].prototype,s)for(a in e){if(u=e[a],n.dontCallGetSet?(c=e1(s,a),l=c&&c.value):l=s[a],r=r1(i?a:t+(o?".":"#")+a,n.forced),!r&&l!==void 0){if(typeof u==typeof l)continue;o1(u,l)}(n.sham||l&&l.sham)&&t1(u,"sham",!0),n1(s,a,u,n)}},s1=vg,rM=Function.prototype,MS=rM.apply,IS=rM.call,Mg=typeof Reflect=="object"&&Reflect.apply||(s1?IS.bind(MS):function(){return IS.apply(MS,arguments)}),a1=Gt,l1=$c,sM=function(n,e,t){try{return a1(l1(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},u1=Lo,c1=function(n){return u1(n)||n===null},h1=c1,d1=String,f1=TypeError,g1=function(n){if(h1(n))return n;throw new f1("Can't set "+d1(n)+" as a prototype")},m1=sM,p1=Lo,w1=Lc,v1=g1,aM=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=m1(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(o,r){return w1(o),v1(r),p1(o)&&(n?t(o,r):o.__proto__=r),o}}():void 0),C1=ns.f,b1=function(n,e,t){t in n||C1(n,t,{configurable:!0,get:function(){return e[t]},set:function(i){e[t]=i}})},y1=hn,S1=Lo,PS=aM,R1=function(n,e,t){var i,o;return PS&&y1(i=e.constructor)&&i!==t&&S1(o=i.prototype)&&o!==t.prototype&&PS(n,o),n},E1=ts,T1=E1("toStringTag"),lM={};lM[T1]="z";var M1=String(lM)==="[object z]",I1=M1,P1=hn,Qd=fa,O1=ts,A1=O1("toStringTag"),x1=Object,H1=Qd(function(){return arguments}())==="Arguments",_1=function(n,e){try{return n[e]}catch{}},uM=I1?Qd:function(n){var e,t,i;return n===void 0?"Undefined":n===null?"Null":typeof(t=_1(e=x1(n),A1))=="string"?t:H1?Qd(e):(i=Qd(e))==="Object"&&P1(e.callee)?"Arguments":i},N1=uM,D1=String,Ig=function(n){if(N1(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return D1(n)},L1=Ig,$1=function(n,e){return n===void 0?arguments.length<2?"":e:L1(n)},k1=Lo,F1=Fc,V1=function(n,e){k1(e)&&"cause"in e&&F1(n,"cause",e.cause)},B1=Gt,cM=Error,W1=B1("".replace),j1=function(n){return String(new cM(n).stack)}("zxcasd"),hM=/\n\s*at [^:]*:[^\n]*/,U1=hM.test(j1),z1=function(n,e){if(U1&&typeof n=="string"&&!cM.prepareStackTrace)for(;e--;)n=W1(n,hM,"");return n},G1=Yn,Y1=Cg,K1=!G1(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",Y1(1,7)),n.stack!==7):!0}),X1=Fc,q1=z1,Z1=K1,OS=Error.captureStackTrace,Q1=function(n,e,t,i){Z1&&(OS?OS(n,e):X1(n,"stack",q1(t,i)))},AS=xl,J1=$o,xS=Fc,eN=Sg,HS=aM,_S=oM,NS=b1,tN=R1,nN=$1,iN=V1,oN=Q1,rN=Zi,sN=function(n,e,t,i){var o="stackTraceLimit",r=i?2:1,s=n.split("."),a=s[s.length-1],l=AS.apply(null,s);if(l){var u=l.prototype;if(J1(u,"cause")&&delete u.cause,!t)return l;var c=AS("Error"),h=e(function(d,g){var m=nN(i?g:d,void 0),w=i?new l(d):new l;return m!==void 0&&xS(w,"message",m),oN(w,h,w.stack,2),this&&eN(u,this)&&tN(w,this,h),arguments.length>r&&iN(w,arguments[r]),w});h.prototype=u,a!=="Error"?HS?HS(h,c):_S(h,c,{name:!0}):rN&&o in l&&(NS(h,l,o),NS(h,l,"prepareStackTrace")),_S(h,l);try{u.name!==a&&xS(u,"name",a),u.constructor=h}catch{}return h}},dM=dn,aN=cn,ko=Mg,fM=sN,Ww="WebAssembly",DS=aN[Ww],Ef=new Error("e",{cause:7}).cause!==7,ga=function(n,e){var t={};t[n]=fM(n,e,Ef),dM({global:!0,constructor:!0,arity:1,forced:Ef},t)},Qv=function(n,e){if(DS&&DS[n]){var t={};t[n]=fM(Ww+"."+n,e,Ef),dM({target:Ww,stat:!0,constructor:!0,arity:1,forced:Ef},t)}};ga("Error",function(n){return function(t){return ko(n,this,arguments)}});ga("EvalError",function(n){return function(t){return ko(n,this,arguments)}});ga("RangeError",function(n){return function(t){return ko(n,this,arguments)}});ga("ReferenceError",function(n){return function(t){return ko(n,this,arguments)}});ga("SyntaxError",function(n){return function(t){return ko(n,this,arguments)}});ga("TypeError",function(n){return function(t){return ko(n,this,arguments)}});ga("URIError",function(n){return function(t){return ko(n,this,arguments)}});Qv("CompileError",function(n){return function(t){return ko(n,this,arguments)}});Qv("LinkError",function(n){return function(t){return ko(n,this,arguments)}});Qv("RuntimeError",function(n){return function(t){return ko(n,this,arguments)}});var lN=fa,gM=Array.isArray||function(e){return lN(e)==="Array"},uN=Zi,cN=gM,hN=TypeError,dN=Object.getOwnPropertyDescriptor,fN=uN&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),mM=fN?function(n,e){if(cN(n)&&!dN(n,"length").writable)throw new hN("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},gN=TypeError,mN=9007199254740991,pM=function(n){if(n>mN)throw gN("Maximum allowed index exceeded");return n},pN=dn,wN=kc,vN=Bc,CN=mM,bN=pM,yN=Yn,SN=yN(function(){return[].push.call({length:4294967296},1)!==4294967297}),RN=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},EN=SN||!RN();pN({target:"Array",proto:!0,arity:1,forced:EN},{push:function(e){var t=wN(this),i=vN(t),o=arguments.length;bN(i+o);for(var r=0;r<o;r++)t[i]=arguments[r],i++;return CN(t,i),i}});var Tm=Gt,gh=Set.prototype,Fo={Set,add:Tm(gh.add),has:Tm(gh.has),remove:Tm(gh.delete),proto:gh},TN=Fo.has,ma=function(n){return TN(n),n},MN=Qi,pa=function(n,e,t){for(var i=t?n:n.iterator,o=n.next,r,s;!(r=MN(o,i)).done;)if(s=e(r.value),s!==void 0)return s},wM=Gt,IN=pa,vM=Fo,PN=vM.Set,CM=vM.proto,ON=wM(CM.forEach),bM=wM(CM.keys),AN=bM(new PN).next,jc=function(n,e,t){return t?IN({iterator:bM(n),next:AN},e):ON(n,e)},yM=Fo,xN=jc,HN=yM.Set,_N=yM.add,Jv=function(n){var e=new HN;return xN(n,function(t){_N(e,t)}),e},NN=sM,DN=Fo,Uc=NN(DN.proto,"size","get")||function(n){return n.size},LN=function(n){return{iterator:n,next:n.next,done:!1}},LS=$c,SM=mr,$S=Qi,$N=Vc,kN=LN,kS="Invalid size",FN=RangeError,VN=TypeError,BN=Math.max,RM=function(n,e){this.set=n,this.size=BN(e,0),this.has=LS(n.has),this.keys=LS(n.keys)};RM.prototype={getIterator:function(){return kN(SM($S(this.keys,this.set)))},includes:function(n){return $S(this.has,this.set,n)}};var wa=function(n){SM(n);var e=+n.size;if(e!==e)throw new VN(kS);var t=$N(e);if(t<0)throw new FN(kS);return new RM(n,t)},WN=ma,EM=Fo,jN=Jv,UN=Uc,zN=wa,GN=jc,YN=pa,KN=EM.has,FS=EM.remove,XN=function(e){var t=WN(this),i=zN(e),o=jN(t);return UN(t)<=i.size?GN(t,function(r){i.includes(r)&&FS(o,r)}):YN(i.getIterator(),function(r){KN(t,r)&&FS(o,r)}),o},qN=xl,VS=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},va=function(n){var e=qN("Set");try{new e()[n](VS(0));try{return new e()[n](VS(-1)),!1}catch{return!0}}catch{return!1}},ZN=dn,QN=XN,JN=va;ZN({target:"Set",proto:!0,real:!0,forced:!JN("difference")},{difference:QN});var eD=ma,eC=Fo,tD=Uc,nD=wa,iD=jc,oD=pa,rD=eC.Set,BS=eC.add,sD=eC.has,aD=function(e){var t=eD(this),i=nD(e),o=new rD;return tD(t)>i.size?oD(i.getIterator(),function(r){sD(t,r)&&BS(o,r)}):iD(t,function(r){i.includes(r)&&BS(o,r)}),o},lD=dn,uD=Yn,cD=aD,hD=va,dD=!hD("intersection")||uD(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});lD({target:"Set",proto:!0,real:!0,forced:dD},{intersection:cD});var fD=Qi,WS=mr,gD=Tg,tC=function(n,e,t){var i,o;WS(n);try{if(i=gD(n,"return"),!i){if(e==="throw")throw t;return t}i=fD(i,n)}catch(r){o=!0,i=r}if(e==="throw")throw t;if(o)throw i;return WS(i),t},mD=ma,pD=Fo.has,wD=Uc,vD=wa,CD=jc,bD=pa,yD=tC,SD=function(e){var t=mD(this),i=vD(e);if(wD(t)<=i.size)return CD(t,function(r){if(i.includes(r))return!1},!0)!==!1;var o=i.getIterator();return bD(o,function(r){if(pD(t,r))return yD(o,"normal",!1)})!==!1},RD=dn,ED=SD,TD=va;RD({target:"Set",proto:!0,real:!0,forced:!TD("isDisjointFrom")},{isDisjointFrom:ED});var MD=ma,ID=Uc,PD=jc,OD=wa,AD=function(e){var t=MD(this),i=OD(e);return ID(t)>i.size?!1:PD(t,function(o){if(!i.includes(o))return!1},!0)!==!1},xD=dn,HD=AD,_D=va;xD({target:"Set",proto:!0,real:!0,forced:!_D("isSubsetOf")},{isSubsetOf:HD});var ND=ma,DD=Fo.has,LD=Uc,$D=wa,kD=pa,FD=tC,VD=function(e){var t=ND(this),i=$D(e);if(LD(t)<i.size)return!1;var o=i.getIterator();return kD(o,function(r){if(!DD(t,r))return FD(o,"normal",!1)})!==!1},BD=dn,WD=VD,jD=va;BD({target:"Set",proto:!0,real:!0,forced:!jD("isSupersetOf")},{isSupersetOf:WD});var UD=ma,nC=Fo,zD=Jv,GD=wa,YD=pa,KD=nC.add,XD=nC.has,qD=nC.remove,ZD=function(e){var t=UD(this),i=GD(e).getIterator(),o=zD(t);return YD(i,function(r){XD(t,r)?qD(o,r):KD(o,r)}),o},QD=dn,JD=ZD,eL=va;QD({target:"Set",proto:!0,real:!0,forced:!eL("symmetricDifference")},{symmetricDifference:JD});var tL=ma,nL=Fo.add,iL=Jv,oL=wa,rL=pa,sL=function(e){var t=tL(this),i=oL(e).getIterator(),o=iL(t);return rL(i,function(r){nL(o,r)}),o},aL=dn,lL=sL,uL=va;aL({target:"Set",proto:!0,real:!0,forced:!uL("union")},{union:lL});var cL=fa,hL=Gt,dL=function(n){if(cL(n)==="Function")return hL(n)},jS=dL,fL=$c,gL=vg,mL=jS(jS.bind),TM=function(n,e){return fL(n),e===void 0?n:gL?mL(n,e):function(){return n.apply(e,arguments)}},pL=xl,MM=pL("document","documentElement"),wL=Gt,iC=wL([].slice),vL=TypeError,IM=function(n,e){if(n<e)throw new vL("Not enough arguments");return n},CL=Rg,bL=/(?:ipad|iphone|ipod).*applewebkit/i.test(CL),jl=cn,yL=Rg,SL=fa,mh=function(n){return yL.slice(0,n.length)===n},PM=function(){return mh("Bun/")?"BUN":mh("Cloudflare-Workers")?"CLOUDFLARE":mh("Deno/")?"DENO":mh("Node.js/")?"NODE":jl.Bun&&typeof Bun.version=="string"?"BUN":jl.Deno&&typeof Deno.version=="object"?"DENO":SL(jl.process)==="process"?"NODE":jl.window&&jl.document?"BROWSER":"REST"}(),RL=PM,EL=RL==="NODE",ri=cn,TL=Mg,ML=TM,US=hn,IL=$o,OM=Yn,zS=MM,PL=iC,GS=Yv,OL=IM,AL=bL,xL=EL,jw=ri.setImmediate,Uw=ri.clearImmediate,HL=ri.process,Mm=ri.Dispatch,_L=ri.Function,YS=ri.MessageChannel,NL=ri.String,Im=0,Ku={},KS="onreadystatechange",vc,ls,Pm,Om;OM(function(){vc=ri.location});var oC=function(n){if(IL(Ku,n)){var e=Ku[n];delete Ku[n],e()}},Am=function(n){return function(){oC(n)}},XS=function(n){oC(n.data)},qS=function(n){ri.postMessage(NL(n),vc.protocol+"//"+vc.host)};(!jw||!Uw)&&(jw=function(e){OL(arguments.length,1);var t=US(e)?e:_L(e),i=PL(arguments,1);return Ku[++Im]=function(){TL(t,void 0,i)},ls(Im),Im},Uw=function(e){delete Ku[e]},xL?ls=function(n){HL.nextTick(Am(n))}:Mm&&Mm.now?ls=function(n){Mm.now(Am(n))}:YS&&!AL?(Pm=new YS,Om=Pm.port2,Pm.port1.onmessage=XS,ls=ML(Om.postMessage,Om)):ri.addEventListener&&US(ri.postMessage)&&!ri.importScripts&&vc&&vc.protocol!=="file:"&&!OM(qS)?(ls=qS,ri.addEventListener("message",XS,!1)):KS in GS("script")?ls=function(n){zS.appendChild(GS("script"))[KS]=function(){zS.removeChild(this),oC(n)}}:ls=function(n){setTimeout(Am(n),0)});var AM={set:jw,clear:Uw},DL=dn,LL=cn,ZS=AM.clear;DL({global:!0,bind:!0,enumerable:!0,forced:LL.clearImmediate!==ZS},{clearImmediate:ZS});var xM=cn,$L=Mg,kL=hn,FL=PM,VL=Rg,BL=iC,WL=IM,jL=xM.Function,UL=/MSIE .\./.test(VL)||FL==="BUN"&&function(){var n=xM.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),zL=function(n,e){var t=e?2:1;return UL?function(i,o){var r=WL(arguments.length,1)>t,s=kL(i)?i:jL(i),a=r?BL(arguments,t):[],l=r?function(){$L(s,this,a)}:s;return e?n(l,o):n(l)}:n},GL=dn,HM=cn,QS=AM.set,YL=zL,JS=HM.setImmediate?YL(QS,!1):QS;GL({global:!0,bind:!0,enumerable:!0,forced:HM.setImmediate!==JS},{setImmediate:JS});/*! @license DOMPurify 2.5.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.7/LICENSE */function Fr(n){"@babel/helpers - typeof";return Fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fr(n)}function zw(n,e){return zw=Object.setPrototypeOf||function(i,o){return i.__proto__=o,i},zw(n,e)}function KL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jd(n,e,t){return KL()?Jd=Reflect.construct:Jd=function(o,r,s){var a=[null];a.push.apply(a,r);var l=Function.bind.apply(o,a),u=new l;return s&&zw(u,s.prototype),u},Jd.apply(null,arguments)}function $i(n){return XL(n)||qL(n)||ZL(n)||QL()}function XL(n){if(Array.isArray(n))return Gw(n)}function qL(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function ZL(n,e){if(n){if(typeof n=="string")return Gw(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gw(n,e)}}function Gw(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function QL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var JL=Object.hasOwnProperty,eR=Object.setPrototypeOf,e$=Object.isFrozen,t$=Object.getPrototypeOf,n$=Object.getOwnPropertyDescriptor,An=Object.freeze,Ei=Object.seal,i$=Object.create,_M=typeof Reflect<"u"&&Reflect,Tf=_M.apply,Yw=_M.construct;Tf||(Tf=function(e,t,i){return e.apply(t,i)});An||(An=function(e){return e});Ei||(Ei=function(e){return e});Yw||(Yw=function(e,t){return Jd(e,$i(t))});var o$=Ti(Array.prototype.forEach),tR=Ti(Array.prototype.pop),Ul=Ti(Array.prototype.push),ef=Ti(String.prototype.toLowerCase),xm=Ti(String.prototype.toString),nR=Ti(String.prototype.match),Ii=Ti(String.prototype.replace),r$=Ti(String.prototype.indexOf),s$=Ti(String.prototype.trim),un=Ti(RegExp.prototype.test),Hm=a$(TypeError);function Ti(n){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return Tf(n,e,i)}}function a$(n){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Yw(n,t)}}function ke(n,e,t){var i;t=(i=t)!==null&&i!==void 0?i:ef,eR&&eR(n,null);for(var o=e.length;o--;){var r=e[o];if(typeof r=="string"){var s=t(r);s!==r&&(e$(e)||(e[o]=s),r=s)}n[r]=!0}return n}function us(n){var e=i$(null),t;for(t in n)Tf(JL,n,[t])===!0&&(e[t]=n[t]);return e}function ph(n,e){for(;n!==null;){var t=n$(n,e);if(t){if(t.get)return Ti(t.get);if(typeof t.value=="function")return Ti(t.value)}n=t$(n)}function i(o){return console.warn("fallback value for",o),null}return i}var iR=An(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_m=An(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Nm=An(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),l$=An(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Dm=An(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),u$=An(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),oR=An(["#text"]),rR=An(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Lm=An(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sR=An(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wh=An(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),c$=Ei(/\{\{[\w\W]*|[\w\W]*\}\}/gm),h$=Ei(/<%[\w\W]*|[\w\W]*%>/gm),d$=Ei(/\${[\w\W]*}/gm),f$=Ei(/^data-[\-\w.\u00B7-\uFFFF]/),g$=Ei(/^aria-[\-\w]+$/),m$=Ei(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),p$=Ei(/^(?:\w+script|data):/i),w$=Ei(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),v$=Ei(/^html$/i),C$=Ei(/^[a-z][.\w]*(-[.\w]+)+$/i),b$=function(){return typeof window>"u"?null:window},y$=function(e,t){if(Fr(e)!=="object"||typeof e.createPolicy!="function")return null;var i=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(i=t.currentScript.getAttribute(o));var r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function NM(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b$(),e=function(_){return NM(_)};if(e.version="2.5.7",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,i=n.document,o=n.DocumentFragment,r=n.HTMLTemplateElement,s=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,c=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,h=n.HTMLFormElement,d=n.DOMParser,g=n.trustedTypes,m=a.prototype,w=ph(m,"cloneNode"),C=ph(m,"nextSibling"),y=ph(m,"childNodes"),R=ph(m,"parentNode");if(typeof r=="function"){var E=i.createElement("template");E.content&&E.content.ownerDocument&&(i=E.content.ownerDocument)}var H=y$(g,t),P=H?H.createHTML(""):"",W=i,j=W.implementation,G=W.createNodeIterator,Y=W.createDocumentFragment,z=W.getElementsByTagName,Q=t.importNode,q={};try{q=us(i).documentMode?i.documentMode:{}}catch{}var ne={};e.isSupported=typeof R=="function"&&j&&j.createHTMLDocument!==void 0&&q!==9;var de=c$,Se=h$,Xe=d$,Oe=f$,ge=g$,fe=p$,st=w$,f=C$,p=m$,v=null,I=ke({},[].concat($i(iR),$i(_m),$i(Nm),$i(Dm),$i(oR))),A=null,F=ke({},[].concat($i(rR),$i(Lm),$i(sR),$i(wh))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,se=null,ue=!0,Z=!0,Me=!1,Te=!0,B=!1,We=!0,Ve=!1,qe=!1,_e=!1,be=!1,b=!1,S=!1,T=!0,$=!1,O="user-content-",k=!0,N=!1,x={},L=null,D=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,ee=ke({},["audio","video","img","source","image","track"]),ae=null,ve=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),He="http://www.w3.org/1998/Math/MathML",Ge="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml",Ee=$e,Ye=!1,Tt=null,Sa=ke({},[He,Ge,$e],xm),Mi,Vl=["application/xhtml+xml","text/html"],si="text/html",Rt,Yt=null,an=i.createElement("form"),bt=function(_){return _ instanceof RegExp||_ instanceof Function},sm=function(_){Yt&&Yt===_||((!_||Fr(_)!=="object")&&(_={}),_=us(_),Mi=Vl.indexOf(_.PARSER_MEDIA_TYPE)===-1?Mi=si:Mi=_.PARSER_MEDIA_TYPE,Rt=Mi==="application/xhtml+xml"?xm:ef,v="ALLOWED_TAGS"in _?ke({},_.ALLOWED_TAGS,Rt):I,A="ALLOWED_ATTR"in _?ke({},_.ALLOWED_ATTR,Rt):F,Tt="ALLOWED_NAMESPACES"in _?ke({},_.ALLOWED_NAMESPACES,xm):Sa,ae="ADD_URI_SAFE_ATTR"in _?ke(us(ve),_.ADD_URI_SAFE_ATTR,Rt):ve,V="ADD_DATA_URI_TAGS"in _?ke(us(ee),_.ADD_DATA_URI_TAGS,Rt):ee,L="FORBID_CONTENTS"in _?ke({},_.FORBID_CONTENTS,Rt):D,K="FORBID_TAGS"in _?ke({},_.FORBID_TAGS,Rt):{},se="FORBID_ATTR"in _?ke({},_.FORBID_ATTR,Rt):{},x="USE_PROFILES"in _?_.USE_PROFILES:!1,ue=_.ALLOW_ARIA_ATTR!==!1,Z=_.ALLOW_DATA_ATTR!==!1,Me=_.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=_.ALLOW_SELF_CLOSE_IN_ATTR!==!1,B=_.SAFE_FOR_TEMPLATES||!1,We=_.SAFE_FOR_XML!==!1,Ve=_.WHOLE_DOCUMENT||!1,be=_.RETURN_DOM||!1,b=_.RETURN_DOM_FRAGMENT||!1,S=_.RETURN_TRUSTED_TYPE||!1,_e=_.FORCE_BODY||!1,T=_.SANITIZE_DOM!==!1,$=_.SANITIZE_NAMED_PROPS||!1,k=_.KEEP_CONTENT!==!1,N=_.IN_PLACE||!1,p=_.ALLOWED_URI_REGEXP||p,Ee=_.NAMESPACE||$e,U=_.CUSTOM_ELEMENT_HANDLING||{},_.CUSTOM_ELEMENT_HANDLING&&bt(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&bt(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),B&&(Z=!1),b&&(be=!0),x&&(v=ke({},$i(oR)),A=[],x.html===!0&&(ke(v,iR),ke(A,rR)),x.svg===!0&&(ke(v,_m),ke(A,Lm),ke(A,wh)),x.svgFilters===!0&&(ke(v,Nm),ke(A,Lm),ke(A,wh)),x.mathMl===!0&&(ke(v,Dm),ke(A,sR),ke(A,wh))),_.ADD_TAGS&&(v===I&&(v=us(v)),ke(v,_.ADD_TAGS,Rt)),_.ADD_ATTR&&(A===F&&(A=us(A)),ke(A,_.ADD_ATTR,Rt)),_.ADD_URI_SAFE_ATTR&&ke(ae,_.ADD_URI_SAFE_ATTR,Rt),_.FORBID_CONTENTS&&(L===D&&(L=us(L)),ke(L,_.FORBID_CONTENTS,Rt)),k&&(v["#text"]=!0),Ve&&ke(v,["html","head","body"]),v.table&&(ke(v,["tbody"]),delete K.tbody),An&&An(_),Yt=_)},Gy=ke({},["mi","mo","mn","ms","mtext"]),Yy=ke({},["annotation-xml"]),kA=ke({},["title","style","font","a","script"]),ah=ke({},_m);ke(ah,Nm),ke(ah,l$);var am=ke({},Dm);ke(am,u$);var FA=function(_){var J=R(_);(!J||!J.tagName)&&(J={namespaceURI:Ee,tagName:"template"});var re=ef(_.tagName),et=ef(J.tagName);return Tt[_.namespaceURI]?_.namespaceURI===Ge?J.namespaceURI===$e?re==="svg":J.namespaceURI===He?re==="svg"&&(et==="annotation-xml"||Gy[et]):!!ah[re]:_.namespaceURI===He?J.namespaceURI===$e?re==="math":J.namespaceURI===Ge?re==="math"&&Yy[et]:!!am[re]:_.namespaceURI===$e?J.namespaceURI===Ge&&!Yy[et]||J.namespaceURI===He&&!Gy[et]?!1:!am[re]&&(kA[re]||!ah[re]):!!(Mi==="application/xhtml+xml"&&Tt[_.namespaceURI]):!1},ai=function(_){Ul(e.removed,{element:_});try{_.parentNode.removeChild(_)}catch{try{_.outerHTML=P}catch{_.remove()}}},lh=function(_,J){try{Ul(e.removed,{attribute:J.getAttributeNode(_),from:J})}catch{Ul(e.removed,{attribute:null,from:J})}if(J.removeAttribute(_),_==="is"&&!A[_])if(be||b)try{ai(J)}catch{}else try{J.setAttribute(_,"")}catch{}},Ky=function(_){var J,re;if(_e)_="<remove></remove>"+_;else{var et=nR(_,/^[\r\n\t ]+/);re=et&&et[0]}Mi==="application/xhtml+xml"&&Ee===$e&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");var Nn=H?H.createHTML(_):_;if(Ee===$e)try{J=new d().parseFromString(Nn,Mi)}catch{}if(!J||!J.documentElement){J=j.createDocument(Ee,"template",null);try{J.documentElement.innerHTML=Ye?P:Nn}catch{}}var gn=J.body||J.documentElement;return _&&re&&gn.insertBefore(i.createTextNode(re),gn.childNodes[0]||null),Ee===$e?z.call(J,Ve?"html":"body")[0]:Ve?J.documentElement:gn},Xy=function(_){return G.call(_.ownerDocument||_,_,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},qy=function(_){return _ instanceof h&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof c)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function"||typeof _.hasChildNodes!="function")},Bl=function(_){return Fr(s)==="object"?_ instanceof s:_&&Fr(_)==="object"&&typeof _.nodeType=="number"&&typeof _.nodeName=="string"},Bo=function(_,J,re){ne[_]&&o$(ne[_],function(et){et.call(e,J,re,Yt)})},Zy=function(_){var J;if(Bo("beforeSanitizeElements",_,null),qy(_)||un(/[\u0080-\uFFFF]/,_.nodeName))return ai(_),!0;var re=Rt(_.nodeName);if(Bo("uponSanitizeElement",_,{tagName:re,allowedTags:v}),_.hasChildNodes()&&!Bl(_.firstElementChild)&&(!Bl(_.content)||!Bl(_.content.firstElementChild))&&un(/<[/\w]/g,_.innerHTML)&&un(/<[/\w]/g,_.textContent)||re==="select"&&un(/<template/i,_.innerHTML)||_.nodeType===7||We&&_.nodeType===8&&un(/<[/\w]/g,_.data))return ai(_),!0;if(!v[re]||K[re]){if(!K[re]&&Jy(re)&&(U.tagNameCheck instanceof RegExp&&un(U.tagNameCheck,re)||U.tagNameCheck instanceof Function&&U.tagNameCheck(re)))return!1;if(k&&!L[re]){var et=R(_)||_.parentNode,Nn=y(_)||_.childNodes;if(Nn&&et)for(var gn=Nn.length,ln=gn-1;ln>=0;--ln){var ss=w(Nn[ln],!0);ss.__removalCount=(_.__removalCount||0)+1,et.insertBefore(ss,C(_))}}return ai(_),!0}return _ instanceof a&&!FA(_)||(re==="noscript"||re==="noembed"||re==="noframes")&&un(/<\/no(script|embed|frames)/i,_.innerHTML)?(ai(_),!0):(B&&_.nodeType===3&&(J=_.textContent,J=Ii(J,de," "),J=Ii(J,Se," "),J=Ii(J,Xe," "),_.textContent!==J&&(Ul(e.removed,{element:_.cloneNode()}),_.textContent=J)),Bo("afterSanitizeElements",_,null),!1)},Qy=function(_,J,re){if(T&&(J==="id"||J==="name")&&(re in i||re in an))return!1;if(!(Z&&!se[J]&&un(Oe,J))){if(!(ue&&un(ge,J))){if(!A[J]||se[J]){if(!(Jy(_)&&(U.tagNameCheck instanceof RegExp&&un(U.tagNameCheck,_)||U.tagNameCheck instanceof Function&&U.tagNameCheck(_))&&(U.attributeNameCheck instanceof RegExp&&un(U.attributeNameCheck,J)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(J))||J==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&un(U.tagNameCheck,re)||U.tagNameCheck instanceof Function&&U.tagNameCheck(re))))return!1}else if(!ae[J]){if(!un(p,Ii(re,st,""))){if(!((J==="src"||J==="xlink:href"||J==="href")&&_!=="script"&&r$(re,"data:")===0&&V[_])){if(!(Me&&!un(fe,Ii(re,st,"")))){if(re)return!1}}}}}}return!0},Jy=function(_){return _!=="annotation-xml"&&nR(_,f)},eS=function(_){var J,re,et,Nn;Bo("beforeSanitizeAttributes",_,null);var gn=_.attributes;if(gn){var ln={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(Nn=gn.length;Nn--;){J=gn[Nn];var ss=J,Kt=ss.name,lm=ss.namespaceURI;if(re=Kt==="value"?J.value:s$(J.value),et=Rt(Kt),ln.attrName=et,ln.attrValue=re,ln.keepAttr=!0,ln.forceKeepAttr=void 0,Bo("uponSanitizeAttribute",_,ln),re=ln.attrValue,!ln.forceKeepAttr&&(lh(Kt,_),!!ln.keepAttr)){if(!Te&&un(/\/>/i,re)){lh(Kt,_);continue}B&&(re=Ii(re,de," "),re=Ii(re,Se," "),re=Ii(re,Xe," "));var tS=Rt(_.nodeName);if(Qy(tS,et,re)){if($&&(et==="id"||et==="name")&&(lh(Kt,_),re=O+re),We&&un(/((--!?|])>)|<\/(style|title)/i,re)){lh(Kt,_);continue}if(H&&Fr(g)==="object"&&typeof g.getAttributeType=="function"&&!lm)switch(g.getAttributeType(tS,et)){case"TrustedHTML":{re=H.createHTML(re);break}case"TrustedScriptURL":{re=H.createScriptURL(re);break}}try{lm?_.setAttributeNS(lm,Kt,re):_.setAttribute(Kt,re),qy(_)?ai(_):tR(e.removed)}catch{}}}}Bo("afterSanitizeAttributes",_,null)}},VA=function Ce(_){var J,re=Xy(_);for(Bo("beforeSanitizeShadowDOM",_,null);J=re.nextNode();)Bo("uponSanitizeShadowNode",J,null),!Zy(J)&&(J.content instanceof o&&Ce(J.content),eS(J));Bo("afterSanitizeShadowDOM",_,null)};return e.sanitize=function(Ce){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},J,re,et,Nn,gn;if(Ye=!Ce,Ye&&(Ce="<!-->"),typeof Ce!="string"&&!Bl(Ce))if(typeof Ce.toString=="function"){if(Ce=Ce.toString(),typeof Ce!="string")throw Hm("dirty is not a string, aborting")}else throw Hm("toString is not a function");if(!e.isSupported){if(Fr(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Ce=="string")return n.toStaticHTML(Ce);if(Bl(Ce))return n.toStaticHTML(Ce.outerHTML)}return Ce}if(qe||sm(_),e.removed=[],typeof Ce=="string"&&(N=!1),N){if(Ce.nodeName){var ln=Rt(Ce.nodeName);if(!v[ln]||K[ln])throw Hm("root node is forbidden and cannot be sanitized in-place")}}else if(Ce instanceof s)J=Ky("<!---->"),re=J.ownerDocument.importNode(Ce,!0),re.nodeType===1&&re.nodeName==="BODY"||re.nodeName==="HTML"?J=re:J.appendChild(re);else{if(!be&&!B&&!Ve&&Ce.indexOf("<")===-1)return H&&S?H.createHTML(Ce):Ce;if(J=Ky(Ce),!J)return be?null:S?P:""}J&&_e&&ai(J.firstChild);for(var ss=Xy(N?Ce:J);et=ss.nextNode();)et.nodeType===3&&et===Nn||Zy(et)||(et.content instanceof o&&VA(et.content),eS(et),Nn=et);if(Nn=null,N)return Ce;if(be){if(b)for(gn=Y.call(J.ownerDocument);J.firstChild;)gn.appendChild(J.firstChild);else gn=J;return(A.shadowroot||A.shadowrootmod)&&(gn=Q.call(t,gn,!0)),gn}var Kt=Ve?J.outerHTML:J.innerHTML;return Ve&&v["!doctype"]&&J.ownerDocument&&J.ownerDocument.doctype&&J.ownerDocument.doctype.name&&un(v$,J.ownerDocument.doctype.name)&&(Kt="<!DOCTYPE "+J.ownerDocument.doctype.name+`>
`+Kt),B&&(Kt=Ii(Kt,de," "),Kt=Ii(Kt,Se," "),Kt=Ii(Kt,Xe," ")),H&&S?H.createHTML(Kt):Kt},e.setConfig=function(Ce){sm(Ce),qe=!0},e.clearConfig=function(){Yt=null,qe=!1},e.isValidAttribute=function(Ce,_,J){Yt||sm({});var re=Rt(Ce),et=Rt(_);return Qy(re,et,J)},e.addHook=function(Ce,_){typeof _=="function"&&(ne[Ce]=ne[Ce]||[],Ul(ne[Ce],_))},e.removeHook=function(Ce){if(ne[Ce])return tR(ne[Ce])},e.removeHooks=function(Ce){ne[Ce]&&(ne[Ce]=[])},e.removeAllHooks=function(){ne={}},e}var S$=NM();function R$(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function aR(n,e){const t=e.length;let i=0;for(;i<t;)n.push(e[i]),i+=1}function tf(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,i=n[0].length;for(let o=0;o<t;o++)for(let r=0;r<i;r++)e[r]||(e[r]=[]),e[r][o]=n[o][r];return e}function Hn(n,e,t,i){let o=-1,r=n,s=t;Array.isArray(n)||(r=Array.from(n));const a=r.length;for(o+=1;o<a;)s=e(s,r[o],o,r),o+=1;return s}function Qr(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length,r=[];let s=-1;for(;t<o;){const a=i[t];e(a,t,i)&&(s+=1,r[s]=a),t+=1}return r}function Ue(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length,r=[];let s=-1;for(;t<o;){const a=i[t];s+=1,r[s]=e(a,t,i),t+=1}return r}function M(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length;for(;t<o&&e(i[t],t,i)!==!1;)t+=1;return n}function DM(n){const e=[];return M(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function lR(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[i,...o]=[...e];let r=i;return M(o,s=>{r=r.filter(a=>!s.includes(a))}),r}function uR(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function rt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return Hn(n,(r,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return r+l+u},"").trim()}function Bt(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function ce(n){return typeof n<"u"}function vt(n){return typeof n>"u"}function kt(n){return n===null||n===""||vt(n)}function E$(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const ju="length",Xu=n=>parseInt(n,16),cR=n=>parseInt(n,10),Mf=(n,e,t)=>n.substr(e,t),qu=n=>n.codePointAt(0)-65,Kw=n=>`${n}`.replace(/\-/g,""),T$=n=>Xu(Mf(Kw(n),Xu("12"),qu("F")))/(Xu(Mf(Kw(n),qu("B"),~~![][ju]))||9),M$=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let hR=!1;const dR={invalid:()=>rt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},fR={invalid:()=>rt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function I$(n,e){const t=!kt(n),i=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",o="14.6.1";let r,s="invalid",a="invalid";n=Kw(n||"");const l=P$(n);if(t||i||l)if(l){const u=Je("17/10/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=T$(n);r=Je((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(M$()&&(s="valid",a="valid"),!hR&&s!=="valid"&&(dR[s]({keyValidityDate:r,hotVersion:o})&&console[s==="non_commercial"?"info":"warn"](dR[s]({keyValidityDate:r,hotVersion:o})),hR=!0),a!=="valid"&&e.parentNode&&fR[a]({keyValidityDate:r,hotVersion:o})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=fR[a]({keyValidityDate:r,hotVersion:o}),e.parentNode.insertBefore(c,e.nextSibling)}}function P$(n){let e=[][ju],t=e;if(n[ju]!==qu("Z"))return!1;for(let i="",o="B<H4P+".split(""),r=qu(o.shift());r;r=qu(o.shift()||"A"))--r<""[ju]?t=t|(cR(`${cR(Xu(i)+(Xu(Mf(n,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Mf(n,r,r?o[ju]===1?9:8:6);return t===e}function Xi(n){return n[0].toUpperCase()+n.substr(1)}function LM(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function $M(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function kM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[i]===void 0?"":e[i])}function gR(n){return rC(`${n}`,{ALLOWED_TAGS:[]})}function rC(n,e){return S$.sanitize(n,e)}const Hl=n=>["tabindex",n],O$=()=>["role","treegrid"],xo=()=>["role","presentation"],A$=()=>["role","gridcell"],x$=()=>["role","rowheader"],FM=()=>["role","rowgroup"],H$=()=>["role","columnheader"],Xw=()=>["role","row"],_$=()=>["role","menu"],N$=()=>["role","menuitem"],D$=()=>["role","menuitemcheckbox"],L$=()=>["role","combobox"],VM=()=>["role","listbox"],$$=()=>["role","option"],k$=()=>["role","checkbox"],F$=()=>["scope","col"],V$=()=>["scope","row"],B$=()=>["type","text"],If=n=>["aria-label",n],Ca=()=>["aria-hidden","true"],W$=()=>["aria-disabled","true"],j$=()=>["aria-multiselectable","true"],BM=n=>["aria-haspopup",n],WM=n=>["aria-rowcount",n],Pg=n=>["aria-colcount",n],jM=n=>["aria-rowindex",n],sC=n=>["aria-colindex",n],Ri=n=>["aria-expanded",n],U$=n=>["aria-sort",n],mR=()=>["aria-readonly","true"],pR=()=>["aria-invalid","true"],UM=n=>["aria-checked",n],aC=()=>["aria-selected","true"],z$=()=>["aria-autocomplete","list"],G$=n=>["aria-controls",n],Y$=n=>["aria-activedescendant",n],K$=n=>["aria-live",n],X$=n=>["aria-relevant",n],q$=n=>["aria-setsize",n],Z$=n=>["aria-posinset",n];function Q$(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,i=null,o=n;for(;o!==null;){if(t===e){i=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return i}function J$(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function ek(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Sl(n){return ek(n)&&n.parent}function oa(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:o}=Node;let r=n;for(;r!=null&&r!==t;){const{nodeType:s,nodeName:a}=r;if(s===i&&(e.includes(a)||e.includes(r)))return r;const{host:l}=r;l&&s===o?r=l:r=r.parentNode}return null}function vh(n,e,t){const i=[];let o=n;for(;o&&(o=oa(o,e,t),!(!o||t&&!t.contains(o)));)i.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const r=i.length;return r?i[r-1]:null}function ia(n,e){let t=n.parentNode,i=[];for(typeof e=="string"?n.defaultView?i=Array.prototype.slice.call(n.querySelectorAll(e),0):i=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):i.push(e);t!==null;){if(i.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function tk(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function cs(n,e,t){const i=t.parentElement.querySelector(`.ht_clone_${n}`);return i?i.contains(e):null}function zM(n){return!n||!n.length?[]:n.filter(e=>!!e)}function GM(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],i=[];return i.push(...n.filter(o=>{const r=o instanceof RegExp;return r&&e&&t.push(o),!r})),{regexFree:i,regexes:t}}function Re(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function X(n,e){typeof e=="string"&&(e=e.split(" ")),e=zM(e),e.length>0&&n.classList.add(...e)}function Ie(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:i}=GM(e,!0);t=zM(t),t.length>0&&n.classList.remove(...t),i.forEach(o=>{n.classList.forEach(r=>{o.test(r)&&n.classList.remove(r)})})}function ye(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&n.setAttribute(...i)})}function _l(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:i}=GM(e,!0);t.forEach(o=>{o!==""&&n.removeAttribute(o)}),i.forEach(o=>{n.getAttributeNames().forEach(r=>{o.test(r)&&n.removeAttribute(r)})})}function YM(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)YM(e[t])}}function No(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const nk=/(<(.*)>|&(.*);)/;function Nl(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;nk.test(e)?n.innerHTML=t?rC(e):e:ra(n,e)}function ra(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(No(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Rl(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Rl(t.host.impl);if(t.host)return Rl(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(dr(t).display==="none")return!1;t=t.parentNode}return!0}function rn(n){const e=n.ownerDocument,t=e.defaultView,i=e.documentElement;let o=n,r,s,a;for(r=o.offsetLeft,s=o.offsetTop,a=o;(o=o.offsetParent)&&!(o===e.body||!("offsetLeft"in o));)r+=o.offsetLeft,s+=o.offsetTop,a=o;return a&&a.style.position==="fixed"&&(r+=t.pageXOffset||i.scrollLeft,s+=t.pageYOffset||i.scrollTop),{left:r,top:s}}function KM(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function lC(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function uC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?KM(e):n.scrollTop}function XM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?lC(e):n.scrollLeft}function Pf(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const i=["auto","scroll"];let o=n.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:r,overflowX:s,overflowY:a}=o.style;if([r,s,a].includes("scroll"))return o;if({overflow:r,overflowX:s,overflowY:a}=t.getComputedStyle(o),i.includes(r)||i.includes(s)||i.includes(a)||o.clientHeight<=o.scrollHeight+1&&(i.includes(a)||i.includes(r))||o.clientWidth<=o.scrollWidth+1&&(i.includes(s)||i.includes(r)))return o;o=o.parentNode}return t}function ik(n){return n.scrollHeight-n.clientHeight}function ok(n){return n.scrollWidth-n.clientWidth}function El(n){const e=n.ownerDocument,t=e.defaultView;let i=n.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const o=dr(i,t),r=["scroll","hidden","auto"],s=o.getPropertyValue("overflow"),a=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(r.includes(s)||r.includes(a)||r.includes(l))return i;i=i.parentNode}return t}function Cc(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const i=n.style[e];if(i!==""&&i!==void 0)return i;const o=dr(n,t);if(o[e]!==""&&o[e]!==void 0)return o[e]}function dr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function Ct(n){return n.offsetWidth}function Wt(n){return n.offsetHeight}function dl(n){return n.clientHeight||n.innerHeight}function qM(n){return n.clientWidth||n.innerWidth}function ZM(n){return n.selectionStart?n.selectionStart:0}function rk(n){return n.selectionEnd?n.selectionEnd:0}function wR(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Og(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const o=n.parentNode,r=o.style.display;o.style.display="block",n.setSelectionRange(e,t),o.style.display=r}}}let $m;function sk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const i=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return i===o&&(o=t.clientWidth),(n.body||n.documentElement).removeChild(t),i-o}function sn(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return $m===void 0&&($m=sk(n)),$m}function ak(n){return n.offsetWidth!==n.clientWidth}function lk(n){return n.offsetHeight!==n.clientHeight}function cC(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function Ag(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function nf(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function QM(n){return nf(n)&&n.hasAttribute("data-hot-input")===!1}function JM(n){return!n.parentNode}function uk(n,e){new IntersectionObserver((i,o)=>{i.forEach(r=>{r.isIntersecting&&n.offsetParent!==null&&(e(),o.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function eI(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=n.ownerDocument,o=i.createRange(),r=i.defaultView.getSelection();ye(n,"contenteditable",!0),t&&ye(n,...Ca()),e&&X(n,"invisibleSelection"),o.selectNodeContents(n),r.removeAllRanges(),r.addRange(o)}function tI(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&Ie(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function ck(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;eI(n,t),e(),tI(n,t)}function wt(n){return typeof n=="function"}function hC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,i;function o(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{i=n.apply(this,s)},e),i}return o}function nI(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return n.apply(this,t.concat(s))}}function hk(n){const e=n.length;function t(i){return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function qw(n,e,t,i,o,r,s,a){return ce(a)?n.call(e,t,i,o,r,s,a):ce(s)?n.call(e,t,i,o,r,s):ce(r)?n.call(e,t,i,o,r):ce(o)?n.call(e,t,i,o):ce(i)?n.call(e,t,i):ce(t)?n.call(e,t):n.call(e)}var dk=Gt,vR=gM,fk=hn,CR=fa,gk=Ig,bR=dk([].push),mk=function(n){if(fk(n))return n;if(vR(n)){for(var e=n.length,t=[],i=0;i<e;i++){var o=n[i];typeof o=="string"?bR(t,o):(typeof o=="number"||CR(o)==="Number"||CR(o)==="String")&&bR(t,gk(o))}var r=t.length,s=!0;return function(a,l){if(s)return s=!1,l;if(vR(this))return l;for(var u=0;u<r;u++)if(t[u]===a)return l}}},pk=dn,iI=xl,oI=Mg,wk=Qi,zc=Gt,rI=Yn,yR=hn,SR=Uv,sI=iC,vk=mk,Ck=jv,bk=String,Kr=iI("JSON","stringify"),Ch=zc(/./.exec),RR=zc("".charAt),yk=zc("".charCodeAt),Sk=zc("".replace),Rk=zc(1 .toString),Ek=/[\uD800-\uDFFF]/g,ER=/^[\uD800-\uDBFF]$/,TR=/^[\uDC00-\uDFFF]$/,MR=!Ck||rI(function(){var n=iI("Symbol")("stringify detection");return Kr([n])!=="[null]"||Kr({a:n})!=="{}"||Kr(Object(n))!=="{}"}),IR=rI(function(){return Kr("\uDF06\uD834")!=='"\\udf06\\ud834"'||Kr("\uDEAD")!=='"\\udead"'}),Tk=function(n,e){var t=sI(arguments),i=vk(e);if(!(!yR(i)&&(n===void 0||SR(n))))return t[1]=function(o,r){if(yR(i)&&(r=wk(i,this,bk(o),r)),!SR(r))return r},oI(Kr,null,t)},Mk=function(n,e,t){var i=RR(t,e-1),o=RR(t,e+1);return Ch(ER,n)&&!Ch(TR,o)||Ch(TR,n)&&!Ch(ER,i)?"\\u"+Rk(yk(n,0),16):n};Kr&&pk({target:"JSON",stat:!0,arity:3,forced:MR||IR},{stringify:function(e,t,i){var o=sI(arguments),r=oI(MR?Tk:Kr,null,o);return IR&&typeof r=="string"?Sk(r,Ek,Mk):r}});function bc(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},Le(n,(t,i)=>{i!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[i]=bc(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[i]=[bc(t[0])]:e[i]=[]:e[i]=null)})),e}function Vo(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function zt(n,e,t){const i=Array.isArray(t);return Le(e,(o,r)=>{(i===!1||t.includes(r))&&(n[r]=o)}),n}function xg(n,e){Le(e,(t,i)=>{e[i]&&typeof e[i]=="object"?(n[i]||(Array.isArray(e[i])?n[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?n[i]=e[i]:n[i]={}),xg(n[i],e[i])):n[i]=e[i]})}function xn(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function Do(n){const e={};return Le(n,(t,i)=>{e[i]=t}),e}function ht(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return M(t,o=>{n.MIXINS.push(o.MIXIN_NAME),Le(o,(r,s)=>{if(n.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof r=="function")n.prototype[s]=r;else{const a=function(c,h){const d=`_${c}`,g=m=>{let w=m;return(Array.isArray(w)||De(w))&&(w=xn(w)),w};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(n.prototype,s,{get:a(s,r),set:l(s),configurable:!0})}})}),n}function dC(n,e){return JSON.stringify(n)===JSON.stringify(e)}function De(n){return Object.prototype.toString.call(n)==="[object Object]"}function pr(n,e,t,i){i.value=t,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(n,e,i)}function Le(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function Ik(n,e){const t=e.split(".");let i=n;return Le(t,o=>{if(i=i[o],i===void 0)return i=void 0,!1}),i}function km(n,e,t){const i=e.split(".");let o=n;i.forEach((r,s)=>{s!==i.length-1?(_t(o,r)||(o[r]={}),o=o[r]):o[r]=t})}function fC(n){if(!De(n))return 0;const e=function(t){let i=0;return De(t)?Le(t,(o,r)=>{r!=="__children"&&(i+=e(o))}):i+=1,i};return e(n)}function Gi(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,i={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[t]},set(o){this._touched=!0,this[t]=o},enumerable:!0,configurable:!0}),i}function _t(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gC(n){return window.requestAnimationFrame(n)}function Of(n){window.cancelAnimationFrame(n)}function aI(){return"ontouchstart"in window}function Pk(){return typeof window<"u"}let Ea;function Ok(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ea||(typeof Intl=="object"?Ea=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Ea=(t,i)=>`${t}`.localeCompare(i):Ea=(t,i)=>t===i?0:t>i?-1:1,Ea)}const pi=n=>{const e={value:!1};return e.test=(t,i)=>{e.value=n(t,i)},e},is={chrome:pi((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:pi(n=>/CriOS/.test(n)),edge:pi(n=>/Edge/.test(n)),edgeWebKit:pi(n=>/EdgiOS/.test(n)),firefox:pi(n=>/Firefox/.test(n)),firefoxWebKit:pi(n=>/FxiOS/.test(n)),mobile:pi(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:pi((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Gc={mac:pi(n=>/^Mac/.test(n)),win:pi(n=>/^Win/.test(n)),linux:pi(n=>/^Linux/.test(n)),ios:pi(n=>/iPhone|iPad|iPod/i.test(n))};function Ak(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(is,t=>{let{test:i}=t;return void i(n,e)})}function xk(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le(Gc,e=>{let{test:t}=e;return void t(n)})}Pk()&&(Ak(),xk());function lI(){return is.chrome.value}function Hk(){return is.chromeWebKit.value}function Fm(){return is.firefox.value}function _k(){return is.firefoxWebKit.value}function uI(){return is.safari.value}function Nk(){return is.edge.value}function jr(){return is.mobile.value}function cI(){return Gc.ios.value}function hI(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Gc.mac.value}function PR(){return Gc.win.value}function Zw(){return Gc.mac.value}const we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Fm()?182:174,AUDIO_MUTE:Fm()?181:173,AUDIO_UP:Fm()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Dk=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function Lk(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function dI(n){return Dk.includes(n)}function $k(n){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(n)}function Yc(n,e){const t=e.split("|");let i=!1;return M(t,o=>{if(n===we[o])return i=!0,!1}),i}function Ji(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Xs(n){return n.isImmediatePropagationEnabled===!1}function sa(n){return n.button===2}function mC(n){return n.button===0}function kk(n){return n instanceof TouchEvent}function Fk(n,e){const t={x:n.offsetX,y:n.offsetY};let i=n.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return t;for(;i!==e;)t.x+=i.offsetLeft,t.y+=i.offsetTop,i=i.offsetParent;return t}var fI={},Vk=nM,Bk=Zv,Wk=Object.keys||function(e){return Vk(e,Bk)},jk=Zi,Uk=XT,zk=ns,Gk=mr,Yk=yg,Kk=Wk;fI.f=jk&&!Uk?Object.defineProperties:function(e,t){Gk(e);for(var i=Yk(t),o=Kk(t),r=o.length,s=0,a;r>s;)zk.f(e,a=o[s++],i[a]);return e};var Xk=mr,qk=fI,OR=Zv,Zk=Xv,Qk=MM,Jk=Yv,eF=QT,AR=">",xR="<",Qw="prototype",Jw="script",gI=eF("IE_PROTO"),Vm=function(){},mI=function(n){return xR+Jw+AR+n+xR+"/"+Jw+AR},HR=function(n){n.write(mI("")),n.close();var e=n.parentWindow.Object;return n=null,e},tF=function(){var n=Jk("iframe"),e="java"+Jw+":",t;return n.style.display="none",Qk.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(mI("document.F=Object")),t.close(),t.F},bh,of=function(){try{bh=new ActiveXObject("htmlfile")}catch{}of=typeof document<"u"?document.domain&&bh?HR(bh):tF():HR(bh);for(var n=OR.length;n--;)delete of[Qw][OR[n]];return of()};Zk[gI]=!0;var nF=Object.create||function(e,t){var i;return e!==null?(Vm[Qw]=Xk(e),i=new Vm,Vm[Qw]=null,i[gI]=e):i=of(),t===void 0?i:qk.f(i,t)},iF=ts,oF=nF,rF=ns.f,ev=iF("unscopables"),tv=Array.prototype;tv[ev]===void 0&&rF(tv,ev,{configurable:!0,value:oF(null)});var pC=function(n){tv[ev][n]=!0},sF=pC;sF("flatMap");function ot(){ce(console)&&console.warn(...arguments)}function wC(){ce(console)&&console.error(...arguments)}function aF(n,e,t){return(e=lF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lF(n){var e=uF(n,"string");return typeof e=="symbol"?e:e+""}function uF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ta=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cF=rt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Bm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Wm=new Map([[]]),yh=new WeakMap;class le{static getSingleton(){return dF()}constructor(){aF(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return M(Ta,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))M(t,r=>this.add(e,r,i));else{Bm.has(e)&&ot(kM(cF,{hookName:e,removedInVersion:Bm.get(e)})),Wm.has(e)&&ot(Wm.get(e));const r=this.getBucket(i);if(typeof r[e]>"u"&&(this.register(e),r[e]=[],this.initOrderMap(r,e)),t.skip=!1,r[e].indexOf(t)===-1){let s=!1;t.initialHook&&M(r[e],(a,l)=>{if(a.initialHook)return r[e][l]=t,s=!0,!1}),s||r[e].push(t)}this.setCallbackOrderIndex(r,e,t,o),this.orderBucketByOrderIndex(r,e)}return this}once(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?M(t,r=>this.once(e,r,i)):(t.runOnce=!0,this.add(e,t,i,o))}remove(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(i);return typeof o[e]<"u"&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=this.getBucket(t);return!!(i[e]!==void 0&&i[e].length)}run(e,t,i,o,r,s,a,l){{const u=this.globalBucket[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=qw(u[h],e,i,o,r,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(t,u[h]),h+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=qw(u[h],e,i,o,r,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(t,u[h],e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Le(this.getBucket(e),(t,i,o)=>o[i].length=0)}register(e){this.isRegistered(e)||Ta.push(e)}deregister(e){this.isRegistered(e)&&Ta.splice(Ta.indexOf(e),1)}isDeprecated(e){return Wm.has(e)||Bm.has(e)}isRegistered(e){return Ta.indexOf(e)>=0}getRegistered(){return Ta}setCallbackOrderIndex(e,t,i,o){const r=Number.isInteger(o)?o:0,s=this.getCallbackOrderMap(e,t);s.set(r,[...s.get(r)||[],i])}orderBucketByOrderIndex(e,t){const i=this.getCallbackOrderMap(e,t);i===void 0||i.size===0||i.size===1&&i.has(0)||(e[t]=[...i].sort((o,r)=>o[0]-r[0]).flatMap(o=>{let[,r]=o;return r}))}initOrderMap(e,t){yh.has(e)||yh.set(e,[]),yh.get(e)[t]=new Map}getCallbackOrderMap(e,t){return yh.get(e)[t]}}const hF=new le;function dF(){return hF}const jm=new Map;function eo(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";jm.has(n)||jm.set(n,new Map);const e=jm.get(n);function t(a,l){e.set(a,l)}function i(a){return e.get(a)}function o(a){return e.has(a)}function r(){return[...e.keys()]}function s(){return[...e.values()]}return{register:t,getItem:i,hasItem:o,getNames:r,getValues:s}}const nv=new WeakMap,{register:fF,getItem:pI,hasItem:wI,getNames:Bee,getValues:Wee}=eo("editors");function gF(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},le.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function vI(n,e){let t;if(typeof n=="function")nv.get(n)||Zn(null,n),t=nv.get(n);else if(typeof n=="string")t=pI(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function iv(n){if(typeof n=="function")return n;if(!wI(n))throw Error(`No registered editor found under "${n}" name`);return pI(n).getConstructor()}function Zn(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new gF(e);typeof n=="string"&&fF(n,t),nv.set(e,t)}function mF(n,e,t){return(e=pF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pF(n){var e=wF(n,"string");return typeof e=="symbol"?e:e+""}function wF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mF(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function r(s){i.call(this,vF(s))}return this.context.eventListeners.push({element:e,event:t,callback:i,callbackProxy:r,options:o,eventManager:this}),e.addEventListener(t,r,o),()=>{this.removeEventListener(e,t,i)}}removeEventListener(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=this.context.eventListeners.length,s;for(;r;)if(r-=1,s=this.context.eventListeners[r],s.event===t&&s.element===e){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(r,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const i=this.context.eventListeners[t];e&&i.eventManager!==this||(this.context.eventListeners.splice(t,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let i=e.document,o=e;i||(i=e.ownerDocument?e.ownerDocument:e,o=i.defaultView);const r={bubbles:!0,cancelable:t!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${t}`,s)}}function vF(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),Ji(this)},n}function CF(n,e){bF(n,e),e.add(n)}function bF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(n,e,t){return(e=yF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yF(n){var e=SF(n,"string");return typeof e=="symbol"?e:e+""}function SF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _R(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Um=new WeakSet;class ov{constructor(e,t,i){CF(this,Um),hs(this,"hot",void 0),hs(this,"tableMeta",void 0),hs(this,"selection",void 0),hs(this,"eventManager",void 0),hs(this,"destroyed",!1),hs(this,"activeEditor",void 0),hs(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=i,this.eventManager=new qi(e),this.hot.addHook("afterDocumentKeyDown",o=>_R(Um,this,RF).call(this,o)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",o=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",o)}),this.hot.view._wt.update("onCellDblClick",(o,r,s)=>_R(Um,this,EF).call(this,o,r,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:i,col:o}=t,r=this.hot.runHooks("modifyGetCellCoords",i,o);let s=i,a=o;if(Array.isArray(r)&&([s,a]=r),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,o,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=vI(u,this.hot),this.activeEditor.prepare(i,o,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const o=this.hot.getSelectedRangeLast();let r=this.hot.runHooks("beforeBeginEditing",o.highlight.row,o.highlight.col,e,t,i);if(t instanceof MouseEvent&&typeof r!="boolean"&&(r=this.hot.selection.getLayerLevel()===0&&o.isSingle()),r===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,i){this.activeEditor?this.activeEditor.finishEditing(e,t,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:i,col:o}=e.highlight,{rowIndexMapper:r,columnIndexMapper:s}=this.hot,a=r.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function RF(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Xs(n))return;const{keyCode:t}=n,i=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!dI(t)&&!$k(t)&&!i&&!this.isEditorOpened()&&this.openEditor("",n)}function EF(n,e){e.isCell()&&this.openEditor(null,n,!0)}const NR=new WeakMap;ov.getInstance=function(n,e,t){let i=NR.get(n);return i||(i=new ov(n,e,t),NR.set(n,i)),i};function TF(n,e){CI(n,e),e.add(n)}function zl(n,e,t){CI(n,e),e.set(n,t)}function CI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(n,e){return n.get(ar(n,e))}function Gl(n,e,t){return n.set(ar(n,e),t),t}function ar(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wl=Object.freeze({CELL:"cell",MIXED:"mixed"});var nn=new WeakMap,Sh=new WeakMap,Rh=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Nr=new WeakSet;class MF{constructor(e){var t=this;TF(this,Nr),zl(this,nn,void 0),zl(this,Sh,void 0),zl(this,Rh,1),zl(this,Eh,null),zl(this,Th,new Map);const i=e.getSettings();Gl(nn,this,e),Gl(Sh,this,i.imeFastEdit?wl.MIXED:wl.CELL),Et(nn,this).addHook("afterUpdateSettings",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return ar(Nr,t,PF).call(t,...r)}),Et(nn,this).addHook("afterSelection",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return ar(Nr,t,DR).call(t,...r)}),Et(nn,this).addHook("afterSelectionFocusSet",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return ar(Nr,t,DR).call(t,...r)}),Et(nn,this).addHook("afterSelectionEnd",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return ar(Nr,t,IF).call(t,...r)})}getFocusMode(){return Et(Sh,this)}setFocusMode(e){Object.values(wl).includes(e)?Gl(Sh,this,e):ot(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Et(Rh,this)}setRefocusDelay(e){Gl(Rh,this,e)}setRefocusElementGetter(e){Gl(Eh,this,e)}getRefocusElement(){if(typeof Et(Eh,this)=="function")return Et(Eh,this).call(this);var e;return(e=Et(nn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=i=>{var o,r;const s=(o=Et(nn,this).getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;if(!s)return;let a=Et(nn,this).runHooks("modifyFocusedElement",s.row,s.col,i);a instanceof HTMLElement||(a=i),a&&!((r=Et(nn,this).getActiveEditor())!==null&&r!==void 0&&r.isOpened())&&a.focus({preventScroll:!0})};e?t(e):ar(Nr,this,vC).call(this,i=>t(i))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Et(Rh,this);const i=this.getRefocusElement();Et(nn,this).getSettings().imeFastEdit&&!((e=Et(nn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&i&&(Et(Th,this).has(t)||Et(Th,this).set(t,hC(()=>{i.select()},t)),Et(Th,this).get(t)())}}function vC(n){var e;const t=(e=Et(nn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!Et(nn,this).selection.isCellVisible(t)){n(null);return}const i=Et(nn,this).getCell(t.row,t.col,!0);i===null?Et(nn,this).addHookOnce("afterScroll",()=>{n(Et(nn,this).getCell(t.row,t.col,!0))}):n(i)}function DR(){ar(Nr,this,vC).call(this,n=>{const{activeElement:e}=Et(nn,this).rootDocument;e&&QM(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function IF(){ar(Nr,this,vC).call(this,n=>{this.getFocusMode()===wl.MIXED&&n.nodeName==="TD"&&this.refocusToEditorTextarea()})}function PF(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?wl.MIXED:wl.CELL)}var OF=Lo,AF=fa,xF=ts,HF=xF("match"),_F=function(n){var e;return OF(n)&&((e=n[HF])!==void 0?!!e:AF(n)==="RegExp")},NF=mr,DF=function(){var n=NF(this),e="";return n.hasIndices&&(e+="d"),n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.unicodeSets&&(e+="v"),n.sticky&&(e+="y"),e},LF=Qi,$F=$o,kF=Sg,FF=DF,LR=RegExp.prototype,VF=function(n){var e=n.flags;return e===void 0&&!("flags"in LR)&&!$F(n,"flags")&&kF(LR,n)?LF(FF,n):e},CC=Gt,BF=kc,WF=Math.floor,zm=CC("".charAt),jF=CC("".replace),Gm=CC("".slice),UF=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,zF=/\$([$&'`]|\d{1,2})/g,GF=function(n,e,t,i,o,r){var s=t+n.length,a=i.length,l=zF;return o!==void 0&&(o=BF(o),l=UF),jF(r,l,function(u,c){var h;switch(zm(c,0)){case"$":return"$";case"&":return n;case"`":return Gm(e,0,t);case"'":return Gm(e,s);case"<":h=o[Gm(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var g=WF(d/10);return g===0?u:g<=a?i[g-1]===void 0?zm(c,1):i[g-1]+zm(c,1):u}h=i[d-1]}return h===void 0?"":h})},YF=dn,KF=Qi,bC=Gt,$R=Lc,XF=hn,qF=bg,ZF=_F,Yl=Ig,QF=Tg,JF=VF,eV=GF,tV=ts,nV=tV("replace"),iV=TypeError,Ym=bC("".indexOf);bC("".replace);var kR=bC("".slice),oV=Math.max;YF({target:"String",proto:!0},{replaceAll:function(e,t){var i=$R(this),o,r,s,a,l,u,c,h,d,g,m=0,w="";if(!qF(e)){if(o=ZF(e),o&&(r=Yl($R(JF(e))),!~Ym(r,"g")))throw new iV("`.replaceAll` does not allow non-global regexes");if(s=QF(e,nV),s)return KF(s,e,i,t)}for(a=Yl(i),l=Yl(e),u=XF(t),u||(t=Yl(t)),c=l.length,h=oV(1,c),d=Ym(a,l);d!==-1;)g=u?Yl(t(l,d,a)):eV(l,a,d,[],void 0,t),w+=kR(a,m,d)+g,m=d+c,d=d+h>a.length?-1:Ym(a,l,d+h);return m<a.length&&(w+=kR(a,m)),w}});const bI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},rV=new RegExp(Object.keys(bI).map(n=>`(${n})`).join("|"),"gi");function sV(n){return(n&&n.nodeName||"")==="TABLE"}function FR(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),i=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],o=n.getData(...i),r=o.length,s=r>0?o[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,h=e?1:0;for(let d=0;d<r;d+=1){const g=e&&d===0,m=[];for(let C=0;C<s;C+=1){const y=!g&&t&&C===0;let R="";if(g)R=`<th>${n.getColHeader(C-c)}</th>`;else if(y)R=`<th>${n.getRowHeader(d-h)}</th>`;else{const E=o[d][C],{hidden:H,rowspan:P,colspan:W}=n.getCellMeta(d-h,C-c);if(!H){const j=[];if(P&&j.push(`rowspan="${P}"`),W&&j.push(`colspan="${W}"`),kt(E))R=`<td ${j.join(" ")}></td>`;else{const G=E.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${j.join(" ")}>${G}</td>`}}}m.push(R)}const w=["<tr>",...m,"</tr>"].join("");g?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function VR(n){const e=n.length,t=["<table>"];for(let i=0;i<e;i+=1){const o=n[i],r=o.length,s=[];i===0&&t.push("<tbody>");for(let a=0;a<r;a+=1){const l=o[a],u=kt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}t.push("<tr>",...s,"</tr>"),i+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function aV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},i=e.createDocumentFragment(),o=e.createElement("div");i.appendChild(o);let r=n;if(typeof r=="string"){const E=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,H=>{const P=H.match(/<td\b[^>]*?>/g)[0],W=/<p.*?>/g,j=H.substring(P.length,H.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(W,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${j}</td>`});o.insertAdjacentHTML("afterbegin",`${E}`),r=o.querySelector("table")}if(!r||!sV(r))return;const s=o.querySelector('meta[name$="enerator"]'),a=r.querySelector("tbody th")!==null,l=r.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,H)=>E+H.colSpan,0)-(a?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],h=[];let d=!1,g=0,m=0;if(r.tHead){const E=Array.from(r.tHead.rows).filter(H=>{const P=H.querySelector("td")!==null;return P&&h.push(H),!P});g=E.length,d=g>0,g>1?t.nestedHeaders=Array.from(E).reduce((H,P)=>{const W=Array.from(P.cells).reduce((j,G,Y)=>{if(a&&Y===0)return j;const{colSpan:z,innerHTML:Q}=G,q=z>1?{label:Q,colspan:z}:Q;return j.push(q),j},[]);return H.push(W),H},[]):d&&(t.colHeaders=Array.from(E[0].children).reduce((H,P,W)=>(a&&W===0||H.push(P.innerHTML),H),[]))}h.length&&(t.fixedRowsTop=h.length),c.length&&(t.fixedRowsBottom=c.length);const w=[...h,...Array.from(r.tBodies).reduce((E,H)=>(E.push(...Array.from(H.rows)),E),[]),...c];m=w.length;const C=new Array(m);for(let E=0;E<m;E++)C[E]=new Array(u);const y=[],R=[];for(let E=0;E<m;E++){const H=w[E],P=Array.from(H.cells),W=P.length;for(let j=0;j<W;j++){const G=P[j],{nodeName:Y,innerHTML:z,rowSpan:Q,colSpan:q}=G,ne=C[E].findIndex(de=>de===void 0);if(Y==="TD"){if(Q>1||q>1){for(let Oe=E;Oe<E+Q;Oe++)if(Oe<m)for(let ge=ne;ge<ne+q;ge++)C[Oe][ge]=null;const Se=G.getAttribute("style");Se&&Se.includes("mso-ignore:colspan")||y.push({col:ne,row:E,rowspan:Q,colspan:q})}let de="";s&&/excel/gi.test(s.content)?de=z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):de=z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][ne]=de.replace(rV,Se=>bI[Se])}else R.push(z)}}return y.length&&(t.mergeCells=y),R.length&&(t.rowHeaders=R),C.length&&(t.data=C),t}function On(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const i=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function lV(n){return On(n,[","])}function me(n,e,t){let i=-1;for(typeof e=="function"?(t=e,e=n):i=n-1;++i<=e&&t(i)!==!1;);}function BR(n,e,t){let i=n+1;for(typeof e=="function"&&(t=e,e=0);--i>=e&&t(i)!==!1;);}function yI(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function ut(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const rv="asc",uV="desc",WR=new Map([[rv,[-1,1]],[uV,[1,-1]]]),cV=n=>`The priority '${n}' is already declared in a map.`,hV=n=>`The priority '${n}' is not a number.`;function dV(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=wt(n)?n:cV,e=wt(e)?e:hV;function i(r,s){if(!On(r))throw new Error(e(r));if(t.has(r))throw new Error(n(r));t.set(r,s)}function o(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rv;const[s,a]=WR.get(r)||WR.get(rv);return[...t].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:o}}const fV=n=>`The id '${n}' is already declared in a map.`;function Hg(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=wt(n)?n:fV;function t(u,c){if(l(u))throw new Error(n(u));e.set(u,c)}function i(u){return e.delete(u)}function o(){e.clear()}function r(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:o,getId:r,getItem:s,getItems:a,hasItem:l,removeItem:i}}const gV=n=>`'${n}' value is already declared in a unique set.`;function mV(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=wt(n)?n:gV;function t(r){if(e.has(r))throw new Error(n(r));e.add(r)}function i(){return[...e]}function o(){e.clear()}return{addItem:t,clear:o,getItems:i}}const yC=n=>`There is already registered "${n}" plugin.`,pV=n=>`There is already registered plugin on priority "${n}".`,wV=n=>`The priority "${n}" is not a number.`,SI=dV({errorPriorityExists:pV,errorPriorityNaN:wV}),RI=mV({errorItemExists:yC}),sv=Hg({errorIdExists:yC});function EI(){return[...SI.getItems(),...RI.getItems()]}function SC(n){const e=Xi(n);return sv.getItem(e)}function vV(n){return!!SC(n)}function Qe(n,e,t){[n,e,t]=bV(n,e,t),SC(n)===void 0&&CV(n,e,t)}function CV(n,e,t){const i=Xi(n);if(sv.hasItem(i))throw new Error(yC(i));t===void 0?RI.addItem(i):SI.addItem(t,i),sv.addItem(i,e)}function bV(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:yV,getItem:SV,hasItem:TI,getNames:jee,getValues:Uee}=eo("renderers");function av(n){if(typeof n=="function")return n;if(!TI(n))throw Error(`No registered renderer found under "${n}" name`);return SV(n)}function gi(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),yV(n,e)}const{register:RV,getItem:EV,hasItem:MI,getNames:zee,getValues:Gee}=eo("validators");function TV(n){if(typeof n=="function")return n;if(!MI(n))throw Error(`No registered validator found under "${n}" name`);return EV(n)}function sl(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),RV(n,e)}var MV=dn,IV=kc,PV=Bc,OV=Vc,AV=pC;MV({target:"Array",proto:!0},{at:function(e){var t=IV(this),i=PV(t),o=OV(e),r=o>=0?o:i+o;return r<0||r>=i?void 0:t[r]}});AV("at");var xV=dn,HV=Gt,_V=Lc,NV=Vc,DV=Ig,LV=Yn,$V=HV("".charAt),kV=LV(function(){return"ð ®·".at(-2)!=="\uD842"});xV({target:"String",proto:!0,forced:kV},{at:function(e){var t=DV(_V(this)),i=t.length,o=NV(e),r=o>=0?o:i+o;return r<0||r>=i?void 0:$V(t,r)}});function Kl(n,e,t){return(e=FV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FV(n){var e=VV(n,"string");return typeof e=="symbol"?e:e+""}function VV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class BV{constructor(){Kl(this,"count",0),Kl(this,"startColumn",null),Kl(this,"endColumn",null),Kl(this,"startPosition",null),Kl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:o,viewportWidth:r,columnWidth:s}=t,a=o>0?r+1:r;i>=o&&i+s<=o+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:i,viewportWidth:o,inlineStartOffset:r,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=o&&(this.startColumn-=1),m>=o)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=s>0?o+1:o,d=i+o-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*r||i>u.at(-1)||-1*i-o>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Xl(n,e,t){return(e=WV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WV(n){var e=jV(n,"string");return typeof e=="symbol"?e:e+""}function jV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class UV{constructor(){Xl(this,"count",0),Xl(this,"startRow",null),Xl(this,"endRow",null),Xl(this,"startPosition",null),Xl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:o,innerViewportHeight:r,rowHeight:s}=t;i>=o&&i+s<=r&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:i,viewportHeight:o,horizontalScrollbarHeight:r,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=o-r&&(this.startRow-=1),d>=o-r)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const c=i+o-r,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ql(n,e,t){return(e=zV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zV(n){var e=GV(n,"string");return typeof e=="symbol"?e:e+""}function GV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class II{constructor(){ql(this,"count",0),ql(this,"startColumn",null),ql(this,"endColumn",null),ql(this,"startPosition",null),ql(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:o,viewportWidth:r}=t;i<=o&&(this.startColumn=e);const s=o>0?r+1:r;i>=o&&i<=o+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:i,viewportWidth:o,inlineStartOffset:r,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>o)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=s>0?o+1:o;i+o-h<-1*r||i>u.at(-1)+c||-1*i-o>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Zl(n,e,t){return(e=YV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YV(n){var e=KV(n,"string");return typeof e=="symbol"?e:e+""}function KV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PI{constructor(){Zl(this,"count",0),Zl(this,"startRow",null),Zl(this,"endRow",null),Zl(this,"startPosition",null),Zl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:o,innerViewportHeight:r}=t;i<=o&&(this.startRow=e),i>=o&&i<=r&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:i,viewportHeight:o,horizontalScrollbarHeight:r,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=o-r)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,i+o-r<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ql(n,e,t){return(e=XV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XV(n){var e=qV(n,"string");return typeof e=="symbol"?e:e+""}function qV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ZV{constructor(){Ql(this,"count",0),Ql(this,"startColumn",0),Ql(this,"endColumn",0),Ql(this,"startPosition",0),Ql(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function Jl(n,e,t){return(e=QV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QV(n){var e=JV(n,"string");return typeof e=="symbol"?e:e+""}function JV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class eB{constructor(){Jl(this,"count",0),Jl(this,"startRow",0),Jl(this,"endRow",0),Jl(this,"startPosition",0),Jl(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class tB extends II{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalColumns:o,startPositions:r}=e;this.startColumn!==null&&typeof i=="function"&&i(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=r[this.startColumn])!==null&&t!==void 0?t:null,o<this.endColumn&&(this.endColumn=o-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class nB extends PI{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalRows:o,startPositions:r}=e;this.startRow!==null&&typeof i=="function"&&i(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=r[this.startRow])!==null&&t!==void 0?t:null,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jR(n,e,t){return(e=iB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iB(n){var e=oB(n,"string");return typeof e=="symbol"?e:e+""}function oB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OI{constructor(e){jR(this,"calculationTypes",[]),jR(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[i,o]=t;this.calculationResults.set(i,o),o.initialize(e)})}_process(e,t){this.calculationTypes.forEach(i=>{let[,o]=i;return o.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,i]=t;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Pi(n,e,t){return(e=rB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rB(n){var e=sB(n,"string");return typeof e=="symbol"?e:e+""}function sB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const _g=50;class aB extends OI{constructor(e){let{calculationTypes:t,viewportWidth:i,scrollOffset:o,totalColumns:r,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(t),Pi(this,"viewportWidth",0),Pi(this,"scrollOffset",0),Pi(this,"zeroBasedScrollOffset",0),Pi(this,"totalColumns",0),Pi(this,"columnWidthFn",null),Pi(this,"columnWidth",0),Pi(this,"overrideFn",null),Pi(this,"inlineStartOffset",0),Pi(this,"totalCalculatedWidth",0),Pi(this,"startPositions",[]),Pi(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalColumns=r,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?_g:t}}function li(n,e,t){return(e=lB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lB(n){var e=uB(n,"string");return typeof e=="symbol"?e:e+""}function uB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const AI=23;class cB extends OI{constructor(e){let{calculationTypes:t,viewportHeight:i,scrollOffset:o,totalRows:r,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),li(this,"viewportHeight",0),li(this,"scrollOffset",0),li(this,"zeroBasedScrollOffset",0),li(this,"totalRows",0),li(this,"rowHeightFn",null),li(this,"rowHeight",0),li(this,"overrideFn",null),li(this,"horizontalScrollbarHeight",0),li(this,"innerViewportHeight",0),li(this,"totalCalculatedHeight",0),li(this,"startPositions",[]),li(this,"needReverse",!0),this.viewportHeight=i,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalRows=r,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?AI:t}}function hB(n,e,t){dB(n,e),e.set(n,t)}function dB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UR(n,e,t){return(e=fB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fB(n){var e=gB(n,"string");return typeof e=="symbol"?e:e+""}function gB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ma(n,e){return n.get(xI(n,e))}function zR(n,e,t){return n.set(xI(n,e),t),t}function xI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Wo=new WeakMap;class aa{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;UR(this,"row",null),UR(this,"col",null),hB(this,Wo,!1),zR(Wo,this,i),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:i,countRowHeaders:o,countColHeaders:r}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-r||this.col<-o||this.row>=t||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ma(Wo,this)}isSouthEastOf(e){return this.row>=e.row&&(Ma(Wo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ma(Wo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ma(Wo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ma(Wo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof aa&&zR(Wo,this,e.isRtl()),this}clone(){return new aa(this.row,this.col,Ma(Wo,this))}toObject(){return{row:this.row,col:this.col}}}function mB(n,e,t){pB(n,e),e.set(n,t)}function pB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Km(n,e,t){return(e=wB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wB(n){var e=vB(n,"string");return typeof e=="symbol"?e:e+""}function vB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ui(n,e){return n.get(HI(n,e))}function CB(n,e,t){return n.set(HI(n,e),t),t}function HI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Dn=new WeakMap;class Kc{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Km(this,"highlight",null),Km(this,"from",null),Km(this,"to",null),mB(this,Dn,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=i.clone(),CB(Dn,this,o)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:i}=e,o=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return o.row<=t&&r.row>=t&&o.col<=i&&r.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),r=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(o.row,a.row),h=Math.max(o.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(r),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ui(Dn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ui(Dn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ui(Dn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ui(Dn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ui(Dn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ui(Dn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ui(Dn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ui(Dn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof aa))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top===i.top&&o.push("top"),t.right===i.right&&o.push(ui(Dn,this)?"left":"right"),t.bottom===i.bottom&&o.push("bottom"),t.left===i.left&&o.push(ui(Dn,this)?"right":"left"),o}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let o=e.row;o<=t.row;o++)for(let r=e.col;r<=t.col;r++)!(this.from.row===o&&this.from.col===r)&&!(this.to.row===o&&this.to.col===r)&&i.push(this._createCellCoords(o,r));return i}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let o=e.row;o<=t.row;o++)for(let r=e.col;r<=t.col;r++)e.row===o&&e.col===r?i.push(e):t.row===o&&t.col===r?i.push(t):i.push(this._createCellCoords(o,r));return i}forAll(e){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let o=t.row;o<=i.row;o++)for(let r=t.col;r<=i.col;r++)if(e(o,r)===!1)return}clone(){return new Kc(this.highlight,this.from,this.to,ui(Dn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new aa(e,t,ui(Dn,this))}}function no(n,e,t){bB(n,e),e.set(n,t)}function bB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pe(n,e){return n.get(_I(n,e))}function Cr(n,e,t){return n.set(_I(n,e),t),t}function _I(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ci=new WeakMap,Xm=new WeakMap,Jt=new WeakMap,Ia=new WeakMap,Mh=new WeakMap,Oi=new WeakMap,qm=new WeakMap,eu=new WeakMap,ds=new WeakMap,io=new WeakMap;let NI=class{constructor(e,t,i,o,r,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;no(this,ci,void 0),no(this,Xm,void 0),no(this,Jt,void 0),no(this,Ia,void 0),no(this,Mh,void 0),no(this,Oi,void 0),no(this,qm,void 0),no(this,eu,void 0),no(this,ds,[null,null]),no(this,io,[null,null]),Cr(ci,this,i),Cr(Xm,this,t),Cr(Jt,this,r),Cr(Ia,this,s),Cr(Mh,this,a),Cr(Oi,this,o),Cr(qm,this,e),this.registerEvents()}registerEvents(){pe(Oi,this).addEventListener(pe(Jt,this).holder,"contextmenu",i=>this.onContextMenu(i)),pe(Oi,this).addEventListener(pe(Jt,this).TABLE,"mouseover",i=>this.onMouseOver(i)),pe(Oi,this).addEventListener(pe(Jt,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{pe(Oi,this).addEventListener(pe(Jt,this).holder,"touchstart",i=>this.onTouchStart(i)),pe(Oi,this).addEventListener(pe(Jt,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),pe(Oi,this).addEventListener(pe(Jt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||pe(ci,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,pe(ci,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{pe(Oi,this).addEventListener(pe(Jt,this).holder,"mouseup",i=>this.onMouseUp(i)),pe(Oi,this).addEventListener(pe(Jt,this).holder,"mousedown",i=>this.onMouseDown(i))};jr()?e():(aI()&&e(),t())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(pe(eu,this)&&i){const[o,r]=[i.row,pe(eu,this).from.row],[s,a]=[i.col,pe(eu,this).from.col];return o===r&&s===a}return!1}parentCell(e){const t={},i=pe(Jt,this).TABLE,o=vh(e,["TD","TH"],i);return o?(t.coords=pe(Jt,this).getCoords(o),t.TD=o):Re(e,"wtBorder")&&Re(e,"current")?(t.coords=pe(Ia,this).getFocusSelection().cellRange.highlight,t.TD=pe(Jt,this).getCell(t.coords)):Re(e,"wtBorder")&&Re(e,"area")&&pe(Ia,this).getAreaSelection().cellRange&&(t.coords=pe(Ia,this).getAreaSelection().cellRange.to,t.TD=pe(Jt,this).getCell(t.coords)),t}onMouseDown(e){const t=pe(Xm,this).rootDocument.activeElement,i=nI(Q$,e.target),o=e.target;if(!["TD","TH"].includes(t.nodeName)&&(o===t||i(0)===t||i(1)===t))return;const r=this.parentCell(o);Re(o,"corner")?pe(ci,this).getSetting("onCellCornerMouseDown",e,o):r.TD&&pe(ci,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),(e.button===0||this.touchApplied)&&r.TD&&(pe(io,this)[0]=r.TD,clearTimeout(pe(ds,this)[0]),pe(ds,this)[0]=setTimeout(()=>{pe(io,this)[0]=null},1e3))}onContextMenu(e){if(pe(ci,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!pe(ci,this).has("onCellMouseOver"))return;const t=pe(Jt,this).TABLE,i=vh(e.target,["TD","TH"],t),o=pe(Mh,this)||this;i&&i!==o.lastMouseOver&&ia(i,t)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",e,pe(Jt,this).getCoords(i),i))}onMouseOut(e){if(!pe(ci,this).has("onCellMouseOut"))return;const t=pe(Jt,this).TABLE,i=vh(e.target,["TD","TH"],t),o=vh(e.relatedTarget,["TD","TH"],t),r=pe(Mh,this)||this;i&&i!==o&&ia(i,t)&&(this.callListener("onCellMouseOut",e,pe(Jt,this).getCoords(i),i),o===null&&(r.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&pe(ci,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===pe(io,this)[0]&&t.TD===pe(io,this)[1]?(Re(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),pe(io,this)[0]=null,pe(io,this)[1]=null):t.TD===pe(io,this)[0]&&(pe(io,this)[1]=t.TD,clearTimeout(pe(ds,this)[1]),pe(ds,this)[1]=setTimeout(()=>{pe(io,this)[1]=null},500)))}onTouchStart(e){Cr(eu,this,pe(Ia,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const i=e.target,o=(t=this.parentCell(i))===null||t===void 0?void 0:t.coords,r=ce(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&r&&pe(ci,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];cI()&&(Hk()||_k())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,i,o){const r=pe(ci,this).getSettingPure(e);r&&r(t,i,o,pe(qm,this).call(this))}destroy(){clearTimeout(pe(ds,this)[0]),clearTimeout(pe(ds,this)[1]),pe(Oi,this).destroy()}};function Zm(n,e,t){return(e=yB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yB(n){var e=SB(n,"string");return typeof e=="symbol"?e:e+""}function SB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RB{constructor(e,t,i){Zm(this,"offset",void 0),Zm(this,"total",void 0),Zm(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Qm(n,e,t){return(e=EB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EB(n){var e=TB(n,"string");return typeof e=="symbol"?e:e+""}function TB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MB{constructor(e,t,i){Qm(this,"offset",void 0),Qm(this,"total",void 0),Qm(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const IB=0,Af=1,xf=2;function Ih(n,e,t){return(e=PB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PB(n){var e=OB(n,"string");return typeof e=="symbol"?e:e+""}function OB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class GR{constructor(){Ih(this,"currentSize",0),Ih(this,"nextSize",0),Ih(this,"currentOffset",0),Ih(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Jm(n,e,t){return(e=AB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AB(n){var e=xB(n,"string");return typeof e=="symbol"?e:e+""}function xB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class HB{constructor(){Jm(this,"size",new GR),Jm(this,"workingSpace",IB),Jm(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof GR}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Af,e.workingSpace=xf,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=xf,e.workingSpace=Af,this.sharedSize=e.getViewSize()}}function Pa(n,e,t){return(e=_B(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _B(n){var e=NB(n,"string");return typeof e=="symbol"?e:e+""}function NB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class DI{constructor(e,t,i){Pa(this,"rootNode",void 0),Pa(this,"nodesPool",void 0),Pa(this,"sizeSet",new HB),Pa(this,"childNodeType",void 0),Pa(this,"visualIndex",0),Pa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let i=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)i+=1;else if(t.isPlaceOn(Af))break;o=o.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,i=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let r=this.getRenderedChildCount();for(;r<o;){const a=this.nodesPool();!i||i&&t.isPlaceOn(xf)?e.appendChild(a):e.insertBefore(a,e.firstChild),r+=1}const s=i&&t.isPlaceOn(Af);for(;r>o;)e.removeChild(s?e.firstChild:e.lastChild),r-=1}render(){const{rootNode:e,sizeSet:t}=this;let i=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(xf)&&(i+=t.sharedSize.nextSize);let o=e.childNodes[i];if(o.tagName!==this.childNodeType){const r=this.nodesPool();e.replaceChild(r,o),o=r}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class LI extends DI{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function DB(n,e,t){return(e=LB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LB(n){var e=$B(n,"string");return typeof e=="symbol"?e:e+""}function $B(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kB{constructor(e){DB(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function tu(n,e,t){return(e=FB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FB(n){var e=VB(n,"string");return typeof e=="symbol"?e:e+""}function VB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Xc{constructor(e,t){tu(this,"nodesPool",null),tu(this,"nodeType",void 0),tu(this,"rootNode",void 0),tu(this,"table",null),tu(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new kB(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function YR(n,e,t){return(e=BB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BB(n){var e=WB(n,"string");return typeof e=="symbol"?e:e+""}function WB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jB extends Xc{constructor(){super("TH"),YR(this,"orderViews",new WeakMap),YR(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new LI(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:i,rows:o,cells:r}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=o.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=r.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<i;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),_l(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(d,[x$(),V$(),sC(h+1),Hl(-1)]),t[h](a,d,h)}u.end()}}}class UB extends Xc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,r=o+t;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<r;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>r;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&No(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ye(this.rootNode,[FM()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:i,columnsToRender:o,rowHeadersCount:r}=this.table,s=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&ye(s,[Xw(),jM(t+1)]);for(let a=-1*r;a<o;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+r];u.className="",u.removeAttribute("style"),_l(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(u,[sC(a+1+this.table.rowHeadersCount),Hl(-1),H$(),...a>=0?[F$()]:[Xw()]]),i[t](l,u,t)}}}}let KR=!1;class zB extends Xc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,i=e+t;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!KR&&e>1e3&&(KR=!0,ot(rt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let o=0;o<t;o++){const r=this.table.renderedColumnToSource(o),s=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[o].style.width=`${s}px`}for(let o=0;o<e;o++){const r=this.table.renderedColumnToSource(o),s=this.table.columnUtils.getStretchedColumnWidth(r);this.rootNode.childNodes[o+t].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&X(i,"rowHeader")}}function GB(n,e,t){return(e=YB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YB(n){var e=KB(n,"string");return typeof e=="symbol"?e:e+""}function KB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ph={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let XR=!1;class XB extends Xc{constructor(e){super("TR",e),GB(this,"orderView",void 0),this.orderView=new DI(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!XR&&e>1e3&&(XR=!0,ot(rt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ye(this.rootNode,[FM()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<e;o++){this.orderView.render();const r=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(o);if(this.table.isAriaEnabled()){var t,i;ye(r,[Xw(),jM(s+((t=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}Ie(r,[Ph.rowEven,Ph.rowOdd]),(s+1)%2===0?X(r,Ph.rowEven):X(r,Ph.rowOdd)}this.orderView.end()}}function qR(n,e,t){return(e=qB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qB(n){var e=ZB(n,"string");return typeof e=="symbol"?e:e+""}function ZB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class QB extends Xc{constructor(){super("TD"),qR(this,"orderViews",new WeakMap),qR(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new LI(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:i,rowHeaders:o}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=o.obtainOrderView(u);c.prependView(h).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){c.render();const g=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(Re(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),_l(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,g),this.table.isAriaEnabled()){var r,s;ye(g,[...g.hasAttribute("role")?[]:[A$()],Hl(-1),sC(m+((r=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&r!==void 0?r:0)+1)])}}c.end()}}}function Xt(n,e,t){return(e=JB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JB(n){var e=eW(n,"string");return typeof e=="symbol"?e:e+""}function eW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class tW{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xt(this,"rootNode",void 0),Xt(this,"rootDocument",void 0),Xt(this,"rowHeaders",null),Xt(this,"columnHeaders",null),Xt(this,"colGroup",null),Xt(this,"rows",null),Xt(this,"cells",null),Xt(this,"rowFilter",null),Xt(this,"columnFilter",null),Xt(this,"rowUtils",null),Xt(this,"columnUtils",null),Xt(this,"rowsToRender",0),Xt(this,"columnsToRender",0),Xt(this,"rowHeaderFunctions",[]),Xt(this,"rowHeadersCount",0),Xt(this,"columnHeaderFunctions",[]),Xt(this,"columnHeadersCount",0),Xt(this,"cellRenderer",void 0),Xt(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:i,rows:o,cells:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),i.setTable(this),o.setTable(this),r.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=i,this.rows=o,this.cells=r}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let i=0;i<e;i++){const o=t.getRenderedNode(i);if(o.firstChild){const r=this.renderedRowToSource(i),s=this.rowUtils.getHeightByOverlayName(r,this.activeOverlayName);s?o.firstChild.style.height=`${s-1}px`:o.firstChild.style.height=""}}}}class nW{constructor(){let{TABLE:e,THEAD:t,COLGROUP:i,TBODY:o,rowUtils:r,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new tW(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new jB,columnHeaders:new UB(t),colGroup:new zB(i),rows:new XB(o),cells:new QB}),this.renderer.setAxisUtils(r,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function nu(n,e,t){iW(n,e),e.set(n,t)}function iW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oh(n,e,t){return(e=oW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oW(n){var e=rW(n,"string");return typeof e=="symbol"?e:e+""}function rW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mn(n,e){return n.get($I(n,e))}function iu(n,e,t){return n.set($I(n,e),t),t}function $I(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ah=new WeakMap,Oa=new WeakMap,ou=new WeakMap,xh=new WeakMap,fs=new WeakMap;class sW{constructor(e){let{totalColumns:t,stretchMode:i,stretchingColumnWidthFn:o,columnWidthFn:r}=e;Oh(this,"stretchAllRatio",0),Oh(this,"stretchLastWidth",0),Oh(this,"stretchAllColumnsWidth",[]),nu(this,Ah,0),Oh(this,"needVerifyLastColumnWidth",!0),nu(this,Oa,()=>0),nu(this,ou,s=>s),nu(this,xh,s=>s),nu(this,fs,()=>"none"),iu(Oa,this,t),iu(fs,this,i),iu(ou,this,o??mn(ou,this)),iu(xh,this,r??mn(xh,this))}refreshStretching(e){if(mn(fs,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,iu(Ah,this,e);let t=0;for(let o=0;o<mn(Oa,this).call(this);o++){const r=this._getColumnWidth(o),s=mn(ou,this).call(this,void 0,o);typeof s=="number"?e-=s:t+=r}const i=e-t;if(mn(fs,this).call(this)==="all"&&i>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(mn(fs,this).call(this)==="last"&&e!==1/0){const o=this._getColumnWidth(mn(Oa,this).call(this)-1),r=i+o;this.stretchLastWidth=r>=0?r:o}}getStretchedColumnWidth(e,t){let i=null;return mn(fs,this).call(this)==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,t):mn(fs,this).call(this)==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,t){let i=0;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(t*this.stretchAllRatio),r=mn(ou,this).call(this,o,e);r===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(r)?this._getColumnWidth(e):r}if(this.stretchAllColumnsWidth.length===mn(Oa,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)i+=this.stretchAllColumnsWidth[o];i!==mn(Ah,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=mn(Ah,this)-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===mn(Oa,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=mn(xh,this).call(this,e);return isNaN(t)&&(t=_g),t}}function Hh(n,e,t){return(e=aW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aW(n){var e=lW(n,"string");return typeof e=="symbol"?e:e+""}function lW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uW{constructor(e,t){Hh(this,"dataAccessObject",void 0),Hh(this,"wtSettings",void 0),Hh(this,"headerWidths",new Map),Hh(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new sW({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(i,o)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",i,o),columnWidthFn:i=>this.dataAccessObject.wtTable.getColumnWidth(i)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const i=this.stretching.getStretchedColumnWidth(e,t);return i&&(t=i),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(t=t?Math.max(t,i):i),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:e.holder,r=o.offsetHeight<o.scrollHeight?sn():0;this.stretching.refreshStretching(t.getViewportWidth()-r)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const i=e.getSetting("rowHeaders").length,o=e.getSetting("defaultColumnWidth");for(let r=0;r<i;r++){let s=Array.isArray(t)?t[r]:t;s=s??o,this.headerWidths.set(r,s)}}}}function ZR(n,e,t){return(e=cW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cW(n){var e=hW(n,"string");return typeof e=="symbol"?e:e+""}function hW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class dW{constructor(e,t){ZR(this,"dataAccessObject",void 0),ZR(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}getHeightByOverlayName(e,t){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const o=this.dataAccessObject.wtViewport.oversizedRows[e];return o!==void 0&&(i=i===void 0?o:Math.max(i,o)),i}}function oo(n,e,t){return(e=fW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fW(n){var e=gW(n,"string");return typeof e=="symbol"?e:e+""}function gW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dl{constructor(e,t,i,o,r){oo(this,"wtSettings",null),oo(this,"domBindings",void 0),oo(this,"TBODY",null),oo(this,"THEAD",null),oo(this,"COLGROUP",null),oo(this,"hasTableHeight",!0),oo(this,"hasTableWidth",!0),oo(this,"isTableVisible",!1),oo(this,"tableOffset",0),oo(this,"holderOffset",0),this.domBindings=i,this.isMaster=r==="master",this.name=r,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,YM(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new dW(this.dataAccessObject,this.wtSettings),this.columnUtils=new uW(this.dataAccessObject,this.wtSettings),this.tableRenderer=new nW({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Re(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",t&&t.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ye(i,[xo()]),i}createHider(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Re(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(i,[xo()]),i}createHolder(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Re(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",t&&t.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ye(i.parentNode,[xo()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(i,[xo()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:i,wtViewport:o}=this.dataAccessObject,r=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=rn(this.holder),h=o.createCalculators(h),l&&!t.getSetting("fixedColumnsStart"))){const g=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=rn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=r>0?this.getFirstRenderedRow():0,m=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new MB(g,r,c),this.columnFilter=new RB(m,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}if(w){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Po)||this.is(Xr))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let C;if(this.isMaster&&(C=this.dataAccessObject.workspaceWidth,o.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Po))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||o.createVisibleCalculators(),i.refresh(!1),i.applyToDOM();const y=Ct(this.hider),R=Ct(this.TABLE);y!==0&&R!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),C!==o.getWorkspaceWidth()&&(o.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Po)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let r,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,r=this.getColumnHeaderHeight(i),s=this.getColumnHeader(t,i),s&&(a=dl(s),(!r&&o<a||r<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let r=0,s=o.length;r<s;r++)if(i[r]){if(!t[r]||t[r].childNodes.length===0)return;t[r].childNodes[0].style.height=`${i[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Po))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let o=0;o<i;o++){const r=this.rowFilter.renderedToSource(o);t.oversizedRows&&t.oversizedRows[r]&&(t.oversizedRows[r]=void 0)}}}getCell(e){let t=e.row,i=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,i);if(o&&Array.isArray(o)&&([t,i]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const r=this.getRow(t);if(!r&&t>=0)throw new Error("TR was expected to be rendered but is not");const s=r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let t=null,i=null;if(e<0){var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var r;t=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceToRendered(e),i=this.TBODY}return t!==void 0&&i!==void 0?i.childNodes.length<t+1?!1:i.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[t];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const r=o.childNodes[i];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(t>=i)return;const o=this.rowFilter.sourceToRendered(e),r=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):o,a=(o<0?this.THEAD:this.TBODY).childNodes[r];return a==null?void 0:a.childNodes[t]}getRowHeaders(e){const t=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<i;o++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=r==null?void 0:r.childNodes[o];s&&t.push(s)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=oa(t,["TD","TH"])),t===null)return null;const i=t.parentNode,o=i.parentNode;let r=tk(i),s=t.cellIndex;return cs(ca,t,this.wtRootElement)||cs(la,t,this.wtRootElement)?o.nodeName==="THEAD"&&(r-=o.childNodes.length):cs(Xr,t,this.wtRootElement)||cs(Po,t,this.wtRootElement)?r=this.wtSettings.getSetting("totalRows")-o.childNodes.length+r:o===this.THEAD?r=this.rowFilter.visibleColHeadedRowToSourceRow(r):r=this.rowFilter.renderedToSource(r),cs(ca,t,this.wtRootElement)||cs(ua,t,this.wtRootElement)||cs(Xr,t,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(r,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),i=dl(this.TBODY)-1;let o,r,s,a,l;if(!(t===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),o=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?r=dl(l):r=dl(a)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<r||o<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=r)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Ct(this.TABLE)}getHeight(){return Wt(this.TABLE)}getTotalWidth(){const e=Ct(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Wt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Rl(this.TABLE)}_modifyRowHeaderWidth(e){let t=wt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const mW="stickyRowsBottom",RC={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};pr(RC,"MIXIN_NAME",mW,{writable:!1,enumerable:!1});const pW="stickyColumnsStart",Ng={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pr(Ng,"MIXIN_NAME",pW,{writable:!1,enumerable:!1});class EC extends Dl{constructor(e,t,i,o){super(e,t,i,o,Xr)}}ht(EC,RC);ht(EC,Ng);const la="top",Po="bottom",ua="inline_start",ca="top_inline_start_corner",Xr="bottom_inline_start_corner",kI=[la,Po,ua,ca,Xr],wW=new Map([[la,`ht_clone_${la}`],[Po,`ht_clone_${Po}`],[ua,`ht_clone_${ua} ht_clone_left`],[ca,`ht_clone_${ca} ht_clone_top_left_corner`],[Xr,`ht_clone_${Xr} ht_clone_bottom_left_corner`]]);function vW(n,e){CW(n,e),e.add(n)}function CW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bW(n,e,t){return(e=yW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yW(n){var e=SW(n,"string");return typeof e=="symbol"?e:e+""}function SW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _h(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ru=new WeakSet;class RW{constructor(e){vW(this,ru),bW(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,i,o,r){const s=this.scrollViewportHorizontally(e.col,i,r),a=this.scrollViewportVertically(e.row,t,o);return s||a}scrollViewportHorizontally(e,t,i){const{drawn:o,totalColumns:r}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>r)return!1;const s=t===void 0&&i===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(s&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>r))return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(s&&(e<u||e>c)||!s)&&(h=l.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():t)),h}scrollViewportVertically(e,t,i){const{drawn:o,totalRows:r}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>r)return!1;const s=t===void 0&&i===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(s&&(e<l||e>r-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>r))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(s&&(e<c||e>h)||!s)&&(d=u.scrollTo(e,s?e>=this.getLastPartiallyVisibleRow():i)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _h(ru,this,JR).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _h(ru,this,JR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _h(ru,this,QR).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _h(ru,this,QR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function QR(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:i,wtViewport:o,totalColumns:r,rootWindow:s}=this.dataAccessObject;if(t.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=rn(i.wtRootElement).left;const u=Math.abs(XM(s,s));if(l>u){const c=qM(s);let h=o.getRowHeaderWidth();for(let d=1;d<=r;d++)if(h+=t.sumCellSizes(d-1,d),l+h-u>=c){n=d-2;break}}}return n}function JR(n){const{topOverlay:e,wtTable:t,wtViewport:i,totalRows:o,rootWindow:r}=this.dataAccessObject;if(e.mainTableScrollableElement===r){const s=rn(t.wtRootElement),a=uC(r,r);if(s.top>a){const l=dl(r);let u=i.getColumnHeaderHeight();for(let c=1;c<=o;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){n=c-2;break}}}return n}function Ai(n,e,t){return(e=EW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EW(n){var e=TW(n,"string");return typeof e=="symbol"?e:e+""}function TW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TC{get eventManager(){return new qi(this)}constructor(e,t){Ai(this,"wtTable",void 0),Ai(this,"wtScroll",void 0),Ai(this,"wtViewport",void 0),Ai(this,"wtOverlays",void 0),Ai(this,"selectionManager",void 0),Ai(this,"wtEvent",void 0),Ai(this,"guid",`wt_${LM()}`),Ai(this,"drawInterrupted",!1),Ai(this,"drawn",!1),Ai(this,"domBindings",void 0),Ai(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new RW(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;t<i;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,i){ra(i,e[t])}])}}createCellCoords(e,t){return new aa(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,i){return new Kc(e,t,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,i,o,r){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,i,o,r)}scrollViewportHorizontally(e,t,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function eE(n,e,t){return(e=MW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MW(n){var e=IW(n,"string");return typeof e=="symbol"?e:e+""}function IW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PW extends TC{constructor(e,t,i){super(e,t),eE(this,"cloneSource",void 0),eE(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new NI(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function OW(n,e,t){return(e=AW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AW(n){var e=xW(n,"string");return typeof e=="symbol"?e:e+""}function xW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qc{constructor(e,t,i,o,r){OW(this,"wtSettings",null),pr(this,"wot",e,{writable:!1}),this.domBindings=r,this.facadeGetter=t,this.wtSettings=o;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=El(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=El(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Pf(e.TABLE)}getRelativeCellPosition(e,t,i){if(this.clone.wtTable.holder.contains(e)===!1){ot(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,r=i<this.wtSettings.getSetting("fixedColumnsStart"),s=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return o?h=this.getRelativeCellPositionWithinWindow(s,r,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,r,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,i,o){const r=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!t)s=o.start;else{let l=r.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(r.left+r.width+sn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-r.top:a=o.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,t,i,o,r){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-r.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-r.top);return{start:o.start-a,top:o.top-l}}makeClone(){if(kI.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:i,rootWindow:o}=this.domBindings,r=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;r.className=`${wW.get(this.type)} handsontable`,r.setAttribute("dir",this.isRtl()?"rtl":"ltr"),r.style.position="absolute",r.style.top=0,r.style.overflow="visible",this.isRtl()?r.style.right=0:r.style.left=0,t.getSetting("ariaTags")&&ye(r,[xo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),r.appendChild(s),a.appendChild(r);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===la||u==="vertical"&&this.type===ua?this.mainTableScrollableElement=o:o.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Pf(e.TABLE),new PW(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=e.style,o=t.style,r=e.parentNode.style;[i,o,r].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class HW extends qc{constructor(e,t,i,o,r,s){super(e,t,Xr,i,o),this.bottomOverlay=r,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new EC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${r}px`,t.style.bottom=`${s}px`}else Ag(t),this.repositionOverlay();let i=Wt(this.clone.wtTable.TABLE);const o=Ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height=`${i}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=sn(i)),o.style.bottom=`${r}px`}}const _W="calculatedColumns",Dg={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pr(Dg,"MIXIN_NAME",_W,{writable:!1,enumerable:!1});class MC extends Dl{constructor(e,t,i,o){super(e,t,i,o,Po)}}ht(MC,RC);ht(MC,Dg);function NW(n,e,t){return(e=DW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DW(n){var e=LW(n,"string");return typeof e=="symbol"?e:e+""}function LW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $W extends qc{constructor(e,t,i,o){super(e,t,Po,i,o),NW(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new MC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let i=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(i=this.getOverlayOffset(),t.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=sn(i)),o.style.bottom=`${r}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.mainTableScrollableElement===t?(t.scrollTo(lC(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:i,wtSettings:o}=this.wot,r=o.getSetting("defaultRowHeight");let s=e,a=0;for(;s<t;){const l=i.getRowHeight(s);a+=l===void 0?r:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:o}=this.domBindings,r=sn(i),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||l==="horizontal"){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=r),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let i=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;t&&r.offsetHeight!==r.clientHeight&&(s=sn(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return uC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),s=o-r,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+o,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let r=!1;if((i||t===0)&&o.length>0){const s=this.wot.wtTable.holder.parentNode,a=Re(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),r=!a):(Ie(s,"innerBorderBottom"),r=a)}return r}}const kW="calculatedRows",IC={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pr(IC,"MIXIN_NAME",kW,{writable:!1,enumerable:!1});class PC extends Dl{constructor(e,t,i,o){super(e,t,i,o,ua)}}ht(PC,IC);ht(PC,Ng);const FW="localHooks",fn={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,i,o,r,s){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)qw(this._localHooks[n][l],this,e,t,i,o,r,s)}},clearLocalHooks(){return this._localHooks={},this}};pr(fn,"MIXIN_NAME",FW,{writable:!1,enumerable:!1});let FI=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};ht(FI,fn);const VI="active-header",OC="header",AC="area",xC="focus",VW="fill",BW="row",WW="column",jW="custom-selection",HC=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var UW=pC;UW("flat");function zW(n,e){BI(n,e),e.add(n)}function tE(n,e,t){BI(n,e),e.set(n,t)}function BI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(n,e){return n.get(Zu(n,e))}function nE(n,e,t){return n.set(Zu(n,e),t),t}function Zu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xi=new WeakMap,Vn=new WeakMap,Nh=new WeakSet;class GW{constructor(){zW(this,Nh),tE(this,xi,void 0),tE(this,Vn,void 0)}setActiveOverlay(e){return nE(Vn,this,e),this}setActiveSelection(e){return nE(xi,this,e),this}scan(){const e=Ft(xi,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="area"?this.scanCellsRange(i=>t.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i)),this.scanCellsRange(i=>t.add(i))):e==="fill"?this.scanCellsRange(i=>t.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>t.add(i)),this.scanRowsInCellsRange(i=>t.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanColumnsInCellsRange(i=>t.add(i))),t}scanColumnsInHeadersRange(e){const[t,i,o,r]=Ft(xi,this).getCorners(),{wtTable:s}=Ft(Vn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>r)){for(let d=-l;d<0;d++){if(d<t||d>o)continue;const g=d+l;let m=s.getColumnHeader(h,g);const w=Ft(Vn,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ft(xi,this).settings.selectionType,columnCursor:u,selectionWidth:r-i+1});w!==null&&(w!==h&&(m=s.getColumnHeader(w,g)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[t,i,o,r]=Ft(xi,this).getCorners(),{wtTable:s}=Ft(Vn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<t||h>o)){for(let d=-l;d<0;d++){if(d<i||d>r)continue;const g=d+l;let m=s.getRowHeader(h,g);const w=Ft(Vn,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ft(xi,this).settings.selectionType,rowCursor:u,selectionHeight:o-t+1});w!==null&&(w!==h&&(m=s.getRowHeader(w,g)),e(m))}u+=1}}}scanCellsRange(e){const[t,i,o,r]=Ft(xi,this).getCorners(),{wtTable:s}=Ft(Vn,this);Zu(Nh,this,ep).call(this,(a,l)=>{if(a>=t&&a<=o&&l>=i&&l<=r){const u=s.getCell(Ft(Vn,this).createCellCoords(a,l)),c=Ft(Vn,this).getSetting("onAfterDrawSelection",a,l,Ft(xi,this).settings.layerLevel);typeof c=="string"&&X(u,c),e(u)}})}scanRowsInCellsRange(e){const[t,,i]=Ft(xi,this).getCorners(),{wtTable:o}=Ft(Vn,this);Zu(Nh,this,ep).call(this,(r,s)=>{if(r>=t&&r<=i){const a=o.getCell(Ft(Vn,this).createCellCoords(r,s));e(a)}})}scanColumnsInCellsRange(e){const[,t,,i]=Ft(xi,this).getCorners(),{wtTable:o}=Ft(Vn,this);Zu(Nh,this,ep).call(this,(r,s)=>{if(s>=t&&s<=i){const a=o.getCell(Ft(Vn,this).createCellCoords(r,s));e(a)}})}}function ep(n){const{wtTable:e}=Ft(Vn,this),t=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let o=0;o<t;o+=1){const r=e.rowFilter.renderedToSource(o);for(let s=0;s<i;s+=1)n(r,e.columnFilter.renderedToSource(s))}}class iE{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=HC,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,i=this.main.childNodes.length;t<i;t++){const o=this.main.childNodes[t];this.eventManager.addEventListener(o,"mouseenter",r=>this.onMouseEnter(r,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ji(e);const i=this,o=this.wot.rootDocument.body,r=t.getBoundingClientRect();t.style.display="none";function s(l){if(l.clientY<Math.floor(r.top)||l.clientY>Math.ceil(r.top+r.height)||l.clientX<Math.floor(r.left)||l.clientX>Math.ceil(r.left+r.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(o,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(o,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const i=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let a=0;a<5;a++){const l=i[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),o=u.style,o.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,o.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,o.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),jr()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:r}=this.wot;let s=r.bordersHolder;s||(s=t.createElement("div"),s.className="htBorders",r.bordersHolder=s,r.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};Le(o,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const r={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Le(r,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||t!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,i,o,r,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),m=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(i-m-1,10)}px`,u[l]=`${parseInt(o-m-1,10)}px`,c.top=`${parseInt(i-w/4*3,10)}px`,c[l]=`${parseInt(o-w/4*3,10)}px`;const R=Math.min(parseInt(o+r,10),C-m-g*2),E=Math.min(parseInt(o+r-w/4,10),C-w-g*2);h[l]=`${R}px`,d[l]=`${E}px`;const H=Math.min(parseInt(i+s,10),y-m-g*2),P=Math.min(parseInt(i+s-w/4,10),y-w-g*2);h.top=`${H}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:i,rootWindow:o}=this.wot;let r,s,a,l,u,c;const h=t.getRenderedRowsCount();for(let ge=0;ge<h;ge+=1){const fe=t.rowFilter.renderedToSource(ge);if(fe>=e[0]&&fe<=e[2]){r=fe,u=e[0];break}}for(let ge=h-1;ge>=0;ge-=1){const fe=t.rowFilter.renderedToSource(ge);if(fe>=e[0]&&fe<=e[2]){s=fe;break}}const d=t.getRenderedColumnsCount();for(let ge=0;ge<d;ge+=1){const fe=t.columnFilter.renderedToSource(ge);if(fe>=e[1]&&fe<=e[3]){a=fe,c=e[1];break}}for(let ge=d-1;ge>=0;ge-=1){const fe=t.columnFilter.renderedToSource(ge);if(fe>=e[1]&&fe<=e[3]){l=fe;break}}if(r===void 0||a===void 0){this.disappear();return}let g=t.getCell(this.wot.createCellCoords(r,a));const m=r!==s||a!==l,w=m?t.getCell(this.wot.createCellCoords(s,l)):g,C=rn(g),y=m?rn(w):C,R=rn(t.TABLE),E=Ct(t.TABLE),H=C.top,P=C.left,W=this.wot.wtSettings.getSetting("rtlMode");let j=0,G=0;if(W){const ge=Ct(g),fe=o.innerWidth-R.left-E;G=P+ge-y.left,j=o.innerWidth-P-ge-fe-1}else G=y.left+Ct(w)-P,j=P-R.left-1;if(this.isEntireColumnSelected(r,s)){const ge=this.getDimensionsFromHeader("columns",a,l,u,R);let fe=null;ge&&([fe,j,G]=ge),fe&&(g=fe)}let Y=H-R.top-1,z=y.top+Wt(w)-H;if(this.isEntireRowSelected(a,l)){const ge=this.getDimensionsFromHeader("rows",r,s,c,R);let fe=null;ge&&([fe,Y,z]=ge),fe&&(g=fe)}const Q=dr(g,o);parseInt(Q.borderTopWidth,10)>0&&(Y+=1,z=z>0?z-1:0),parseInt(Q[W?"borderRightWidth":"borderLeftWidth"],10)>0&&(j+=1,G=G>0?G-1:0);const q=W?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[q]=`${j}px`,this.topStyle.width=`${G}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[q]=`${j}px`,this.startStyle.height=`${z}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+z-ne}px`,this.bottomStyle[q]=`${j}px`,this.bottomStyle.width=`${G}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[q]=`${j+G-ne}px`,this.endStyle.height=`${z+1}px`,this.endStyle.display="block";let de=this.settings.border.cornerVisible;de=typeof de=="function"?de(this.settings.layerLevel):de;const Se=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Xe,Oe]=[s,l];if(Se&&Array.isArray(Se)&&([,,Xe,Oe]=Se),jr()||!de||this.isPartRange(Xe,Oe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+z+this.cornerCenterPointOffset-1}px`,this.cornerStyle[q]=`${j+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ge=El(t.TABLE);const fe=ge===o;fe&&(ge=i.documentElement);const st=parseInt(this.cornerDefaultStyle.width,10)/2,f=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const p=fe?w.getBoundingClientRect().left:w.offsetLeft;let v=!1,I=0;W?(I=p-parseInt(this.cornerDefaultStyle.width,10)/2,v=I<0):(I=p+Ct(w)+parseInt(this.cornerDefaultStyle.width,10)/2,v=I>=qM(ge)),v&&(this.cornerStyle[q]=`${Math.floor(j+G+this.cornerCenterPointOffset-st)}px`,this.cornerStyle[W?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(fe?w.getBoundingClientRect().top:w.offsetTop)+Wt(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=dl(ge)&&(this.cornerStyle.top=`${Math.floor(Y+z+this.cornerCenterPointOffset-f)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}jr()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,l,Y,j,G,z)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,i,o,r){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,m=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Wt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Ct(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(m=l(t,C-o),w=l(i,C-o),!m||!w)return!1;const y=rn(m),R=rn(w);return m&&w&&(h=y[g]-r[g]-1,d=R[g]+u(w)-y[g]),[m,h,d]}return!1}changeBorderStyle(e,t){const i=this[e].style,o=t[e];!o||o.hide?X(this[e],"hidden"):(Re(this[e],"hidden")&&Ie(this[e],"hidden"),i.backgroundColor=o.color,(e==="top"||e==="bottom")&&(i.height=`${o.width}px`),(e==="start"||e==="end")&&(i.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},i=this[e].style;i.backgroundColor=t.color,i.width=`${t.width}px`,i.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?X(this[e],"hidden"):Ie(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",jr()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function YW(n,e){WI(n,e),e.add(n)}function Aa(n,e,t){WI(n,e),e.set(n,t)}function WI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(n,e){return n.get(_C(n,e))}function oE(n,e,t){return n.set(_C(n,e),t),t}function _C(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Cn=new WeakMap,Wn=new WeakMap,tp=new WeakMap,Uu=new WeakMap,np=new WeakMap,gs=new WeakMap,rE=new WeakSet;class KW{constructor(e){YW(this,rE),Aa(this,Cn,void 0),Aa(this,Wn,void 0),Aa(this,tp,new GW),Aa(this,Uu,new WeakMap),Aa(this,np,new WeakSet),Aa(this,gs,new Map),oE(Wn,this,e)}setActiveOverlay(e){return oE(Cn,this,e),Fe(tp,this).setActiveOverlay(Fe(Cn,this)),Fe(Uu,this).has(Fe(Cn,this))||Fe(Uu,this).set(Fe(Cn,this),new Set),this}getFocusSelection(){return Fe(Wn,this)!==null?Fe(Wn,this).getFocus():null}getAreaSelection(){return Fe(Wn,this)!==null?Fe(Wn,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Fe(gs,this).has(e)){const i=Fe(gs,this).get(e);if(i.has(Fe(Cn,this)))return i.get(Fe(Cn,this));const o=new iE(Fe(Cn,this),e.settings);return i.set(Fe(Cn,this),o),o}const t=new iE(Fe(Cn,this),e.settings);return Fe(gs,this).set(e,new Map([[Fe(Cn,this),t]])),t}getBorderInstances(e){var t,i;return Array.from((t=(i=Fe(gs,this).get(e))===null||i===void 0?void 0:i.values())!==null&&t!==void 0?t:[])}destroyBorders(e){Fe(gs,this).get(e).forEach(t=>t.destroy()),Fe(gs,this).delete(e)}render(e){if(Fe(Wn,this)===null)return;e&&_C(rE,this,XW).call(this);const t=Array.from(Fe(Wn,this)),i=new Map,o=new Map;for(let r=0;r<t.length;r++){const s=t[r],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Fe(np,this).has(s)||(Fe(np,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Fe(tp,this).setActiveSelection(s).scan().forEach(m=>{if(i.has(m)){const w=i.get(m);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else i.set(m,new Map([[a,1]]));l&&(o.has(m)||o.set(m,[]),m.nodeName==="TH"&&o.get(m).push(...l))});const d=s.getCorners();Fe(Cn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((r,s)=>{var a;const l=Array.from(r).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>Fe(Uu,this).get(Fe(Cn,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=Fe(Wn,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ye(s,Fe(Wn,this).options.cellAttributes)}),Array.from(o.keys()).forEach(r=>{ye(r,[...o.get(r)])})}}function XW(){const n=Fe(Uu,this).get(Fe(Cn,this)),e=Fe(Cn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var i,o;const r=Fe(Cn,this).wtTable.TABLE.querySelectorAll(`.${t}`);let s=[];Array.isArray((i=Fe(Wn,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=Fe(Wn,this).options.cellAttributes.map(a=>a[0])),Array.isArray((o=Fe(Wn,this).options)===null||o===void 0?void 0:o.headerAttributes)&&(s=[...s,...Fe(Wn,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=r.length;a<l;a++)Ie(r[a],t),_l(r[a],s)}),n.clear()}class qW extends qc{constructor(e,t,i,o){super(e,t,ua,i,o)}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new PC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,i=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let r=0;this.trimmingContainer===t&&(!o||o!=="horizontal")?(r=this.getOverlayOffset()*(this.isRtl()?-1:1),cC(i,`${r}px`,"0px")):(r=this.getScrollPosition(),Ag(i));const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,KM(t)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultColumnWidth");let o=e,r=0;for(;o<t;)r+=this.wot.wtTable.getStretchedColumnWidth(o)||i,o+=1;return r}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,o=sn(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=o),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Ct(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(HC.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:i}=this,o=i.getSetting("rowHeaders"),r=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=r===0&&o.length>0&&!Re(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(t){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(c=sn(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,ok(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(XM(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),r=this.clone.wtTable.getTotalWidth(),s=o-r;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,i=this.wot.wtTable.holder.parentNode,o=t.getSetting("rowHeaders"),r=t.getSetting("fixedColumnsStart"),s=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";s?Ie(i,"emptyRows"):X(i,"emptyRows");let l=!1;if(!a){if(r&&!o.length)X(i,"innerBorderLeft innerBorderInlineStart");else if(!r&&o.length){const u=Re(i,"innerBorderInlineStart");e?(X(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(Ie(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const ZW="stickyRowsTop",NC={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pr(NC,"MIXIN_NAME",ZW,{writable:!1,enumerable:!1});class DC extends Dl{constructor(e,t,i,o){super(e,t,i,o,ca)}}ht(DC,NC);ht(DC,Ng);function sE(n,e,t){return(e=QW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QW(n){var e=JW(n,"string");return typeof e=="symbol"?e:e+""}function JW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ej extends qc{constructor(e,t,i,o,r,s){super(e,t,ca,i,o),sE(this,"topOverlay",void 0),sE(this,"inlineStartOverlay",void 0),this.topOverlay=r,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new DC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),r=this.topOverlay.getOverlayOffset();cC(e,`${o}px`,`${r}px`)}else Ag(e);let t=Wt(this.clone.wtTable.TABLE);const i=Ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${i}px`,!1}}class LC extends Dl{constructor(e,t,i,o){super(e,t,i,o,la)}}ht(LC,NC);ht(LC,Dg);function tj(n,e,t){return(e=nj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nj(n){var e=ij(n,"string");return typeof e=="symbol"?e:e+""}function ij(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class oj extends qc{constructor(e,t,i,o){super(e,t,la,i,o),tj(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new LC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let o=0,r=!1;if(this.trimmingContainer===t&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;r=u===c,o=this.getOverlayOffset(),cC(e,"0px",`${o}px`)}else o=this.getScrollPosition(),Ag(e);const s=this.adjustHeaderBordersPosition(o,r);return this.adjustElementsSize(),s}setScrollPosition(e){const t=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(lC(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultRowHeight");let o=e,r=0;for(;o<t;){const s=this.wot.wtTable.getRowHeight(o);r+=s===void 0?i:s,o+=1}return r}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,o=sn(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(HC.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:i,wtSettings:o}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=o.getSetting("columnHeaders"),u=o.getSetting("fixedRowsTop")===0&&a.length>0&&!Re(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(t){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(t=!1)}if(t&&s.offsetHeight!==s.clientHeight&&(h=sn(this.domBindings.rootDocument)),t){const d=o.getSetting("fixedRowsBottom"),g=o.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return c+=h,ik(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return uC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),s=o-r;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,o=this.wot.wtTable.holder.parentNode,r=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";r?Ie(o,"emptyColumns"):X(o,"emptyColumns");let a=!1;if(!t&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Re(o,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(X(o,"innerBorderTop"),a=!h):(Ie(o,"innerBorderTop"),a=h)}}return a}}function Dh(n,e,t){rj(n,e),e.set(n,t)}function rj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jo(n,e,t){return(e=sj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sj(n){var e=aj(n,"string");return typeof e=="symbol"?e:e+""}function aj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ms(n,e,t){return n.set(jI(n,e),t),t}function Uo(n,e){return n.get(jI(n,e))}function jI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xa=new WeakMap,Lh=new WeakMap,Ha=new WeakMap,$h=new WeakMap;class lj{constructor(e,t,i,o,r,s){jo(this,"wot",null),Dh(this,xa,[]),jo(this,"topOverlay",null),jo(this,"bottomOverlay",null),jo(this,"inlineStartOverlay",null),jo(this,"topInlineStartCornerOverlay",null),jo(this,"bottomInlineStartCornerOverlay",null),jo(this,"browserLineHeight",void 0),jo(this,"wtSettings",null),Dh(this,Lh,!1),Dh(this,Ha,0),Dh(this,$h,null),jo(this,"resizeObserver",new ResizeObserver(c=>{gC(()=>{!Array.isArray(c)||!c.length||(ms(Ha,this,Uo(Ha,this)+1),Uo(Ha,this)===100&&(ot("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Uo($h,this)!==null&&clearTimeout(Uo($h,this)),ms($h,this,setTimeout(()=>{ms(Ha,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=o,this.domBindings=i,this.facadeGetter=t,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=r,this.scrollbarSize=sn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Pf(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...Uo(xa,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,i=e.getComputedStyle(t.body),o=parseInt(i.lineHeight,10),r=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=o||r}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new oj(...e),this.bottomOverlay=new $W(...e),this.inlineStartOverlay=new qW(...e),this.topInlineStartCornerOverlay=new ej(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new HW(...e,this.bottomOverlay,this.inlineStartOverlay),ms(xa,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ms(Lh,this,Uo(xa,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),Uo(xa,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Uo(xa,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==o&&this.eventManager.addEventListener(o,"scroll",h=>this.onTableScroll(h),{passive:!0});const r=t.devicePixelRatio&&t.devicePixelRatio>1,s=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||r||!lI())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),ms(Ha,this,0)},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(o!==t&&r!==t&&!e.target.contains(o)||i!==t&&r!==t&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:i}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target,a=r!==i&&s!==i&&!s.contains(r),l=o!==i&&s!==i&&!s.contains(o);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Yc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),r=this.scrollHorizontally(i);return o||r}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[o,r]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==r||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Uo(Lh,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),ms(Lh,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Pf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,i=e.clientHeight,o=t!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=i),o}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:i}=this.domBindings,o=this.scrollableElement===i,r=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,r),d=t.hider.style,g=()=>o?!1:this.scrollableElement.scrollTop>Math.max(0,u-t.holder.clientHeight),m=()=>o?!1:this.scrollableElement.scrollLeft>Math.max(0,c-t.holder.clientWidth),w=g()?1:0,C=m()?1:0;if(d.width=`${c+C}px`,d.height=`${u+w}px`,this.scrollbarSize>0){const{scrollHeight:y,scrollWidth:R}=t.wtRootElement,{scrollHeight:E,scrollWidth:H}=t.holder;this.hasScrollbarRight=y<E,this.hasScrollbarBottom=R<H,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>R?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return M(t,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(i=o.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(t,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function aE(n,e,t){return(e=uj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uj(n){var e=cj(n,"string");return typeof e=="symbol"?e:e+""}function cj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hj{constructor(e){aE(this,"settings",{}),aE(this,"defaults",Object.freeze(this.getDefaults())),Le(this.defaults,(t,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(t===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,i)=>{const o=this.getSetting("data",e,t);ra(i,o??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?Le(e,(i,o)=>{this.settings[o]=i}):this.settings[e]=t,this}getSetting(e,t,i,o,r){return typeof this.settings[e]=="function"?this.settings[e](t,i,o,r):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class $C extends Dl{constructor(e,t,i,o){super(e,t,i,o,"master")}alignOverlaysWithTrimmingContainer(){const e=El(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,o=Cc(e,"height",t),r=Cc(e,"overflow",t),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(r)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const g=parseInt(dr(d,t).height,10);i.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=o==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Rl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,i="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<r;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[i]=!0}}}ht($C,IC);ht($C,Dg);class dj{constructor(e,t,i,o,r){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=i,this.wtTable=r,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new eB:new nB],["fullyVisible",()=>new UV],["partiallyVisible",()=>new PI]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new ZV:new tB],["fullyVisible",()=>new BV],["partiallyVisible",()=>new II]]),this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return t===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=Wt(t)>0&&t.clientHeight>0?t.clientHeight:1/0,i}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:i}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,r=t.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-r:u.left,h=r-c;let d,g;if(a)return Ct(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,r):d=Math.min(this.getContainerFillWidth(),h,r),o===i&&s>0&&this.sumColumnWidths(0,s-1)>d)return t.documentElement.clientWidth;if(o!==i&&(g=Cc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(d,o.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,Ct(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let i=0,o=e;for(;o<t;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const i=t.offsetWidth;return this.containerWidth=i,e.removeChild(t),i}getWorkspaceOffset(){return rn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Wt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,o=t.length;i<o;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,r=t.length;o<r;o++)i?(this.rowHeaderWidth+=Ct(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let o=this.getViewportHeight(),r,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,o-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),o-=s),i.holder.clientHeight===i.holder.offsetHeight?r=0:r=sn(this.domBindings.rootDocument),new cB({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:o,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:h=>i.getRowHeight(h),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let o=this.getViewportWidth(),r=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=t.getSetting("fixedColumnsStart");if(s&&r>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);r+=a,o-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=sn(this.domBindings.rootDocument)),new aB({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:o,scrollOffset:r,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,i=this.createRowsCalculator(),o=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const r=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!t.getSetting("renderAllColumns")){const r=o.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=o.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=o.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:o,endRow:r}=this.rowsRenderCalculator;return t<o||t===o&&t>0?!1:!(i>r||i===r&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:o,endColumn:r}=this.columnsRenderCalculator;return t<o||t===o&&t>0?!1:!(i>r||i===r&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Le(this.hasOversizedColumnHeadersMarked,(e,t,i)=>{i[t]=void 0})}}class fj extends TC{constructor(e,t){super(e,new hj(t));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new $C(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new dj(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new KW(this.wtSettings.getSetting("selections")),this.wtEvent=new NI(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new lj(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],i=[];Le(e,(o,r)=>{this.wtSettings.getSetting(r).length&&i.push(o),t.push(o)}),Ie(this.wtTable.wtRootElement.parentNode,t),X(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var t;if(!kI.includes(e))return null;const i=e.replace(/_([a-z])/g,o=>o[1].toUpperCase());return(t=this.wtOverlays[`${i}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class kC{constructor(e){e instanceof TC?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const i=new kC(t);return()=>i},this._wot=new fj(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,i){return this._wot.createCellRange(e,t,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,i,o,r){return this._wot.scrollViewport(e,t,i,o,r)}scrollViewportHorizontally(e,t,i){return this._wot.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wot.scrollViewportVertically(e,t,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,i,o,r){return this._wot.wtSettings.getSetting(e,t,i,o,r)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function lE(n){let{isShiftKey:e,isLeftClick:t,isRightClick:i,coords:o,selection:r,controller:s,cellCoordsFactory:a}=n;const l=r.isSelected()?r.getSelectedRange().current():null,u=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(r.markSource("mouse"),e&&l)o.row>=0&&o.col>=0&&!s.cell?r.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!s.cell?r.setRangeEnd(a(o.row,o.col)):u&&o.row<0&&!s.column?r.setRangeEnd(a(l.to.row,o.col)):c&&o.col<0&&!s.row?r.setRangeEnd(a(o.row,l.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!s.row?r.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!s.column&&r.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{const h=!r.inInSelection(o),d=t||i&&h;o.row<0&&o.col>=0&&!s.column?d&&r.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!s.row?d&&r.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!s.cell?d&&r.setRangeStart(o):o.col<0&&o.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}r.markEndSource()}function gj(n){let{isLeftClick:e,coords:t,selection:i,controller:o,cellCoordsFactory:r}=n;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!o.column?i.setRangeEnd(r(u-1,t.col)):s&&!o.row?i.setRangeEnd(r(t.row,l-1)):o.cell||i.setRangeEnd(t),i.markEndSource()}const mj=new Map([["mousedown",lE],["mouseover",gj],["touchstart",lE]]);function uE(n,e){let{coords:t,selection:i,controller:o,cellCoordsFactory:r}=e;mj.get(n.type)({coords:t,selection:i,controller:o,cellCoordsFactory:r,isShiftKey:n.shiftKey,isLeftClick:mC(n)||n.type==="touchstart",isRightClick:sa(n)})}const UI=new WeakMap,FC=Symbol("rootInstance");function pj(n){UI.set(n,!0)}function wj(n){return n===FC}function rf(n){return UI.has(n)}function vj(n,e){zI(n,e),e.add(n)}function ps(n,e,t){zI(n,e),e.set(n,t)}function zI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(n,e,t){return(e=Cj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cj(n){var e=bj(n,"string");return typeof e=="symbol"?e:e+""}function bj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function en(n,e){return n.get(yc(n,e))}function hi(n,e,t){return n.set(yc(n,e),t),t}function yc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ip=new WeakMap,kh=new WeakMap,Fh=new WeakMap,zo=new WeakMap,Hi=new WeakMap,op=new WeakMap,rp=new WeakMap,sf=new WeakSet;class yj{constructor(e){vj(this,sf),br(this,"hot",void 0),br(this,"eventManager",void 0),br(this,"settings",void 0),br(this,"THEAD",void 0),br(this,"TBODY",void 0),br(this,"_wt",void 0),br(this,"activeWt",void 0),ps(this,ip,0),ps(this,kh,0),br(this,"postponedAdjustElementsSize",!1),ps(this,Fh,!1),ps(this,zo,void 0),ps(this,Hi,void 0),ps(this,op,0),ps(this,rp,0),this.hot=e,this.eventManager=new qi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const i=this._wt.getCell(e,t);return i<0?null:i}scrollViewport(e,t,i,o,r){return this._wt.scrollViewport(e,t,i,o,r)}scrollViewportHorizontally(e,t,i){return this._wt.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wt.scrollViewportVertically(e,t,i)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),X(e,"handsontable"),hi(Hi,this,t.createElement("TABLE")),X(en(Hi,this),"htCore"),this.hot.getSettings().tableClassName&&X(en(Hi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ye(en(Hi,this),[xo()]),ye(e,[O$(),WM(-1),Pg(this.hot.countCols()),j$()])),this.THEAD=t.createElement("THEAD"),en(Hi,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),en(Hi,this).appendChild(this.TBODY),this.hot.table=en(Hi,this),this.hot.container.insertBefore(en(Hi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:i,rootWindow:o}=this.hot,r=t.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{hi(Fh,this,!0),this.isTextSelectionAllowed(a.target)||(wR(o),a.preventDefault(),o.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{hi(Fh,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{en(Fh,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&wR(o),a.preventDefault())}),this.eventManager.addEventListener(r,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(r,"mouseup",a=>{i.isInProgress()&&mC(a)&&i.finish(),hi(zo,this,!1);const l=QM(t.activeElement);nf(t.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!sa(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(r,"contextmenu",a=>{i.isInProgress()&&sa(a)&&(i.finish(),hi(zo,this,!1))}),this.eventManager.addEventListener(r,"touchend",()=>{i.isInProgress()&&i.finish(),hi(zo,this,!1)}),this.eventManager.addEventListener(r,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(en(zo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=sn(t);if(t.elementFromPoint(u+m,c)!==d||t.elementFromPoint(u,c+m)!==d)return}else for(;h!==r;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Sl(o);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Sl(s);this.eventManager.addEventListener(en(Hi,this),"selectstart",a=>{this.settings.fragmentSelection||nf(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,i))}translateFromRenderableToVisualIndex(e,t){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return i===null&&(i=e),o===null&&(o=t),[i,o]}countRenderableIndexes(e,t){const i=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(i-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,i,o){if(isNaN(e)||e<0)return 0;const r=i.getNearestNotHiddenIndex(e,t),s=i.getRenderableFromVisualIndex(r);if(!Number.isInteger(s))return 0;let a=0;return t<0?a=s+1:t>0&&(a=o-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let i=0;for(let o=e;o<=t;o++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)!==null&&(i+=1);return i}countRenderableRowsInRange(e,t){let i=0;for(let o=e;o<=t;o++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)!==null&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:en(Hi,this),isDataViewInstance:()=>rf(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(r,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(r,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const r=[];return this.hot.hasRowHeaders()&&r.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",r),hi(kh,this,r.length),this.hot.getSettings().ariaTags&&yc(sf,this,GI).call(this)===this.hot.countCols()&&yc(sf,this,Sj).call(this,en(kh,this)),r},columnHeaders:()=>{const r=[];return this.hot.hasColHeaders()&&r.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",r),hi(ip,this,r.length),r},columnWidth:r=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getColWidth(s===null?r:s)},rowHeight:r=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getRowHeight(s===null?r:s)},rowHeightByOverlayName:(r,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),l=a===null?r:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(r,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(r,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,g)),this.hot.runHooks("beforeRenderer",a,l,u,m,w,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,m,w,g),this.hot.runHooks("afterRenderer",a,l,u,m,w,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Rl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,hi(zo,this,!0),this.hot.runHooks("beforeOnCellMouseDown",r,u,a,c),!Xs(r)&&(uE(r,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",r,u,a),this.activeWt=this._wt)},onCellContextMenu:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,hi(zo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",r,u,a),!Xs(r)&&(this.hot.runHooks("afterOnCellContextMenu",r,u,a),this.activeWt=this._wt)},onCellMouseOut:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",r,u,a),!Xs(r)&&(this.hot.runHooks("afterOnCellMouseOut",r,u,a),this.activeWt=this._wt)},onCellMouseOver:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",r,u,a,c),!Xs(r)&&(en(zo,this)&&uE(r,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",r,u,a),this.activeWt=this._wt)},onCellMouseUp:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",r,u,a),!(Xs(r)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",r,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",r)},onCellCornerDblClick:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",r)},beforeDraw:(r,s)=>this.beforeRender(r,s),onDraw:r=>this.afterRender(r),onBeforeViewportScrollVertically:r=>{const s=this.hot.rowIndexMapper,a=r<0;let l=r;return!a&&(l=s.getVisualFromRenderableIndex(r),l===null)?r:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:r=>{const s=this.hot.columnIndexMapper,a=r<0;let l=r;return!a&&(l=s.getVisualFromRenderableIndex(r),l===null)?r:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(r,s,a)=>{const l=this.hot.rowIndexMapper,u=r<0;let c=r;u||(c=l.getVisualFromRenderableIndex(r));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(r,s,a)=>{const l=this.hot.columnIndexMapper,u=r<0;let c=r;u||(c=l.getVisualFromRenderableIndex(r));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(r,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(r,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(r,s)=>{const[a,l,u,c]=r,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(r,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",r,a)},onModifyRowHeaderWidth:r=>this.hot.runHooks("modifyRowHeaderWidth",r),onModifyGetCellCoords:(r,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=r>=0?l.getVisualFromRenderableIndex(r):r,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[g,m,w,C]=d;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C]}},viewportRowCalculatorOverride:r=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=r.startRow,u=r.endRow;if(typeof s=="number")r.startRow=Math.max(l-s,0),r.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);r.startRow=Math.max(l-c,0),r.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",r)},viewportColumnCalculatorOverride:r=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=r.startColumn,u=r.endColumn;if(typeof s=="number"&&(r.startColumn=Math.max(l-s,0),r.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);r.startColumn=Math.max(l-c,0),r.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",r)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const r=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||r}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new kC(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:i,height:o}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,o),this.eventManager.addEventListener(t,"mousedown",r=>{r.target===t&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",r=>{r.target===t&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(nf(e))return!0;const t=ia(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return en(zo,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const i=t.firstChild;if(!Re(i,"relative")){No(t),this.appendRowHeader(e,t);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:o}=this.hot,r=i.createElement("div"),s=i.createElement("span");r.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,o),r.appendChild(s),t.appendChild(r)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const r=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(t.firstChild){const s=t.firstChild;Re(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,o),s.className="",X(s,["relative",...r()])):(No(t),this.appendColHeader(e,t,i,o))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=r();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ye(a,...xo()),ye(l,...xo())),this.updateCellHeader(l,e,i,o),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=t;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Re(e,"colHeader")?r=s.wtTable.columnFilter.sourceToRendered(t):Re(e,"rowHeader")&&(r=s.wtTable.rowFilter.sourceToRendered(t))),r>-1?Nl(e,i(t,o)):(ra(e,"Â "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,t){hi(op,this,e),hi(rp,this,t)}getLastSize(){return{width:en(op,this),height:en(rp,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return en(ip,this)}getRowHeadersCount(){return en(kh,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function GI(){return parseInt(this.hot.rootElement.getAttribute(Pg()[0]),10)}function Sj(n){const e=yc(sf,this,GI).call(this)+n;ye(this.hot.rootElement,...Pg(e))}const Rj="ABCDEFGHIJKLMNOPQRSTUVWXYZ",cE=Rj.length;function Ej(n){let e=n+1,t="",i;for(;e>0;)i=(e-1)%cE,t=String.fromCharCode(65+i)+t,e=parseInt((e-i)/cE,10);return t}function YI(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const i=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((o,r)=>{Array.isArray(o)?o.forEach((s,a)=>{i.push([r+e,a,s])}):Object.keys(o).forEach(s=>{i.push([r+e,s,o[s]])})}),i}function KI(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&De(n[0])&&(e=fC(n[0]))),e}function Tj(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function Mj(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function su(n,e,t){return(e=Ij(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ij(n){var e=Pj(n,"string");return typeof e=="symbol"?e:e+""}function Pj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Oj{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];su(this,"hot",void 0),su(this,"data",void 0),su(this,"dataType","array"),su(this,"colToProp",()=>{}),su(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return M(this.data,(i,o)=>{const r=this.getAtCell(o,e);t.push(r)}),t}getAtRow(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=t===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],r?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):me(t,i,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(De(a)||wt(a))if(o?l=[]:l={},!r||o){const c=this.countFirstRowKeys()-1;me(0,c,h=>{const d=this.colToProp(h);if(h>=(t||0)&&h<=(i||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);o?l.push(g):s?km(l,d,g):l[d]=g}})}else Le(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?km(l,c,h):l[c]=h});return l}setAtCell(e,t,i){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Gi(i);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(t)?this.data[e][t]=i:km(this.data[e],t,i)}}getAtPhysicalCell(e,t,i){let o=null;if(i)if(typeof t=="string"){const{dataDotNotation:r}=this.hot.getSettings();o=r?Ik(i,t):i[t]}else typeof t=="function"?o=t(i):o=i[t];if(this.hot.hasHook("modifySourceData")){const r=Gi(o);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(o=r.value)}return o}getAtCell(e,t){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,r=null,s=null,a=null,l=null;e===null||t===null?(o=!0,r=0,a=this.countRows()-1):(r=Math.min(e.row,t.row),s=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return me(r,a,c=>{u.push(o?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return KI(this.data)}destroy(){this.data=null,this.hot=null}}function hE(n,e,t){return(e=Aj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Aj(n){var e=xj(n,"string");return typeof e=="symbol"?e:e+""}function xj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ba{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;hE(this,"indexedValues",[]),hE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?me(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ht(ba,fn);function VC(n,e,t,i){const o=t.length?t[0]:void 0;return[...n.slice(0,o),...t.map((r,s)=>wt(i)?i(r,s):i),...o===void 0?[]:n.slice(o)]}function BC(n,e){return Qr(n,(t,i)=>e.includes(i)===!1)}class os extends ba{insert(e,t){this.indexedValues=VC(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=BC(this.indexedValues,e),super.remove(e)}}class Lg extends os{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Hn(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}function WC(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function Sc(n,e){return Qr(n,t=>e.includes(t)===!1)}function jC(n,e){return Ue(n,t=>t-e.filter(i=>i<t).length)}function UC(n,e){const t=e[0],i=e.length;return Ue(n,o=>o>=t?o+i:o)}function Hj(n,e,t){return(e=_j(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _j(n){var e=Nj(n,"string");return typeof e=="symbol"?e:e+""}function Nj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $g extends ba{constructor(){super(...arguments),Hj(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Sc(this.orderOfIndexes,[e]),wt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=VC(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=UC(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=BC(this.indexedValues,e),this.orderOfIndexes=Sc(this.orderOfIndexes,e),this.orderOfIndexes=jC(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Zc extends os{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Hn(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}const dE=new Map([["indexesSequence",{getListWithInsertedItems:WC,getListWithRemovedItems:Sc}],["physicallyIndexed",{getListWithInsertedItems:VC,getListWithRemovedItems:BC}]]),XI=n=>{if(dE.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return dE.get(n)};class qI extends ba{constructor(){super(e=>e)}insert(e,t){const i=UC(this.indexedValues,t);this.indexedValues=WC(i,e,t),super.insert(e,t)}remove(e){const t=Sc(this.indexedValues,e);this.indexedValues=jC(t,e),super.remove(e)}}const fE=new Map([["hiding",Lg],["index",ba],["linkedPhysicalIndexToValue",$g],["physicalIndexToValue",os],["trimming",Zc]]);function Dj(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!fE.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(fE.get(n))(e)}function Lj(n,e,t){return(e=$j(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $j(n){var e=kj(n,"string");return typeof e=="symbol"?e:e+""}function kj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zC{constructor(){Lj(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);ce(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(i=>{i.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}ht(zC,fn);function sp(n,e,t){return(e=Fj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fj(n){var e=Vj(n,"string");return typeof e=="symbol"?e:e+""}function Vj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class gE extends zC{constructor(e,t){super(),sp(this,"mergedValuesCache",[]),sp(this,"aggregationFunction",void 0),sp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=Ue(this.get(),r=>r.getValues()),i=[],o=ce(t[0])&&t[0].length||0;for(let r=0;r<o;r+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(t[a][r]);i.push(s)}return Ue(i,this.aggregationFunction)}getMergedValueAtIndex(e,t){const i=this.getMergedValues(t)[e];return ce(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Bj(n,e,t){Wj(n,e),e.set(n,t)}function Wj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jj(n,e,t){return n.set(ZI(n,e),t),t}function Uj(n,e){return n.get(ZI(n,e))}function ZI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ap=new WeakMap;class QI{constructor(){Bj(this,ap,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Uj(ap,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){jj(ap,this,e)}}ht(QI,fn);function mE(n,e){const t=[];let i=0,o=0;for(;i<n.length&&o<e.length;i++,o++)n[i]!==e[o]&&t.push({op:"replace",index:o,oldValue:n[i],newValue:e[o]});for(;i<e.length;i++)t.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;o<n.length;o++)t.push({op:"remove",index:o,oldValue:n[o],newValue:void 0});return t}function au(n,e,t){zj(n,e),e.set(n,t)}function zj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function di(n,e){return n.get(JI(n,e))}function Vh(n,e,t){return n.set(JI(n,e),t),t}function JI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Bh=new WeakMap,lu=new WeakMap,Wh=new WeakMap,jh=new WeakMap,Uh=new WeakMap;class Gj{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};au(this,Bh,new Set),au(this,lu,[]),au(this,Wh,[]),au(this,jh,!1),au(this,Uh,!1),Vh(Uh,this,e??!1)}createObserver(){const e=new QI;return di(Bh,this).add(e),e.addLocalHook("unsubscribe",()=>{di(Bh,this).delete(e)}),e._writeInitialChanges(mE(di(lu,this),di(Wh,this))),e}emit(e){let t=di(Wh,this);(!di(jh,this)||di(lu,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(di(Uh,this)):Vh(lu,this,new Array(e.length).fill(di(Uh,this))),di(jh,this)||(Vh(jh,this,!0),t=di(lu,this)));const i=mE(t,e);di(Bh,this).forEach(o=>o._write(i)),Vh(Wh,this,e)}}function yn(n,e,t){return(e=Yj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yj(n){var e=Kj(n,"string");return typeof e=="symbol"?e:e+""}function Kj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lv{constructor(){yn(this,"indexesSequence",new qI),yn(this,"trimmingMapsCollection",new gE(e=>e.some(t=>t===!0),!1)),yn(this,"hidingMapsCollection",new gE(e=>e.some(t=>t===!0),!1)),yn(this,"variousMapsCollection",new zC),yn(this,"hidingChangesObservable",new Gj({initialIndexValue:!1})),yn(this,"notTrimmedIndexesCache",[]),yn(this,"notHiddenIndexesCache",[]),yn(this,"isBatched",!1),yn(this,"indexesSequenceChanged",!1),yn(this,"indexesChangeSource",void 0),yn(this,"trimmedIndexesChanged",!1),yn(this,"hiddenIndexesChanged",!1),yn(this,"renderablePhysicalIndexesCache",[]),yn(this,"fromPhysicalToVisualIndexesCache",new Map),yn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,i){return this.registerMap(e,Dj(t,i))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Zc?this.trimmingMapsCollection.register(e,t):t instanceof Lg?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const i=this.getNumberOfIndexes();return i>0&&t.init(i),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return ce(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return ce(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return ce(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return ce(t)?t:null}getNearestNotHiddenIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return t>0?s=r.findIndex(a=>a>e):s=r.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-t,!1):null:r[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(i)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const i=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),o=this.getNotTrimmedIndexesLength(),r=e.length,s=Sc(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(t+r<o){const u=a[t];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(WC(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const i=this.getNotTrimmedIndexes()[e],o=ce(i)?i:this.getNumberOfIndexes(),r=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Ue(new Array(t).fill(o),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(r,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(r,s),this.hidingMapsCollection.insertToEvery(r,s),this.variousMapsCollection.insertToEvery(r,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(i,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,t)}}}ht(lv,fn);function Xj(n,e){return Le(e,(t,i)=>{vt(n[i])&&(n[i]=t)}),n}function eP(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function tP(n){ce(n)&&wC(rt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function qj(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:Zj,getValues:Qj}=eo("phraseFormatters");function Jj(n,e){Zj(n,e)}function eU(){return Qj()}Jj("pluralize",qj);const nP="ContextMenu:items",Ae=nP,GC=`${Ae}.noItems`,YC=`${Ae}.insertRowAbove`,KC=`${Ae}.insertRowBelow`,XC=`${Ae}.insertColumnOnTheLeft`,qC=`${Ae}.insertColumnOnTheRight`,ZC=`${Ae}.removeRow`,QC=`${Ae}.removeColumn`,JC=`${Ae}.undo`,eb=`${Ae}.redo`,Hf=`${Ae}.readOnly`,tb=`${Ae}.clearColumn`,nb=`${Ae}.copy`,ib=`${Ae}.copyWithHeaders`,ob=`${Ae}.copyWithGroupHeaders`,rb=`${Ae}.copyHeadersOnly`,sb=`${Ae}.cut`,ab=`${Ae}.freezeColumn`,lb=`${Ae}.unfreezeColumn`,ub=`${Ae}.mergeCells`,cb=`${Ae}.unmergeCells`,hb=`${Ae}.addComment`,db=`${Ae}.editComment`,fb=`${Ae}.removeComment`,gb=`${Ae}.readOnlyComment`,mb=`${Ae}.align`,_f=`${Ae}.align.left`,Nf=`${Ae}.align.center`,Df=`${Ae}.align.right`,Lf=`${Ae}.align.justify`,$f=`${Ae}.align.top`,kf=`${Ae}.align.middle`,Ff=`${Ae}.align.bottom`,pb=`${Ae}.borders`,wb=`${Ae}.borders.top`,vb=`${Ae}.borders.right`,Cb=`${Ae}.borders.bottom`,bb=`${Ae}.borders.left`,yb=`${Ae}.borders.remove`,Sb=`${Ae}.nestedHeaders.insertChildRow`,Rb=`${Ae}.nestedHeaders.detachFromParent`,Eb=`${Ae}.hideColumn`,Tb=`${Ae}.showColumn`,Mb=`${Ae}.hideRow`,Ib=`${Ae}.showRow`,_n="Filters:",Nt=`${_n}conditions`,kg=`${Nt}.none`,Pb=`${Nt}.isEmpty`,Ob=`${Nt}.isNotEmpty`,Ab=`${Nt}.isEqualTo`,xb=`${Nt}.isNotEqualTo`,Hb=`${Nt}.beginsWith`,_b=`${Nt}.endsWith`,Nb=`${Nt}.contains`,Db=`${Nt}.doesNotContain`,tU=`${Nt}.byValue`,Lb=`${Nt}.greaterThan`,$b=`${Nt}.greaterThanOrEqualTo`,kb=`${Nt}.lessThan`,Fb=`${Nt}.lessThanOrEqualTo`,Vb=`${Nt}.isBetween`,Bb=`${Nt}.isNotBetween`,Wb=`${Nt}.after`,jb=`${Nt}.before`,Ub=`${Nt}.today`,zb=`${Nt}.tomorrow`,Gb=`${Nt}.yesterday`,Yb=`${_n}labels.filterByCondition`,Kb=`${_n}labels.filterByValue`,Xb=`${_n}labels.conjunction`,Fg=`${_n}labels.disjunction`,Vf=`${_n}values.blankCells`,qb=`${_n}buttons.selectAll`,Zb=`${_n}buttons.clear`,Qb=`${_n}buttons.ok`,Jb=`${_n}buttons.cancel`,ey=`${_n}buttons.placeholder.search`,ty=`${_n}buttons.placeholder.value`,ny=`${_n}buttons.placeholder.secondValue`,iy="CheckboxRenderer:",oy=`${iy}checked`,ry=`${iy}unchecked`,nU=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:oy,CHECKBOX_RENDERER_NAMESPACE:iy,CHECKBOX_UNCHECKED:ry,CONTEXTMENU_ITEMS_ADD_COMMENT:hb,CONTEXTMENU_ITEMS_ALIGNMENT:mb,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Ff,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Nf,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Lf,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:_f,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:kf,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Df,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:$f,CONTEXTMENU_ITEMS_BORDERS:pb,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Cb,CONTEXTMENU_ITEMS_BORDERS_LEFT:bb,CONTEXTMENU_ITEMS_BORDERS_RIGHT:vb,CONTEXTMENU_ITEMS_BORDERS_TOP:wb,CONTEXTMENU_ITEMS_CLEAR_COLUMN:tb,CONTEXTMENU_ITEMS_COPY:nb,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:rb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:ob,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:ib,CONTEXTMENU_ITEMS_CUT:sb,CONTEXTMENU_ITEMS_EDIT_COMMENT:db,CONTEXTMENU_ITEMS_FREEZE_COLUMN:ab,CONTEXTMENU_ITEMS_HIDE_COLUMN:Eb,CONTEXTMENU_ITEMS_HIDE_ROW:Mb,CONTEXTMENU_ITEMS_INSERT_LEFT:XC,CONTEXTMENU_ITEMS_INSERT_RIGHT:qC,CONTEXTMENU_ITEMS_MERGE_CELLS:ub,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Rb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Sb,CONTEXTMENU_ITEMS_NO_ITEMS:GC,CONTEXTMENU_ITEMS_READ_ONLY:Hf,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:gb,CONTEXTMENU_ITEMS_REDO:eb,CONTEXTMENU_ITEMS_REMOVE_BORDERS:yb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:QC,CONTEXTMENU_ITEMS_REMOVE_COMMENT:fb,CONTEXTMENU_ITEMS_REMOVE_ROW:ZC,CONTEXTMENU_ITEMS_ROW_ABOVE:YC,CONTEXTMENU_ITEMS_ROW_BELOW:KC,CONTEXTMENU_ITEMS_SHOW_COLUMN:Tb,CONTEXTMENU_ITEMS_SHOW_ROW:Ib,CONTEXTMENU_ITEMS_UNDO:JC,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:lb,CONTEXTMENU_ITEMS_UNMERGE_CELLS:cb,CONTEXT_MENU_ITEMS_NAMESPACE:nP,FILTERS_BUTTONS_CANCEL:Jb,FILTERS_BUTTONS_CLEAR:Zb,FILTERS_BUTTONS_OK:Qb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:ey,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:ny,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ty,FILTERS_BUTTONS_SELECT_ALL:qb,FILTERS_CONDITIONS_AFTER:Wb,FILTERS_CONDITIONS_BEFORE:jb,FILTERS_CONDITIONS_BEGINS_WITH:Hb,FILTERS_CONDITIONS_BETWEEN:Vb,FILTERS_CONDITIONS_BY_VALUE:tU,FILTERS_CONDITIONS_CONTAINS:Nb,FILTERS_CONDITIONS_EMPTY:Pb,FILTERS_CONDITIONS_ENDS_WITH:_b,FILTERS_CONDITIONS_EQUAL:Ab,FILTERS_CONDITIONS_GREATER_THAN:Lb,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:$b,FILTERS_CONDITIONS_LESS_THAN:kb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Fb,FILTERS_CONDITIONS_NAMESPACE:Nt,FILTERS_CONDITIONS_NONE:kg,FILTERS_CONDITIONS_NOT_BETWEEN:Bb,FILTERS_CONDITIONS_NOT_CONTAIN:Db,FILTERS_CONDITIONS_NOT_EMPTY:Ob,FILTERS_CONDITIONS_NOT_EQUAL:xb,FILTERS_CONDITIONS_TODAY:Ub,FILTERS_CONDITIONS_TOMORROW:zb,FILTERS_CONDITIONS_YESTERDAY:Gb,FILTERS_DIVS_FILTER_BY_CONDITION:Yb,FILTERS_DIVS_FILTER_BY_VALUE:Kb,FILTERS_LABELS_CONJUNCTION:Xb,FILTERS_LABELS_DISJUNCTION:Fg,FILTERS_NAMESPACE:_n,FILTERS_VALUES_BLANK_CELLS:Vf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const iP={languageCode:"en-US",[GC]:"No available options",[YC]:"Insert row above",[KC]:"Insert row below",[XC]:"Insert column left",[qC]:"Insert column right",[ZC]:["Remove row","Remove rows"],[QC]:["Remove column","Remove columns"],[JC]:"Undo",[eb]:"Redo",[Hf]:"Read only",[tb]:"Clear column",[mb]:"Alignment",[_f]:"Left",[Nf]:"Center",[Df]:"Right",[Lf]:"Justify",[$f]:"Top",[kf]:"Middle",[Ff]:"Bottom",[ab]:"Freeze column",[lb]:"Unfreeze column",[pb]:"Borders",[wb]:"Top",[vb]:"Right",[Cb]:"Bottom",[bb]:"Left",[yb]:"Remove border(s)",[hb]:"Add comment",[db]:"Edit comment",[fb]:"Delete comment",[gb]:"Read-only comment",[ub]:"Merge cells",[cb]:"Unmerge cells",[nb]:"Copy",[ib]:["Copy with header","Copy with headers"],[ob]:["Copy with group header","Copy with group headers"],[rb]:["Copy header only","Copy headers only"],[sb]:"Cut",[Sb]:"Insert child row",[Rb]:"Detach from parent",[Eb]:["Hide column","Hide columns"],[Tb]:["Show column","Show columns"],[Mb]:["Hide row","Hide rows"],[Ib]:["Show row","Show rows"],[kg]:"None",[Pb]:"Is empty",[Ob]:"Is not empty",[Ab]:"Is equal to",[xb]:"Is not equal to",[Hb]:"Begins with",[_b]:"Ends with",[Nb]:"Contains",[Db]:"Does not contain",[Lb]:"Greater than",[$b]:"Greater than or equal to",[kb]:"Less than",[Fb]:"Less than or equal to",[Vb]:"Is between",[Bb]:"Is not between",[Wb]:"After",[jb]:"Before",[Ub]:"Today",[zb]:"Tomorrow",[Gb]:"Yesterday",[Vf]:"Blank cells",[Yb]:"Filter by condition",[Kb]:"Filter by value",[Xb]:"And",[Fg]:"Or",[qb]:"Select all",[Zb]:"Clear",[Qb]:"OK",[Jb]:"Cancel",[ey]:"Search",[ty]:"Value",[ny]:"Second value",[oy]:"Checked",[ry]:"Unchecked"},iU=nU,uv=iP.languageCode,{register:oU,getItem:oP,hasItem:rU,getValues:sU}=eo("languagesDictionaries");rP(iP);function rP(n,e){let t=n,i=e;return De(n)&&(i=n,t=i.languageCode),aU(t,i),oU(t,xn(i)),xn(i)}function aU(n,e){n!==uv&&Xj(e,oP(uv))}function sP(n){return sy(n)?xn(oP(n)):null}function sy(n){return rU(n)}function lU(){return sU()}function aP(n,e,t){const i=sP(n);if(i===null)return null;const o=i[e];if(vt(o))return null;const r=uU(o,t);return Array.isArray(r)?r[0]:r}function uU(n,e){let t=n;return M(eU(),i=>{t=i(n,e)}),t}function cU(n){let e=eP(n);return sy(e)||(e=uv,tP(n)),e}function hU(n,e,t){return(e=dU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dU(n){var e=fU(n,"string");return typeof e=="symbol"?e:e+""}function fU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wr extends FI{constructor(e,t){super(e,null),hU(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:i}=e,o=this.getNearestNotHiddenCoords(t,1),r=this.getNearestNotHiddenCoords(i,-1);return o===null||r===null?null:((o.row>r.row||o.col>r.col)&&(o=t,r=i),this.settings.createCellRange(o,o,r))}getNearestNotHiddenCoords(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(o===null)return null;const r=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return r===null?null:this.settings.createCellCoords(o,r)}getNearestNotHiddenIndex(e,t,i){return t<0?t:e.getNearestNotHiddenIndex(t,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,o=e.getHorizontalDirection()==="W-E"?1:-1,r=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((r===null||r.col===null||r.row===null)&&(s=this.getNearestNotHiddenCoords(t,i,o)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&r!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const i=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return i.row===null||i.col===null||o.row===null||o.col===null?null:this.settings.createCellRange(i,i,o)}}function lp(n){let{activeHeaderClassName:e,...t}=n;return new wr({className:e,...t,selectionType:VI})}function gU(n){let{areaCornerVisible:e,...t}=n;return new wr({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:AC})}function mU(n){let{...e}=n;return new wr({className:"highlight",...e,selectionType:AC})}function pU(n){let{columnClassName:e,...t}=n;return new wr({className:e,...t,selectionType:WW})}function wU(n){let{cellCornerVisible:e,...t}=n;return new wr({className:"current",headerAttributes:[aC()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:xC})}function vU(n){let{border:e,visualCellRange:t,...i}=n;return new wr({...e,...i,selectionType:jW},t)}function CU(n){let{...e}=n;return new wr({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:VW})}function pE(n){let{headerClassName:e,...t}=n;return new wr({className:e,...t,selectionType:OC})}function bU(n){let{rowClassName:e,...t}=n;return new wr({className:e,...t,selectionType:BW})}function yU(n,e){SU(n,e),e.add(n)}function SU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ln(n,e,t){return(e=RU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RU(n){var e=EU(n,"string");return typeof e=="symbol"?e:e+""}function EU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Go(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ro=new WeakSet;class TU{constructor(e){yU(this,ro),Ln(this,"options",void 0),Ln(this,"layerLevel",0),Ln(this,"focus",void 0),Ln(this,"fill",void 0),Ln(this,"layeredAreas",new Map),Ln(this,"areas",new Map),Ln(this,"rowHeaders",new Map),Ln(this,"columnHeaders",new Map),Ln(this,"activeRowHeaders",new Map),Ln(this,"activeColumnHeaders",new Map),Ln(this,"activeCornerHeaders",new Map),Ln(this,"rowHighlights",new Map),Ln(this,"columnHighlights",new Map),Ln(this,"customSelections",[]),this.options=e,this.focus=wU(e),this.fill=CU(e)}isEnabledFor(e,t){let i=e;e===xC&&(i="current");let o=this.options.disabledCellSelection(t.row,t.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Go(ro,this,Yo).call(this,this.layeredAreas,gU)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Go(ro,this,Yo).call(this,this.areas,mU)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Go(ro,this,Yo).call(this,this.rowHeaders,pE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Go(ro,this,Yo).call(this,this.columnHeaders,pE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Go(ro,this,Yo).call(this,this.activeRowHeaders,lp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Go(ro,this,Yo).call(this,this.activeColumnHeaders,lp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Go(ro,this,Yo).call(this,this.activeCornerHeaders,lp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Go(ro,this,Yo).call(this,this.rowHighlights,bU)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Go(ro,this,Yo).call(this,this.columnHighlights,pU)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(vU({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Yo(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const i=e({layerLevel:t,...this.options});return n.set(t,i),i}function wE(n,e,t){return(e=MU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MU(n){var e=IU(n,"string");return typeof e=="symbol"?e:e+""}function IU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PU{constructor(e){wE(this,"ranges",[]),wE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function OU(n,e){lP(n,e),e.add(n)}function up(n,e,t){lP(n,e),e.set(n,t)}function lP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(n,e){return n.get(Ut(n,e))}function zh(n,e,t){return n.set(Ut(n,e),t),t}function Ut(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Gh=new WeakMap,pt=new WeakMap,Yi=new WeakMap,Zt=new WeakSet;class cv{constructor(e,t){OU(this,Zt),up(this,Gh,void 0),up(this,pt,void 0),up(this,Yi,{x:0,y:0}),zh(Gh,this,e),zh(pt,this,t)}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=Ze(pt,this).createCellCoords(e,t);let r=Ze(Gh,this).current().highlight;const s=Ze(pt,this).visualToRenderableCoords(r);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",o),s.row!==null&&s.col!==null){const{width:u,height:c}=Ut(Zt,this,uP).call(this),{row:h,col:d}=Ut(Zt,this,CE).call(this,r),g=Ze(pt,this).fixedRowsBottom(),m=Ze(pt,this).minSpareRows(),w=Ze(pt,this).minSpareCols(),C=Ze(pt,this).autoWrapRow(),y=Ze(pt,this).autoWrapCol(),R=Ze(pt,this).createCellCoords(h+o.row,d+o.col);if(R.row>=c){const P=Gi(i&&m>0&&g===0),W=R.col+1,j=Ze(pt,this).createCellCoords(R.row-c,W>=u?W-u:W);this.runLocalHooks("beforeColumnWrap",P,Ut(Zt,this,_a).call(this,j),W>=u),P.value?this.runLocalHooks("insertRowRequire",Ze(pt,this).countRenderableRows()):y&&R.assign(j)}else if(R.row<0){const P=Gi(y),W=R.col-1,j=Ze(pt,this).createCellCoords(c+R.row,W<0?u+W:W);this.runLocalHooks("beforeColumnWrap",P,Ut(Zt,this,_a).call(this,j),W<0),y&&R.assign(j)}if(R.col>=u){const P=Gi(i&&w>0),W=R.row+1,j=Ze(pt,this).createCellCoords(W>=c?W-c:W,R.col-u);this.runLocalHooks("beforeRowWrap",P,Ut(Zt,this,_a).call(this,j),W>=c),P.value?this.runLocalHooks("insertColRequire",Ze(pt,this).countRenderableColumns()):C&&R.assign(j)}else if(R.col<0){const P=Gi(C),W=R.row-1,j=Ze(pt,this).createCellCoords(W<0?c+W:W,u+R.col);this.runLocalHooks("beforeRowWrap",P,Ut(Zt,this,_a).call(this,j),W<0),C&&R.assign(j)}const{rowDir:E,colDir:H}=Ut(Zt,this,vE).call(this,R);a=E,l=H,r=Ut(Zt,this,_a).call(this,R)}return this.runLocalHooks("afterTransformStart",r,a,l),r}transformEnd(e,t){const i=Ze(pt,this).createCellCoords(e,t),o=Ze(Gh,this).current(),r=Ze(pt,this).visualToRenderableCoords(o.highlight),s=Ut(Zt,this,cp).call(this,o.to.row,o.from.row),a=Ut(Zt,this,hp).call(this,o.to.col,o.from.col),l=o.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),r.row!==null&&r.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Ut(Zt,this,CE).call(this,o.highlight),g=Ze(pt,this).createCellCoords(s+i.row,a+i.col),m=o.getTopStartCorner(),w=o.getTopEndCorner(),C=o.getBottomEndCorner();if(i.col<0&&a>=d&&g.col<d){const H=g.col-d;g.col=Ut(Zt,this,hp).call(this,m.col,w.col)+H}else if(i.col>0&&a<=d&&g.col>d){const H=Ut(Zt,this,hp).call(this,w.col,m.col),P=Math.max(g.col-H,1);g.col=H+P}if(i.row<0&&s>=h&&g.row<h){const H=g.row-h;g.row=Ut(Zt,this,cp).call(this,m.row,C.row)+H}else if(i.row>0&&s<=h&&g.row>h){const H=Ut(Zt,this,cp).call(this,C.row,m.row),P=Math.max(g.row-H,1);g.row=H+P}const{rowDir:y,colDir:R}=Ut(Zt,this,vE).call(this,g);u=y,c=R;const E=Ut(Zt,this,_a).call(this,g);i.row===0&&i.col!==0?l.col=E.col:i.row!==0&&i.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:t,y:i}=e;zh(Yi,this,{x:t,y:i})}resetOffsetSize(){zh(Yi,this,{x:0,y:0})}}function vE(n){const{width:e,height:t}=Ut(Zt,this,uP).call(this);let i=0,o=0;return n.row<0?(i=-1,n.row=0):n.row>0&&n.row>=t&&(i=1,n.row=t-1),n.col<0?(o=-1,n.col=0):n.col>0&&n.col>=e&&(o=1,n.col=e-1),{rowDir:i,colDir:o}}function uP(){return{width:Ze(Yi,this).x+Ze(pt,this).countRenderableColumns(),height:Ze(Yi,this).y+Ze(pt,this).countRenderableRows()}}function cp(n,e){const t=Ze(pt,this).findFirstNonHiddenRenderableRow(n,e);return t===null?null:Ze(Yi,this).y+t}function hp(n,e){const t=Ze(pt,this).findFirstNonHiddenRenderableColumn(n,e);return t===null?null:Ze(Yi,this).x+t}function CE(n){const{row:e,col:t}=Ze(pt,this).visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return Ze(pt,this).createCellCoords(Ze(Yi,this).y+e,Ze(Yi,this).x+t)}function _a(n){const e=n.clone();return e.col=n.col-Ze(Yi,this).x,e.row=n.row-Ze(Yi,this).y,Ze(pt,this).renderableToVisualCoords(e)}ht(cv,fn);const Vg=0,Bg=1,cP=2,ay=3,AU=[ay,cP],xU=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],dp=Symbol("root"),bE=Symbol("child");function Tl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dp;if(e!==dp&&e!==bE)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),i=e===dp;let o=Vg;if(t){const r=n[0];n.length===0?o=Bg:i&&r instanceof Kc?o=ay:i&&Array.isArray(r)?o=Tl(r,bE):n.length>=2&&n.length<=4&&!n.some((a,l)=>!xU[l].includes(typeof a))&&(o=cP)}return o}function Rc(n){let{createCellCoords:e,createCellRange:t,keepDirection:i=!1,propToCol:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!AU.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=n===ay;let a=s?r.from.row:r[0],l=s?r.from.col:r[1],u=s?r.to.row:r[2],c=s?r.to.col:r[3];if(typeof o=="function"&&(typeof l=="string"&&(l=o(l)),typeof c=="string"&&(c=o(c))),vt(u)&&(u=a),vt(c)&&(c=l),!i){const g=a,m=l,w=u,C=c;a=Math.min(g,w),l=Math.min(m,C),u=Math.max(g,w),c=Math.max(m,C)}const h=e(a,l),d=e(u,c);return t(h,h,d)}}function HU(n){const e=Tl(n.getSelected());if(e===Vg||e===Bg)return[];const t=Rc(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),i=new Set;M(n.getSelected(),s=>{const{from:a,to:l}=t(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const o=Array.from(i).sort((s,a)=>s-a);return Hn(o,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function _U(n){const e=Tl(n.getSelected());if(e===Vg||e===Bg)return[];const t=Rc(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),i=new Set;M(n.getSelected(),s=>{const{from:a,to:l}=t(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const o=Array.from(i).sort((s,a)=>s-a);return Hn(o,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Na(n,e,t){NU(n,e),e.set(n,t)}function NU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ws(n,e,t){return(e=DU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DU(n){var e=LU(n,"string");return typeof e=="symbol"?e:e+""}function LU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function yt(n,e){return n.get(hP(n,e))}function so(n,e,t){return n.set(hP(n,e),t),t}function hP(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var pn=new WeakMap,vs=new WeakMap,Yh=new WeakMap,uu=new WeakMap,Kh=new WeakMap,cu=new WeakMap;class dP{constructor(e,t){var i=this;ws(this,"settings",void 0),ws(this,"tableProps",void 0),ws(this,"inProgress",!1),ws(this,"selectedRange",new PU((o,r,s)=>this.tableProps.createCellRange(o,r,s))),ws(this,"highlight",void 0),Na(this,pn,void 0),Na(this,vs,void 0),ws(this,"selectedByRowHeader",new Set),ws(this,"selectedByColumnHeader",new Set),Na(this,Yh,!1),Na(this,uu,!1),Na(this,Kh,"unknown"),Na(this,cu,-1),this.settings=e,this.tableProps=t,this.highlight=new TU({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[aC()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(o,r)=>this.tableProps.isDisabledCellSelection(o,r),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,r)=>this.tableProps.createCellCoords(o,r),createCellRange:(o,r,s)=>this.tableProps.createCellRange(o,r,s)}),so(pn,this,new cv(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(o,r)=>this.tableProps.createCellCoords(o,r),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),so(vs,this,new cv(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const o=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,o.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const o=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,o.getOuterBottomEndCorner().col)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(o,r)=>this.tableProps.createCellCoords(o,r),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),yt(pn,this).addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...r)}),yt(pn,this).addLocalHook("afterTransformStart",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...r)}),yt(pn,this).addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...r)}),yt(pn,this).addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...r)}),yt(pn,this).addLocalHook("insertRowRequire",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...r)}),yt(pn,this).addLocalHook("insertColRequire",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("insertColRequire",...r)}),yt(pn,this).addLocalHook("beforeRowWrap",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...r)}),yt(pn,this).addLocalHook("beforeColumnWrap",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...r)}),yt(vs,this).addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...r)}),yt(vs,this).addLocalHook("afterTransformStart",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...r)})}getSelectedRange(){return this.selectedRange}markSource(e){so(Kh,this,e)}markEndSource(){so(Kh,this,"unknown")}getSelectionSource(){return yt(Kh,this)}setExpectedLayers(e){so(cu,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,so(cu,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const r=this.settings.selectionMode==="multiple",s=vt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();so(Yh,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!r||r&&!s&&vt(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(o.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),r=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&t.col<0&&!r||o===0&&t.row<0&&!r))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(t),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=yt(cu,this)===-1||this.selectedRange.size()===yt(cu,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),o=this.tableProps.countCols();t<this.highlight.layerLevel&&(M(this.highlight.getAreas(),m=>void m.clear()),M(this.highlight.getLayeredAreas(),m=>void m.clear()),M(this.highlight.getRowHeaders(),m=>void m.clear()),M(this.highlight.getColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveRowHeaders(),m=>void m.clear()),M(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),M(this.highlight.getRowHighlights(),m=>void m.clear()),M(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(t);const r=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(r.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(AC,e.highlight)&&(this.isMultiple()||t>=1)&&(r.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),t===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(OC,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(R).commit(),d.add(C).commit(),g.add(R).commit()):(a.add(C).add(y).commit(),l.add(R).add(E).commit(),d.add(C).add(y).commit(),g.add(R).add(E).commit())}const m=!yt(uu,this)&&this.isEntireRowSelected()&&(o>0&&o===e.getWidth()||o===0&&this.isSelectedByRowHeader()),w=!yt(uu,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(xC,t.highlight)&&i.add(t.highlight).commit().syncWith(t),this.inProgress||(so(Yh,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?yt(pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(pn,this).resetOffsetSize(),this.setRangeStart(yt(pn,this).transformStart(e,t,i))}transformEnd(e,t){this.settings.navigableHeaders?yt(pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(pn,this).resetOffsetSize(),this.setRangeEnd(yt(pn,this).transformEnd(e,t))}transformFocus(e,t){const i=this.selectedRange.current(),{row:o,col:r}=i.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,r-1),a=this.tableProps.countRenderableRowsInRange(0,o-1);i.highlight.isHeader()?yt(vs,this).setOffsetSize({x:r<0?Math.abs(r):-s,y:o<0?Math.abs(o):-a}):yt(vs,this).setOffsetSize({x:r<0?0:-s,y:o<0?0:-a});const l=yt(vs,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:o,to:r,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ut(o.row+h,c,a-1),o.col),g=this.tableProps.createCellCoords(ut(r.row+t,c,a-1),r.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ut(s.row+t,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:o,to:r,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(o.row,ut(o.col+h,c,a-1)),g=this.tableProps.createCellCoords(r.row,ut(r.col+t,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,ut(s.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Gi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&yt(Yh,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{col:r}=o.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&r<0||s===0)&&o.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{row:r}=o.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&r<0||s===0)&&o.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const r=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=t?-a:0;if(u===0&&c===0&&(r===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=o;so(uu,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(ut(d.row,u,r-1),ut(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(r-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),so(uu,this,!1)}selectCells(e){var t=this;const i=Tl(e);if(i===Bg)return!1;if(i===Vg)throw new Error(rt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=Rc(i,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),r=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:r?this.tableProps.countRowHeaders():0,countColHeaders:r?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=o(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=o(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=typeof e=="string"?this.tableProps.propToCol(e):e,r=typeof t=="string"?this.tableProps.propToCol(t):t,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,o),h=this.tableProps.createCellCoords(s-1,r),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,m=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(g=ut(i.row,u,s-1),m=ut(i.col,Math.min(o,r),Math.max(o,r))):(g=ut(i,u,s-1),m=o);const w=this.tableProps.createCellCoords(g,m),C=l===0?0:ut(w.row,u,-1),y=s-1,R=this.tableProps.createCellCoords(C,o),E=this.tableProps.createCellCoords(y,r);this.runLocalHooks("beforeSelectColumns",R,E,w),R.row=C,E.row=y,this.setRangeStartOnly(R,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",R,E,w),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,r-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:o,countCols:r,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=ut(i.row,Math.min(e,t),Math.max(e,t)),d=ut(i.col,a,r-1)):(h=e,d=ut(i,a,r-1));const g=this.tableProps.createCellCoords(h,d),m=s===0?0:ut(g.col,a,-1),w=r-1,C=this.tableProps.createCellCoords(e,m),y=this.tableProps.createCellCoords(t,w);this.runLocalHooks("beforeSelectRows",C,y,g),C.col=m,y.col=w,this.setRangeStartOnly(C,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",C,y,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:o,to:r,highlight:s}=i;this.clear(),s.assign({row:ut(s.row,-1/0,e-1),col:ut(s.col,-1/0,t-1)}),o.assign({row:ut(o.row,-1/0,e-1),col:ut(o.col,-1/0,t-1)}),r.assign({row:ut(r.row,0,e-1),col:ut(r.col,0,t-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),i=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const r=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();r.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(i)}}ht(dP,fn);const yE=/^(\r\n|\n\r|\r|\n)/,$U=/^[^\t\r\n]+/,SE=/^\t/;function kU(n){const e=[[""]];if(n.length===0)return e;let t=0,i=0,o;for(;n.length>0&&o!==n.length;)if(o=n.length,n.match(SE))n=n.replace(SE,""),t+=1,e[i][t]="";else if(n.match(yE))n=n.replace(yE,""),t=0,i+=1,e[i]=[""];else{let r="";if(n.startsWith('"')){let s=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(s+=1),r+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=n.match($U);r=s?s[0]:"",n=n.slice(r.length)}e[i][t]=r}return e}function Qu(n){let e,t,i,o,r="",s;for(e=0,t=n.length;e<t;e+=1){for(o=n[e].length,i=0;i<o;i+=1)i>0&&(r+="	"),s=n[e][i],typeof s=="string"?s.indexOf(`
`)>-1?r+=`"${s.replace(/"/g,'""')}"`:r+=s:s==null?r+="":r+=s;e!==t-1&&(r+=`
`)}return r}function Cs(n,e,t){return(e=FU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FU(n){var e=VU(n,"string");return typeof e=="symbol"?e:e+""}function VU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,i){Cs(this,"hot",void 0),Cs(this,"metaManager",void 0),Cs(this,"tableMeta",void 0),Cs(this,"dataSource",void 0),Cs(this,"duckSchema",void 0),Cs(this,"colToPropCache",void 0),Cs(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,r=0,s=!1;if(typeof t=="function"){const a=fC(e);o=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;o=Math.min(a,t.length)}for(i=0;i<o;i++){const a=s?t(i):t[i];if(De(a)){if(typeof a.data<"u"){const l=s?r:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}r+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return KI(this.dataSource)}recursiveDuckColumns(e,t,i){let o=t,r=i,s;return typeof o>"u"&&(o=0,r=""),typeof e=="object"&&!Array.isArray(e)&&Le(e,(a,l)=>{a===null?(s=r+l,this.colToPropCache.push(s),this.propToColCache.set(s,o),o+=1):o=this.recursiveDuckColumns(a,o,`${l}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&ce(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(ce(t))return this.hot.toVisualColumn(t);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?bc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.hot.countSourceRows();let s=r,a=0,l=e;if((typeof l!="number"||l>=r)&&(l=r),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<t&&r+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=xn(this.getSchema()):(m=[],me(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},xg(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),o==="below"&&(s=Math.min(s+1,r)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,t)),this.hot.runHooks("afterCreateRow",g,a,i),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const r=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,t,i)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,m=c;o==="end"&&(m=Math.min(m+1,a));const w=m;for(;g<t&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let y=0;y<h;y+=1)typeof r[y]>"u"&&(r[y]=[]),r[y].push(null);else r.push([null]);else for(let y=0;y<h;y++)r[y].splice(m,0,null);g+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):i!=="auto"&&this.metaManager.createColumn(w,t));const C=this.hot.toVisualColumn(w);return this.hot.runHooks("afterCreateCol",C,g,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:w}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const r=this.visualRowsToPhysical(o,t),s=this.hot.countSourceRows();if(o=(s+o)%s,this.hot.runHooks("beforeRemoveRow",o,r.length,r,i)===!1)return!1;const l=r.length;if(this.filterData(o,l,r),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(r);const c=ce(this.tableMeta.columns)||ce(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return r.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",o,l,r,i),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-t:e;o=(this.hot.countCols()+o)%this.hot.countCols();const r=this.visualColumnsToPhysical(o,t),s=r.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",o,t,r,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&r[0]!==r[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(r[0],t),h===0&&this.metaManager.removeColumn(r[0],t);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(r),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,t,r,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,i){const o=this.hot.getDataAtCol(e),r=o.slice(t,t+i),s=o.slice(t+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];aR(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return R$(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),r}spliceRow(e,t,i){const o=this.hot.getSourceDataAtRow(e),r=o.slice(t,t+i),s=o.slice(t+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];aR(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),r}spliceData(e,t,i){if(this.hot.runHooks("beforeDataSplice",e,t,i)!==!1){const r=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,r.forEach(s=>this.dataSource.push(s))}}filterData(e,t,i){let o=this.hot.runHooks("filterData",e,t,i);Array.isArray(o)===!1&&(o=this.dataSource.filter((r,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const i=this.hot.toPhysicalRow(e);let o=this.dataSource[i];const r=this.hot.runHooks("modifyRowData",i);o=isNaN(r)?r:o;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(o&&o.hasOwnProperty&&_t(o,t))a=o[t];else if(s&&typeof t=="string"&&t.indexOf(".")>-1){let l=o;if(!l)return null;const u=t.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof t=="function"&&(a=t(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=Gi(a);this.hot.runHooks("modifyData",i,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,i){const o=this.hot.toPhysicalRow(e);let r=i,s=this.dataSource[o];const a=this.hot.runHooks("modifyRowData",o);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Gi(r);this.hot.runHooks("modifyData",o,this.propToCol(t),u,"set"),u.isTouched()&&(r=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&_t(s,t))s[t]=r;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=s,c=0,h;const d=t.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=r}else typeof t=="function"?t(this.dataSource.slice(o,o+1)[0],r):s[t]=r}visualRowsToPhysical(e,t){const i=this.hot.countSourceRows(),o=[];let r=(i+e)%i,s=t,a;for(;r<i&&s;)a=this.hot.toPhysicalRow(r),o.push(a),s-=1,r+=1;return o}visualColumnsToPhysical(e,t){const i=this.hot.countCols(),o=[];let r=(i+e)%i,s=t;for(;r<i&&s;){const a=this.hot.toPhysicalColumn(r);o.push(a),s-=1,r+=1}return o}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,fl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,i){const o=[];let r,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===fl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(r=Math.min(e.row,t.row);r<=h;r++){a=[];const g=r>=0?this.hot.toPhysicalRow(r):r;for(s=Math.min(e.col,t.col);s<=d&&g!==null;s++)a.push(c.call(this,r,this.colToProp(s)));g!==null&&o.push(a)}return o}getText(e,t){return Qu(this.getRange(e,t,fl.DESTINATION_RENDERER))}getCopyableText(e,t){return Qu(this.getRange(e,t,fl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:BU,getItem:WU,hasItem:fP,getNames:Xee,getValues:qee}=eo("cellTypes");function jU(n){if(!fP(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return WU(n)}function ki(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:i,validator:o}=e;t&&Zn(n,t),i&&gi(n,i),o&&sl(n,o),BU(n,e)}function UU(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!_t(e,n)}function Wg(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=typeof e.type=="string"?jU(e.type):e.type;if(n._automaticallyAssignedMetaProps&&Le(e,(r,s)=>void n._automaticallyAssignedMetaProps.delete(s)),!De(i))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const o={};Le(i,(r,s)=>{if(UU(s,t)){var a;o[s]=r,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),zt(n,o)}function zU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Vo(t,n);for(let i=0;i<e.length;i++)t.prototype[e[i]]=void 0;return t}function af(n){return Number.isInteger(n)&&n>=0}function lf(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function Xh(n){return n==null}const gP=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,i;for(e=0,t=this.countRows();e<t;e++)if(i=this.getDataAtCell(e,n),kt(i)===!1)return!1;return!0},isEmptyRow(n){let e,t,i,o;for(e=0,t=this.countCols();e<t;e++)if(i=this.getDataAtCell(n,e),kt(i)===!1)return typeof i=="object"?(o=this.getCellMeta(n,e),dC(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function RE(n,e,t){return(e=GU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GU(n){var e=YU(n,"string");return typeof e=="symbol"?e:e+""}function YU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function KU(){return class{}}class XU{constructor(e){RE(this,"metaCtor",KU()),RE(this,"meta",void 0),this.meta=this.metaCtor.prototype,zt(this.meta,gP()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;zt(this.meta,e),Wg(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function qU(n,e,t){return(e=ZU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZU(n){var e=QU(n,"string");return typeof e=="symbol"?e:e+""}function QU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class JU{constructor(e){qU(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){zt(this.meta,e),Wg(this.meta,e,e)}}function qh(n,e,t){return(e=ez(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ez(n){var e=tz(n,"string");return typeof e=="symbol"?e:e+""}function tz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Bf{constructor(e){qh(this,"valueFactory",void 0),qh(this,"data",[]),qh(this,"index",[]),qh(this,"holes",new Set),this.valueFactory=e}obtain(e){lf(()=>af(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let i;if(t>=0)i=this.data[t],i===void 0&&(i=this.valueFactory(e),this.data[t]=i);else if(i=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=i,this.index[e]=o}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;lf(()=>af(e)||Xh(e),"Expecting an unsigned number or null/undefined argument.");const i=[],o=this.data.length;for(let s=0;s<t;s++)i.push(o+s),this.data.push(void 0);const r=Xh(e)?this.index.length:e;this.index=[...this.index.slice(0,r),...i,...this.index.slice(r)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;lf(()=>af(e)||Xh(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Xh(e)?this.index.length-t:e,t);for(let o=0;o<i.length;o++){const r=i[o];typeof r=="number"&&this.holes.add(r)}}size(){return this.data.length-this.holes.size}values(){return Qr(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const o=this._getKeyByStorageIndex(i);o!==-1&&e.push([o,this.data[i]])}let t=0;return{next:()=>{if(t<e.length){const i=e[t];return t+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function EE(n,e,t){return(e=nz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nz(n){var e=iz(n,"string");return typeof e=="symbol"?e:e+""}function iz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const oz=["data","width"];class rz{constructor(e){EE(this,"globalMeta",void 0),EE(this,"metas",new Bf(()=>this._createMeta())),this.globalMeta=e,this.metas=new Bf(()=>this._createMeta())}updateMeta(e,t){const i=this.getMeta(e);zt(i,t),Wg(i,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return zU(this.globalMeta.getMetaConstructor(),oz).prototype}}function TE(n,e,t){return(e=sz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sz(n){var e=az(n,"string");return typeof e=="symbol"?e:e+""}function az(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lz{constructor(e){TE(this,"columnMeta",void 0),TE(this,"metas",new Bf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,i){const o=this.getMeta(e,t);zt(o,i),Wg(o,i)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}getMeta(e,t,i){const o=this.metas.obtain(e).obtain(t);return i===void 0?o:o[i]}setMeta(e,t,i,o){var r;const s=this.metas.obtain(e).obtain(t);(r=s._automaticallyAssignedMetaProps)===null||r===void 0||r.delete(i),s[i]=o}removeMeta(e,t,i){const o=this.metas.obtain(e).obtain(t);delete o[i]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let i=0;i<t.length;i++)ce(t[i])&&e.push(...t[i].values());return e}getMetasAtRow(e){lf(()=>af(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Bf(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class mP{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new XU(e),this.tableMeta=new JU(this.globalMeta),this.columnMeta=new rz(this.globalMeta),this.cellMeta=new lz(this.columnMeta),i.forEach(o=>new o(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,i){let{visualRow:o,visualColumn:r}=i;const s=this.cellMeta.getMeta(e,t);return s.visualRow=o,s.visualCol=r,s.row=e,s.col=t,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,t,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,i)}setCellMeta(e,t,i,o){this.cellMeta.setMeta(e,t,i,o)}updateCellMeta(e,t,i){this.cellMeta.updateMeta(e,t,i)}removeCellMeta(e,t,i){this.cellMeta.removeMeta(e,t,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ht(mP,fn);function ME(n,e,t,i){const{hotInstance:o,dataMap:r,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=Xi(a),d=o.getSettings();Array.isArray(d.dataSchema)?o.dataType="array":wt(d.dataSchema)?o.dataType="function":o.dataType="object",r&&r.destroy(),n=o.runHooks(`before${h}`,n,c,l);const g=new fl(o,n,u);if(e(g),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const m=g.getSchema();n=[];let w,C=0,y=0;for(C=0,y=d.startRows;C<y;C++)if((o.dataType==="object"||o.dataType==="function")&&d.dataSchema)w=xn(m),n.push(w);else if(o.dataType==="array")w=xn(m[0]),n.push(w);else{w=[];for(let R=0,E=d.startCols;R<E;R++)w.push(null);n.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(o.dataType="array"),d.data=n,g.dataSource=n,s.data=n,s.dataType=o.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),t(g),o.runHooks(`after${h}`,n,c,l),c||(o.runHooks("afterChange",null,a),o.render()),o.getSettings().ariaTags&&ye(o.rootElement,[WM(-1),Pg(o.countCols()+(o.view?o.countRowHeaders():0))])}function IE(n,e,t){return(e=uz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uz(n){var e=cz(n,"string");return typeof e=="symbol"?e:e+""}function cz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hz{constructor(e){IE(this,"metaManager",void 0),IE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),le.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:i,col:o}=e;if((t=this.metaSyncMemo.get(i))!==null&&t!==void 0&&t.has(o))return;const{visualRow:r,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",r,s,e);const u=_t(e,"type")?e.type:null;let c=wt(e.cells)?e.cells(i,o,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,o,c),a.runHooks("afterGetCellMeta",r,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}function dz(n,e,t){fz(n,e),e.set(n,t)}function fz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fp(n,e,t){return(e=gz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gz(n){var e=mz(n,"string");return typeof e=="symbol"?e:e+""}function mz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function pz(n,e){return n.get(wz(n,e))}function wz(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var PE=new WeakMap;class vz{constructor(e){fp(this,"metaManager",void 0),fp(this,"usageTracker",new Set),fp(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),dz(this,PE,(t,i,o)=>{if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:i,target:o,onChange:r}=e,s=typeof o=="string",a=s?o:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],r?(this.installPropWatcher(t,l,r),s&&this.installPropWatcher(o,l,r)):i&&(this.installPropWatcher(t,l,pz(PE,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,i){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(r){const s=!o.usageTracker.has(e);o.usageTracker.add(e),i.call(o,e,r,s),this[t]=r},enumerable:!0,configurable:!0})}}const pP="gridDefault",rs="editorManager.handlingEditor",Cz={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},bz="hooksRefRegisterer",wP={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){M(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){Le(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};pr(wP,"MIXIN_NAME",bz,{writable:!1,enumerable:!1});function _i(n,e,t){return(e=yz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yz(n){var e=Sz(n,"string");return typeof e=="symbol"?e:e+""}function Sz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Rz="base",Lt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Ll{static get EDITOR_TYPE(){return Rz}constructor(e){_i(this,"hot",void 0),_i(this,"state",Lt.VIRGIN),_i(this,"_opened",!1),_i(this,"_fullEditMode",!1),_i(this,"_closeCallback",null),_i(this,"TD",null),_i(this,"row",null),_i(this,"col",null),_i(this,"prop",null),_i(this,"originalValue",null),_i(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,i,o,r,s){this.TD=o,this.row=e,this.col=t,this.prop=i,this.originalValue=r,this.cellProperties=s,this.state=this.isOpened()?this.state:Lt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let i,o,r,s;if(t){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),o=Math.max(Math.min(l[1],l[3]),0),r=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[i,o,r,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,o);Array.isArray(a)&&([i,o]=a),this.hot.populateFromArray(i,o,e,r,s,"edit")}beginEditing(e,t){if(this.state!==Lt.VIRGIN)return;const i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,r)),this.state=Lt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Bt(this.originalValue);this.setValue(s)}this.open(t),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,i){let o;if(i){const r=this._closeCallback;this._closeCallback=s=>{r&&r(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Lt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Lt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const r=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof r=="string"?String.prototype.trim.call(r||""):r]]:o=[[r]],this.state=Lt.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Lt.FINISHED,this.discardEditor(s)}):(this.state=Lt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Lt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Lt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Lt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Lt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Lt.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:i,wtViewport:o}=this.hot.view._wt,r=this.hot.rootWindow,s=rn(t),a=Ct(t),l=rn(this.hot.rootElement),u=Ct(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==r?c.scrollTop:0,g=h!==r?h.scrollLeft:0,m=r.innerWidth-l.left-u,{wtTable:w}=(e=i.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,y=["master","inline_start"].includes(C)?d:0,R=["master","top","bottom"].includes(C)?g:0,E=s.top===l.top?0:1;let H=s.top-l.top-E-y,P=0;this.hot.isRtl()?P=r.innerWidth-s.left-a-m-1+R:P=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(C)&&(H+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(P+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const W=this.hot.hasColHeaders(),j=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(W&&j<=0||j===z)&&(H+=1),G<=0&&(P+=1);const Q=o.rowsRenderCalculator.startPosition,q=o.columnsRenderCalculator.startPosition,ne=Math.abs(i.inlineStartOverlay.getScrollPosition()),de=i.topOverlay.getScrollPosition(),Se=sn(this.hot.rootDocument);let Xe=t.offsetTop;if(["inline_start","master"].includes(C)&&(Xe+=Q-de),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:se}=i.bottomOverlay.clone;Xe+=K.getWorkspaceHeight()-se.getHeight()-Se}let Oe=t.offsetLeft;this.hot.isRtl()?(Oe>=0?Oe=w.getWidth()-t.offsetLeft:Oe=Math.abs(Oe),Oe+=q-ne-a):["top","master","bottom"].includes(C)&&(Oe+=q-ne);const ge=dr(this.TD,this.hot.rootWindow),fe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",st=parseInt(ge[fe],10)>0?0:1,f=parseInt(ge.borderTopWidth,10)>0?0:1,p=Ct(t)+st,v=Wt(t)+f,I=ak(c)?Se:0,A=lk(h)?Se:0,F=this.hot.view.maximumVisibleElementWidth(Oe)-I+st,U=Math.max(this.hot.view.maximumVisibleElementHeight(Xe)-A+f,23);return{top:H,start:P,height:v,maxHeight:U,width:p,maxWidth:F}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}ht(Ll,wP);const Ez={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const i=n._getEditorManager(),o=i.getActiveEditor();o.isInFullEditMode()&&o.state===Lt.EDITING||(i.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},Tz={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},Mz={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Iz={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},Pz={name:"editorOpen",callback(n,e,t){const i=n._getEditorManager(),o=n.getSelectedRangeLast(),{highlight:r}=o;if(n.selection.isMultiple()&&!o.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const s=n.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;t.includes("shift")?n.selection.transformFocus(-a.row,-a.col):n.selection.transformFocus(a.row,a.col);return}r.isHeader()||(n.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ji(e))}};function Oz(){return[Cz,Ez,Tz,Mz,Iz,Pz]}const Az={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},xz={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),i=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(i!==null){const o=n._createCellCoords(i,e.col),r=e.row-n.view.getFirstFullyVisibleRow(),s=Math.min(o.row-r,n.countRows()-1);n.selection.setRangeEnd(o),n.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Hz={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},_z={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},Nz={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:i}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,i.col,e)}},Dz={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast(),s=i.isHeader()&&n.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1),l=o.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,r.col))}}},Lz={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&i.isCell()){const s=t.getNearestNotHiddenIndex(n.countCols()-1,-1),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(n._createCellCoords(r.row,s))}}},$z={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&i.isCell()){const s=parseInt(n.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(s,1),l=o.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(n._createCellCoords(r.row,a))}}},kz={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast(),s=i.isHeader()&&n.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),l=o.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(r.row,a))}}},Fz={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast(),s=i.isHeader()&&n.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),l=o.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(r.row,a))}}},Vz={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:i,from:o,to:r}=n.getSelectedRangeLast(),s=i.isHeader()&&n.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=t.getNearestNotHiddenIndex(0,1),l=o.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,r.col))}}},Bz={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:i}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,i.row,e)}},Wz={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},jz={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),i=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(i!==null){const o=n._createCellCoords(i,e.col),r=e.row-n.view.getFirstFullyVisibleRow(),s=Math.max(o.row-r,0);n.selection.setRangeEnd(o),n.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Uz(){return[Az,xz,Hz,_z,Nz,Dz,Lz,$z,kz,Fz,Vz,Bz,Wz,jz]}const zz={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},Gz={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:i}=n.getSelectedRangeLast().highlight;let o=n.countVisibleRows()+t;i===n.countRows()-1?o=1:i+o>n.countRows()&&(o=n.countRows()-i-1),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},Yz={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),i=n.getSelectedRangeLast(),o=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(-o.row,-o.col):n.selection.transformStart(-o.row,-o.col)}},Kz={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),i=n.getSelectedRangeLast(),o=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(o.row,o.col):n.selection.transformStart(o.row,o.col)}},Xz={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},qz={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},Zz={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},Qz={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:i}=n,o=parseInt(n.getSettings().fixedRowsBottom,10),r=t.getNearestNotHiddenIndex(n.countRows()-o-1,-1),s=i.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(r,s))}},Jz={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},eG={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,i=parseInt(n.getSettings().fixedColumnsStart,10),o=n.getSelectedRangeLast().highlight.row,r=t.getNearestNotHiddenIndex(i,1);e.setRangeStart(n._createCellCoords(o,r))}},tG={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,i=n.getSelectedRangeLast().highlight.row;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);o===null&&(o=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(i,o))}},nG={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:i}=n.getSelectedRangeLast().highlight;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);o===null&&(o=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(i,o))}},iG={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},oG={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:i}=n,o=parseInt(n.getSettings().fixedRowsTop,10),r=parseInt(n.getSettings().fixedColumnsStart,10),s=t.getNearestNotHiddenIndex(o,1),a=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(n._createCellCoords(s,a))}},rG={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},sG={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:i}=n.getSelectedRangeLast().highlight;let o=-(n.countVisibleRows()+t);i===-t?o=-1:i+o<t&&(o=-(i+t)),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function aG(){return[zz,Gz,Yz,Kz,Xz,qz,Zz,Qz,Jz,eG,tG,nG,iG,oG,rG,sG]}const lG={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},uG={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,i=n.view.getFirstFullyVisibleColumn()-1,o=n.view.getLastFullyVisibleRow()+1,r=n.view.getLastFullyVisibleColumn()+1,s=n._createCellCoords(t,i),a=n._createCellCoords(o,r);if(!n._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},cG={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},hG={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},dG={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:i}=e[e.length-1].highlight.normalize(),o=n.getDataAtCell(t,i),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==i)){const{readOnly:u}=n.getCellMeta(a,l);u||r.set(`${a}x${l}`,[a,l,o])}});n.setDataAtCell(Array.from(r.values()))}},fG=[...Oz(),...Uz(),...aG(),lG,uG,cG,hG,dG];function vP(n){const e={};return fG.forEach(t=>{let{name:i,callback:o}=t;e[i]=function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return o(n,...s)}}),e}function gG(n){const e=n.getShortcutManager().addContext("editor"),t=vP(n),i={group:rs};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(o,r)=>t.editorCloseAndSaveByEnter(o,r)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(o,r)=>t.editorCloseAndSaveByEnter(o,r)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(o,r)=>t.editorCloseAndSave(o,r)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(o,r)=>t.editorCloseAndSaveByArrowKeys(o,r)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],i)}function mG(n){const e=n.getShortcutManager().addContext("grid"),t=vP(n),i={runOnlyIf:()=>{const{navigableHeaders:o}=n.getSettings();return ce(n.getSelected())&&(o||!o&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:pP};e.addShortcuts([{keys:[["F2"]],callback:o=>t.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,r)=>t.editorOpen(o,r)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:rs,runOnlyIf:()=>ce(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var o;return!((o=n.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=n.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var o,r;return!((o=n.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())&&((r=n.getSelectedRangeLast())===null||r===void 0?void 0:r.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>t.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>t.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],i)}function pG(n){[mG,gG].forEach(e=>e(n))}function wG(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,i=OE(n),o=OE(n);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),o.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(i),t.lastChild.after(o),{activate(){n._registerTimeout(()=>{i.tabIndex=0,o.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{i.tabIndex=-1,o.tabIndex=-1},10)}}}function OE(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&ye(t,[xo(),Ca()]),t}function vG(n){const e=CG(n);let t;const{activate:i,deactivate:o}=wG(n,{onFocusFromTop(){var h;const d=(h=e(t))!==null&&h!==void 0?h:hv(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_above",d),n.selectCell(d.row,d.col)),n.listen()},onFocusFromBottom(){var h;const d=(h=e(t))!==null&&h!==void 0?h:dv(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_below",d),n.selectCell(d.row,d.col)),n.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;n.addHook("afterListen",()=>o()),n.addHook("afterUnlisten",()=>i()),n.addHook("afterSelection",(h,d,g,m,w)=>{if(a&&(r.wrapped&&r.flipped||l)&&(l=!1,w.value=!0),s){var C;t=(C=n.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),n.addHook("beforeRowWrap",(h,d,g)=>{r.wrapped=!0,r.flipped=g});function u(){r.wrapped=!1,r.flipped=!1,n.deselectCell(),n.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:pP,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=n.getSettings();a=!0,n.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=n.getSettings();if(a=!1,s=!0,!d||!n.selection.isSelected()||g&&r.wrapped&&r.flipped||!g&&r.wrapped)return g&&r.wrapped&&r.flipped&&(t=h.shiftKey?hv(n):dv(n)),u(),!1;h.preventDefault()},position:"after"}])}function hv(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:i}=n.getSettings();let o=i&&n.countColHeaders()>0?-n.countColHeaders():0,r=i&&n.countRowHeaders()>0?-n.countRowHeaders():0;return o===0&&(o=e.getVisualFromRenderableIndex(o)),r===0&&(r=t.getVisualFromRenderableIndex(r)),o===null||r===null?null:n._createCellCoords(o,r)}function dv(n){var e,t;const{rowIndexMapper:i,columnIndexMapper:o}=n,{navigableHeaders:r}=n.getSettings();let s=i.getRenderableIndexesLength()-1,a=o.getRenderableIndexesLength()-1;if(s<0){if(!r||n.countColHeaders()===0)return null;s=-1}if(a<0){if(!r||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(t=o.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}function CG(n){return e=>{if(!e)return null;const t=hv(n),i=dv(n);return e.col<t.col&&(e.col=t.col),e.col>i.col&&(e.col=i.col),e.row<t.row&&(e.row=t.row),e.row>i.row&&(e.row=i.row),e}}function bG(n){return e=>{let{col:t}=e;n.scrollViewportTo({col:t})}}function yG(){return()=>{}}function SG(n){return e=>{n.scrollViewportTo(e.toObject())}}function RG(n){return e=>{n.scrollViewportTo(e.toObject())}}function EG(n){return e=>{n.scrollViewportTo(e.toObject())}}function TG(n){return e=>{let{row:t}=e;n.scrollViewportTo({row:t})}}function MG(n){return e=>{const t=n.selection.getSelectionSource(),{row:i,col:o}=e;if(i<0&&o>=0)n.scrollViewportTo({col:o});else if(o<0&&i>=0)n.scrollViewportTo({row:i});else{if(t==="mouse"&&(o===n.view.getLastPartiallyVisibleColumn()||i===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:i,col:o})}}}function IG(n){const{selection:e}=n;let t=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){t=!0},scrollTo(o){var r;if(t||i){t=!1;return}let s;e.isFocusSelectionChanged()?s=SG(n):e.isSelectedByCorner()?s=yG():e.isSelectedByRowHeader()?s=TG(n):e.isSelectedByColumnHeader()?s=bG(n):e.getSelectedRange().size()===1&&e.isMultiple()?s=RG(n):e.getSelectedRange().size()===1&&!e.isMultiple()?s=MG(n):e.getSelectedRange().size()>1&&(s=EG(n)),(r=s)===null||r===void 0||r(o)}}}const AE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Zh=n=>n.map(e=>{const t=e.toLowerCase();return AE.has(t)?AE.get(t):t}).sort().join("+"),PG=n=>n.split("+"),xE=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),gp=n=>{let{which:e,key:t}=n;if(xE.has(e))return xE.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:t.toLowerCase()},CP=Symbol("shortcut-context");function bP(n){return De(n)&&n.__kindOf===CP}const OG=n=>{const e=Hg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:m=!1,relativeToGroup:w,position:C,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(vt(c))throw new Error("You need to define the shortcut's group.");if(wt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(rt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:m};ce(w)&&(R.relativeToGroup=w,R.position=C),bP(y)&&(R.forwardToContext=y),l.forEach(E=>{const H=Zh(E);if(e.hasItem(H)){const W=e.getItem(H);let j=W.findIndex(G=>G.group===w);j!==-1?C==="before"?j-=1:j+=1:j=W.length,W.splice(j,0,R)}else e.addItem(H,[R])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Le(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),t(c)})},o=l=>{const u=Zh(l);e.removeItem(u)};return{__kindOf:CP,addShortcut:t,addShortcuts:i,getShortcuts:l=>{const u=Zh(l),c=e.getItem(u);return ce(c)?c.slice():[]},hasShortcut:l=>{const u=Zh(l);return e.hasItem(u)},removeShortcutsByKeys:o,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(m=>m.group!==l);g.length===0?o(PG(h)):(d.length=0,d.push(...g))})}}};function AG(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const xG=["meta","alt","shift","control"],hu=AG(),du=[];let Qh=0;function HG(n,e,t,i,o){const r=g=>xG.includes(g),s=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return g.altKey&&w.push("alt"),m&&(g.ctrlKey||g.metaKey)?w.push("control/meta"):(g.ctrlKey&&w.push("control"),g.metaKey&&w.push("meta")),g.shiftKey&&w.push("shift"),w},a=g=>{if(e(g)===!1)return;const m=t(g);if(g.keyCode===229||m===!1||Xs(g))return;const w=gp(g);let C=[];r(w)||(C=s(g));const y=[w].concat(C);!o(g,y)&&(Zw()&&C.includes("meta")||!Zw()&&C.includes("control"))&&o(g,[w].concat(s(g,!0))),i(g)},l=g=>{if(g.key){const m=gp(g);r(m)&&hu.press(m)}},u=g=>{if(g.key){const m=gp(g);r(m)&&hu.release(m)}},c=()=>{hu.releaseAll()};return{mount:()=>{let g=n;for(Qh+=1;g;)Qh===1&&(g.document.documentElement.addEventListener("keydown",l),du.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),du.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Sl(g)},unmount:()=>{let g=n;for(Qh-=1;g;){if(Qh===0){for(let m=0;m<du.length;m++){const{event:w,listener:C}=du[m];g.document.documentElement.removeEventListener(w,C)}du.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Sl(g)}},isPressed:g=>hu.isPressed(g),releasePressedKeys:()=>hu.releaseAll()}}const _G=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:i,afterKeyDown:o}=n;const r=Hg({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const w=OG(m);return r.addItem(m,w),w},l=()=>s,u=m=>r.getItem(m),c=m=>{if(!r.hasItem(m))throw new Error(rt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=bP(C)?C:u(C);let R=!1;if(!y.hasShortcut(w))return R;const E=y.getShortcuts(w);for(let H=0;H<E.length;H++){const{callback:P,runOnlyIf:W,preventDefault:j,stopPropagation:G,captureCtrl:Y,forwardToContext:z}=E[H];if(W(m)===!0){if(h=Y,R=P(m,w)===!1,h=!1,j&&m.preventDefault(),G&&(Ji(m),m.stopPropagation()),R)break;z&&d(m,w,z)}}return R},g=HG(e,t,i,o,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let mp=null;const pp=new Map;function yP(n,e){var t,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=this;const s=new qi(r);let a,l,u,c,h,d,g=!0;wj(o)&&pj(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",w=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=cU(e.language);const C=new mP(r,e,[hz,vz]),y=C.getTableMeta(),R=C.getGlobalMeta(),E=Hg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),rf(this)&&I$(e.licenseKey,n),this.guid=`ht_${LM()}`,pp.set(this.guid,this),this.columnIndexMapper=new lv,this.rowIndexMapper=new lv,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{r.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{r.runHooks("afterRowSequenceChange",f)}),l=new Oj(r),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const H=f=>{const{row:p,col:v}=f;return r._createCellCoords(p>=0?r.rowIndexMapper.getRenderableFromVisualIndex(p):p,v>=0?r.columnIndexMapper.getRenderableFromVisualIndex(v):v)},P=f=>{const{row:p,col:v}=f;return r._createCellCoords(p>=0?r.rowIndexMapper.getVisualFromRenderableIndex(p):p,v>=0?r.columnIndexMapper.getVisualFromRenderableIndex(v):v)},W=(f,p)=>{const v=p>f?1:-1,I=Math.min(f,p),A=Math.max(f,p),F=r.rowIndexMapper.getNearestNotHiddenIndex(f,v);return F===null||v===1&&F>A||v===-1&&F<I?null:F>=0?r.rowIndexMapper.getRenderableFromVisualIndex(F):F},j=(f,p)=>{const v=p>f?1:-1,I=Math.min(f,p),A=Math.max(f,p),F=r.columnIndexMapper.getNearestNotHiddenIndex(f,v);return F===null||v===1&&F>A||v===-1&&F<I?null:F>=0?r.columnIndexMapper.getRenderableFromVisualIndex(F):F};let G=new dP(y,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>r.getActiveEditor()?r.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(f,p)=>r._createCellCoords(f,p),createCellRange:(f,p,v)=>r._createCellRange(f,p,v),visualToRenderableCoords:H,renderableToVisualCoords:P,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:j,isDisabledCellSelection:(f,p)=>f<0||p<0?r.getSettings().disableVisualSelection:r.getCellMeta(f,p).disableVisualSelection});this.selection=G;const Y=f=>{let{hiddenIndexesChanged:p}=f;p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(f,p)=>{const v=Gi(!1),I=this.selection.getSelectedRange(),{from:A,to:F}=I.current(),U=I.size()-1;this.runHooks("afterSelection",A.row,A.col,F.row,F.col,v,U),this.runHooks("afterSelectionByProp",A.row,r.colToProp(A.col),F.row,r.colToProp(F.col),v,U),p&&(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(f);const K=G.isSelectedByRowHeader(),se=G.isSelectedByColumnHeader();K&&se?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):K?(Ie(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):se?(Ie(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):Ie(this.rootElement,["ht__selection--rows","ht__selection--columns"]),G.getSelectionSource()!=="shift"&&c.closeEditor(null),r.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const p=Gi(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(f),c.closeEditor(),r.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const p=f.length-1,{from:v,to:I}=f[p];this.runHooks("afterSelectionEnd",v.row,v.col,I.row,I.col,p),this.runHooks("afterSelectionEndByProp",v.row,r.colToProp(v.col),I.row,r.colToProp(I.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const p=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),r.view.render(),Ie(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,p){var v,I;let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;const K=se=>{if(se.length===0)return[];const ue=[...se];return ue.sort((Me,Te)=>{let[B]=Me,[We]=Te;return B===We?0:B>We?1:-1}),Hn(ue,(Me,Te)=>{let[B,We]=Te;const Ve=Me[Me.length-1],[qe,_e]=Ve,be=qe+_e;if(B<=be){const b=Math.max(We-(be-B),0);Ve[1]+=b}else Me.push([B,We]);return Me},[ue[0]])};switch(f){case"insert_row_below":case"insert_row_above":const se=r.countSourceRows();if(y.maxRows===se)return;const ue=f==="insert_row_below"?"below":"above";p=(v=p)!==null&&v!==void 0?v:ue==="below"?se:0;const{delta:Z,startPhysicalIndex:Me}=a.createRow(p,A,{source:F,mode:ue});G.shiftRows(r.toVisualRow(Me),Z);break;case"insert_col_start":case"insert_col_end":const Te=f==="insert_col_end"?"end":"start";p=(I=p)!==null&&I!==void 0?I:Te==="end"?r.countSourceCols():0;const{delta:B,startPhysicalIndex:We}=a.createCol(p,A,{source:F,mode:Te});if(B){if(Array.isArray(y.colHeaders)){const _e=[r.toVisualColumn(We),0];_e.length+=B,Array.prototype.splice.apply(y.colHeaders,_e)}G.shiftColumns(r.toVisualColumn(We),B)}break;case"remove_row":const Ve=_e=>{let be=0;M(_e,b=>{let[S,T]=b;const $=kt(S)?r.countRows()-1:Math.max(S-be,0);if(Number.isInteger(S)&&(S=Math.max(S-be,0)),!a.removeRow(S,T,F))return;if(G.isSelected()){const{row:L}=r.getSelectedRangeLast().highlight;L>=S&&L<=S+T-1&&c.closeEditor(!0)}const k=r.countRows();k===0?G.deselect():F==="ContextMenu.removeRow"?G.refresh():G.shiftRows(S,-T);const N=y.fixedRowsTop;N>=$+1&&(y.fixedRowsTop-=Math.min(T,N-$));const x=y.fixedRowsBottom;x&&$>=k-x&&(y.fixedRowsBottom-=Math.min(T,x)),be+=T})};Array.isArray(p)?Ve(K(p)):Ve([[p,A]]);break;case"remove_col":const qe=_e=>{let be=0;M(_e,b=>{let[S,T]=b;const $=kt(S)?r.countCols()-1:Math.max(S-be,0);let O=r.toPhysicalColumn($);if(Number.isInteger(S)&&(S=Math.max(S-be,0)),!a.removeCol(S,T,F))return;if(G.isSelected()){const{col:L}=r.getSelectedRangeLast().highlight;L>=S&&L<=S+T-1&&c.closeEditor(!0)}r.countCols()===0?G.deselect():F==="ContextMenu.removeColumn"?G.refresh():G.shiftColumns(S,-T);const x=y.fixedColumnsStart;x>=$+1&&(y.fixedColumnsStart-=Math.min(T,x-$)),Array.isArray(y.colHeaders)&&(typeof O>"u"&&(O=-1),y.colHeaders.splice(O,T)),be+=T})};Array.isArray(p)?qe(K(p)):qe([[p,A]]);break;default:throw new Error(`There is no such action "${f}"`)}r.view.render(),U||u.adjustRowsAndCols()},adjustRowsAndCols(){const f=y.minRows,p=y.minSpareRows,v=y.minCols,I=y.minSpareCols;if(f){const A=r.countRows();A<f&&a.createRow(A,f-A,{source:"auto"})}if(p){const A=r.countEmptyRows(!0);if(A<p){const F=p-A,U=Math.min(F,y.maxRows-r.countSourceRows());a.createRow(r.countRows(),U,{source:"auto"})}}{let A;(v||I)&&(A=r.countEmptyCols(!0));let F=r.countCols();if(v&&!y.columns&&F<v){const U=v-F;A+=U,a.createCol(F,U,{source:"auto"})}if(I&&!y.columns&&r.dataType==="array"&&A<I){F=r.countCols();const U=I-A,K=Math.min(U,y.maxCols-F);a.createCol(F,K,{source:"auto"})}}r.view&&r.view.adjustElementsSize()},populateFromArray(f,p,v,I,A){let F,U,K,se;const ue=[],Z={},Me=[],Te=f.row,B=f.col;if(U=p.length,U===0)return!1;let We=0,Ve=0;switch(De(v)&&(We=v.col-B+1,Ve=v.row-Te+1),A){case"shift_down":const qe=tf(p),_e=qe.length,be=Math.max(_e,We),b=r.getData().slice(Te),S=tf(b).slice(B,B+be);for(K=0;K<be;K+=1)if(K<_e){for(F=0,U=qe[K].length;F<Ve-U;F+=1)qe[K].push(qe[K][F%U]);K<S.length?Me.push(qe[K].concat(S[K])):Me.push(qe[K].concat(new Array(b.length).fill(null)))}else Me.push(qe[K%_e].concat(S[K]));r.populateFromArray(Te,B,tf(Me));break;case"shift_right":const T=p.length,$=Math.max(T,Ve),O=r.getData().slice(Te).map(ae=>ae.slice(B));for(F=0;F<$;F+=1)if(F<T){for(K=0,se=p[F].length;K<We-se;K+=1)p[F].push(p[F][K%se]);if(F<O.length)for(let ae=0;ae<O[F].length;ae+=1)p[F].push(O[F][ae]);else p[F].push(...new Array(O[0].length).fill(null))}else p.push(p[F%U].slice(0,$).concat(O[F]));r.populateFromArray(Te,B,p);break;case"overwrite":default:Z.row=f.row,Z.col=f.col;let k=0,N=0,x=!0,L;const D=function(ve){let He=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ge=p[ve%p.length];return He!==null?Ge[He%Ge.length]:Ge},V=p.length,ee=v?v.row-f.row+1:0;for(v?U=ee:U=Math.max(V,ee),F=0;F<U&&!(v&&Z.row>v.row&&ee>V||!y.allowInsertRow&&Z.row>r.countRows()-1||Z.row>=y.maxRows);F++){const ae=F-k,ve=D(ae).length,He=v?v.col-f.col+1:0;if(v?se=He:se=Math.max(ve,He),Z.col=f.col,L=r.getCellMeta(Z.row,Z.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&L.skipRowOnPaste){k+=1,Z.row+=1,U+=1;continue}for(N=0,K=0;K<se&&!(v&&Z.col>v.col&&He>ve||!y.allowInsertColumn&&Z.col>r.countCols()-1||Z.col>=y.maxCols);K++){if(L=r.getCellMeta(Z.row,Z.col),(I==="CopyPaste.paste"||I==="Autofill.fill")&&L.skipColumnOnPaste){N+=1,Z.col+=1,se+=1;continue}if(L.readOnly&&I!=="UndoRedo.undo"){Z.col+=1;continue}const Ge=K-N;let $e=D(ae,Ge),Ee=r.getDataAtCell(Z.row,Z.col);if($e!==null&&typeof $e=="object")if(Array.isArray($e)&&Ee===null&&(Ee=[]),Ee===null||typeof Ee!="object")x=!1;else{const Ye=bc(Array.isArray(Ee)?Ee:Ee[0]||Ee),Tt=bc(Array.isArray($e)?$e:$e[0]||$e);dC(Ye,Tt)||Array.isArray(Ye)&&Array.isArray(Tt)?$e=xn($e):x=!1}else Ee!==null&&typeof Ee=="object"&&(x=!1);x&&ue.push([Z.row,Z.col,$e]),x=!0,Z.col+=1}Z.row+=1}r.setDataAtCell(ue,null,null,I||"populateFromArray");break}}};function z(f){const p=eP(f);sy(p)?(r.runHooks("beforeLanguageChange",p),R.language=p,r.runHooks("afterLanguageChange",p)):tP(f)}function Q(f,p){const v=f==="className"?r.rootElement:r.table;if(g)X(v,p);else{let I=[],A=[];R[f]&&(I=Array.isArray(R[f])?R[f]:uR(R[f])),p&&(A=Array.isArray(p)?p:uR(p));const F=lR(I,A),U=lR(A,I);F.length&&Ie(v,F),U.length&&X(v,U)}R[f]=p}this.init=function(){l.setData(y.data),r.runHooks("beforeInit"),(jr()||hI())&&X(r.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new yj(this),c=ov.getInstance(r,y,G),d=IG(r),h=new MF(r),rf(this)&&vG(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&r.rootElement.offsetParent===null&&uk(r.rootElement,()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()}),typeof g=="object"&&(r.runHooks("afterChange",g[0],g[1]),g=!1),r.runHooks("afterInit")};function q(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function ne(f){const p=f.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):f}function de(f,p,v){if(!f.length){v();return}const I=r.getActiveEditor(),A=new q;let F=!0;A.onQueueEmpty=()=>{I&&F&&I.cancelChanges(),v()};for(let U=f.length-1;U>=0;U--){const[K,se,,ue]=f[U],Z=a.propToCol(se);let Me;Number.isInteger(Z)?Me=r.getCellMeta(K,Z):Me={...Object.getPrototypeOf(y),...y},Me.type==="numeric"&&typeof ue=="string"&&lV(ue)&&(f[U][3]=ne(ue)),r.getCellValidator(Me)&&(A.addValidatorToQueue(),r.validateCell(f[U][3],Me,function(Te,B){return function(We){if(typeof We!="boolean")throw new Error("Validation error: result is not boolean");We===!1&&B.allowInvalid===!1&&(F=!1,f.splice(Te,1),B.valid=!0),A.removeValidatorFormQueue()}}(U,Me),p))}A.checkIfQueueIsEmpty()}function Se(f,p){for(let I=f.length-1;I>=0;I--){let A=!1;if(f[I]===null){f.splice(I,1);continue}if(!((f[I][2]===null||f[I][2]===void 0)&&(f[I][3]===null||f[I][3]===void 0))){if(y.allowInsertRow)for(;f[I][0]>r.countRows()-1;){const{delta:F}=a.createRow(void 0,void 0,{source:p});if(F===0){A=!0;break}}if(r.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(f[I][1])>r.countCols()-1;){const{delta:F}=a.createCol(void 0,void 0,{source:p});if(F===0){A=!0;break}}A||a.set(f[I][0],f[I][1],f[I][3])}}const v=f.length>0;if(r.forceFullRender=!0,v){u.adjustRowsAndCols(),r.runHooks("beforeChangeRender",f,p),c.closeEditor(),r.view.render(),c.prepareEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",f,p||"edit");const I=r.getActiveEditor();I&&ce(I.refreshValue)&&I.refreshValue()}else r.view.render()}this._createCellCoords=function(f,p){return r.view._wt.createCellCoords(f,p)},this._createCellRange=function(f,p,v){return r.view._wt.createCellRange(f,p,v)},this.validateCell=function(f,p,v,I){let A=r.getCellValidator(p);function F(U){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){v(U);return}const se=p.visualCol,ue=p.visualRow,Z=r.getCell(ue,se,!0);if(Z&&Z.nodeName!=="TH"){const Me=r.rowIndexMapper.getRenderableFromVisualIndex(ue),Te=r.columnIndexMapper.getRenderableFromVisualIndex(se);r.view._wt.getSetting("cellRenderer",Me,Te,Z)}v(U)}E$(A)&&(A=function(U){return function(K,se){se(U.test(K))}}(A)),wt(A)?(f=r.runHooks("beforeValidate",f,p.visualRow,p.prop,I),r._registerImmediate(()=>{A.call(p,f,U=>{r&&(U=r.runHooks("afterValidate",U,f,p.visualRow,p.prop,I),p.valid=U,F(U),r.runHooks("postAfterValidate",U,f,p.visualRow,p.prop,I))})})):r._registerImmediate(()=>{p.valid=!0,F(p.valid,!1)})};function Xe(f,p,v){return Array.isArray(f)?f:[[f,p,v]]}function Oe(f,p){const v=r.getActiveEditor(),I=r.runHooks("beforeChange",f,p||"edit"),A=f.filter(F=>F!==null);return I===!1||A.length===0?(v&&v.cancelChanges(),[]):A}this.setDataAtCell=function(f,p,v,I){const A=Xe(f,p,v),F=[];let U=I,K,se,ue;for(K=0,se=A.length;K<se;K++){if(typeof A[K]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof A[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");A[K][1]>=this.countCols()?ue=A[K][1]:ue=a.colToProp(A[K][1]),F.push([A[K][0],ue,l.getAtCell(this.toPhysicalRow(A[K][0]),A[K][1]),A[K][2]])}!U&&typeof f=="object"&&(U=p);const Z=Oe(F,I);r.runHooks("afterSetDataAtCell",Z,U),de(Z,U,()=>{Se(Z,U)})},this.setDataAtRowProp=function(f,p,v,I){const A=Xe(f,p,v),F=[];let U=I,K,se;for(K=0,se=A.length;K<se;K++)F.push([A[K][0],A[K][1],l.getAtCell(this.toPhysicalRow(A[K][0]),A[K][1]),A[K][2]]);!U&&typeof f=="object"&&(U=p);const ue=Oe(F,I);r.runHooks("afterSetDataAtRowProp",ue,U),de(ue,U,()=>{Se(ue,U)})},this.listen=function(){r&&!r.isListening()&&(pp.forEach(f=>{r!==f&&f.unlisten()}),mp=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(mp=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return mp===r.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),r.view.render(),p&&G.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,p,v,I,A,F,U){if(!(typeof v=="object"&&typeof v[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const K=typeof I=="number"?r._createCellCoords(I,A):null;return u.populateFromArray(r._createCellCoords(f,p),v,K,F,U)},this.spliceCol=function(f,p,v){for(var I=arguments.length,A=new Array(I>3?I-3:0),F=3;F<I;F++)A[F-3]=arguments[F];return a.spliceCol(f,p,v,...A)},this.spliceRow=function(f,p,v){for(var I=arguments.length,A=new Array(I>3?I-3:0),F=3;F<I;F++)A[F-3]=arguments[F];return a.spliceRow(f,p,v,...A)},this.getSelected=function(){if(G.isSelected())return Ue(G.getSelectedRange(),f=>{let{from:p,to:v}=f;return[p.row,p.col,v.row,v.col]})},this.getSelectedLast=function(){const f=this.getSelected();let p;return f&&f.length>0&&(p=f[f.length-1]),p},this.getSelectedRange=function(){if(G.isSelected())return Array.from(G.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let p;return f&&f.length>0&&(p=f[f.length-1]),p},this.emptySelectedCells=function(f){if(!G.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];M(G.getSelectedRange(),v=>{if(v.isSingleHeader())return;const I=v.getTopStartCorner(),A=v.getBottomEndCorner();me(I.row,A.row,F=>{me(I.col,A.col,U=>{this.getCellMeta(F,U).readOnly||p.push([F,U,null])})})}),p.length>0&&this.setDataAtCell(p,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():r.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||r.view.render())},this.batchRender=function(f){this.suspendRender();const p=f();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const v=f();return this.resumeExecution(p),v},this.batch=function(f){this.suspendRender(),this.suspendExecution();const p=f();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!r.view)return;const{width:f,height:p}=r.view.getLastSize(),{width:v,height:I}=r.rootElement.getBoundingClientRect(),A=v!==f||I!==p;r.runHooks("beforeRefreshDimensions",{width:f,height:p},{width:v,height:I},A)!==!1&&((A||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(v,I),r.render()),r.runHooks("afterRefreshDimensions",{width:f,height:p},{width:v,height:I},A))},this.updateData=function(f,p){ME(f,v=>{a=v},v=>{a=v,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),G.refresh()},{hotInstance:r,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:C,firstRun:g})},this.loadData=function(f,p){ME(f,v=>{a=v},()=>{C.clearCellsCache(),r.initIndexMappers(),u.adjustRowsAndCols(),G.refresh(),g&&(g=[null,"loadData"])},{hotInstance:r,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:C,firstRun:g})},this.getInitialColumnCount=function(){const f=y.columns;let p=0;if(Array.isArray(f))p=f.length;else if(wt(f))if(r.dataType==="array"){const v=this.countSourceCols();for(let I=0;I<v;I+=1)f(I)&&(p+=1)}else(r.dataType==="object"||r.dataType==="function")&&(p=a.colToPropCache.length);else if(ce(y.dataSchema)){const v=a.getSchema();p=Array.isArray(v)?v.length:fC(v)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,p,v,I){return vt(f)?a.getAll():a.getRange(r._createCellCoords(f,p),r._createCellCoords(v,I),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,p,v,I){return a.getCopyableText(r._createCellCoords(f,p),r._createCellCoords(v,I))},this.getCopyableData=function(f,p){return a.getCopyable(f,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=(g?r.loadData:r.updateData).bind(this);let I=!1,A,F;if(ce(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ce(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ce(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(A in f)A==="data"||(A==="language"?z(f.language):A==="className"?Q("className",f.className):A==="tableClassName"&&r.table?(Q("tableClassName",f.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):le.getSingleton().isRegistered(A)||le.getSingleton().isDeprecated(A)?(wt(f[A])||Array.isArray(f[A]))&&(f[A].initialHook=!0,r.addHook(A,f[A])):!p&&_t(f,A)&&(R[A]=f[A]));f.data===void 0&&y.data===void 0?v(null,"updateSettings"):f.data!==void 0?v(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),r.initIndexMappers());const U=r.countCols(),K=y.columns;if(K&&wt(K)&&(I=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&C.clearCache(),U>0)for(A=0,F=0;A<U;A++){if(K){const Z=I?K(A):K[F];Z&&C.updateColumnMeta(F,Z)}F+=1}ce(f.cell)&&Le(f.cell,Z=>{r.setCellMetaObject(Z.row,Z.col,Z)}),r.runHooks("afterCellMetaReset");let se=r.rootElement.style.height;se!==""&&(se=parseInt(r.rootElement.style.height,10));let ue=f.height;if(wt(ue)&&(ue=ue()),p&&r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style")),ue===null){const Z=r.rootElement.getAttribute("data-initialstyle");Z&&(Z.indexOf("height")>-1||Z.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",Z):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else ue!==void 0&&(r.rootElement.style.height=isNaN(ue)?`${ue}`:`${ue}px`,r.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let Z=f.width;wt(Z)&&(Z=Z()),r.rootElement.style.width=isNaN(Z)?`${Z}`:`${Z}px`}p||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",f)),u.adjustRowsAndCols(),r.view&&!g&&(r.forceFullRender=!0,r.view.render(),r.view._wt.wtOverlays.adjustElementsSize()),!p&&r.view&&(se===""||ue===""||ue===void 0)&&se!==ue&&r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=r.getSelectedLast();if(y.getValue){if(wt(y.getValue))return y.getValue.call(r);if(f)return r.getData()[f[0][0]][y.getValue]}else if(f)return r.getDataAtCell(f[0],f[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,p,v,I,A){u.alter(f,p,v,I,A)},this.getCell=function(f,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,I=p,A=f;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;I=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;A=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return A===null||I===null||A===void 0||I===void 0?null:r.view.getCellAtCoords(r._createCellCoords(A,I),v)},this.getCoords=function(f){const p=this.view._wt.wtTable.getCoords(f);if(p===null)return null;const{row:v,col:I}=p;let A=v,F=I;return v>=0&&(A=this.rowIndexMapper.getVisualFromRenderableIndex(v)),I>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(I)),r._createCellCoords(A,F)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,p){return a.get(f,a.colToProp(p))},this.getDataAtRowProp=function(f,p){return a.get(f,p)},this.getDataAtCol=function(f){const p=[],v=a.getRange(r._createCellCoords(0,f),r._createCellCoords(y.data.length-1,f),a.DESTINATION_RENDERER);for(let I=0;I<v.length;I+=1)for(let A=0;A<v[I].length;A+=1)p.push(v[I][A]);return p},this.getDataAtProp=function(f){const p=[],v=a.getRange(r._createCellCoords(0,a.propToCol(f)),r._createCellCoords(y.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let I=0;I<v.length;I+=1)for(let A=0;A<v[I].length;A+=1)p.push(v[I][A]);return p},this.getSourceData=function(f,p,v,I){let A;return f===void 0?A=l.getData():A=l.getByRange(r._createCellCoords(f,p),r._createCellCoords(v,I)),A},this.getSourceDataArray=function(f,p,v,I){let A;return f===void 0?A=l.getData(!0):A=l.getByRange(r._createCellCoords(f,p),r._createCellCoords(v,I),!0),A},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,p,v,I){const A=Xe(f,p,v),F=this.hasHook("afterSetSourceDataAtCell"),U=[];F&&M(A,se=>{let[ue,Z,Me]=se;U.push([ue,Z,l.getAtCell(ue,Z),Me])}),M(A,se=>{let[ue,Z,Me]=se;l.setAtCell(ue,Z,Me)}),F&&this.runHooks("afterSetSourceDataAtCell",U,I),this.render();const K=r.getActiveEditor();K&&ce(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,p){return l.getAtCell(f,p)},this.getDataAtRow=function(f){return a.getRange(r._createCellCoords(f,0),r._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,p,v,I){const A=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,p,v,I],[F,U]=A;let[,,K,se]=A,ue=null,Z=null;K===void 0&&(K=F),se===void 0&&(se=U);let Me="mixed";return me(Math.max(Math.min(F,K),0),Math.max(F,K),Te=>{let B=!0;return me(Math.max(Math.min(U,se),0),Math.max(U,se),We=>(Z=this.getCellMeta(Te,We).type,ue?B=ue===Z:ue=Z,B)),Me=B?Z:"mixed",B}),Me},this.removeCellMeta=function(f,p,v){const[I,A]=[this.toPhysicalRow(f),this.toPhysicalColumn(p)];let F=C.getCellMetaKeyValue(I,A,v);r.runHooks("beforeRemoveCellMeta",f,p,v,F)!==!1&&(C.removeCellMeta(I,A,v),r.runHooks("afterRemoveCellMeta",f,p,v,F)),F=null},this.spliceCellsMeta=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var v=arguments.length,I=new Array(v>2?v-2:0),A=2;A<v;A++)I[A-2]=arguments[A];if(I.length>0&&!Array.isArray(I[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&C.removeRow(this.toPhysicalRow(f),p),I.length>0&&M(I.reverse(),F=>{C.createRow(this.toPhysicalRow(f)),M(F,(U,K)=>this.setCellMetaObject(f,K,U))}),r.render()},this.setCellMetaObject=function(f,p,v){typeof v=="object"&&Le(v,(I,A)=>{this.setCellMeta(f,p,A,I)})},this.setCellMeta=function(f,p,v,I){if(r.runHooks("beforeSetCellMeta",f,p,v,I)===!1)return;let F=f,U=p;f<this.countRows()&&(F=this.toPhysicalRow(f)),p<this.countCols()&&(U=this.toPhysicalColumn(p)),C.setCellMeta(F,U,v,I),r.runHooks("afterSetCellMeta",f,p,v,I)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(f,p){let v=this.toPhysicalRow(f),I=this.toPhysicalColumn(p);return v===null&&(v=f),I===null&&(I=p),C.getCellMeta(v,I,{visualRow:f,visualColumn:p})},this.getColumnMeta=function(f){return C.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return C.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(r.dataType==="object"||y.columns)},this.getCellRenderer=function(f,p){const v=typeof f=="number"?r.getCellMeta(f,p).renderer:f.renderer;return typeof v=="string"?av(v):vt(v)?av("text"):v},this.getCellEditor=function(f,p){const v=typeof f=="number"?r.getCellMeta(f,p).editor:f.editor;return typeof v=="string"?iv(v):vt(v)?iv("text"):v},this.getCellValidator=function(f,p){const v=typeof f=="number"?r.getCellMeta(f,p).validator:f.validator;return typeof v=="string"?TV(v):v},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,p){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,f)},this.validateColumns=function(f,p){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,f)},this._validateCells=function(f,p,v){const I=new q;f&&(I.onQueueEmpty=f);let A=r.countRows()-1;for(;A>=0;){if(p!==void 0&&p.indexOf(A)===-1){A-=1;continue}let F=r.countCols()-1;for(;F>=0;){if(v!==void 0&&v.indexOf(F)===-1){F-=1;continue}I.addValidatorToQueue(),r.validateCell(r.getDataAtCell(A,F),r.getCellMeta(A,F),U=>{if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&(I.valid=!1),I.removeValidatorFormQueue()},"validateCells"),F-=1}A-=1}I.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let p=y.rowHeaders,v=f;return v!==void 0&&(v=r.runHooks("modifyRowHeader",v)),v===void 0?(p=[],me(r.countRows()-1,I=>{p.push(r.getRowHeader(I))})):Array.isArray(p)&&p[v]!==void 0?p=p[v]:wt(p)?p=p(v):p&&typeof p!="string"&&typeof p!="number"&&(p=v+1),p},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,p=r.countCols();f<p;f++)if(r.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const v=r.runHooks("modifyColHeader",f);if(v===void 0){const K=[],se=r.countCols();for(let ue=0;ue<se;ue++)K.push(r.getColHeader(ue));return K}let I=y.colHeaders;const A=function(K){const se=[],ue=r.countCols();let Z=0;for(;Z<ue;Z++)wt(y.columns)&&y.columns(Z)&&se.push(Z);return se[K]},F=r.toPhysicalColumn(v),U=A(F);return y.colHeaders===!1?I=null:y.columns&&wt(y.columns)&&y.columns(U)&&y.columns(U).title?I=y.columns(U).title:y.columns&&y.columns[F]&&y.columns[F].title?I=y.columns[F].title:Array.isArray(y.colHeaders)&&y.colHeaders[F]!==void 0?I=y.colHeaders[F]:wt(y.colHeaders)?I=y.colHeaders(F):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(I=Ej(v)),I=r.runHooks("modifyColumnHeaderValue",I,f,p),I},this._getColWidthFromSettings=function(f){let p;if(f>=0&&(p=r.getCellMeta(0,f).width),(p===void 0||p===y.width)&&(p=y.colWidths),p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(f){let p=r._getColWidthFromSettings(f);return p=r.runHooks("modifyColWidth",p,f),p===void 0&&(p=_g),p},this._getRowHeightFromSettings=function(f){let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(f){let p=r._getRowHeightFromSettings(f);return p=r.runHooks("modifyRowHeight",p,f),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=y.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,p)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return BR(r.countRows()-1,v=>{if(r.isEmptyRow(v))p+=1;else if(f===!0)return!1}),p},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return BR(r.countCols()-1,v=>{if(r.isEmptyCol(v))p+=1;else if(f===!0)return!1}),p},this.isEmptyRow=function(f){return y.isEmptyRow.call(r,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(r,f)},this.selectCell=function(f,p,v,I){let A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return vt(f)||vt(p)?!1:this.selectCells([[f,p,v,I]],A,F)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const I=G.selectCells(f);return I&&v&&r.listen(),d.resume(),I},this.selectColumns=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;return G.selectColumns(f,p,v)},this.selectRows=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;return G.selectRows(f,p,v)},this.deselectCell=function(){G.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),G.selectAll(f,p,v)};const ge=(f,p)=>f.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(f){var p;if(typeof f=="number"){var v;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(v=arguments[4])!==null&&v!==void 0?v:!0}}const{row:I,col:A,verticalSnap:F,horizontalSnap:U,considerHiddenIndexes:K}=(p=f)!==null&&p!==void 0?p:{};let se,ue,Z,Me;F!==void 0&&(se=F==="top",ue=!se),U!==void 0&&(Z=U==="start",Me=!Z);let Te=I,B=A;if(K===void 0||K){const qe=Number.isInteger(I)&&I>=0,_e=Number.isInteger(A)&&A>=0,be=qe?ge(this.rowIndexMapper,I):void 0,b=_e?ge(this.columnIndexMapper,A):void 0;if(be===null||b===null)return!1;Te=qe?r.rowIndexMapper.getRenderableFromVisualIndex(be):I,B=_e?r.columnIndexMapper.getRenderableFromVisualIndex(b):A}const We=Number.isInteger(Te),Ve=Number.isInteger(B);return We&&Te>=0&&Ve&&B>=0?r.view.scrollViewport(r._createCellCoords(Te,B),se,Me,ue,Z):We&&Te>=0&&(Ve&&B<0||!Ve)?r.view.scrollViewportVertically(Te,se,ue):Ve&&B>=0&&(We&&Te<0||!We)?r.view.scrollViewportHorizontally(B,Me,Z):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);const{highlight:p}=this.getSelectedRangeLast();this.scrollViewportTo(p.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),C.clearCache(),pp.delete(this.guid),rf(r)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}No(r.rootElement),s.destroy(),c&&c.destroy(),r.batchExecution(()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),E.getItems().forEach(f=>{let[,p]=f;p.destroy()}),E.clear(),r.runHooks("afterDestroy")},!0),le.getSingleton().destroy(r),Le(r,(f,p,v)=>{wt(f)?v[p]=fe(p):p!=="guid"&&(v[p]=null)}),r.isDestroyed=!0,a&&a.destroy(),a=null,u=null,G=null,c=null,r=null};function fe(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return r.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return r.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return r.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return r.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return r.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return r.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return r.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return r.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return r.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return r.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return r.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return r.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){const p=Xi(f);return p==="UndoRedo"?this.undoRedo:E.getItem(p)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:E.getId(f)},this.getInstance=function(){return r},this.addHook=function(f,p,v){le.getSingleton().add(f,p,r,v)},this.hasHook=function(f){return le.getSingleton().has(f,r)||le.getSingleton().has(f)},this.addHookOnce=function(f,p,v){le.getSingleton().once(f,p,r,v)},this.removeHook=function(f,p){le.getSingleton().remove(f,p,r)},this.runHooks=function(f,p,v,I,A,F,U){return le.getSingleton().run(r,f,p,v,I,A,F,U)},this.getTranslatedPhrase=function(f,p){return aP(y.language,f,p)},this.toHTML=()=>FR(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",FR(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=f;typeof v=="function"&&(v=setTimeout(v,p)),this.timeouts.push(v)},this._clearTimeouts=function(){M(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){M(this.immediates,f=>{clearImmediate(f)})},this._getEditorManager=function(){return c},this.isRtl=function(){return r.rootWindow.getComputedStyle(r.rootElement).direction==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const st=_G({handleEvent(){return r.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&st.releasePressedKeys()}),this.getShortcutManager=function(){return st},this.getFocusManager=function(){return h},EI().forEach(f=>{const p=SC(f);E.addItem(f,new p(this))}),pG(r),st.setActiveContextName("grid"),le.getSingleton().run(r,"construct")}function HE(n,e,t){n.addEventListener(e,t,!1)}function _E(n,e,t){n.removeEventListener(e,t,!1)}function NE(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function NG(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,i=n.createTextNode(""),o=n.createElement("span");let r;function s(){i.textContent=r.value,o.style.position="absolute",o.style.fontSize=NE(r).fontSize,o.style.fontFamily=NE(r).fontFamily,o.style.whiteSpace="pre",t.appendChild(o);const c=o.clientWidth+2;t.removeChild(o);const h=r.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){n.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=r.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=r.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=r.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=r.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;r=c,l(h),r.nodeName==="TEXTAREA"&&(r.style.resize="none",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),d&&(HE(r,"input",s),HE(r,"keydown",a)),s()}return{init:u,resize:s,unObserve(){_E(r,"input",s),_E(r,"keydown",a)}}}function DE(n,e){const t=ZM(e),i=e.value.split(`
`);let o=t,r=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(r+=i[s-1].length+1);const l=r+a.length;if(n==="home"?o=r:n==="end"&&(o=l),t<=l)break}Og(e,o)}function bs(n,e,t){return(e=DG(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DG(n){var e=LG(n,"string");return typeof e=="symbol"?e:e+""}function LG(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const $G="ht_editor_visible",Jh="ht_editor_hidden",LE="textEditor",kG="text";class ya extends Ll{static get EDITOR_TYPE(){return kG}constructor(e){super(e),bs(this,"eventManager",new qi(this)),bs(this,"autoResize",NG(this.hot.rootDocument)),bs(this,"TEXTAREA",void 0),bs(this,"textareaStyle",void 0),bs(this,"TEXTAREA_PARENT",void 0),bs(this,"textareaParentStyle",void 0),bs(this,"layerClass",void 0),this.eventManager=new qi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),J$(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,i,o,r,s){const a=this.state;if(super.prepare(e,t,i,o,r,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Lt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===Lt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Og(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ye(this.TEXTAREA,[["data-hot-input",""],Hl(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),Re(this.TEXTAREA_PARENT,this.layerClass)&&Ie(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Jh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Nk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ie(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Jh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;me(e.length-1,i=>{const o=e[i];if(Re(o,"handsontableEditor"))return t=!0,!1}),Re(this.TEXTAREA_PARENT,Jh)&&Ie(this.TEXTAREA_PARENT,Jh),t?(this.layerClass=$G,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Lt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:i,width:o,maxWidth:r,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=dr(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=dr(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=o-c,g=s-h,m=r-c,w=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(g,w),maxWidth:m,maxHeight:w},!0)}bindEvents(){cI()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Lt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Lt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>ce(this.hot.getSelected()),group:LE},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:r=>!this.hot.selection.isMultiple()&&!r.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(r,s)=>{let[a]=s;DE(a,this.TEXTAREA)}},{keys:[["End"]],callback:(r,s)=>{let[a]=s;DE(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LE)}}const FG="base";function Qc(n,e,t,i,o,r,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(mR())):a&&c.push(mR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(pR())):(u.push(s.invalidCellClassName),a&&c.push(pR()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!r&&s.placeholder&&l.push(s.placeholderCellClassName),Ie(e,u),X(e,l),_l(e,c),ye(e,h)}Qc.RENDERER_TYPE=FG;const VG="text";function vr(n,e,t,i,o,r,s){Qc.apply(this,[n,e,t,i,o,r,s]);let a=r;if(!a&&s.placeholder&&(a=s.placeholder),a=Bt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){No(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else ra(e,a)}vr.RENDERER_TYPE=VG;const BG="text",SP={CELL_TYPE:BG,editor:ya,renderer:vr};ki(SP);je.editors={BaseEditor:Ll};function je(n,e){const t=new yP(n,e||{},FC);return t.init(),t}je.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yP(n,e,FC)};je.DefaultSettings=gP();je.hooks=le.getSingleton();je.CellCoords=aa;je.CellRange=Kc;je.packageName="handsontable";je.buildDate="17/10/2024 09:16:16";je.version="14.6.1";je.languages={dictionaryKeys:iU,getLanguageDictionary:sP,getLanguagesDictionaries:lU,registerLanguageDictionary:rP,getTranslatedPhrase:aP};function fv(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function WG(n){if(Array.isArray(n))return fv(n)}function jG(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Ec(n,e,t){return e=Wf(e),qG(n,RP()?Reflect.construct(e,t||[],Wf(n).constructor):e.apply(n,t))}function Ml(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function $E(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,EP(i.key),i)}}function Il(n,e,t){return e&&$E(n.prototype,e),t&&$E(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function UG(n,e,t){return(e=EP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wf(n){return Wf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wf(n)}function Tc(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&gv(n,e)}function RP(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RP=function(){return!!n})()}function zG(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function GG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kE(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function YG(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?kE(Object(t),!0).forEach(function(i){UG(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):kE(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function KG(n,e){if(n==null)return{};var t,i,o=XG(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(i=0;i<r.length;i++)t=r[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function XG(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function qG(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jG(n)}function gv(n,e){return gv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},gv(n,e)}function ZG(n){return WG(n)||zG(n)||JG(n)||GG()}function QG(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function EP(n){var e=QG(n,"string");return typeof e=="symbol"?e:e+""}function JG(n,e){if(n){if(typeof n=="string")return fv(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?fv(n,e):void 0}}var wp=null,eY="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",tY="The Handsontable instance bound to this component was destroyed and cannot be used properly.",jf="global",nY="hot-wrapper-editor-container";function iY(){if(typeof console<"u"){var n;(n=console).warn.apply(n,arguments)}}function mv(n,e){var t=At.Children.toArray(n),i=At.Children.count(n),o=null;return i!==0&&(i===1&&t[0].props[e]?o=t[0]:o=t.find(function(r){return r.props[e]!==void 0})),o||null}function TP(n){return n?n.type.WrappedComponent?n.type.WrappedComponent:n.type:null}function MP(n,e){if(typeof n>"u"||e===null)return null;var t=PP(e.props,!1);return t.className="".concat(nY," ").concat(t.className),DT.createPortal(At.createElement("div",Object.assign({},t),e),n.body)}function IP(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jf,i=mv(n,"hot-editor"),o=TP(i);return i?At.cloneElement(i,{emitEditorInstance:function(s,a){e.get(o)||e.set(o,new Map);var l=e.get(o);l.set(a??jf,s)},editorColumnScope:t,isEditor:!0}):null}function oY(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;t||(t=document),wp||(wp=t.createDocumentFragment());var r=o??t.createElement("DIV");wp.appendChild(r);var s=At.cloneElement(n,YG({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:DT.createPortal(s,r,i),portalContainer:r}}function PP(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:n.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:n.className||"",style:n.style||{}}}function rY(){return typeof window<"u"}var OP=function(){function n(){Ml(this,n)}return Il(n,null,[{key:"getSettings",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.prevProps,r=o===void 0?{}:o,s=i.isInit,a=s===void 0?!1:s,l=i.initOnlySettingKeys,u=l===void 0?[]:l,c=function(C){return!a&&u.includes(C)?r[C]===t[C]:!1},h={};if(t.settings){var d=t.settings;for(var g in d)d.hasOwnProperty(g)&&!c(g)&&(h[g]=d[g])}for(var m in t)m!=="settings"&&m!=="children"&&!c(m)&&t.hasOwnProperty(m)&&(h[m]=t[m]);return h}}])}(),sY=function(n){function e(){return Ml(this,e),Ec(this,e,arguments)}return Tc(e,n),Il(e,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,r){return o[r]=i.props[r],o},{})}},{key:"getLocalEditorElement",value:function(){return IP(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=OP.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=MP(i,this.getLocalEditorElement());return At.createElement(At.Fragment,null,o)}}])}(At.Component),aY=function(n){function e(){var t;return Ml(this,e),t=Ec(this,e,arguments),t.state={portals:[]},t}return Tc(e,n),Il(e,[{key:"render",value:function(){return At.createElement(At.Fragment,null,this.state.portals)}}])}(At.Component),lY="14.6.1";function uY(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var AP={exports:{}},vp,FE;function cY(){if(FE)return vp;FE=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return vp=n,vp}var Cp,VE;function hY(){if(VE)return Cp;VE=1;var n=cY();function e(){}function t(){}return t.resetWarningCache=e,Cp=function(){function o(a,l,u,c,h,d){if(d!==n){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}o.isRequired=o;function r(){return o}var s={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:r,element:o,elementType:o,instanceOf:r,node:o,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},Cp}AP.exports=hY()();var dY=AP.exports,bp=uY(dY),ly=function(n){function e(){var t;return Ml(this,e),t=Ec(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCache=new Map,t.portalContainerCache=new Map,t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return Tc(e,n),Il(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(tY),null)},set:function(i){this.__hotInstance=i}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return rY()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(s,a,l,u,c,h,d){var g=o.getRenderedCellCache(),m=o.getPortalContainerCache(),w="".concat(l,"-").concat(u),C=s.guid,y="".concat(C,"-").concat(w),R="".concat(w,"-").concat(C);if(g.has(w)&&(a.innerHTML=g.get(w).innerHTML),a&&!a.getAttribute("ghost-table")){for(var E=o.portalCache.get(R),H=m.get(y);a.firstChild;)a.removeChild(a.firstChild);if(E&&H)a.appendChild(H);else{var P=oY(i,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:d,isRenderer:!0},a.ownerDocument,R,H),W=P.portal,j=P.portalContainer;m.set(y,j),a.appendChild(j),o.portalCache.set(R,W)}}return g.set(w,a),a}}},{key:"getEditorClass",value:function(i){var o,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jf,s=TP(i),a=(o=this.getEditorCache().get(s))===null||o===void 0?void 0:o.get(r);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(i){var o=function(r){function s(a){var l;return Ml(this,s),l=Ec(this,s,[a]),i.hotCustomEditorInstance=l,l.editorComponent=i,l}return Tc(s,r),Il(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(je.editors.BaseEditor);return Object.getOwnPropertyNames(je.editors.BaseEditor.prototype).forEach(function(r){r!=="constructor"&&(o.prototype[r]=function(){for(var s,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(s=i[r]).call.apply(s,[i].concat(l))})}),o}},{key:"getGlobalRendererElement",value:function(){return mv(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return IP(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],a=OP.getSettings(this.props,{prevProps:r,isInit:o,initOnlySettingKeys:s}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,jf);else{var c;this.props.editor||(c=this.props.settings)!==null&&c!==void 0&&c.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=iv("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=av("text")}return a}},{key:"displayAutoSizeWarning",value:function(i){var o,r;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(r=this.hotInstance.getPlugin("autoColumnSize"))!==null&&r!==void 0&&r.enabled)&&this.componentRendererColumns.size>0&&iY(eY)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:ZG(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings(!0);this.hotInstance=new je.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var o=this.createNewGlobalSettings(!1,i);this.updateHot(o),this.displayAutoSizeWarning(o)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=function(c){return c.type===sY},r=At.Children.toArray(this.props.children),s=r.filter(function(u){return o(u)}).map(function(u,c){return At.cloneElement(u,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:c,_getChildElementByType:mv.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:u.props.children})}),a=PP(this.props),l=MP(this.getOwnerDocument(),this.getGlobalEditorElement());return At.createElement(At.Fragment,null,At.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),s),At.createElement(aY,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return lY}}])}(At.Component);ly.propTypes={style:bp.object,id:bp.string,className:bp.string};var fY=["children"],xP=At.forwardRef(function(n,e){var t,i=n.children,o=KG(n,fY),r=typeof At.useId=="function"?At.useId():void 0,s=(t=o.id)!==null&&t!==void 0?t:r;return At.createElement(ly,Object.assign({id:s},o,{ref:e}),i)});xP.version=ly.version;At.Component;const BE="handsontableEditor",gY="handsontable";class uy extends ya{static get EDITOR_TYPE(){return gY}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Og(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(l,s.handsontable),this.htOptions=l}beginEditing(e,t){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,t,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:BE,relativeToGroup:rs,position:"before"},o=(r,s)=>{const a=this.htEditor;if(r!==void 0&&(r<0||a.flipped&&r>a.countRows()-1?a.deselectCell():a.selectCell(r,0),a.getData().length))return s.preventDefault(),Ji(s),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:r=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),o(a,r)},preventDefault:!1},{keys:[["ArrowDown"]],callback:r=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return o(a,r)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(BE)}}function mY(n,e,t){pY(n,e),e.set(n,t)}function pY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(n,e,t){return(e=wY(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wY(n){var e=vY(n,"string");return typeof e=="symbol"?e:e+""}function vY(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function WE(n,e){return n.get(CY(n,e))}function CY(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const bY="autocomplete";var yp=new WeakMap;class cy extends uy{constructor(){super(...arguments),ed(this,"query",null),ed(this,"strippedChoices",[]),ed(this,"rawChoices",[]),mY(this,yp,this.hot.guid.slice(0,9)),ed(this,"sortByRelevance",function(e,t,i){const o=[],r=[],s=e.length;let a=t.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)r.push(c);return r}for(c=0;c<a;c++){if(u=gR(Bt(t[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,o.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(o.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=o.length;c<a;c++)r.push(o[c].baseIndex);return r})}static get EDITOR_TYPE(){return bY}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return ce(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[B$(),L$(),BM("listbox"),z$()])}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[Ri("false"),G$(`${WE(yp,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,o=i==null?void 0:i.length,{row:r,col:s}=this;this.showEditableElement(),this.focus();let a=sn();a===0&&Zw()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[Ct(this.TEXTAREA)-2]:void 0,width:e?Ct(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,g,m)=>{vr(l,u,c,h,d,g,m);const{filteringCaseSensitive:w,allowHtml:C,locale:y}=this.cellProperties,R=this.query;let E=Bt(g),H,P;E&&!C&&(H=w===!0?E.indexOf(R):E.toLocaleLowerCase(y).indexOf(R.toLocaleLowerCase(y)),H!==-1&&(P=E.substr(H,R.length),E=E.replace(P,`<strong>${P}</strong>`))),t&&ye(u,[$$(),...i?[q$(o)]:[],...i?[Z$(i.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=E},afterSelectionEnd:(l,u)=>{if(t){const c=this.htEditor.getCell(l,u,!0);ye(c,[aC()]),ye(this.TEXTAREA,...Y$(c.id))}}}),t&&(ye(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...xo()),ye(this.htEditor.rootElement,[VM(),K$("polite"),X$("text"),["id",`${WE(yp,this)}-listbox-${r}-${s}`]]),ye(this.TEXTAREA,...Ri("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[Ri("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=ZM(this.TEXTAREA),i=rk(this.TEXTAREA),o=this.cellProperties.sortByRelevance,r=this.cellProperties.filter;let s=null,a=null,l=e;o&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(r===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(o&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(tf([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Og(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){const e=El(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(t||!t&&(i||i==="horizontal"))return!1;const o=rn(this.TEXTAREA),r=Wt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Wt(this.hot.view._wt.wtTable.THEAD),u=rn(e),c=o.top-u.top-l+a,h=e.scrollHeight-c-l-r,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,t){if(t>e){let i=0,o=0,r=0,s=null;do r=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=r,o+=1;while(i<e);s=i-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-s}px`),this.setDropdownHeight(i-r)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+sn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,i=Ue(e,r=>Bt(r));return Ue(i,r=>t?r:gR(r))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1};let o=!1;return e===we.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(o=!0),e===we.ARROW_UP&&i.row>-1&&(o=!0),o}onBeforeKeyDown(e){if(Lk(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let t=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const yY="checkbox";class HP extends Ll{static get EDITOR_TYPE(){return yY}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Re(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ur=()=>window,Ci=()=>window.document,pv=(n,e)=>window.setTimeout(n,e),bo=function(n,e,t,i){n.addEventListener(e,t,!!i)},Ko=function(n,e,t,i){n.removeEventListener(e,t,!!i)},SY=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},qn=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Sp=function(n,e){qn(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Rp=function(n,e){n.className=SY((" "+n.className+" ").replace(" "+e+" "," "))},hy=function(n){return/Array/.test(Object.prototype.toString.call(n))},ei=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},RY=function(n){let e=n.getDay();return e===0||e===6},EY=function(n){return n%4===0&&n%100!==0||n%400===0},jE=function(n,e){return[31,EY(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},td=function(n){ei(n)&&n.setHours(0,0,0,0)},nd=function(n,e){return n.getTime()===e.getTime()},Uf=function(n,e,t){let i,o;for(i in e)o=n[i]!==void 0,o&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?ei(e[i])?t&&(n[i]=new Date(e[i].getTime())):hy(e[i])?t&&(n[i]=e[i].slice(0)):n[i]=Uf({},e[i],t):(t||!o)&&(n[i]=e[i]);return n},UE=function(n,e,t){let i=Ci().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Uf(i,t),n.dispatchEvent(i)},zE=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},ao={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},GE=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},TY=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},MY=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),i=n.getDay(),o=e,r=o-1,s=7,a=function(d){return(d+s-1)%s};n.setDate(t+r-a(i));let l=new Date(n.getFullYear(),0,o),u=24*60*60*1e3,c=(n.getTime()-l.getTime())/u;return 1+Math.round((c-r+a(l.getDay()))/s)},IY=function(n,e,t,i,o){let r=new Date(i,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(r).isoWeek():MY(r,o))+"</td>"},PY=function(n,e,t,i){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},OY=function(n){return"<tbody>"+n.join("")+"</tbody>"},AY=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+GE(n,e)+'">'+GE(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},xY=function(n,e,t,i,o,r){let s,a,l,u=n._o,c=t===u.minYear,h=t===u.maxYear,d='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',g,m,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(t===o?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",hy(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=t-u.yearRange,a=1+t+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===t?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+g:d+=g+m,c&&(i===0||u.minMonth>=i)&&(w=!1),h&&(i===11||u.maxMonth<=i)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},HY=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+AY(n)+OY(e)+"</table>"};function wv(n){let e=this,t=e.config(n);e._onMouseDown=function(o){if(!e._v)return;o=o||Ur().event;let r=o.target||o.srcElement;if(r)if(qn(r,"is-disabled")||(qn(r,"pika-button")&&!qn(r,"is-empty")&&!qn(r.parentNode,"is-disabled")?(e.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),t.bound&&pv(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):qn(r,"pika-prev")?e.prevMonth():qn(r,"pika-next")&&e.nextMonth()),qn(r,"pika-select"))e._c=!0;else if(o.preventDefault)o.preventDefault();else return o.returnValue=!1,!1},e._onChange=function(o){o=o||Ur().event;let r=o.target||o.srcElement;r&&(qn(r,"pika-select-month")?e.gotoMonth(r.value):qn(r,"pika-select-year")&&e.gotoYear(r.value))},e._onKeyChange=function(o){if(o=o||Ur().event,e.isVisible())switch(o.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let o=this.moment(t.field.value,t.format,t.formatStrict);return o&&o.isValid()?o.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(o){let r;o.firedBy!==e&&(r=e._parseFieldValue(),ei(r)&&e.setDate(r),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let o=Ci().activeElement;do if(qn(o,"pika-single"))return;while(o=o.parentNode);e._c||(e._b=pv(function(){e.hide()},50)),e._c=!1},e._onClick=function(o){o=o||Ur().event;let r=o.target||o.srcElement,s=r;if(r){!hasEventListeners&&qn(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),bo(r,"change",e._onChange)));do if(qn(s,"pika-single")||s===t.trigger)return;while(s=s.parentNode);e._v&&r!==t.trigger&&s!==t.trigger&&e.hide()}},e.el=Ci().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),bo(e.el,"mousedown",e._onMouseDown,!0),bo(e.el,"touchend",e._onMouseDown,!0),bo(e.el,"change",e._onChange),t.keyboardInput&&bo(Ci(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?Ci().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),bo(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let i=t.defaultDate;ei(i)?t.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",bo(t.trigger,"click",e._onInputClick),bo(t.trigger,"focus",e._onInputFocus),bo(t.trigger,"blur",e._onInputBlur)):this.show()}wv.prototype={config:function(n){this._o||(this._o=Uf({},ao,!0));let e=Uf(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,ei(e.minDate)||(e.minDate=!1),ei(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),hy(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||ao.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,ei(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return ei(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",UE(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!ei(n))return;let t=this._o.minDate,i=this._o.maxDate;ei(t)&&n<t?n=t:ei(i)&&n>i&&(n=i),this._d=new Date(n.getTime()),td(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),UE(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(ei(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=n.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=o<t.getTime()||i.getTime()<o}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,o;n==="add"?o=new Date(t.valueOf()+i):n==="subtract"&&(o=new Date(t.valueOf()-i)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=zE(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=zE({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(td(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=ao.minDate,this._o.minYear=ao.minYear,this._o.minMonth=ao.minMonth,this._o.startRange=ao.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(td(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=ao.maxDate,this._o.maxYear=ao.maxYear,this._o.maxMonth=ao.maxMonth,this._o.endRange=ao.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,i=e.maxYear,o=e.minMonth,r=e.maxMonth,s="",a;this._y<=t&&(this._y=t,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(r)&&this._m>r&&(this._m=r));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+xY(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&pv(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,i,o,r,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,i=Ur().innerWidth||Ci().documentElement.clientWidth,o=Ur().innerHeight||Ci().documentElement.clientHeight,r=Ci().body.scrollTop||Ci().documentElement.scrollTop,u=!0,c=!0,l=n.getBoundingClientRect(),s=l.left+Ur().pageXOffset,a=l.bottom+Ur().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+n.offsetWidth>0)&&(s=s-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>o+r||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Sp(this.el,u?"left-aligned":"right-aligned"),Sp(this.el,c?"bottom-aligned":"top-aligned"),Rp(this.el,u?"right-aligned":"left-aligned"),Rp(this.el,c?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let i=this._o,o=new Date,r=jE(n,e),s=new Date(n,e,1).getDay(),a=[],l=[];td(o),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?n-1:n,d=e===11?n+1:n,g=jE(h,u),m=r+s,w=m;for(;w>7;)w-=7;m+=7-w;let C=!1;for(let y=0,R=0;y<m;y++){let E=new Date(n,e,1+(y-s)),H=ei(this._d)?nd(E,this._d):!1,P=nd(E,o),W=i.events.indexOf(E.toDateString())!==-1,j=y<s||y>=r+s,G=1+(y-s),Y=e,z=n,Q=i.startRange&&nd(i.startRange,E),q=i.endRange&&nd(i.endRange,E),ne=i.startRange&&i.endRange&&i.startRange<E&&E<i.endRange,de=i.minDate&&E<i.minDate||i.maxDate&&E>i.maxDate||i.disableWeekends&&RY(E)||i.disableDayFn&&i.disableDayFn(E);j&&(y<s?(G=g+G,Y=u,z=h):(G=G-r,Y=c,z=d));let Se={day:G,month:Y,year:z,hasEvent:W,isSelected:H,isToday:P,isDisabled:de,isEmpty:j,isStartRange:Q,isEndRange:q,isInRange:ne,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&H&&(C=!0),l.push(TY(Se)),++R===7&&(i.showWeekNumber&&l.unshift(IY(this,y-s,e,n,i.firstWeekOfYearMinDays)),a.push(PY(l,i.isRTL,i.pickWholeWeek,C)),l=[],R=0,C=!1)}return HY(i,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Rp(this.el,"is-hidden"),this._o.bound&&(bo(Ci(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Ko(Ci(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Sp(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Ko(this.el,"mousedown",this._onMouseDown,!0),Ko(this.el,"touchend",this._onMouseDown,!0),Ko(this.el,"change",this._onChange),n.keyboardInput&&Ko(Ci(),"keydown",this._onKeyChange),n.field&&(Ko(n.field,"change",this._onInputChange),n.bound&&(Ko(n.trigger,"click",this._onInputClick),Ko(n.trigger,"focus",this._onInputFocus),Ko(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Ep(n,e,t){return(e=_Y(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _Y(n){var e=NY(n,"string");return typeof e=="symbol"?e:e+""}function NY(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const _P="date",YE="dateEditor";class NP extends ya{constructor(){super(...arguments),Ep(this,"defaultDateFormat","DD/MM/YYYY"),Ep(this,"parentDestroyed",!1),Ep(this,"$datePicker",null)}static get EDITOR_TYPE(){return _P}init(){if(typeof Je!="function")throw new Error("You need to include moment.js to your project.");if(typeof wv!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Re(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:YE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const o=this.hot._getEditorManager();o.closeEditor(),this.hot.view.render(),o.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(YE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?dI(e.keyCode):!1;let r;this.datePicker.style.display="block",this.$datePicker=new wv(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Je),this.$datePicker._onInputFocus=function(){},this.originalValue?(r=this.originalValue,Je(r,t,!0).isValid()&&this.$datePicker.setMoment(Je(r,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,Je(r,t,!0).isValid()&&this.$datePicker.setMoment(Je(r,t),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&xg(t,this.cellProperties.datePickerConfig);const i=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=r=>{let s=r;isNaN(s.getTime())||(s=Je(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),i&&i()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==Lt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{wtOverlays:r}=this.hot.view._wt,{wtTable:s}=(t=r.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=o.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=o.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Wt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Ct(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const DY="dropdown";class dy extends cy{static get EDITOR_TYPE(){return DY}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}le.getSingleton().add("beforeValidate",function(n,e,t){const i=this.propToCol(t);if(Number.isInteger(i)){const o=this.getCellMeta(e,i);o.editor===dy&&o.strict===void 0&&(o.filter=!1,o.strict=!0)}});const LY="numeric";class DP extends ya{static get EDITOR_TYPE(){return LY}}const $Y="password";class LP extends ya{static get EDITOR_TYPE(){return $Y}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,No(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Tp="ht_editor_visible",KE="selectEditor",kY="select";class $P extends Ll{static get EDITOR_TYPE(){return kY}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",X(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Re(this.select,Tp)&&Ie(this.select,Tp),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),No(this.select),Le(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Nl(h,u),this.select.appendChild(h)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,o=e.length;i<o;i++)t[e[i]]=e[i];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Lt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:i,height:o}=this.getEditedCellRect(),r=this.select.style;r.height=`${o}px`,r.width=`${i}px`,r.top=`${e}px`,r[this.hot.isRtl()?"right":"left"]=`${t}px`,r.margin="0px",X(this.select,Tp)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={group:KE};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(KE)}}const FY="time";class kP extends ya{static get EDITOR_TYPE(){return FY}prepare(e,t,i,o,r,s){super.prepare(e,t,i,o,r,s),this.TEXTAREA.dir="ltr"}}function VY(){Zn(Ll),Zn(cy),Zn(HP),Zn(NP),Zn(dy),Zn(uy),Zn(DP),Zn(LP),Zn($P),Zn(ya),Zn(kP)}const BY="html";function fy(n,e,t,i,o,r,s){Qc.apply(this,[n,e,t,i,o,r,s]),Nl(e,r??"",!1)}fy.RENDERER_TYPE=BY;const WY="autocomplete";function $l(n,e,t,i,o,r,s){const{rootDocument:a}=n,l=s.allowHtml?fy:vr,u=a.createElement("DIV"),c=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Ca()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[n,e,t,i,o,r,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!n.acArrowListener){const h=new qi(n);n.acArrowListener=function(d){Re(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,i),e)},h.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{h.destroy()})}}$l.RENDERER_TYPE=WY;const jY="dropdown";function gy(n,e,t,i,o,r,s){$l.apply(this,[n,e,t,i,o,r,s])}gy.RENDERER_TYPE=jY;const XE=new WeakMap,qE=new WeakMap,UY="htBadValue",Pl="data-row",Ol="data-col",zY="checkboxRenderer",FP="checkbox";le.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:i,type:o,row:r,column:s,prop:a}=e;if(o===FP){if(i){const{value:l,property:u}=i;let c=t;if(l)c=typeof l=="function"?l(r,s,a,t):l;else if(u){const h=this.getDataAtRowProp(r,u);c=h!==null?h:t}n=c}return n}});function my(n,e,t,i,o,r,s){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Qc.apply(this,[n,e,t,i,o,r,s]),GY(n);let u=YY(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),No(e),r===s.checkedTemplate||Bt(r).toLocaleLowerCase(s.locale)===Bt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:r===s.uncheckedTemplate||Bt(r).toLocaleLowerCase(s.locale)===Bt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:kt(r)?X(u,"noValue"):(u.style.display="none",X(u,UY),h=!0),ye(u,[[Pl,t],[Ol,i]]),l&&ye(u,[If(u.checked?n.getTranslatedPhrase(oy):n.getTranslatedPhrase(ry)),UM(u.checked),k$()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,t,i,o,r):c.value;else if(c.property){const y=n.getDataAtRowProp(t,c.property);w=y!==null?y:""}const C=KY(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),XE.has(n)||(XE.set(n,!0),d());function d(){const C=n.getShortcutManager().getContext("grid"),y={group:zY,relativeToGroup:rs,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(g(),!m()),runOnlyIf:()=>{var R;return(R=n.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}},{keys:[["enter"]],callback:()=>(g(),!m()),runOnlyIf:()=>{const R=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&(R==null?void 0:R.isSingle())&&R.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!m()),runOnlyIf:()=>{var R;return(R=n.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}}],y)}function g(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=n.getSelectedRange(),y=[],R=new Map;let E=[],H=0;if(C){for(let P=0;P<C.length;P++){const{row:W,col:j}=C[P].getTopStartCorner(),{row:G,col:Y}=C[P].getBottomEndCorner();for(let z=W;z<=G;z+=1)for(let Q=j;Q<=Y;Q+=1){const q=n.getCellMeta(z,Q),ne={checkedTemplate:q.checkedTemplate,uncheckedTemplate:q.uncheckedTemplate};if(q.type!=="checkbox"){w===!0&&!q.readOnly&&(R.has(y.length)?R.set(y.length,[...R.get(y.length),[z,Q,null]]):R.set(y.length,[[z,Q,null]]));continue}if(q.readOnly===!0)continue;typeof q.checkedTemplate>"u"&&(q.checkedTemplate=!0),typeof q.uncheckedTemplate>"u"&&(q.uncheckedTemplate=!1);const de=n.getDataAtCell(z,Q);w===!1?[q.checkedTemplate,q.checkedTemplate.toString()].includes(de)?E.push([z,Q,q.uncheckedTemplate,ne]):[q.uncheckedTemplate,q.uncheckedTemplate.toString(),null,void 0].includes(de)&&E.push([z,Q,q.checkedTemplate,ne]):E.push([z,Q,q.uncheckedTemplate,ne]),H+=1}y.push(H),H=0}E.every(P=>{let[,,W]=P;return W===E[0][2]})?E=E.map(P=>{let[W,j,G]=P;return[W,j,G]}):E=E.map(P=>{let[W,j,,G]=P;return[W,j,G.checkedTemplate]}),E.length>0&&y.forEach((P,W)=>{let j=E.splice(0,P);R.size&&R.has(W)&&(j=[...j,...R.get(W)]),n.setDataAtCell(j)})}}function m(){const w=n.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const y=w[C].getTopStartCorner(),R=w[C].getBottomEndCorner();for(let E=y.row;E<=R.row;E++)for(let H=y.col;H<=R.col;H++){const P=n.getCellMeta(E,H),W=n.getCell(E,H);if(W==null)return!0;if(W.querySelectorAll("input[type=checkbox]").length>0&&!P.readOnly)return!0}}return!1}}}my.RENDERER_TYPE=FP;function GY(n){let e=qE.get(n);if(!e){const{rootElement:t}=n;e=new qi(n),e.addEventListener(t,"click",i=>qY(i,n)),e.addEventListener(t,"mouseup",i=>XY(i,n)),e.addEventListener(t,"change",i=>ZY(i,n)),qE.set(n,e)}return e}function YY(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function KY(n,e,t){const i=n.createElement("label");return i.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,i.appendChild(n.createTextNode(e)),i.cloneNode(!0)}function XY(n,e){const{target:t}=n;py(t)&&(!t.hasAttribute(Pl)||!t.hasAttribute(Ol)||setTimeout(e.listen,10))}function qY(n,e){const{target:t}=n;if(!py(t)||!t.hasAttribute(Pl)||!t.hasAttribute(Ol))return;const i=parseInt(t.getAttribute(Pl),10),o=parseInt(t.getAttribute(Ol),10);e.getCellMeta(i,o).readOnly&&n.preventDefault()}function ZY(n,e){const{target:t}=n;if(!py(t)||!t.hasAttribute(Pl)||!t.hasAttribute(Ol))return;const i=parseInt(t.getAttribute(Pl),10),o=parseInt(t.getAttribute(Ol),10),r=e.getCellMeta(i,o);if(!r.readOnly){let s=null;n.target.checked?s=r.uncheckedTemplate===void 0?!0:r.checkedTemplate:s=r.uncheckedTemplate===void 0?!1:r.uncheckedTemplate,e.setDataAtCell(i,o,s)}}function py(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const QY="handsontable";function wy(n,e,t,i,o,r,s){$l.apply(this,[n,e,t,i,o,r,s])}wy.RENDERER_TYPE=QY;function id(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var VP={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,o,r){function s(u,c){if(!o[u]){if(!i[u]){var h=typeof id=="function"&&id;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var g=o[u]={exports:{}};i[u][0].call(g.exports,function(m){return s(i[u][1][m]||m)},g,g.exports,t,i,o,r)}return o[u].exports}for(var a=typeof id=="function"&&id,l=0;l<r.length;l++)s(r[l]);return s}({1:[function(t,i,o){(function(r){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,m=9007199254740991,w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],C=1e7,y=1e9;function R(Y){var z=0|Y;return 0<Y||Y===z?z:z-1}function E(Y){for(var z,Q,q=1,ne=Y.length,de=Y[0]+"";q<ne;){for(z=Y[q++]+"",Q=g-z.length;Q--;z="0"+z);de+=z}for(ne=de.length;de.charCodeAt(--ne)===48;);return de.slice(0,ne+1||1)}function H(Y,z){var Q,q,ne=Y.c,de=z.c,Se=Y.s,Xe=z.s,Oe=Y.e,ge=z.e;if(!Se||!Xe)return null;if(Q=ne&&!ne[0],q=de&&!de[0],Q||q)return Q?q?0:-Xe:Se;if(Se!=Xe)return Se;if(Q=Se<0,q=Oe==ge,!ne||!de)return q?0:!ne^Q?1:-1;if(!q)return ge<Oe^Q?1:-1;for(Xe=(Oe=ne.length)<(ge=de.length)?Oe:ge,Se=0;Se<Xe;Se++)if(ne[Se]!=de[Se])return ne[Se]>de[Se]^Q?1:-1;return Oe==ge?0:ge<Oe^Q?1:-1}function P(Y,z,Q,q){if(Y<z||Q<Y||Y!==(Y<0?l(Y):u(Y)))throw Error(c+(q||"Argument")+(typeof Y=="number"?Y<z||Q<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function W(Y){var z=Y.c.length-1;return R(Y.e/g)==z&&Y.c[z]%2!=0}function j(Y,z){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(z<0?"e":"e+")+z}function G(Y,z,Q){var q,ne;if(z<0){for(ne=Q+".";++z;ne+=Q);Y=ne+Y}else if(++z>(q=Y.length)){for(ne=Q,z-=q;--z;ne+=Q);Y+=ne}else z<q&&(Y=Y.slice(0,z)+"."+Y.slice(z));return Y}(s=function Y(z){var Q,q,ne,de,Se,Xe,Oe,ge,fe,st,f=B.prototype={constructor:B,toString:null,valueOf:null},p=new B(1),v=20,I=4,A=-7,F=21,U=-1e7,K=1e7,se=!1,ue=1,Z=0,Me={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Te="0123456789abcdefghijklmnopqrstuvwxyz";function B(b,S){var T,$,O,k,N,x,L,D,V=this;if(!(V instanceof B))return new B(b,S);if(S==null){if(b instanceof B)return V.s=b.s,V.e=b.e,void(V.c=(b=b.c)?b.slice():b);if((x=typeof b=="number")&&0*b==0){if(V.s=1/b<0?(b=-b,-1):1,b===~~b){for(k=0,N=b;10<=N;N/=10,k++);return V.e=k,void(V.c=[b])}D=String(b)}else{if(D=String(b),!a.test(D))return ne(V,D,x);V.s=D.charCodeAt(0)==45?(D=D.slice(1),-1):1}-1<(k=D.indexOf("."))&&(D=D.replace(".","")),0<(N=D.search(/e/i))?(k<0&&(k=N),k+=+D.slice(N+1),D=D.substring(0,N)):k<0&&(k=D.length)}else{if(P(S,2,Te.length,"Base"),D=String(b),S==10)return _e(V=new B(b instanceof B?b:D),v+V.e+1,I);if(x=typeof b=="number"){if(0*b!=0)return ne(V,D,x,S);if(V.s=1/b<0?(D=D.slice(1),-1):1,B.DEBUG&&15<D.replace(/^0\.0*|\./,"").length)throw Error(h+b);x=!1}else V.s=D.charCodeAt(0)===45?(D=D.slice(1),-1):1;for(T=Te.slice(0,S),k=N=0,L=D.length;N<L;N++)if(T.indexOf($=D.charAt(N))<0){if($=="."){if(k<N){k=L;continue}}else if(!O&&(D==D.toUpperCase()&&(D=D.toLowerCase())||D==D.toLowerCase()&&(D=D.toUpperCase()))){O=!0,N=-1,k=0;continue}return ne(V,String(b),x,S)}-1<(k=(D=q(D,S,10,V.s)).indexOf("."))?D=D.replace(".",""):k=D.length}for(N=0;D.charCodeAt(N)===48;N++);for(L=D.length;D.charCodeAt(--L)===48;);if(D=D.slice(N,++L)){if(L-=N,x&&B.DEBUG&&15<L&&(m<b||b!==u(b)))throw Error(h+V.s*b);if(K<(k=k-N-1))V.c=V.e=null;else if(k<U)V.c=[V.e=0];else{if(V.e=k,V.c=[],N=(k+1)%g,k<0&&(N+=g),N<L){for(N&&V.c.push(+D.slice(0,N)),L-=g;N<L;)V.c.push(+D.slice(N,N+=g));D=D.slice(N),N=g-D.length}else N-=L;for(;N--;D+="0");V.c.push(+D)}}else V.c=[V.e=0]}function We(b,S,T,$){var O,k,N,x,L;if(T==null?T=I:P(T,0,8),!b.c)return b.toString();if(O=b.c[0],N=b.e,S==null)L=E(b.c),L=$==1||$==2&&(N<=A||F<=N)?j(L,N):G(L,N,"0");else if(k=(b=_e(new B(b),S,T)).e,x=(L=E(b.c)).length,$==1||$==2&&(S<=k||k<=A)){for(;x<S;L+="0",x++);L=j(L,k)}else if(S-=N,L=G(L,k,"0"),x<k+1){if(0<--S)for(L+=".";S--;L+="0");}else if(0<(S+=k-x))for(k+1==x&&(L+=".");S--;L+="0");return b.s<0&&O?"-"+L:L}function Ve(b,S){for(var T,$=1,O=new B(b[0]);$<b.length;$++){if(!(T=new B(b[$])).s){O=T;break}S.call(O,T)&&(O=T)}return O}function qe(b,S,T){for(var $=1,O=S.length;!S[--O];S.pop());for(O=S[0];10<=O;O/=10,$++);return(T=$+T*g-1)>K?b.c=b.e=null:b.c=T<U?[b.e=0]:(b.e=T,S),b}function _e(b,S,T,$){var O,k,N,x,L,D,V,ee=b.c,ae=w;if(ee){e:{for(O=1,x=ee[0];10<=x;x/=10,O++);if((k=S-O)<0)k+=g,N=S,V=(L=ee[D=0])/ae[O-N-1]%10|0;else if((D=l((k+1)/g))>=ee.length){if(!$)break e;for(;ee.length<=D;ee.push(0));L=V=0,N=(k%=g)-g+(O=1)}else{for(L=x=ee[D],O=1;10<=x;x/=10,O++);V=(N=(k%=g)-g+O)<0?0:L/ae[O-N-1]%10|0}if($=$||S<0||ee[D+1]!=null||(N<0?L:L%ae[O-N-1]),$=T<4?(V||$)&&(T==0||T==(b.s<0?3:2)):5<V||V==5&&(T==4||$||T==6&&(0<k?0<N?L/ae[O-N]:0:ee[D-1])%10&1||T==(b.s<0?8:7)),S<1||!ee[0])return ee.length=0,$?(S-=b.e+1,ee[0]=ae[(g-S%g)%g],b.e=-S||0):ee[0]=b.e=0,b;if(k==0?(ee.length=D,x=1,D--):(ee.length=D+1,x=ae[g-k],ee[D]=0<N?u(L/ae[O-N]%ae[N])*x:0),$)for(;;){if(D==0){for(k=1,N=ee[0];10<=N;N/=10,k++);for(N=ee[0]+=x,x=1;10<=N;N/=10,x++);k!=x&&(b.e++,ee[0]==d&&(ee[0]=1));break}if(ee[D]+=x,ee[D]!=d)break;ee[D--]=0,x=1}for(k=ee.length;ee[--k]===0;ee.pop());}b.e>K?b.c=b.e=null:b.e<U&&(b.c=[b.e=0])}return b}function be(b){var S,T=b.e;return T===null?b.toString():(S=E(b.c),S=T<=A||F<=T?j(S,T):G(S,T,"0"),b.s<0?"-"+S:S)}return B.clone=Y,B.ROUND_UP=0,B.ROUND_DOWN=1,B.ROUND_CEIL=2,B.ROUND_FLOOR=3,B.ROUND_HALF_UP=4,B.ROUND_HALF_DOWN=5,B.ROUND_HALF_EVEN=6,B.ROUND_HALF_CEIL=7,B.ROUND_HALF_FLOOR=8,B.EUCLID=9,B.config=B.set=function(b){var S,T;if(b!=null){if(typeof b!="object")throw Error(c+"Object expected: "+b);if(b.hasOwnProperty(S="DECIMAL_PLACES")&&(P(T=b[S],0,y,S),v=T),b.hasOwnProperty(S="ROUNDING_MODE")&&(P(T=b[S],0,8,S),I=T),b.hasOwnProperty(S="EXPONENTIAL_AT")&&((T=b[S])&&T.pop?(P(T[0],-y,0,S),P(T[1],0,y,S),A=T[0],F=T[1]):(P(T,-y,y,S),A=-(F=T<0?-T:T))),b.hasOwnProperty(S="RANGE"))if((T=b[S])&&T.pop)P(T[0],-y,-1,S),P(T[1],1,y,S),U=T[0],K=T[1];else{if(P(T,-y,y,S),!T)throw Error(c+S+" cannot be zero: "+T);U=-(K=T<0?-T:T)}if(b.hasOwnProperty(S="CRYPTO")){if((T=b[S])!==!!T)throw Error(c+S+" not true or false: "+T);if(T){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw se=!T,Error(c+"crypto unavailable");se=T}else se=T}if(b.hasOwnProperty(S="MODULO_MODE")&&(P(T=b[S],0,9,S),ue=T),b.hasOwnProperty(S="POW_PRECISION")&&(P(T=b[S],0,y,S),Z=T),b.hasOwnProperty(S="FORMAT")){if(typeof(T=b[S])!="object")throw Error(c+S+" not an object: "+T);Me=T}if(b.hasOwnProperty(S="ALPHABET")){if(typeof(T=b[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(T))throw Error(c+S+" invalid: "+T);Te=T}}return{DECIMAL_PLACES:v,ROUNDING_MODE:I,EXPONENTIAL_AT:[A,F],RANGE:[U,K],CRYPTO:se,MODULO_MODE:ue,POW_PRECISION:Z,FORMAT:Me,ALPHABET:Te}},B.isBigNumber=function(b){return b instanceof B||b&&b._isBigNumber===!0||!1},B.maximum=B.max=function(){return Ve(arguments,f.lt)},B.minimum=B.min=function(){return Ve(arguments,f.gt)},B.random=(de=9007199254740992,Se=Math.random()*de&2097151?function(){return u(Math.random()*de)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(b){var S,T,$,O,k,N=0,x=[],L=new B(p);if(b==null?b=v:P(b,0,y),O=l(b/g),se)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(O*=2));N<O;)9e15<=(k=131072*S[N]+(S[N+1]>>>11))?(T=crypto.getRandomValues(new Uint32Array(2)),S[N]=T[0],S[N+1]=T[1]):(x.push(k%1e14),N+=2);N=O/2}else{if(!crypto.randomBytes)throw se=!1,Error(c+"crypto unavailable");for(S=crypto.randomBytes(O*=7);N<O;)9e15<=(k=281474976710656*(31&S[N])+1099511627776*S[N+1]+4294967296*S[N+2]+16777216*S[N+3]+(S[N+4]<<16)+(S[N+5]<<8)+S[N+6])?crypto.randomBytes(7).copy(S,N):(x.push(k%1e14),N+=7);N=O/7}if(!se)for(;N<O;)(k=Se())<9e15&&(x[N++]=k%1e14);for(O=x[--N],b%=g,O&&b&&(k=w[g-b],x[N]=u(O/k)*k);x[N]===0;x.pop(),N--);if(N<0)x=[$=0];else{for($=-1;x[0]===0;x.splice(0,1),$-=g);for(N=1,k=x[0];10<=k;k/=10,N++);N<g&&($-=g-N)}return L.e=$,L.c=x,L}),B.sum=function(){for(var b=1,S=arguments,T=new B(S[0]);b<S.length;)T=T.plus(S[b++]);return T},q=function(){var b="0123456789";function S(T,$,O,k){for(var N,x,L=[0],D=0,V=T.length;D<V;){for(x=L.length;x--;L[x]*=$);for(L[0]+=k.indexOf(T.charAt(D++)),N=0;N<L.length;N++)L[N]>O-1&&(L[N+1]==null&&(L[N+1]=0),L[N+1]+=L[N]/O|0,L[N]%=O)}return L.reverse()}return function(T,$,O,k,N){var x,L,D,V,ee,ae,ve,He,Ge=T.indexOf("."),$e=v,Ee=I;for(0<=Ge&&(V=Z,Z=0,T=T.replace(".",""),ae=(He=new B($)).pow(T.length-Ge),Z=V,He.c=S(G(E(ae.c),ae.e,"0"),10,O,b),He.e=He.c.length),D=V=(ve=S(T,$,O,N?(x=Te,b):(x=b,Te))).length;ve[--V]==0;ve.pop());if(!ve[0])return x.charAt(0);if(Ge<0?--D:(ae.c=ve,ae.e=D,ae.s=k,ve=(ae=Q(ae,He,$e,Ee,O)).c,ee=ae.r,D=ae.e),Ge=ve[L=D+$e+1],V=O/2,ee=ee||L<0||ve[L+1]!=null,ee=Ee<4?(Ge!=null||ee)&&(Ee==0||Ee==(ae.s<0?3:2)):V<Ge||Ge==V&&(Ee==4||ee||Ee==6&&1&ve[L-1]||Ee==(ae.s<0?8:7)),L<1||!ve[0])T=ee?G(x.charAt(1),-$e,x.charAt(0)):x.charAt(0);else{if(ve.length=L,ee)for(--O;++ve[--L]>O;)ve[L]=0,L||(++D,ve=[1].concat(ve));for(V=ve.length;!ve[--V];);for(Ge=0,T="";Ge<=V;T+=x.charAt(ve[Ge++]));T=G(T,D,x.charAt(0))}return T}}(),Q=function(){function b($,O,k){var N,x,L,D,V=0,ee=$.length,ae=O%C,ve=O/C|0;for($=$.slice();ee--;)V=((x=ae*(L=$[ee]%C)+(N=ve*L+(D=$[ee]/C|0)*ae)%C*C+V)/k|0)+(N/C|0)+ve*D,$[ee]=x%k;return V&&($=[V].concat($)),$}function S($,O,k,N){var x,L;if(k!=N)L=N<k?1:-1;else for(x=L=0;x<k;x++)if($[x]!=O[x]){L=$[x]>O[x]?1:-1;break}return L}function T($,O,k,N){for(var x=0;k--;)$[k]-=x,x=$[k]<O[k]?1:0,$[k]=x*N+$[k]-O[k];for(;!$[0]&&1<$.length;$.splice(0,1));}return function($,O,k,N,x){var L,D,V,ee,ae,ve,He,Ge,$e,Ee,Ye,Tt,Sa,Mi,Vl,si,Rt,Yt=$.s==O.s?1:-1,an=$.c,bt=O.c;if(!(an&&an[0]&&bt&&bt[0]))return new B($.s&&O.s&&(an?!bt||an[0]!=bt[0]:bt)?an&&an[0]==0||!bt?0*Yt:Yt/0:NaN);for($e=(Ge=new B(Yt)).c=[],Yt=k+(D=$.e-O.e)+1,x||(x=d,D=R($.e/g)-R(O.e/g),Yt=Yt/g|0),V=0;bt[V]==(an[V]||0);V++);if(bt[V]>(an[V]||0)&&D--,Yt<0)$e.push(1),ee=!0;else{for(Mi=an.length,si=bt.length,Yt+=2,1<(ae=u(x/(bt[V=0]+1)))&&(bt=b(bt,ae,x),an=b(an,ae,x),si=bt.length,Mi=an.length),Sa=si,Ye=(Ee=an.slice(0,si)).length;Ye<si;Ee[Ye++]=0);Rt=bt.slice(),Rt=[0].concat(Rt),Vl=bt[0],bt[1]>=x/2&&Vl++;do{if(ae=0,(L=S(bt,Ee,si,Ye))<0){if(Tt=Ee[0],si!=Ye&&(Tt=Tt*x+(Ee[1]||0)),1<(ae=u(Tt/Vl)))for(x<=ae&&(ae=x-1),He=(ve=b(bt,ae,x)).length,Ye=Ee.length;S(ve,Ee,He,Ye)==1;)ae--,T(ve,si<He?Rt:bt,He,x),He=ve.length,L=1;else ae==0&&(L=ae=1),He=(ve=bt.slice()).length;if(He<Ye&&(ve=[0].concat(ve)),T(Ee,ve,Ye,x),Ye=Ee.length,L==-1)for(;S(bt,Ee,si,Ye)<1;)ae++,T(Ee,si<Ye?Rt:bt,Ye,x),Ye=Ee.length}else L===0&&(ae++,Ee=[0]);$e[V++]=ae,Ee[0]?Ee[Ye++]=an[Sa]||0:(Ee=[an[Sa]],Ye=1)}while((Sa++<Mi||Ee[0]!=null)&&Yt--);ee=Ee[0]!=null,$e[0]||$e.splice(0,1)}if(x==d){for(V=1,Yt=$e[0];10<=Yt;Yt/=10,V++);_e(Ge,k+(Ge.e=V+D*g-1)+1,N,ee)}else Ge.e=D,Ge.r=+ee;return Ge}}(),Xe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Oe=/^([^.]+)\.$/,ge=/^\.([^.]+)$/,fe=/^-?(Infinity|NaN)$/,st=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(b,S,T,$){var O,k=T?S:S.replace(st,"");if(fe.test(k))b.s=isNaN(k)?null:k<0?-1:1,b.c=b.e=null;else{if(!T&&(k=k.replace(Xe,function(N,x,L){return O=(L=L.toLowerCase())=="x"?16:L=="b"?2:8,$&&$!=O?N:x}),$&&(O=$,k=k.replace(Oe,"$1").replace(ge,"0.$1")),S!=k))return new B(k,O);if(B.DEBUG)throw Error(c+"Not a"+($?" base "+$:"")+" number: "+S);b.c=b.e=b.s=null}},f.absoluteValue=f.abs=function(){var b=new B(this);return b.s<0&&(b.s=1),b},f.comparedTo=function(b,S){return H(this,new B(b,S))},f.decimalPlaces=f.dp=function(b,S){var T,$,O;if(b!=null)return P(b,0,y),S==null?S=I:P(S,0,8),_e(new B(this),b+this.e+1,S);if(!(T=this.c))return null;if($=((O=T.length-1)-R(this.e/g))*g,O=T[O])for(;O%10==0;O/=10,$--);return $<0&&($=0),$},f.dividedBy=f.div=function(b,S){return Q(this,new B(b,S),v,I)},f.dividedToIntegerBy=f.idiv=function(b,S){return Q(this,new B(b,S),0,1)},f.exponentiatedBy=f.pow=function(b,S){var T,$,O,k,N,x,L,D,V=this;if((b=new B(b)).c&&!b.isInteger())throw Error(c+"Exponent not an integer: "+be(b));if(S!=null&&(S=new B(S)),N=14<b.e,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!b.c||!b.c[0])return D=new B(Math.pow(+be(V),N?2-W(b):+be(b))),S?D.mod(S):D;if(x=b.s<0,S){if(S.c?!S.c[0]:!S.s)return new B(NaN);($=!x&&V.isInteger()&&S.isInteger())&&(V=V.mod(S))}else{if(9<b.e&&(0<V.e||V.e<-1||(V.e==0?1<V.c[0]||N&&24e7<=V.c[1]:V.c[0]<8e13||N&&V.c[0]<=9999975e7)))return k=V.s<0&&W(b)?-0:0,-1<V.e&&(k=1/k),new B(x?1/k:k);Z&&(k=l(Z/g+2))}for(L=N?(T=new B(.5),x&&(b.s=1),W(b)):(O=Math.abs(+be(b)))%2,D=new B(p);;){if(L){if(!(D=D.times(V)).c)break;k?D.c.length>k&&(D.c.length=k):$&&(D=D.mod(S))}if(O){if((O=u(O/2))===0)break;L=O%2}else if(_e(b=b.times(T),b.e+1,1),14<b.e)L=W(b);else{if((O=+be(b))==0)break;L=O%2}V=V.times(V),k?V.c&&V.c.length>k&&(V.c.length=k):$&&(V=V.mod(S))}return $?D:(x&&(D=p.div(D)),S?D.mod(S):k?_e(D,Z,I,void 0):D)},f.integerValue=function(b){var S=new B(this);return b==null?b=I:P(b,0,8),_e(S,S.e+1,b)},f.isEqualTo=f.eq=function(b,S){return H(this,new B(b,S))===0},f.isFinite=function(){return!!this.c},f.isGreaterThan=f.gt=function(b,S){return 0<H(this,new B(b,S))},f.isGreaterThanOrEqualTo=f.gte=function(b,S){return(S=H(this,new B(b,S)))===1||S===0},f.isInteger=function(){return!!this.c&&R(this.e/g)>this.c.length-2},f.isLessThan=f.lt=function(b,S){return H(this,new B(b,S))<0},f.isLessThanOrEqualTo=f.lte=function(b,S){return(S=H(this,new B(b,S)))===-1||S===0},f.isNaN=function(){return!this.s},f.isNegative=function(){return this.s<0},f.isPositive=function(){return 0<this.s},f.isZero=function(){return!!this.c&&this.c[0]==0},f.minus=function(b,S){var T,$,O,k,N=this,x=N.s;if(S=(b=new B(b,S)).s,!x||!S)return new B(NaN);if(x!=S)return b.s=-S,N.plus(b);var L=N.e/g,D=b.e/g,V=N.c,ee=b.c;if(!L||!D){if(!V||!ee)return V?(b.s=-S,b):new B(ee?N:NaN);if(!V[0]||!ee[0])return ee[0]?(b.s=-S,b):new B(V[0]?N:I==3?-0:0)}if(L=R(L),D=R(D),V=V.slice(),x=L-D){for((O=(k=x<0)?(x=-x,V):(D=L,ee)).reverse(),S=x;S--;O.push(0));O.reverse()}else for($=(k=(x=V.length)<(S=ee.length))?x:S,x=S=0;S<$;S++)if(V[S]!=ee[S]){k=V[S]<ee[S];break}if(k&&(O=V,V=ee,ee=O,b.s=-b.s),0<(S=($=ee.length)-(T=V.length)))for(;S--;V[T++]=0);for(S=d-1;x<$;){if(V[--$]<ee[$]){for(T=$;T&&!V[--T];V[T]=S);--V[T],V[$]+=d}V[$]-=ee[$]}for(;V[0]==0;V.splice(0,1),--D);return V[0]?qe(b,V,D):(b.s=I==3?-1:1,b.c=[b.e=0],b)},f.modulo=f.mod=function(b,S){var T,$,O=this;return b=new B(b,S),!O.c||!b.s||b.c&&!b.c[0]?new B(NaN):!b.c||O.c&&!O.c[0]?new B(O):(ue==9?($=b.s,b.s=1,T=Q(O,b,0,3),b.s=$,T.s*=$):T=Q(O,b,0,ue),(b=O.minus(T.times(b))).c[0]||ue!=1||(b.s=O.s),b)},f.multipliedBy=f.times=function(b,S){var T,$,O,k,N,x,L,D,V,ee,ae,ve,He,Ge,$e,Ee=this,Ye=Ee.c,Tt=(b=new B(b,S)).c;if(!(Ye&&Tt&&Ye[0]&&Tt[0]))return!Ee.s||!b.s||Ye&&!Ye[0]&&!Tt||Tt&&!Tt[0]&&!Ye?b.c=b.e=b.s=null:(b.s*=Ee.s,Ye&&Tt?(b.c=[0],b.e=0):b.c=b.e=null),b;for($=R(Ee.e/g)+R(b.e/g),b.s*=Ee.s,(L=Ye.length)<(ee=Tt.length)&&(He=Ye,Ye=Tt,Tt=He,O=L,L=ee,ee=O),O=L+ee,He=[];O--;He.push(0));for(Ge=d,$e=C,O=ee;0<=--O;){for(T=0,ae=Tt[O]%$e,ve=Tt[O]/$e|0,k=O+(N=L);O<k;)T=((D=ae*(D=Ye[--N]%$e)+(x=ve*D+(V=Ye[N]/$e|0)*ae)%$e*$e+He[k]+T)/Ge|0)+(x/$e|0)+ve*V,He[k--]=D%Ge;He[k]=T}return T?++$:He.splice(0,1),qe(b,He,$)},f.negated=function(){var b=new B(this);return b.s=-b.s||null,b},f.plus=function(b,S){var T,$=this,O=$.s;if(S=(b=new B(b,S)).s,!O||!S)return new B(NaN);if(O!=S)return b.s=-S,$.minus(b);var k=$.e/g,N=b.e/g,x=$.c,L=b.c;if(!k||!N){if(!x||!L)return new B(O/0);if(!x[0]||!L[0])return L[0]?b:new B(x[0]?$:0*O)}if(k=R(k),N=R(N),x=x.slice(),O=k-N){for((T=0<O?(N=k,L):(O=-O,x)).reverse();O--;T.push(0));T.reverse()}for((O=x.length)-(S=L.length)<0&&(T=L,L=x,x=T,S=O),O=0;S;)O=(x[--S]=x[S]+L[S]+O)/d|0,x[S]=d===x[S]?0:x[S]%d;return O&&(x=[O].concat(x),++N),qe(b,x,N)},f.precision=f.sd=function(b,S){var T,$,O;if(b!=null&&b!==!!b)return P(b,1,y),S==null?S=I:P(S,0,8),_e(new B(this),b,S);if(!(T=this.c))return null;if($=(O=T.length-1)*g+1,O=T[O]){for(;O%10==0;O/=10,$--);for(O=T[0];10<=O;O/=10,$++);}return b&&this.e+1>$&&($=this.e+1),$},f.shiftedBy=function(b){return P(b,-m,m),this.times("1e"+b)},f.squareRoot=f.sqrt=function(){var b,S,T,$,O,k=this,N=k.c,x=k.s,L=k.e,D=v+4,V=new B("0.5");if(x!==1||!N||!N[0])return new B(!x||x<0&&(!N||N[0])?NaN:N?k:1/0);if((T=(x=Math.sqrt(+be(k)))==0||x==1/0?(((S=E(N)).length+L)%2==0&&(S+="0"),x=Math.sqrt(+S),L=R((L+1)/2)-(L<0||L%2),new B(S=x==1/0?"1e"+L:(S=x.toExponential()).slice(0,S.indexOf("e")+1)+L)):new B(x+"")).c[0]){for((x=(L=T.e)+D)<3&&(x=0);;)if(O=T,T=V.times(O.plus(Q(k,O,D,1))),E(O.c).slice(0,x)===(S=E(T.c)).slice(0,x)){if(T.e<L&&--x,(S=S.slice(x-3,x+1))!="9999"&&($||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(_e(T,T.e+v+2,1),b=!T.times(T).eq(k));break}if(!$&&(_e(O,O.e+v+2,0),O.times(O).eq(k))){T=O;break}D+=4,x+=4,$=1}}return _e(T,T.e+v+1,I,b)},f.toExponential=function(b,S){return b!=null&&(P(b,0,y),b++),We(this,b,S,1)},f.toFixed=function(b,S){return b!=null&&(P(b,0,y),b=b+this.e+1),We(this,b,S)},f.toFormat=function(b,S,T){var $;if(T==null)b!=null&&S&&typeof S=="object"?(T=S,S=null):b&&typeof b=="object"?(T=b,b=S=null):T=Me;else if(typeof T!="object")throw Error(c+"Argument not an object: "+T);if($=this.toFixed(b,S),this.c){var O,k=$.split("."),N=+T.groupSize,x=+T.secondaryGroupSize,L=T.groupSeparator||"",D=k[0],V=k[1],ee=this.s<0,ae=ee?D.slice(1):D,ve=ae.length;if(x&&(O=N,N=x,ve-=x=O),0<N&&0<ve){for(O=ve%N||N,D=ae.substr(0,O);O<ve;O+=N)D+=L+ae.substr(O,N);0<x&&(D+=L+ae.slice(O)),ee&&(D="-"+D)}$=V?D+(T.decimalSeparator||"")+((x=+T.fractionGroupSize)?V.replace(new RegExp("\\d{"+x+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):V):D}return(T.prefix||"")+$+(T.suffix||"")},f.toFraction=function(b){var S,T,$,O,k,N,x,L,D,V,ee,ae,ve=this,He=ve.c;if(b!=null&&(!(x=new B(b)).isInteger()&&(x.c||x.s!==1)||x.lt(p)))throw Error(c+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+be(x));if(!He)return new B(ve);for(S=new B(p),D=T=new B(p),$=L=new B(p),ae=E(He),k=S.e=ae.length-ve.e-1,S.c[0]=w[(N=k%g)<0?g+N:N],b=!b||0<x.comparedTo(S)?0<k?S:D:x,N=K,K=1/0,x=new B(ae),L.c[0]=0;V=Q(x,S,0,1),(O=T.plus(V.times($))).comparedTo(b)!=1;)T=$,$=O,D=L.plus(V.times(O=D)),L=O,S=x.minus(V.times(O=S)),x=O;return O=Q(b.minus(T),$,0,1),L=L.plus(O.times(D)),T=T.plus(O.times($)),L.s=D.s=ve.s,ee=Q(D,$,k*=2,I).minus(ve).abs().comparedTo(Q(L,T,k,I).minus(ve).abs())<1?[D,$]:[L,T],K=N,ee},f.toNumber=function(){return+be(this)},f.toPrecision=function(b,S){return b!=null&&P(b,1,y),We(this,b,S,2)},f.toString=function(b){var S,T=this,$=T.s,O=T.e;return O===null?$?(S="Infinity",$<0&&(S="-"+S)):S="NaN":(S=b==null?O<=A||F<=O?j(E(T.c),O):G(E(T.c),O,"0"):b===10?G(E((T=_e(new B(T),v+O+1,I)).c),T.e,"0"):(P(b,2,Te.length,"Base"),q(G(E(T.c),O,"0"),10,b,$,!0)),$<0&&T.c[0]&&(S="-"+S)),S},f.valueOf=f.toJSON=function(){return be(this)},f._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(f[Symbol.toStringTag]="BigNumber",f[Symbol.for("nodejs.util.inspect.custom")]=f.valueOf),z!=null&&B.set(z),B}()).default=s.BigNumber=s,i!==void 0&&i.exports?i.exports=s:(r||(r=typeof self<"u"&&self?self:window),r.BigNumber=s)})(this)},{}],2:[function(t,i,o){i.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){var s=r%10;return~~(r%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,i,o){function r(R,E){return function(H){if(Array.isArray(H))return H}(R)||function(H,P){var W=[],j=!0,G=!1,Y=void 0;try{for(var z,Q=H[Symbol.iterator]();!(j=(z=Q.next()).done)&&(W.push(z.value),!P||W.length!==P);j=!0);}catch(q){G=!0,Y=q}finally{try{j||Q.return==null||Q.return()}finally{if(G)throw Y}}return W}(R,E)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(R){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},H=2<arguments.length?arguments[2]:void 0;if(typeof E=="string"&&(E=l.parseFormat(E)),!a.validateFormat(E))return"ERROR: invalid format";var P=E.prefix||"",W=E.postfix||"",j=function(G,Y,z){switch(Y.output){case"currency":return Y=y(Y,s.currentCurrencyDefaultFormat()),function(Te,B,We){var Ve=We.currentCurrency(),qe=Object.assign({},h,B),_e=void 0,be="",b=!!qe.totalLength||!!qe.forceAverage||qe.average,S=B.currencyPosition||Ve.position,T=B.currencySymbol||Ve.symbol;qe.spaceSeparated&&(be=" "),S==="infix"&&(_e=be+T+be);var $=C({instance:Te,providedFormat:B,state:We,decimalSeparator:_e});return S==="prefix"&&($=Te._value<0&&qe.negative==="sign"?"-".concat(be).concat(T).concat($.slice(1)):T+be+$),S&&S!=="postfix"||($=$+(be=b?"":be)+T),$}(G,Y,s);case"percent":return Y=y(Y,s.currentPercentageDefaultFormat()),function(Te,B,We,Ve){var qe=B.prefixSymbol,_e=C({instance:Ve(100*Te._value),providedFormat:B,state:We}),be=Object.assign({},h,B);return qe?"%".concat(be.spaceSeparated?" ":"").concat(_e):"".concat(_e).concat(be.spaceSeparated?" ":"","%")}(G,Y,s,z);case"byte":return Y=y(Y,s.currentByteDefaultFormat()),p=G,I=s,A=z,F=(v=Y).base||"binary",U=c[F],K=g(p._value,U.suffixes,U.scale),se=K.value,ue=K.suffix,Z=C({instance:A(se),providedFormat:v,state:I,defaults:I.currentByteDefaultFormat()}),Me=I.currentAbbreviations(),"".concat(Z).concat(Me.spaced?" ":"").concat(ue);case"time":return Y=y(Y,s.currentTimeDefaultFormat()),ge=G,fe=Math.floor(ge._value/60/60),st=Math.floor((ge._value-60*fe*60)/60),f=Math.round(ge._value-60*fe*60-60*st),"".concat(fe,":").concat(st<10?"0":"").concat(st,":").concat(f<10?"0":"").concat(f);case"ordinal":return Y=y(Y,s.currentOrdinalDefaultFormat()),Q=G,q=Y,de=(ne=s).currentOrdinal(),Se=Object.assign({},h,q),Xe=C({instance:Q,providedFormat:q,state:ne}),Oe=de(Q._value),"".concat(Xe).concat(Se.spaceSeparated?" ":"").concat(Oe);case"number":default:return C({instance:G,providedFormat:Y,numbro:z})}var Q,q,ne,de,Se,Xe,Oe,ge,fe,st,f,p,v,I,A,F,U,K,se,ue,Z,Me}(R,E,H);return j=(j=P+j)+W}function g(R,E,H){var P=E[0],W=Math.abs(R);if(H<=W){for(var j=1;j<E.length;++j){var G=Math.pow(H,j),Y=Math.pow(H,j+1);if(G<=W&&W<Y){P=E[j],R/=G;break}}P===E[0]&&(R/=Math.pow(H,E.length-1),P=E[E.length-1])}return{value:R,suffix:P}}function m(R){for(var E="",H=0;H<R;H++)E+="0";return E}function w(R,E){return R.toString().indexOf("e")!==-1?function(H,P){var W=H.toString(),j=r(W.split("e"),2),G=j[0],Y=j[1],z=r(G.split("."),2),Q=z[0],q=z[1],ne=q===void 0?"":q;if(0<+Y)W=Q+ne+m(Y-ne.length);else{var de=".";de=+Q<0?"-0".concat(de):"0".concat(de);var Se=(m(-Y-1)+Math.abs(Q)+ne).substr(0,P);Se.length<P&&(Se+=m(P-Se.length)),W=de+Se}return 0<+Y&&0<P&&(W+=".".concat(m(P))),W}(R,E):(Math.round(+"".concat(R,"e+").concat(E))/Math.pow(10,E)).toFixed(E)}function C(R){var E=R.instance,H=R.providedFormat,P=R.state,W=P===void 0?s:P,j=R.decimalSeparator,G=R.defaults,Y=G===void 0?W.currentDefaults():G,z=E._value;if(z===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(z))return z.toString();var Q,q,ne,de,Se,Xe,Oe,ge,fe=Object.assign({},h,Y,H),st=fe.totalLength,f=st?0:fe.characteristic,p=fe.optionalCharacteristic,v=fe.forceAverage,I=!!st||!!v||fe.average,A=st?-1:I&&H.mantissa===void 0?0:fe.mantissa,F=!st&&(H.optionalMantissa===void 0?A===-1:fe.optionalMantissa),U=fe.trimMantissa,K=fe.thousandSeparated,se=fe.spaceSeparated,ue=fe.negative,Z=fe.forceSign,Me=fe.exponential,Te="";if(I){var B=function(b){var S=b.value,T=b.forceAverage,$=b.abbreviations,O=b.spaceSeparated,k=O!==void 0&&O,N=b.totalLength,x=N===void 0?0:N,L="",D=Math.abs(S),V=-1;if(D>=Math.pow(10,12)&&!T||T==="trillion"?(L=$.trillion,S/=Math.pow(10,12)):D<Math.pow(10,12)&&D>=Math.pow(10,9)&&!T||T==="billion"?(L=$.billion,S/=Math.pow(10,9)):D<Math.pow(10,9)&&D>=Math.pow(10,6)&&!T||T==="million"?(L=$.million,S/=Math.pow(10,6)):(D<Math.pow(10,6)&&D>=Math.pow(10,3)&&!T||T==="thousand")&&(L=$.thousand,S/=Math.pow(10,3)),L&&(L=(k?" ":"")+L),x){var ee=S.toString().split(".")[0];V=Math.max(x-ee.length,0)}return{value:S,abbreviation:L,mantissaPrecision:V}}({value:z,forceAverage:v,abbreviations:W.currentAbbreviations(),spaceSeparated:se,totalLength:st});z=B.value,Te+=B.abbreviation,st&&(A=B.mantissaPrecision)}if(Me){var We=(q=(Q={value:z,characteristicPrecision:f}).value,ne=Q.characteristicPrecision,de=ne===void 0?0:ne,Se=r(q.toExponential().split("e"),2),Xe=Se[0],Oe=Se[1],ge=+Xe,de&&1<de&&(ge*=Math.pow(10,de-1),Oe=0<=(Oe=+Oe-(de-1))?"+".concat(Oe):Oe),{value:ge,abbreviation:"e".concat(Oe)});z=We.value,Te=We.abbreviation+Te}var Ve,qe,_e,be=function(b,S,T,$,O){if($===-1)return b;var k=w(S,$),N=r(k.toString().split("."),2),x=N[0],L=N[1],D=L===void 0?"":L;if(D.match(/^0+$/)&&(T||O))return x;var V=D.match(/0+$/);return O&&V?"".concat(x,".").concat(D.toString().slice(0,V.index)):k.toString()}(z.toString(),z,F,A,U);return be=function(b,S,T,$,O){var k=$.currentDelimiters(),N=k.thousands;O=O||k.decimal;var x=k.thousandsSize||3,L=b.toString(),D=L.split(".")[0],V=L.split(".")[1];return T&&(S<0&&(D=D.slice(1)),function(ee,ae){for(var ve=[],He=0,Ge=ee;0<Ge;Ge--)He===ae&&(ve.unshift(Ge),He=0),He++;return ve}(D.length,x).forEach(function(ee,ae){D=D.slice(0,ee+ae)+N+D.slice(ee+ae)}),S<0&&(D="-".concat(D))),L=V?D+O+V:D}(be=function(b,S,T,$){var O=b,k=r(O.toString().split("."),2),N=k[0],x=k[1];if(N.match(/^-?0$/)&&T)return x?"".concat(N.replace("0",""),".").concat(x):N.replace("0","");if(N.length<$)for(var L=$-N.length,D=0;D<L;D++)O="0".concat(O);return O.toString()}(be,0,p,f),z,K,W,j),(I||Me)&&(be=be+Te),(Z||z<0)&&(Ve=be,_e=ue,be=(qe=z)===0?Ve:+Ve==0?Ve.replace("-",""):0<qe?"+".concat(Ve):_e==="sign"?Ve:"(".concat(Ve.replace("-",""),")")),be}function y(R,E){if(!R)return E;var H=Object.keys(R);return H.length===1&&H[0]==="output"?E:R}i.exports=function(R){return{format:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return d.apply(void 0,H.concat([R]))},getByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(W){var j=c.general;return g(W._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},getBinaryByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(W){var j=c.binary;return g(W._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},getDecimalByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(W){var j=c.decimal;return g(W._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,i,o){var r=t("./en-US"),s=t("./validating"),a=t("./parsing"),l={},u=void 0,c={},h=null,d={};function g(w){u=w}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(w){w=a.parseFormat(w),s.validateFormat(w)&&(d=w)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(w){return h=typeof w=="string"?w:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(w){if(w){if(c[w])return c[w];throw new Error('Unknown tag "'.concat(w,'"'))}return m()},l.registerLanguage=function(w){var C=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(w))throw new Error("Invalid language data");c[w.languageTag]=w,C&&g(w.languageTag)},l.setLanguage=function(w){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:r.languageTag;if(!c[w]){var y=w.split("-")[0],R=Object.keys(c).find(function(E){return E.split("-")[0]===y});return c[R]?void g(R):void g(C)}g(w)},l.registerLanguage(r),u=r.languageTag,i.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,i,o){i.exports=function(r){return{loadLanguagesInNode:function(s){return a=r,void s.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,i,o){var r=t("bignumber.js");function s(a,l,u){var c=new r(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new r(h),a._value=c.minus(h).toNumber(),a}i.exports=function(a){return{add:function(l,u){return h=u,d=a,g=new r((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new r(m),c._value=g.plus(m).toNumber(),c;var c,h,d,g,m},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,g=new r((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new r(m),c._value=g.times(m).toNumber(),c;var c,h,d,g,m},divide:function(l,u){return h=u,d=a,g=new r((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new r(m),c._value=g.dividedBy(m).toNumber(),c;var c,h,d,g,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(t,i,o){function r(C,y){for(var R=0;R<y.length;R++){var E=y[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(C,E.key,E)}}var s=t("./globalState"),a=t("./validating"),l=t("./loading")(w),u=t("./unformatting"),c=t("./formatting")(w),h=t("./manipulating")(w),d=t("./parsing"),g=function(){function C(E){(function(H,P){if(!(H instanceof P))throw new TypeError("Cannot call a class as a function")})(this,C),this._value=E}var y,R;return y=C,(R=[{key:"clone",value:function(){return w(this._value)}},{key:"format",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,E)}},{key:"formatCurrency",value:function(E){return typeof E=="string"&&(E=d.parseFormat(E)),(E=c.formatOrDefault(E,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,E)}},{key:"formatTime",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return E.output="time",c.format(this,E)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(E){return h.difference(this,E)}},{key:"add",value:function(E){return h.add(this,E)}},{key:"subtract",value:function(E){return h.subtract(this,E)}},{key:"multiply",value:function(E){return h.multiply(this,E)}},{key:"divide",value:function(E){return h.divide(this,E)}},{key:"set",value:function(E){return h.set(this,m(E))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(y.prototype,R),C}();function m(C){var y=C;return w.isNumbro(C)?y=C._value:typeof C=="string"?y=w.unformat(C):isNaN(C)&&(y=NaN),y}function w(C){return new g(m(C))}w.version="2.1.2",w.isNumbro=function(C){return C instanceof g},w.language=s.currentLanguage,w.registerLanguage=s.registerLanguage,w.setLanguage=s.setLanguage,w.languages=s.languages,w.languageData=s.languageData,w.zeroFormat=s.setZeroFormat,w.defaultFormat=s.currentDefaults,w.setDefaults=s.setDefaults,w.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,w.validate=a.validate,w.loadLanguagesInNode=l.loadLanguagesInNode,w.unformat=u.unformat,i.exports=w},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,i,o){i.exports={parseFormat:function(r){var s,a,l,u,c,h,d,g,m,w,C,y,R,E,H,P,W,j,G,Y,z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof r!="string"?r:(a=z,r=(l=(s=r).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=z,function(Q,q){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(q.output="byte",q.base="general"):Q.indexOf("b")!==-1?(q.output="byte",q.base="binary"):Q.indexOf("d")!==-1?(q.output="byte",q.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(q.output="ordinal"):q.output="time";q.output="percent"}else q.output="currency"}(r=(h=(u=r).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,z),d=z,(g=r.match(/[1-9]+[0-9]*/))&&(d.totalLength=+g[0]),m=z,(w=r.split(".")[0].match(/0+/))&&(m.characteristic=w[0].length),function(Q,q){if(Q.indexOf(".")!==-1){var ne=Q.split(".")[0];q.optionalCharacteristic=ne.indexOf("0")===-1}}(r,z),C=z,r.indexOf("a")!==-1&&(C.average=!0),R=z,(y=r).indexOf("K")!==-1?R.forceAverage="thousand":y.indexOf("M")!==-1?R.forceAverage="million":y.indexOf("B")!==-1?R.forceAverage="billion":y.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(Q,q){var ne=Q.split(".")[1];if(ne){var de=ne.match(/0+/);de&&(q.mantissa=de[0].length)}}(r,z),H=z,(E=r).match(/\[\.]/)?H.optionalMantissa=!0:E.match(/\./)&&(H.optionalMantissa=!1),P=z,r.indexOf(",")!==-1&&(P.thousandSeparated=!0),W=z,r.indexOf(" ")!==-1&&(W.spaceSeparated=!0),G=z,(j=r).match(/^\+?\([^)]*\)$/)&&(G.negative="parenthesis"),j.match(/^\+?-/)&&(G.negative="sign"),Y=z,r.match(/^\+/)&&(Y.forceSign=!0),z)}}},{}],9:[function(t,i,o){var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function w(C,y){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",E=3<arguments.length?arguments[3]:void 0,H=4<arguments.length?arguments[4]:void 0,P=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+C))return+C;var j="",G=C.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(G!==C)return-1*w(G,y,R,E,H,P,W);for(var Y=0;Y<r.length;Y++){var z=r[Y];if((j=C.replace(z.key,""))!==C)return w(j,y,R,E,H,P,W)*z.factor}if((j=C.replace("%",""))!==C)return w(j,y,R,E,H,P,W)/100;var Q=parseFloat(C);if(!isNaN(Q)){var q=E(Q);if(q&&q!=="."&&(j=C.replace(new RegExp("".concat(s(q),"$")),""))!==C)return w(j,y,R,E,H,P,W);var ne={};Object.keys(P).forEach(function(st){ne[P[st]]=st});for(var de=Object.keys(ne).sort().reverse(),Se=de.length,Xe=0;Xe<Se;Xe++){var Oe=de[Xe],ge=ne[Oe];if((j=C.replace(Oe,""))!==C){var fe=void 0;switch(ge){case"thousand":fe=Math.pow(10,3);break;case"million":fe=Math.pow(10,6);break;case"billion":fe=Math.pow(10,9);break;case"trillion":fe=Math.pow(10,12)}return w(j,y,R,E,H,P,W)*fe}}}}(function(w,C){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=w.replace(y,"");return R=(R=R.replace(new RegExp("([0-9])".concat(s(C.thousands),"([0-9])"),"g"),"$1$2")).replace(C.decimal,".")}(l,u,c),u,c,h,d,g,m)}i.exports={unformat:function(l,u){var c,h,d,g=t("./globalState"),m=g.currentDelimiters(),w=g.currentCurrency().symbol,C=g.currentOrdinal(),y=g.getZeroFormat(),R=g.currentAbbreviations(),E=void 0;if(typeof l=="string")E=function(H,P){if(!H.indexOf(":")||P.thousands===":")return!1;var W=H.split(":");if(W.length!==3)return!1;var j=+W[0],G=+W[1],Y=+W[2];return!isNaN(j)&&!isNaN(G)&&!isNaN(Y)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,w,C,y,R,u);else{if(typeof l!="number")return;E=l}if(E!==void 0)return E}}},{"./globalState":4}],10:[function(t,i,o){function r(m){return function(w){if(Array.isArray(w)){for(var C=0,y=new Array(w.length);C<w.length;C++)y[C]=w[C];return y}}(m)||function(w){if(Symbol.iterator in Object(w)||Object.prototype.toString.call(w)==="[object Arguments]")return Array.from(w)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(m){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(m)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,w){return w.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,w){return!w.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,w){return w.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,w,C){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(m).map(function(E){if(!w[E])return console.error("".concat(C," Invalid key: ").concat(E)),!1;var H=m[E],P=w[E];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!d(H,u,"[Validate ".concat(E,"]"),!0))return!1}else if(s(H)!==P.type)return console.error("".concat(C," ").concat(E,' type mismatched: "').concat(P.type,'" expected, "').concat(s(H),'" provided')),!1;if(P.restrictions&&P.restrictions.length)for(var W=P.restrictions.length,j=0;j<W;j++){var G=P.restrictions[j],Y=G.restriction,z=G.message;if(!Y(H,m))return console.error("".concat(C," ").concat(E," invalid value: ").concat(z)),!1}return P.restriction&&!P.restriction(H,m)?(console.error("".concat(C," ").concat(E," invalid value: ").concat(P.message)),!1):P.validValues&&P.validValues.indexOf(H)===-1?(console.error("".concat(C," ").concat(E," invalid value: must be among ").concat(JSON.stringify(P.validValues),', "').concat(H,'" provided')),!1):!(P.children&&!d(H,P.children,"[Validate ".concat(E,"]")))});return y||R.push.apply(R,r(Object.keys(w).map(function(E){var H=w[E];if(typeof H=="string"&&(H={type:H}),H.mandatory){var P=H.mandatory;if(typeof P=="function"&&(P=P(m)),P&&m[E]===void 0)return console.error("".concat(C,' Missing mandatory key "').concat(E,'"')),!1}return!0}))),R.reduce(function(E,H){return E&&H},!0)}function g(m){return d(m,u,"[Validate format]")}i.exports={validate:function(m,w){var C=h(m),y=g(w);return C&&y},validateFormat:g,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(VP);var JY=VP.exports;const ys=BA(JY),e2="numeric";function BP(n,e){if(On(n)){const t=e.numericFormat,i=t&&t.culture||"-",o=t&&t.pattern;if(typeof i<"u"&&!ys.languages()[i]){const r=i.replace("-",""),s=ys.allLanguages?ys.allLanguages[i]:ys[r];s&&ys.registerLanguage(s)}ys.setLanguage(i),n=ys(n).format(o||"0")}return n}function vy(n,e,t,i,o,r,s){let a=r;if(On(a)){const l=s.className||"",u=l.length?l.split(" "):[];a=BP(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}vr(n,e,t,i,o,a,s)}vy.RENDERER_TYPE=e2;const t2="password";function Cy(n,e,t,i,o,r,s){vr.apply(this,[n,e,t,i,o,r,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Nl(e,u)}Cy.RENDERER_TYPE=t2;const n2="select";function by(n,e,t,i,o,r,s){vr.apply(this,[n,e,t,i,o,r,s])}by.RENDERER_TYPE=n2;const i2="time";function yy(n,e,t,i,o,r,s){vr.apply(this,[n,e,t,i,o,r,s]),e.dir="ltr"}yy.RENDERER_TYPE=i2;function o2(){gi($l),gi(Qc),gi(my),gi(gy),gi(wy),gi(fy),gi(vy),gi(Cy),gi(by),gi(vr),gi(yy)}const r2="autocomplete";function jg(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,ZE(t,e)):ZE(t,e)(this.source):e(!0)}jg.VALIDATOR_TYPE=r2;function ZE(n,e){const t=n;return function(i){let o=!1;for(let r=0,s=i.length;r<s;r++)if(t===i[r]){o=!0;break}e(o)}}function s2(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const a2="date";function Sy(n,e){const t=vI(_P,this.instance);let i=n,o=!0;i==null&&(i="");let r=Je(i,this.dateFormat||t.defaultDateFormat,!0).isValid(),s=Je(new Date(i)).isValid()||r;if(this.allowEmpty&&i===""&&(s=!0,r=!0),s||(o=!1),!s&&r&&(o=!0),s&&!r)if(this.correctFormat===!0){const a=l2(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),o=!0}else o=!1;e(o)}Sy.VALIDATOR_TYPE=a2;function l2(n,e){const t=Je(s2(n)),i=Je(n,e),o=n.search(/[A-z]/g)>-1;let r;return t.isValid()&&t.format("x")===i.format("x")||!i.isValid()||o?r=t:r=i,r.format(e)}const u2="dropdown";function Ry(n,e){jg.apply(this,[n,e])}Ry.VALIDATOR_TYPE=u2;const c2="numeric";function Ey(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:On(n))}Ey.VALIDATOR_TYPE=c2;const h2=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],d2="time";function Ty(n,e){const t=this.timeFormat||"h:mm:ss a";let i=!0,o=n;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const r=/^\d{1,2}$/.test(o);r&&(o+=":00");const s=Je(o,h2,!0).isValid()?Je(o):Je(o,t);let a=s.isValid(),l=Je(o,t,!0).isValid()&&!r;if(this.allowEmpty&&o===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}Ty.VALIDATOR_TYPE=d2;function f2(){sl(jg),sl(Ry),sl(Sy),sl(Ey),sl(Ty)}const g2="autocomplete",m2={CELL_TYPE:g2,editor:cy,renderer:$l,validator:jg},p2="checkbox",w2={CELL_TYPE:p2,editor:HP,renderer:my},v2="date";function WP(n,e,t,i,o,r,s){$l.apply(this,[n,e,t,i,o,r,s])}WP.RENDERER_TYPE=v2;const C2="date",b2={CELL_TYPE:C2,editor:NP,renderer:WP,validator:Sy},y2="dropdown",S2={CELL_TYPE:y2,editor:dy,renderer:gy,validator:Ry},R2="handsontable",E2={CELL_TYPE:R2,editor:uy,renderer:wy},T2="numeric",M2={CELL_TYPE:T2,editor:DP,renderer:vy,validator:Ey,dataType:"number"},I2="password",P2={CELL_TYPE:I2,editor:LP,renderer:Cy,copyable:!1},O2="select",A2={CELL_TYPE:O2,editor:$P,renderer:by},x2="time",H2={CELL_TYPE:x2,editor:kP,renderer:yy,validator:Ty};function _2(){ki(m2),ki(w2),ki(b2),ki(S2),ki(E2),ki(M2),ki(P2),ki(A2),ki(SP),ki(H2)}function N2(n,e){jP(n,e),e.add(n)}function D2(n,e,t){jP(n,e),e.set(n,t)}function jP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(n,e,t){return(e=L2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L2(n){var e=$2(n,"string");return typeof e=="symbol"?e:e+""}function $2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function La(n,e){return n.get(UP(n,e))}function UP(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const QE=new Map([["plugin",vV],["cell-type",fP],["editor",wI],["renderer",TI],["validator",MI]]),k2="base",Mp=[];let lo=null;var Ss=new WeakMap,JE=new WeakSet;class nt{static get PLUGIN_KEY(){return k2}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){N2(this,JE),Da(this,"eventManager",new qi(this)),Da(this,"pluginName",null),Da(this,"pluginsInitializedCallbacks",[]),Da(this,"isPluginsReady",!1),Da(this,"enabled",!1),Da(this,"initialized",!1),D2(this,Ss,{}),pr(this,"hot",e,{writable:!1}),lo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const o=[];if(t.forEach(r=>{const[s,a]=r.split(":");if(!QE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);QE.get(s)(a)||o.push(` - ${a} (${s})`)}),o.length>0){const r=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");Mp.push(r)}}if(lo||(lo=EI()),lo.indexOf("UndoRedo")>=0&&lo.splice(lo.indexOf("UndoRedo"),1),lo.indexOf(this.pluginName)>=0&&lo.splice(lo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),lo.length===0){if(Mp.length>0){const o=[`${Mp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,i){La(Ss,this)[e]=La(Ss,this)[e]||[];const o=La(Ss,this)[e];this.hot.addHook(e,t,i),o.push(t),La(Ss,this)[e]=o}removeHooks(e){M(La(Ss,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=La(Ss,this);Le(e,(t,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=UP(JE,this,F2).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Le(this,(t,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function F2(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function Rs(n,e,t){return(e=V2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function V2(n){var e=B2(n,"string");return typeof e=="symbol"?e:e+""}function B2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let zP=class{constructor(e){Rs(this,"hot",null),Rs(this,"container",null),Rs(this,"injected",!1),Rs(this,"rows",[]),Rs(this,"columns",[]),Rs(this,"samples",null),Rs(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,t=>{const{height:i}=t.table.getBoundingClientRect();e(t.row,Math.ceil(i)-1)})}getWidths(e){this.injected||this.injectTable(),M(this.columns,t=>{const{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{M(i.strings,o=>{t.appendChild(this.createColElement(o.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),i.appendChild(o)),this.samples.forEach(r=>{M(r.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");i.push([-1,o]),t.appendChild(o)}this.samples.forEach(o=>{M(o.strings,r=>{const s=r.col,a=e.createElement("th");i.push([s,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),M(i,o=>{const[r,s]=o;this.hot.view.appendColHeader(r,s)})}createCol(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(o=>{M(o.strings,r=>{const s=r.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),r.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const i=this.hot.rootDocument.createElement("col");let o=0;t>=0&&e>=0&&(o=this.hot.getCellMeta(t,e).colspan);let r=this.hot.getColWidth(e);if(o>1)for(let s=e+1;s<e+o;s++)r+=this.hot.getColWidth(s);return i.style.width=`${r}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("table"),r=t.createElement("thead"),s=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&o.appendChild(a),this.isHorizontal()&&(l.appendChild(u),r.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(r),this.isVertical()&&s.appendChild(l),o.appendChild(s),X(o,e),i.appendChild(o),{fragment:i,table:o,tHead:r,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("div"),r=`htGhostTable htAutoSize ${e.trim()}`;return X(o,r),i.appendChild(o),{fragment:i,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function od(n,e,t){return(e=W2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W2(n){var e=j2(n,"string");return typeof e=="symbol"?e:e+""}function j2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ug{static get SAMPLE_COUNT(){return 3}constructor(e){od(this,"samples",null),od(this,"dataFactory",null),od(this,"customSampleCount",null),od(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ug.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,i){const o=new Map,{from:r,to:s}=typeof i=="number"?{from:i,to:i}:i;return me(r,s,a=>{const l=this.generateSample(e,t,a);o.set(a,l)}),o}generateSample(e,t,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,r=e==="row"?"col":"row",s=[];return me(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:De(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Bt(u).length}`,o.has(d)||o.set(d,{needed:this.getSampleCount(),strings:[]});const g=o.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[r]:a}),s.push(u),g.needed-=1)}),o}}function U2(n,e){GP(n,e),e.add(n)}function e0(n,e,t){GP(n,e),e.set(n,t)}function GP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fu(n,e,t){return(e=z2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z2(n){var e=G2(n,"string");return typeof e=="symbol"?e:e+""}function G2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qs(n,e){return n.get(To(n,e))}function My(n,e,t){return n.set(To(n,e),t),t}function To(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("modifyAutoColumnSizeSeed");const gu="autoColumnSize",Y2=10,K2="autoColumnSize";var al=new WeakMap,Al=new WeakMap,er=new WeakSet;class Ju extends nt{static get PLUGIN_KEY(){return gu}static get PLUGIN_PRIORITY(){return Y2}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),U2(this,er),fu(this,"ghostTable",new zP(this.hot)),fu(this,"samplesGenerator",new Ug((t,i)=>{const o=this.hot.toPhysicalRow(t),r=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(r))return!1;const s=this.hot.getCellMeta(t,i);let a="";s.spanned||(a=this.hot.getDataAtCell(t,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),fu(this,"inProgress",!1),fu(this,"measuredColumns",0),fu(this,"columnWidthsMap",new os),e0(this,al,[]),e0(this,Al,[]),this.hot.columnIndexMapper.registerMap(K2,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,i,o)=>To(er,this,t0).call(this,t,i,o))}isEnabled(){return this.hot.getSettings()[gu]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[gu];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return To(er,e,Z2).call(e,...o)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return To(er,e,Q2).call(e,...o)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return To(er,e,eK).call(e,...o)}),this.addHook("beforeRender",()=>To(er,this,q2).call(this)),this.addHook("modifyColWidth",(i,o)=>this.getColumnWidth(o,i)),this.addHook("init",()=>To(er,this,J2).call(this)),super.enablePlugin()}updatePlugin(){My(Al,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,i)=>To(er,this,t0).call(this,e,t,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;me(o.from,o.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(s,r).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countCols()-1;let r=null;this.inProgress=!0;const s=()=>{if(!this.hot){Of(r),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Ju.CALCULATION_STEP,o)},e,t),i=i+Ju.CALCULATION_STEP+1,i<o?r=gC(s):(Of(r),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),i=a+1),i<o?s():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[gu],t=e&&_t(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&_t(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gu];let t=Ju.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return De(e)&&(t=e.syncLimit,$M(t)?t=yI(i,t):t>>=0),Math.min(t,i)}getColumnWidth(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=t;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof o=="number"&&(o=Math.max(o,_g))),o}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,o,r)=>{const s=qs(al,this).length;return(s-1<r||qs(al,this)[r]!==o)&&i.push(this.hot.toVisualColumn(r)),s-1<r?qs(al,this).push(o):qs(al,this)[r]=o,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function X2(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const i=this.hot.toPhysicalColumn(t);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(t,e).forEach((r,s)=>this.ghostTable.addColumn(s,r)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,i)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function q2(){this.calculateVisibleColumnsWidth(),this.inProgress||(To(er,this,X2).call(this,qs(Al,this)),My(Al,this,[]))}function Z2(n,e){e||this.recalculateAllColumnsWidth()}function Q2(n){const e=n.reduce((t,i)=>{let[,o]=i;const r=this.hot.propToCol(o);return Number.isInteger(r)&&t.indexOf(r)===-1&&t.push(r),t},[]);qs(Al,this).push(...e)}function t0(n,e,t){let i=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function J2(){My(al,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function eK(n){const e=n.reduce((t,i)=>{var o;const r=(o=i.address)===null||o===void 0?void 0:o.col;if(Number.isInteger(r)){const s=this.hot.toVisualColumn(r);t.indexOf(s)===-1&&t.push(s)}return t},[]);qs(Al,this).push(...e)}const Zs={horizontal:"horizontal",vertical:"vertical"};function tK(n,e,t){let i,o,r;return e[0]===n[0]&&e[1]<n[1]?(r="left",i=t(e[0],e[1]),o=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(r="right",i=t(e[0],n[3]+1),o=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(r="up",i=t(e[0],e[1]),o=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(r="down",i=t(n[2]+1,e[1]),o=t(e[2],e[3])),i&&i.normalize(),o&&o.normalize(),{directionOfDrag:r,startOfDragCoords:i,endOfDragCoords:o}}function nK(n){const e={};return n===!0?(e.directions=Object.keys(Zs),e.autoInsertRow=!0):De(n)?(ce(n.autoInsertRow)?n.direction===Zs.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,ce(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Zs)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function iK(n,e){oK(n,e),e.add(n)}function oK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(n,e,t){return(e=rK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rK(n){var e=sK(n,"string");return typeof e=="symbol"?e:e+""}function sK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("modifyAutofillRange");le.getSingleton().register("beforeAutofill");le.getSingleton().register("afterAutofill");const n0="autofill",aK=20,lK=["fillHandle"],uK="insert_row_below",cK=200;var ka=new WeakSet;class hK extends nt{constructor(){super(...arguments),iK(this,ka),$a(this,"addingStarted",!1),$a(this,"mouseDownOnCellCorner",!1),$a(this,"mouseDragOutside",!1),$a(this,"handleDraggedCells",0),$a(this,"directions",[]),$a(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return n0}static get PLUGIN_PRIORITY(){return aK}static get SETTING_KEYS(){return[n0,...lK]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>mu(ka,this,fK).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>mu(ka,this,dK).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>mu(ka,this,gK).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:o,col:r}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:o,endCol:r}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,i,o]=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.getSelectedRangeLast(),s=r.getTopStartCorner(),a=r.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,t),Math.max(a.row,i),Math.max(a.col,o)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=tK(l,u,(g,m)=>this.hot._createCellCoords(g,m));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),m=r.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",g,m,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=C;const R=C;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(y=[],c==="up"){const E=d.row-h.row+1,H=E%R.length;for(let P=0;P<E;P++)y.push(R[(P+(R.length-H))%R.length])}else{const E=d.col-h.col+1,H=E%R[0].length;for(let P=0;P<R.length;P++){y.push([]);for(let W=0;W<E;W++)y[P].push(R[P][(W+(R[P].length-H))%R[P].length])}}this.hot.populateFromArray(h.row,h.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,m,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner();let o=e;if(this.directions.includes(Zs.vertical)&&this.directions.includes(Zs.horizontal)){const r=t.getTopStartCorner();(i.col<=e.col||r.col>=e.col)&&(o=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||r.row>e.row)&&(o=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Zs.vertical))o=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Zs.horizontal))o=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(uK,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},cK)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),i=this.hot.countRows();let o;for(let r=e[2]+1;r<i;r++){for(let l=e[1];l<=e[3];l++){const u=t[r][l];if(!kt(u))return-1}const s=t[r][e[1]-1],a=t[r][e[3]+1];(!kt(s)||!kt(a))&&(o=r)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,i=rn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Wt(this.hot.table),o=rn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Ct(this.hot.table);return e.clientY>i&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>mu(ka,this,mK).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>mu(ka,this,pK).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=nK(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function dK(){this.selectAdjacent()&&this.fillIn()}function fK(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function gK(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function mK(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function pK(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function wK(n,e){YP(n,e),e.add(n)}function vK(n,e,t){YP(n,e),e.set(n,t)}function YP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(n,e,t){return(e=CK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CK(n){var e=bK(n,"string");return typeof e=="symbol"?e:e+""}function bK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function yK(n,e,t){return n.set(Mo(n,e),t),t}function Iy(n,e){return n.get(Mo(n,e))}function Mo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const rd="autoRowSize",SK=40,RK="autoRowSize";var Mc=new WeakMap,tr=new WeakSet;class ec extends nt{static get PLUGIN_KEY(){return rd}static get PLUGIN_PRIORITY(){return SK}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),wK(this,tr),Fa(this,"headerHeight",null),Fa(this,"ghostTable",new zP(this.hot)),Fa(this,"samplesGenerator",new Ug((t,i)=>{const o=this.hot.toPhysicalRow(t),r=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(r)||t>=0&&i>=0&&this.hot.getCellMeta(t,i).hidden)return!1;let s;return t>=0?s=this.hot.getDataAtCell(t,i):t===-1&&(s=this.hot.getColHeader(i)),{value:s}})),Fa(this,"inProgress",!1),Fa(this,"measuredRows",0),Fa(this,"rowHeightsMap",new os),vK(this,Mc,[]),this.hot.rowIndexMapper.registerMap(RK,this.rowHeightsMap),this.addHook("beforeRowResize",(t,i,o)=>Mo(tr,this,i0).call(this,t,i,o))}isEnabled(){const e=this.hot.getSettings()[rd];return e===!0||De(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Mo(tr,e,MK).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Mo(tr,e,IK).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Mo(tr,e,OK).call(e,...i)}),this.addHook("beforeRender",()=>Mo(tr,this,TK).call(this)),this.addHook("modifyRowHeight",(t,i)=>this.getRowHeight(i,t)),this.addHook("init",()=>Mo(tr,this,PK).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,i)=>Mo(tr,this,i0).call(this,e,t,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,r);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(o.from,o.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,r).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countRows()-1;let r=null;this.inProgress=!0;const s=()=>{if(!this.hot){Of(r),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+ec.CALCULATION_STEP,o)},e,t),i=i+ec.CALCULATION_STEP+1,i<o?r=gC(s):(Of(r),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),i=a+1),i<o?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[rd],t=e&&_t(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&_t(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[rd];let t=ec.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return De(e)&&(t=e.syncLimit,$M(t)?t=yI(i,t):t>>=0),Math.min(t,i)}getRowHeight(e,t){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return i!==null&&i>(t||0)&&(o=i),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(t,i),Math.max(t,i),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function EK(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((o,r)=>this.ghostTable.addRow(r,o))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,i)=>{const o=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function TK(){this.calculateVisibleRowsHeight(),this.inProgress||(Mo(tr,this,EK).call(this,Iy(Mc,this)),yK(Mc,this,[]))}function i0(n,e,t){let i=n;return t&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function MK(n,e){e||this.recalculateAllRowsHeight()}function IK(n){const e=n.reduce((t,i)=>{let[o]=i;return t.indexOf(o)===-1&&t.push(o),t},[]);Iy(Mc,this).push(...e)}function PK(){this.recalculateAllRowsHeight()}function OK(n){const e=n.reduce((t,i)=>{var o;const r=(o=i.address)===null||o===void 0?void 0:o.row;if(Number.isInteger(r)){const s=this.hot.toVisualRow(r);t.indexOf(s)===-1&&t.push(s)}return t},[]);Iy(Mc,this).push(...e)}const{getListWithInsertedItems:AK,getListWithRemovedItems:xK}=XI("physicallyIndexed");class HK extends ba{constructor(){super(e=>e)}insert(e,t){const i=UC(this.indexedValues,t);this.indexedValues=AK(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=xK(this.indexedValues,e);this.indexedValues=jC(t,e),super.remove(e)}}const{getListWithInsertedItems:_K,getListWithRemovedItems:NK}=XI("physicallyIndexed");class DK extends ba{constructor(){super(e=>e)}insert(e,t){this.indexedValues=_K(this.indexedValues,e,t,(i,o)=>this.getNextValue(o)),super.insert(e,t)}remove(e){this.indexedValues=NK(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function LK(n,e){$K(n,e),e.add(n)}function $K(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kK(n,e,t){return(e=FK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FK(n){var e=VK(n,"string");return typeof e=="symbol"?e:e+""}function VK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function BK(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ip="bindRowsWithHeaders",WK=210,jK="loose",UK=new Map([["loose",HK],["strict",DK]]);var o0=new WeakSet;class zK extends nt{constructor(){super(...arguments),LK(this,o0),kK(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Ip}static get PLUGIN_PRIORITY(){return WK}isEnabled(){return!!this.hot.getSettings()[Ip]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Ip];typeof e!="string"&&(e=jK);const t=UK.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",i=>BK(o0,this,GK).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function GK(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function YK(n,e){KP(n,e),e.add(n)}function KK(n,e,t){KP(n,e),e.set(n,t)}function KP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r0(n,e,t){return(e=XK(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XK(n){var e=qK(n,"string");return typeof e=="symbol"?e:e+""}function qK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function s0(n,e){return n.get(gl(n,e))}function Pp(n,e,t){return n.set(gl(n,e),t),t}function gl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const uf="collapsibleColumns",ZK=290,QK=["nestedHeaders"],vl="collapsibleIndicator",a0=uf,l0=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Va=new WeakMap,pu=new WeakSet;class JK extends nt{constructor(){super(...arguments),YK(this,pu),r0(this,"nestedHeadersPlugin",null),r0(this,"headerStateManager",null),KK(this,Va,null)}static get PLUGIN_KEY(){return uf}static get PLUGIN_PRIORITY(){return ZK}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[uf,...QK]}isEnabled(){return!!this.hot.getSettings()[uf]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||ot("You need to configure the Nested Headers plugin in order to use collapsible headers."),Pp(Va,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>gl(pu,this,n3).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return gl(pu,e,i3).call(e,...o)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return gl(pu,e,e3).call(e,...o)}),this.addHook("beforeOnCellMouseDown",(i,o,r)=>gl(pu,this,t3).call(this,i,o,r)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Pp(Va,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:r,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(t,i))!==null&&e!==void 0?e:{};if(o)return r?this.expandSection({row:t,col:s}):this.collapseSection({row:t,col:s}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:a0,relativeToGroup:rs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(a0)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,r=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=t.childNodes[s],l=i.childNodes[s],u=o?o.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${vl}`);r(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${vl}`),r(h)),o&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${vl}`),r(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(i=>{const{collapsible:o,origColspan:r,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(o===!0&&r>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!l0.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const i=Qr(e,g=>{let{row:m}=g;return m<0});let o=i.length>0;M(i,g=>{var m;let{row:w,col:C}=g;const{collapsible:y,isCollapsed:R}=(m=this.headerStateManager.getHeaderSettings(w,C))!==null&&m!==void 0?m:{};if(!y||R&&t==="collapse"||!R&&t==="expand")return o=!1,!1});const r=[],s=[];o&&M(i,g=>{let{row:m,col:w}=g;const{colspanCompensation:C,affectedColumns:y,rollbackModification:R}=this.headerStateManager.triggerNodeModification(t,m,w);C>0&&(s.push(...y),r.push(R))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=DM([...a,...s]):t==="expand"&&(l=Qr(a,g=>!s.includes(g)));const u=l0.get(t);if(this.hot.runHooks(u.beforeHook,a,l,o)===!1){M(r,g=>{g()});return}this.hot.batchExecution(()=>{M(s,g=>{s0(Va,this).setValueAtIndex(this.hot.toPhysicalColumn(g),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&h&&d){const{row:g,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const C=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,y=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;C!==null&&y!==null&&this.hot.selectCell(C,y)}}this.hot.runHooks(u.afterHook,a,l,o,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return s0(Va,this).getHiddenIndexes()}destroy(){Pp(Va,this,null),super.destroy()}}function e3(n,e,t){var i;const{collapsible:o,origColspan:r,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(t,n))!==null&&i!==void 0?i:{},a=o&&r>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${vl}`);if(_l(e,[Ri("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,vl),e.querySelector("div:first-child").appendChild(u)),Ie(u,["collapsed","expanded"]),s?(X(u,"collapsed"),ra(u,"+"),l&&ye(e,...Ri(!1))):(X(u,"expanded"),ra(u,"-"),l&&ye(e,...Ri(!0))),l&&ye(u,...Ca());else{var c;(c=u)===null||c===void 0||c.remove()}}function t3(n,e){Re(n.target,vl)&&(Re(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Re(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ji(n))}function n3(){this.updatePlugin()}function i3(n,e){e||this.updatePlugin()}function Es(n,e,t){return(e=o3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o3(n){var e=r3(n,"string");return typeof e=="symbol"?e:e+""}function r3(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const s3=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],a3=!1,l3=!0,u3=!0;class c3{constructor(e,t){Es(this,"hot",void 0),Es(this,"sortingStates",new $g),Es(this,"sortEmptyCells",a3),Es(this,"indicator",l3),Es(this,"headerAction",u3),Es(this,"compareFunctionFactory",void 0),Es(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&Le(e,(t,i)=>{s3.includes(i)&&(this[i]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[i,o]=t;return{column:this.hot.toVisualColumn(i),...o}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(ce(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function XP(n,e,t){const i=e.locale;return function(o,r){const{sortEmptyCells:s}=t;return typeof o=="string"&&(o=o.toLocaleLowerCase(i)),typeof r=="string"&&(r=r.toLocaleLowerCase(i)),o===r?_o:kt(o)?kt(r)?_o:s&&n==="asc"?xt:Ht:kt(r)?s&&n==="asc"?Ht:xt:isNaN(o)&&!isNaN(r)?n==="asc"?Ht:xt:!isNaN(o)&&isNaN(r)||(isNaN(o)||isNaN(r)||(o=parseFloat(o),r=parseFloat(r)),o<r)?n==="asc"?xt:Ht:o>r?n==="asc"?Ht:xt:_o}}const qP="default";function h3(n,e,t){return function(i,o){const r=parseFloat(i),s=parseFloat(o),{sortEmptyCells:a}=t;if(r===s||isNaN(r)&&isNaN(s))return _o;if(a){if(kt(i))return n==="asc"?xt:Ht;if(kt(o))return n==="asc"?Ht:xt}return isNaN(r)?Ht:isNaN(s)?xt:r<s?n==="asc"?xt:Ht:r>s?n==="asc"?Ht:xt:_o}}const d3="numeric";function f3(n,e,t){const i=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:r}=t;return function(s,a){const l=kt(s),u=kt(a),c=l?o:s,h=u?o:a,d=c===o||c===i,g=h===o||h===i;if(r===!1){if(l&&u===!1)return Ht;if(l===!1&&u)return xt}return d===!1&&g?n==="asc"?xt:Ht:d&&g===!1?n==="asc"?Ht:xt:d===!1&&g===!1?XP(n,e,t)(s,a):c===o&&h===i?n==="asc"?xt:Ht:c===i&&h===o?n==="asc"?Ht:xt:_o}}const g3="checkbox";function m3(n,e,t){return nO(n,e.dateFormat,t)}const p3="date";function w3(n,e,t){return nO(n,e.timeFormat,t)}const v3="time",{register:Jc,getItem:u0,hasItem:C3}=eo("sorting.compareFunctionFactory"),{register:ZP,getItem:b3}=eo("sorting.mainSortComparator");function QP(n){return C3(n)?u0(n):u0(qP)}Jc(g3,f3);Jc(p3,m3);Jc(qP,XP);Jc(d3,h3);Jc(v3,w3);const _o=0,xt=-1,Ht=1;function y3(n,e){const t=b3(e);for(var i=arguments.length,o=new Array(i>2?i-2:0),r=2;r<i;r++)o[r-2]=arguments[r];n.sort(t(...o))}const zf="asc",Gf="desc",JP="colHeader";function S3(n){if(De(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[zf,Gf].includes(t)}function R3(n){if(n.some(t=>S3(t)===!1))return!1;const e=n.map(t=>{let{column:i}=t;return i});return new Set(e).size===e.length}function c0(n){if(n!==Gf)return n===zf?Gf:zf}function eO(n){return n.querySelector(`.${JP}`)}function tO(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function Py(n,e,t){return n===-1&&e>=0&&sa(t)===!1}function nO(n,e,t){return function(i,o){const{sortEmptyCells:r}=t;if(i===o)return _o;if(kt(i))return kt(o)?_o:r&&n==="asc"?xt:Ht;if(kt(o))return r&&n==="asc"?Ht:xt;const s=Je(i,e),a=Je(o,e);return s.isValid()?a.isValid()?a.isAfter(s)?n==="asc"?xt:Ht:a.isBefore(s)?n==="asc"?Ht:xt:_o:xt:Ht}}const E3="ascending",T3="descending",iO="indicatorDisabled",oO="columnSorting",rO="sortAction",sO=new Map([[zf,E3],[Gf,T3]]);function M3(n,e,t,i){const o=[oO];if(i&&o.push(rO),t===!1)return o.push(iO),o;const r=n.getSortOrderOfColumn(e);return ce(r)&&o.push(sO.get(r)),o}function I3(){return Array.from(sO.values()).concat(rO,iO,oO)}function P3(n,e){return function(t,i){const[,...o]=t,[,...r]=i;return function(a){const l=n[a],u=e[a],c=o[a],h=r[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:QP(u.type))(l,u,d)(c,h)}(0)}}function O3(n,e){A3(n,e),e.add(n)}function A3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(n,e,t){return(e=x3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x3(n){var e=H3(n,"string");return typeof e=="symbol"?e:e+""}function H3(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ll(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Yf="columnSorting",_3=50,Kf="append",N3="replace",h0=Yf;ZP(Yf,P3);le.getSingleton().register("beforeColumnSort");le.getSingleton().register("afterColumnSort");var Ys=new WeakSet;class aO extends nt{constructor(){super(...arguments),O3(this,Ys),sd(this,"columnStatesManager",null),sd(this,"columnMetaCache",null),sd(this,"pluginKey",Yf),sd(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Yf}static get PLUGIN_PRIORITY(){return _3}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new c3(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new os(t=>{let i=this.hot.toVisualColumn(t);return i===null&&(i=t),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,i)=>ll(Ys,this,D3).call(this,t,i)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ll(Ys,e,$3).call(e,...i)}),this.addHook("afterOnCellMouseDown",(t,i)=>this.onAfterOnCellMouseDown(t,i)),this.addHook("afterInit",()=>ll(Ys,this,vv).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ll(Ys,e,L3).call(e,...i)}),this.hot.view&&ll(Ys,this,vv).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,i)=>{const o=eO(i);tO(t,i)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:rs,position:"before",group:h0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(h0)}sort(e){const t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",t,i,o)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new qI),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,o?i:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ce(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return R3(e)&&e.every(i=>{let{column:o}=i;return o<=t&&o>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),i=o=>{let{column:r,...s}=o;return{column:this.hot.toPhysicalColumn(r),...s}};t.initialConfig=Ue(e,i),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,i=o=>{let{column:r,...s}=o;return{column:this.hot.toVisualColumn(r),...s}};return ce(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Ue(t.initialConfig,i)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(ce(t)){const o=c0(t);return ce(o)?{column:e,sortOrder:o}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:c0()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kf;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=i!==-1,r=this.getSortConfig(),s=this.getColumnNextConfig(e);if(o){if(vt(s))return[...r.slice(0,i),...r.slice(i+1)];if(t===Kf)return[...r.slice(0,i),...r.slice(i+1),s];if(t===N3)return[...r.slice(0,i),s,...r.slice(i+1)]}return ce(s)?r.concat(s):r}getPluginColumnConfig(e){if(De(e)){const t=e[this.pluginKey];if(De(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(o);return Array.isArray(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns[e])):wt(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),i=Object.create(t);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],i=this.hot.countRows(),o=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(o(u)));const r=Ue(t,u=>u[0]);y3(t,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<i;u+=1)t.push([u].concat(o(u)));const s=Ue(t,u=>u[0]),a=new Map(Ue(r,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||De(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Ie(e,I3()),this.enabled!==!1){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];X(e,M3(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ce(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Re(e.target,JP)}onAfterOnCellMouseDown(e,t){if(Py(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const i=this.hot.getActiveEditor(),o=this.getColumnNextConfig(t.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(o)}):this.sort(o)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function vv(){const n=this.getAllSavedSortSettings();if(De(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function D3(n,e){const t=eO(e);if(tO(n,e)===!1||t===null)return;const i=this.getFirstCellSettings(n)[this.pluginKey],o=i.indicator,r=i.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,o,r),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(n);ye(e,...U$(s?`${s}ending`:"none"))}}function L3(n){n===!0&&this.hot.view&&ll(Ys,this,vv).call(this)}function $3(n,e,t,i){Py(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Ts(n,e,t){return(e=k3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k3(n){var e=F3(n,"string");return typeof e=="symbol"?e:e+""}function F3(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class V3{constructor(e,t){Ts(this,"plugin",void 0),Ts(this,"hot",void 0),Ts(this,"endpoints",[]),Ts(this,"settings",void 0),Ts(this,"settingsType","array"),Ts(this,"currentEndpoint",null),Ts(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),M(i,o=>{const r={};this.assignSetting(o,r,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,r,"reversedRowCoords",!1),this.assignSetting(o,r,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,r,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,r,"sourceColumn",o.destinationColumn),this.assignSetting(o,r,"type","sum"),this.assignSetting(o,r,"forceNumeric",!1),this.assignSetting(o,r,"suppressDataTypeErrors",!0),this.assignSetting(o,r,"customFunction",null),this.assignSetting(o,r,"readOnly",!0),this.assignSetting(o,r,"roundFloat",!1),t.push(r)}),t}assignSetting(e,t,i,o){if(i==="ranges"&&e[i]===void 0){t[i]=o;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(o instanceof Error)throw o;t[i]=o}else i==="destinationRow"&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",r=this.getAllEndpoints();M(r,s=>{o==="row"&&s.destinationRow>=t&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),o==="col"&&s.destinationColumn>=t&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(r,!1)}resetSetupAfterStructureAlteration(e,t,i,o,r){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=t;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,o[0],o.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,o){M(e.ranges,r=>{r[1]&&(t>=r[0]&&t<=r[1]?i>r[1]?r[1]+=o:i<r[0]&&(r[0]-=o):i>=r[0]&&i<=r[1]&&(r[1]-=o,t<=r[0]&&(r[0]+=1,r[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,i=[],o=[];M(t,r=>{const s=[];if(r[1])for(let a=r[0];a<=r[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(r[0]));o.push(s)}),M(o,r=>{let s=[];M(r,(a,l)=>{l===0?s.push(a):r[l]!==r[l-1]+1&&(s.push(r[l-1]),i.push(s),s=[],s.push(a)),l===r.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,i=>{M(i,(o,r)=>{o>=t&&(i[r]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const r=o.alterRowOffset||0,s=o.alterColumnOffset||0;return o.destinationRow+r>=this.hot.countRows()||o.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,o=>{this.resetEndpointValue(o,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],M(e,(i,o,r)=>{`${i[2]||""}`!=`${i[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(r[o][1])===s.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),M(t,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const i=this.hot.getCellMeta(t,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const s=this.hot.getCellMeta(r,e.destinationColumn);(t==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ot("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Op(n){return n==null||isNaN(n)}function B3(n,e){W3(n,e),e.add(n)}function W3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j3(n,e,t){return(e=U3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U3(n){var e=z3(n,"string");return typeof e=="symbol"?e:e+""}function z3(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ad(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ap="columnSummary",G3=220;var wu=new WeakSet;class Y3 extends nt{constructor(){super(...arguments),B3(this,wu),j3(this,"endpoints",null)}static get PLUGIN_KEY(){return Ap}static get PLUGIN_PRIORITY(){return G3}isEnabled(){return!!this.hot.getSettings()[Ap]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Ap],this.endpoints=new V3(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ad(wu,e,K3).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ad(wu,e,q3).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ad(wu,e,X3).call(e,...i)}),this.addHook("beforeCreateRow",(t,i,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,o)),this.addHook("beforeCreateCol",(t,i,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,o)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,i,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,o)),this.addHook("afterCreateCol",(t,i,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,o)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ad(wu,e,Z3).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return Le(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,o=e[1]||e[0],r=null,s=0;do{if(r=this.getCellValue(o,t),r=Op(r)?null:r,r!==null){const a=(`${r}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=r||0,o-=1}while(o>=e[0]);return Math.round(i*10**s)/10**s}calculateMinMax(e,t){let i=null;return Le(e.ranges,o=>{const r=this.getPartialMinMax(o,e.sourceColumn,t);if(i===null&&r!==null&&(i=r),r!==null)switch(t){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r);break}}),i===null?"Not enough data":i}getPartialMinMax(e,t,i){let o=null,r=e[1]||e[0],s;do{if(s=this.getCellValue(r,t),s=Op(s)?null:s,o===null)o=s;else if(s!==null)switch(i){case"min":o=Math.min(o,s);break;case"max":o=Math.max(o,s);break}r-=1}while(r>=e[0]);return o}countEmpty(e,t){let i,o=0,r=e[1]||e[0];do i=this.getCellValue(r,t),i=Op(i)?null:i,i===null&&(o+=1),r-=1;while(r>=e[0]);return o}countEntries(e){let t=0;const i=e.ranges;return Le(i,o=>{const r=o[1]===void 0?1:o[1]-o[0]+1,s=this.countEmpty(o,e.sourceColumn);t+=r,t-=s}),t}calculateAverage(e){const t=this.calculateSum(e),i=this.countEntries(e);return t/i}getCellValue(e,t){const i=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let r=this.hot.getSourceDataAtCell(e,t),s="";if(i!==null&&o!==null&&(s=this.hot.getCellMeta(i,o).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof r=="string"&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(rt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return r}}function K3(){this.endpoints.initEndpoints()}function X3(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function q3(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function Z3(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function Q3(n,e){lO(n,e),e.add(n)}function xp(n,e,t){lO(n,e),e.set(n,t)}function lO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ul(n,e){return n.get(Oy(n,e))}function Cv(n,e,t){return n.set(Oy(n,e),t),t}function Oy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xf=new WeakMap,ld=new WeakMap,ud=new WeakMap,d0=new WeakSet;class uO{constructor(){Q3(this,d0),xp(this,Xf,!0),xp(this,ld,null),xp(this,ud,new ResizeObserver(e=>Oy(d0,this,J3).call(this,e)))}setObservedElement(e){Cv(ld,this,e)}unobserve(){ul(ud,this).unobserve(ul(ld,this))}observe(){Cv(Xf,this,!0),ul(ud,this).observe(ul(ld,this))}destroy(){ul(ud,this).disconnect()}}function J3(n){if(ul(Xf,this)||!Array.isArray(n)||!n.length){Cv(Xf,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:i,blockSize:o}=t[0];this.runLocalHooks("resize",i,o)})}ht(uO,fn);function Ms(n,e,t){eX(n,e),e.set(n,t)}function eX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dt(n,e){return n.get(cO(n,e))}function Xo(n,e,t){return n.set(cO(n,e),t),t}function cO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Is=new WeakMap,Hp=new WeakMap,qo=new WeakMap,Ps=new WeakMap,yr=new WeakMap,cd=new WeakMap,Ba=new WeakMap;class Qs{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var i=this;Ms(this,Is,void 0),Ms(this,Hp,!1),Ms(this,qo,null),Ms(this,Ps,void 0),Ms(this,yr,void 0),Ms(this,cd,!0),Ms(this,Ba,new uO),Xo(Is,this,e),Xo(Hp,this,t),Xo(Ps,this,this.createEditor()),Xo(yr,this,dt(Ps,this).style),dt(Ba,this).setObservedElement(this.getInputElement()),dt(Ba,this).addLocalHook("resize",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.runLocalHooks("resize",...r)}),this.hide()}setPosition(e,t){dt(yr,this).left=`${e}px`,dt(yr,this).top=`${t}px`}setSize(e,t){if(e&&t){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${t}px`}}getSize(){return{width:Ct(this.getInputElement()),height:Wt(this.getInputElement())}}observeSize(){dt(Ba,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){dt(yr,this).display="block",Xo(cd,this,!1)}hide(){dt(Ba,this).unobserve(),dt(cd,this)||(dt(yr,this).display="none"),Xo(cd,this,!0)}isVisible(){return dt(yr,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return dt(Is,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=dt(Is,this).createElement("div"),t=dt(Is,this).createElement("textarea");return e.style.display="none",Xo(qo,this,dt(Is,this).createElement("div")),dt(qo,this).setAttribute("dir",dt(Hp,this)?"rtl":"ltr"),X(dt(qo,this),Qs.CLASS_EDITOR_CONTAINER),dt(Is,this).body.appendChild(dt(qo,this)),X(e,Qs.CLASS_EDITOR),X(t,Qs.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),dt(qo,this).appendChild(e),e}getInputElement(){return dt(Ps,this).querySelector(`.${Qs.CLASS_INPUT}`)}destroy(){const e=dt(qo,this)?dt(qo,this).parentNode:null;dt(Ps,this).parentNode.removeChild(dt(Ps,this)),Xo(Ps,this,null),Xo(yr,this,null),dt(Ba,this).destroy(),e&&e.removeChild(dt(qo,this))}}ht(Qs,fn);function _p(n,e,t){return(e=tX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tX(n){var e=nX(n,"string");return typeof e=="symbol"?e:e+""}function nX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const iX=250,oX=250;class hO{constructor(e){_p(this,"wasLastActionShow",!0),_p(this,"showDebounced",null),_p(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},oX)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iX;this.showDebounced=hC(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}ht(hO,fn);function rX(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function sX(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Os(n,e){const t={};return M(n,i=>{i.forAll((o,r)=>{o>=0&&r>=0&&(t[o]||(t[o]=[]),t[o][r]=e(o,r))})}),t}function _r(n,e,t,i,o){M(n,r=>{r.forAll((s,a)=>{s>=0&&a>=0&&aX(s,a,e,t,i,o)})})}function aX(n,e,t,i,o,r){const s=o(n,e);let a=i;s.className&&(t==="vertical"?a=rX(s.className,i):a=sX(s.className,i)),r(n,e,"className",a)}function ir(n){return`<span class="selected">â</span>${n}`}function tc(n,e){let t=!1;return Array.isArray(n)&&M(n,i=>(i.forAll((o,r)=>{if(o>=0&&r>=0&&e(o,r))return t=!0,!1}),t)),t}function zg(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:i}=e.defaultView,{top:o,left:r}=i.getBoundingClientRect();t.top=o,t.left=r}return t}function lX(n){return function(e,t){const i=this.getCellMeta(e,t).className;return i&&i.indexOf(n)!==-1}}function $n(n,e){return tc(n.getSelectedRange(),lX(e).bind(n))}const Ne="---------";function uX(){return{name:Ne}}const wi="alignment";function cX(){return{key:wi,name(){return this.getTranslatedPhrase(mb)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${wi}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(_f)},ariaChecked(){return $n(this,"htLeft")},name(){let n=this.getTranslatedPhrase(_f);return $n(this,"htLeft")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{key:`${wi}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Nf)},ariaChecked(){return $n(this,"htCenter")},name(){let n=this.getTranslatedPhrase(Nf);return $n(this,"htCenter")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{key:`${wi}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Df)},ariaChecked(){return $n(this,"htRight")},name(){let n=this.getTranslatedPhrase(Df);return $n(this,"htRight")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{key:`${wi}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Lf)},ariaChecked(){return $n(this,"htJustify")},name(){let n=this.getTranslatedPhrase(Lf);return $n(this,"htJustify")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{name:Ne},{key:`${wi}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase($f)},ariaChecked(){return $n(this,"htTop")},name(){let n=this.getTranslatedPhrase($f);return $n(this,"htTop")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{key:`${wi}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(kf)},ariaChecked(){return $n(this,"htMiddle")},name(){let n=this.getTranslatedPhrase(kf);return $n(this,"htMiddle")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1},{key:`${wi}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Ff)},ariaChecked(){return $n(this,"htBottom")},name(){let n=this.getTranslatedPhrase(Ff);return $n(this,"htBottom")&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=Os(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,n,t,i),_r(n,t,i,(o,r)=>this.getCellMeta(o,r),(o,r,s,a)=>this.setCellMeta(o,r,s,a)),this.render()},disabled:!1}]}}}const Gg="clear_column";function hX(){return{key:Gg,name(){return this.getTranslatedPhrase(tb)},callback(n,e){const t=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const eh="col_left";function dX(){return{key:eh,name(){return this.getTranslatedPhrase(XC)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const th="col_right";function fX(){return{key:th,name(){return this.getTranslatedPhrase(qC)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const nh="make_read_only";function gX(){return{key:nh,checkable:!0,ariaChecked(){return tc(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Hf)},name(){let n=this.getTranslatedPhrase(Hf);return tc(this.getSelectedRange(),(t,i)=>this.getCellMeta(t,i).readOnly)&&(n=ir(n)),n},callback(){const n=this.getSelectedRange(),e=tc(n,(t,i)=>this.getCellMeta(t,i).readOnly);M(n,t=>{t.forAll((i,o)=>{i>=0&&o>=0&&this.setCellMeta(i,o,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Yg="redo";function mX(){return{key:Yg,name(){return this.getTranslatedPhrase(eb)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ih="remove_col";function pX(){return{key:ih,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(QC,e)},callback(){this.alter("remove_col",HU(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Kg="remove_row";function wX(){return{key:Kg,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(ZC,e)},callback(){this.alter("remove_row",_U(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Xg="row_above";function vX(){return{key:Xg,name(){return this.getTranslatedPhrase(YC)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const qg="row_below";function CX(){return{key:qg,name(){return this.getTranslatedPhrase(KC)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Ic="no_items";function bX(){return{key:Ic,name(){return this.getTranslatedPhrase(GC)},disabled:!0,isCommand:!1}}const Zg="undo";function yX(){return{key:Zg,name(){return this.getTranslatedPhrase(JC)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const SX=[Xg,qg,eh,th,Gg,Kg,ih,Zg,Yg,nh,wi,Ne,Ic],RX={[Ne]:uX,[Ic]:bX,[Xg]:vX,[qg]:CX,[eh]:dX,[th]:fX,[Gg]:hX,[Kg]:wX,[ih]:pX,[Zg]:yX,[Yg]:mX,[nh]:gX,[wi]:cX};function dO(){const n={};return Le(RX,(e,t)=>{n[t]=e()}),n}function EX(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(db):this.getTranslatedPhrase(hb)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function TX(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(fb)},callback(){this.getSelectedRangeLast().forAll((t,i)=>{t>=0&&i>=0&&n.removeCommentAtCell(t,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function MX(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(gb);return tc(this.getSelectedRange(),(i,o)=>n.getCommentMeta(i,o,cf))?ir(e):e},callback(){this.getSelectedRangeLast().forAll((t,i)=>{if(t>=0&&i>=0){const o=!!n.getCommentMeta(t,i,cf);n.updateCommentMeta(t,i,{[cf]:!o})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function IX(n,e){fO(n,e),e.add(n)}function Wa(n,e,t){fO(n,e),e.set(n,t)}function fO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PX(n,e,t){return(e=OX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OX(n){var e=AX(n,"string");return typeof e=="symbol"?e:e+""}function AX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zr(n,e,t){return n.set(Vi(n,e),t),t}function Be(n,e){return n.get(Vi(n,e))}function Vi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const nc="comments",xX=60,or="comment",zu="value",gO="style",cf="readOnly",hd=nc,bv=`plugin:${nc}`;var gt=new WeakMap,So=new WeakMap,Qg=new WeakMap,hf=new WeakMap,yv=new WeakMap,qf=new WeakMap,uo=new WeakSet;class HX extends nt{constructor(){super(...arguments),IX(this,uo),PX(this,"range",{}),Wa(this,gt,null),Wa(this,So,null),Wa(this,Qg,!1),Wa(this,hf,!1),Wa(this,yv,null),Wa(this,qf,"")}static get PLUGIN_KEY(){return nc}static get PLUGIN_PRIORITY(){return xX}isEnabled(){return!!this.hot.getSettings()[nc]}enablePlugin(){var e=this;this.enabled||(Be(gt,this)||(zr(gt,this,new Qs(this.hot.rootDocument,this.hot.isRtl())),Be(gt,this).addLocalHook("resize",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Vi(uo,e,FX).call(e,...i)})),Be(So,this)||zr(So,this,new hO(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,i,o,r,s,a)=>Vi(uo,this,LX).call(this,t,a)),this.addHook("afterScroll",()=>Vi(uo,this,BX).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Vi(uo,this,VX).call(this,t)),Be(So,this).addLocalHook("hide",()=>this.hide()),Be(So,this).addLocalHook("show",(t,i)=>this.showAtCell(t,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Be(So,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),i=e.addContext(bv);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const o=this.hot.getSelectedRangeLast();zr(hf,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(o),this.show(),this.focusEditor(),e.setActiveContextName(bv),this.hot._registerTimeout(()=>{zr(hf,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&!Be(gt,this).isVisible()},group:hd}),i.addShortcut({keys:[["Escape"]],callback:()=>{Be(gt,this).setValue(Be(qf,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Be(gt,this).isVisible()&&Be(gt,this).isFocused(),group:hd}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Be(gt,this).isVisible()&&Be(gt,this).isFocused(),group:hd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hd)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Vi(uo,this,NX).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Vi(uo,this,_X).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Vi(uo,this,DX).call(this)),this.eventManager.addEventListener(t,"focus",()=>Vi(uo,this,kX).call(this)),this.eventManager.addEventListener(t,"blur",()=>Vi(uo,this,$X).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=oa(e.target,"TD","TBODY");return!!(t&&Re(t,"htCommentCell")&&oa(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=Be(gt,this).getValue();let i="";e!=null?i=e:t!=null&&(i=t);const o=this.range.from.row,r=this.range.from.col;this.updateCommentMeta(o,r,{[zu]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,or),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,zu)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,zu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:i}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Be(So,this).cancelHiding(),Be(gt,this).setValue((e=o[or]?o[or][zu]:null)!==null&&e!==void 0?e:""),Be(gt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){Be(gt,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Be(gt,this).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:r}=this.hot,{row:s,col:a}=this.range.from;let l=o.getRenderableFromVisualIndex(s),u=r.getRenderableFromVisualIndex(a);const c=l===null;Be(gt,this).setPosition(0,0),l===null&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,-1))),u===null&&(u=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:g,view:{_wt:m}}=this.hot,{wtTable:w}=m,C=m.getCell({row:l,col:u},!0),y=this.getCommentMeta(s,a,gO);y?Be(gt,this).setSize(y.width,y.height):Be(gt,this).resetSize();const R=d?0:w.getStretchedColumnWidth(u),E=c&&!h?Wt(C):0,{left:H,top:P,width:W,height:j}=C.getBoundingClientRect(),{width:G,height:Y}=Be(gt,this).getSize(),{innerWidth:z,innerHeight:Q}=this.hot.rootWindow,q=this.hot.rootDocument.documentElement;let ne=H+g.scrollX+R,de=P+g.scrollY+E;this.hot.isRtl()&&(ne-=G+R),this.hot.isLtr()&&H+W+G>z?ne=H+g.scrollX-G-1:this.hot.isRtl()&&ne<-(q.scrollWidth-q.clientWidth)&&(ne=H+g.scrollX+R+1),P+Y>Q&&(de-=Y-j+1),Be(gt,this).setPosition(ne,de),Be(gt,this).setReadOnlyState(this.getCommentMeta(s,a,cf)),Be(gt,this).observeSize()}focusEditor(){Be(gt,this).focus()}updateCommentMeta(e,t,i){const o=this.hot.getCellMeta(e,t)[or];let r;o?(r=xn(o),xg(r,i)):r=i,this.hot.setCellMeta(e,t,or,r)}getCommentMeta(e,t,i){const o=this.hot.getCellMeta(e,t);if(o[or])return o[or][i]}addToContextMenu(e){e.items.push({name:Ne},EX(this),TX(this),MX(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[nc];if(De(e))return e.displayDelay}getEditorInputElement(){return Be(gt,this).getInputElement()}destroy(){var e,t;(e=Be(gt,this))===null||e===void 0||e.destroy(),(t=Be(So,this))===null||t===void 0||t.destroy(),super.destroy()}}function _X(n){if(!(!this.hot.view||!this.hot.view._wt)&&!Be(Qg,this)&&!this.targetIsCommentTextArea(n)){const e=oa(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function NX(n){const{rootDocument:e}=this.hot;if(!(Be(Qg,this)||Be(gt,this).isFocused()||Re(n.target,"wtBorder")||Be(yv,this)===n.target||!Be(gt,this)))if(zr(yv,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));Be(So,this).show(t)}else ia(n.target,e)&&!this.targetIsCommentTextArea(n)&&Be(So,this).hide()}function DX(){zr(Qg,this,!1)}function LX(n,e){e[or]&&e[or][zu]&&X(n,e.commentedCellClassName)}function $X(){zr(qf,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function kX(){zr(qf,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(bv)}function FX(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[gO]:{width:n,height:e}})}function VX(n){Be(gt,this).isVisible()&&Ji(n)}function BX(){Be(hf,this)||this.hide()}var f0=Eg,WX=TypeError,jX=function(n,e){if(!delete n[e])throw new WX("Cannot delete property "+f0(e)+" of "+f0(n))},UX=dn,zX=kc,GX=Bc,YX=mM,KX=jX,XX=pM,qX=[].unshift(0)!==1,ZX=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},QX=qX||!ZX();UX({target:"Array",proto:!0,arity:1,forced:QX},{unshift:function(e){var t=zX(this),i=GX(t),o=arguments.length;if(o){XX(i+o);for(var r=i;r--;){var s=r+o;r in t?t[s]=t[r]:KX(t,s)}for(var a=0;a<o;a++)t[a]=arguments[a]}return YX(t,i+o)}});function Np(n,e,t){return(e=JX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JX(n){var e=eq(n,"string");return typeof e=="symbol"?e:e+""}function eq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mO{constructor(e){Np(this,"hot",void 0),Np(this,"commands",{}),Np(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];const r=e.split(":"),s=r[0],a=r.length===2?r[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=tq(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||_t(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(r.join(":")),M(u,c=>c.apply(this.hot,i))}}function tq(n,e){let t;return M(e,i=>{const o=i.key?i.key.split(":"):null;if(Array.isArray(o)&&o[1]===n)return t=i,!1}),t}function Dp(n,e,t){return(e=nq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nq(n){var e=iq(n,"string");return typeof e=="symbol"?e:e+""}function iq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Dp(this,"hot",void 0),Dp(this,"predefinedItems",dO()),Dp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,Le(e,(i,o)=>{let r="";i.name===Ne?(t[Ne]=i,r=Ne):isNaN(parseInt(o,10))?(i.key=i.key===void 0?o:i.key,t[o]=i,r=i.key):(t[i.key]=i,r=i.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return oq(e,this.defaultOrderPattern,this.predefinedItems)}}function oq(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let o=n;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),De(o)?Le(o,(r,s)=>{let a=t[typeof r=="string"?r:s];a||(a=r),De(r)?zt(a,r):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):M(o,(r,s)=>{let a=t[r];!a&&SX.indexOf(r)>=0||(a||(a={name:r,key:`${s}`}),De(r)&&zt(a,r),a.key===void 0&&(a.key=s),i.push(a))}),i}function Sr(n,e,t){return(e=rq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rq(n){var e=sq(n,"string");return typeof e=="symbol"?e:e+""}function sq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class aq{constructor(e,t){Sr(this,"top",void 0),Sr(this,"topRelative",void 0),Sr(this,"left",void 0),Sr(this,"leftRelative",void 0),Sr(this,"scrollTop",void 0),Sr(this,"scrollLeft",void 0),Sr(this,"cellHeight",void 0),Sr(this,"cellWidth",void 0);const i=t.scrollY,o=t.scrollX;let r,s,a,l,u,c;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(r=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=r,l=a,r+=i,a+=o):this.type==="event"&&(r=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=r-i,l=a-o),this.top=r,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function vu(n,e,t){lq(n,e),e.set(n,t)}function lq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(n,e){return n.get(wO(n,e))}function dd(n,e,t){return n.set(wO(n,e),t),t}function wO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Sn=new WeakMap,Rr=new WeakMap,kn=new WeakMap,Lp=new WeakMap,ja=new WeakMap;class uq{constructor(e){vu(this,Sn,void 0),vu(this,Rr,void 0),vu(this,kn,void 0),vu(this,Lp,!1),vu(this,ja,{above:0,below:0,left:0,right:0}),dd(Lp,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ze(ja,this)[e]=t,this}setElement(e){return dd(Sn,this,e),this}setParentElement(e){return dd(Rr,this,e),this}updatePosition(e){dd(kn,this,new aq(e,ze(Sn,this).ownerDocument.defaultView)),ze(Lp,this)?(ze(kn,this).fitsBelow(ze(Sn,this))?this.setPositionBelowCursor():ze(kn,this).fitsAbove(ze(Sn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ze(Sn,this).dir==="rtl"?ze(kn,this).fitsOnLeft(ze(Sn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ze(kn,this).fitsOnRight(ze(Sn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ze(ja,this).above+ze(kn,this).top-ze(Sn,this).offsetHeight;ze(Rr,this)&&(e=ze(kn,this).top+ze(kn,this).cellHeight-ze(Sn,this).offsetHeight+3),ze(Sn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ze(ja,this).below+ze(kn,this).top+1;ze(Rr,this)&&(e=ze(kn,this).top-1),ze(Sn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ze(kn,this).left;if(ze(Rr,this)){const t=Number.parseInt(getComputedStyle(ze(Rr,this).querySelector(".htCore")).borderRightWidth,10);e+=ze(kn,this).cellWidth+t}else e+=ze(ja,this).right;ze(Sn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ze(ja,this).left+ze(kn,this).left-ze(Sn,this).offsetWidth;if(ze(Rr,this)){const t=Number.parseInt(getComputedStyle(ze(Rr,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}ze(Sn,this).style.left=`${e}px`}}function vO(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:i=()=>{},onClear:o=()=>{}}=n;const r=new Set;let s=ut(e,-1,m()-1);function a(C,y){const R=m()-1;return C<0&&(C=R),C>R&&(C=0),r.has(C)?-1:(r.add(C),i(C,!1)===!1&&(C=a(y===1?++C:--C,y)),C)}function l(C){C>-1&&C<m()&&i(C,!0)!==!1&&(s=C)}function u(){return s}function c(){m()>0&&(r.clear(),s=a(0,1))}function h(){m()>0&&(r.clear(),s=a(m()-1,-1))}function d(){m()>0&&(r.clear(),s=a(++s,1))}function g(){m()>0&&(r.clear(),s=a(--s,-1))}function m(){return Math.max(t(),0)}function w(){r.clear(),s=e,o()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:m,clear:w}}function cq(n){return Ue(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Sv(n){return _t(n,"submenu")}function Rv(n){return new RegExp(Ne,"i").test(n.name)}function df(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function g0(n){return _t(n,"disableSelection")}function hq(n){return Re(n,"htSeparator")}function dq(n){return Re(n,"htSubmenu")}function fq(n){return Re(n,"htDisabled")}function gq(n){return Re(n,"htSelectionDisabled")}function mq(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function CO(n,e){const t=n.slice(0);for(let i=0;i<t.length&&t[i].name===e;)t.shift();return t}function pq(n,e){let t=n.slice(0);return t.reverse(),t=CO(t,e),t.reverse(),t}function wq(n){const e=[];return M(n,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function vq(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne,t=n.slice(0);return t=CO(t,e),t=pq(t,e),t=wq(t),t}function Cq(n){return n.checkable===!0}function bq(n){return vO({size:()=>n.countRows(),onItemSelect(e,t){const i=n.getCell(e,0);if(!i||hq(i)||fq(i)||gq(i))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function yq(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,o)=>{const r=e.getSettings(),s=typeof r.tabMoves=="function"?r.tabMoves(i):r.tabMoves;o.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=t.getSelectedLast();if(i){const o=n.openSubMenu(i[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const o=t.getSelectedLast();o&&(t.getSourceDataAtRow(o[0]).submenu?n.openSubMenu(o[0]).getNavigator().toFirstItem():(n.executeCommand(i),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const bO="menu",m0=bO;function Sq(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];i(yq(n)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;o(c,h)});function i(u,c){a(c).addShortcuts(u,{group:bO})}function o(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(m=>h.removeShortcutsByKeys(m))}),t.push({shortcuts:u,contextName:c}),i(u,c)}function r(){return[...t]}function s(u){return u?`${m0}:${u}`:m0}function a(u){var c;const h=n.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:o,getCustomShortcuts:r,getContext:a,listen:l}}function Rq(n){return(e,t,i,o,r,s)=>{const a=e.getSourceDataAtRow(i),l=n.rootDocument.createElement("div"),u=typeof s=="function"?s.call(n):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(No(t),X(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!df(a,n)&&!g0(a)&&!Rv(a);ye(t,[...Cq(a)?[D$(),If(c),UM(h)]:[N$(),If(u)],...d?[Hl(-1)]:[],...df(a,n)?[W$()]:[],...Sv(a)?[Ri(!1)]:[]])}t.className="",t.appendChild(l),Rv(a)?X(t,"htSeparator"):typeof a.renderer=="function"?(X(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,i,o,r,u))):Nl(l,u),df(a,n)?X(t,"htDisabled"):g0(a)?X(t,"htSelectionDisabled"):Sv(a)&&X(t,"htSubmenu")}}function $p(n,e,t){Eq(n,e),e.set(n,t)}function Eq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function co(n,e,t){return(e=Tq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tq(n){var e=Mq(n,"string");return typeof e=="symbol"?e:e+""}function Mq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kp(n,e,t){return n.set(yO(n,e),t),t}function As(n,e){return n.get(yO(n,e))}function yO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const p0=215;var Cu=new WeakMap,fd=new WeakMap,gd=new WeakMap;class kl{get tableBorderWidth(){return As(gd,this)===void 0&&this.hotMenu&&kp(gd,this,parseInt(dr(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),As(gd,this)}constructor(e,t){var i=this;co(this,"hot",void 0),co(this,"options",void 0),co(this,"eventManager",new qi(this)),co(this,"container",void 0),co(this,"positioner",void 0),co(this,"hotMenu",null),co(this,"hotSubMenus",{}),co(this,"parentMenu",void 0),co(this,"menuItems",null),co(this,"origOutsideClickDeselects",null),$p(this,Cu,void 0),$p(this,fd,void 0),$p(this,gd,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:p0,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new uq(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...r)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Sl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return As(Cu,this)}getKeyboardShortcutsCtrl(){return As(fd,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=hC(a=>this.openSubMenu(a),300),t=this.options.minWidth||p0;let i=!1,o=Qr(this.menuItems,a=>(a.key===Ic&&(i=!0),mq(a,this.hot)));if(o.length<1&&!i)o.push(dO()[Ic]);else if(o.length===0)return;o=vq(o,Ne);let r=!1;const s={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ce(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Rq(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{As(Cu,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>o[a].name===Ne?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),PR()&&r&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(r=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!PR()||!sa(a))&&r&&this.hasSelectedItem()&&(jr()||hI()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),kp(Cu,this,bq(this.hotMenu)),kp(fd,this,Sq(this)),As(fd,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(As(Cu,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const i=this.parentMenu.hotMenu.getCell(t[0],0);ye(i,[Ri(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!dq(t))return!1;const i=this.hotMenu.getSourceDataAtRow(e),o=new kl(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[i.key]=o,this.hot.getSettings().ariaTags&&ye(t,[Ri(!0)]),o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[t.key];if(i){i.destroy(),delete this.hotSubMenus[t.key];const o=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ye(o,[Ri(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const i=this.hot.getSelectedRange(),o=i?cq(i):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){return e.isCommand===!1||Rv(e)||df(e,this.hot)||Sv(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,i=e.hider.style,o=e.holder.style,r=parseInt(i.width,10),s=Hn(t,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?Wt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ne?1:h)},0);o.width=`${r+3}px`,o.height=`${s+3}px`,i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let i=e,o;return i&&(wt(i)&&(i=i.call(this.hot),i===null||vt(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,o=t.querySelector(`.${this.options.className}.${i}`)),o||(o=t.createElement("div"),X(o,`htMenu ${this.options.className}`),i&&X(o,i),this.options.container.appendChild(o)),o}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ye(this.hotMenu.rootElement,[_$(),Hl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ia(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ia(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Re(e.target,"htCore")&&ia(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ht(kl,fn);function Iq(n,e){Pq(n,e),e.add(n)}function Pq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fp(n,e,t){return(e=Oq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Oq(n){var e=Aq(n,"string");return typeof e=="symbol"?e:e+""}function Aq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function md(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Gu="contextMenu",xq=70,w0=Gu;le.getSingleton().register("afterContextMenuDefaultOptions");le.getSingleton().register("beforeContextMenuShow");le.getSingleton().register("afterContextMenuShow");le.getSingleton().register("afterContextMenuHide");le.getSingleton().register("afterContextMenuExecute");var bu=new WeakSet;class Jg extends nt{constructor(){super(...arguments),Iq(this,bu),Fp(this,"commandExecutor",new mO(this.hot)),Fp(this,"itemsFactory",null),Fp(this,"menu",null)}static get PLUGIN_KEY(){return Gu}static get PLUGIN_PRIORITY(){return xq}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Xg,qg,Ne,eh,th,Ne,Kg,ih,Ne,Zg,Yg,Ne,nh,Ne,wi]}isEnabled(){return!!this.hot.getSettings()[Gu]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Gu];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new kl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>md(bu,this,_q).call(this)),this.menu.addLocalHook("afterOpen",()=>md(bu,this,Nq).call(this)),this.menu.addLocalHook("afterClose",()=>md(bu,this,Dq).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",i=>md(bu,this,Hq).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=zg(this.menu.container,this.hot.rootDocument);this.open({left:t.left+i.left,top:t.top+i.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:w0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(w0)}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),Le(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new pO(this.hot,Jg.DEFAULT_ITEMS);const e=this.hot.getSettings()[Gu],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),M(i,o=>this.commandExecutor.registerCommand(o.key,o))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Hq(n){const e=this.hot.getSettings(),t=e.rowHeaders,i=e.colHeaders;function o(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const r=n.target;if(this.close(),Re(r,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||i)&&!o(r)&&!(Re(r,"current")&&Re(r,"wtBorder"))))return;const s=zg(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+s.top,left:n.clientX+s.left})}function _q(){this.hot.runHooks("beforeContextMenuShow",this)}function Nq(){this.hot.runHooks("afterContextMenuShow",this)}function Dq(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Jg.SEPARATOR={name:Ne};function Lq(n){return{key:"copy",name(){return this.getTranslatedPhrase(nb)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function $q(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(rb,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function kq(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ob,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Fq(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?ut(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ib,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Vq(n){return{key:"cut",name(){return this.getTranslatedPhrase(sb)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class Bq{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class Wq{constructor(){this.clipboardData=new Bq}preventDefault(){}}function jq(n,e){SO(n,e),e.add(n)}function Ua(n,e,t){SO(n,e),e.set(n,t)}function SO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(n,e){return n.get(ml(n,e))}function za(n,e,t){return n.set(ml(n,e),t),t}function ml(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Er=new WeakMap,Vp=new WeakMap,yu=new WeakMap,Ev=new WeakMap,Tv=new WeakMap,Su=new WeakMap,Ru=new WeakSet;class Uq{constructor(e){let{countRows:t,countColumns:i,rowsLimit:o,columnsLimit:r,countColumnHeaders:s}=e;jq(this,Ru),Ua(this,Er,void 0),Ua(this,Vp,void 0),Ua(this,yu,void 0),Ua(this,Ev,void 0),Ua(this,Tv,void 0),Ua(this,Su,void 0),za(Vp,this,t),za(yu,this,i),za(Ev,this,o),za(Tv,this,r),za(Su,this,s)}setSelectedRange(e){za(Er,this,e)}getCellsRange(){if(Tn(Vp,this).call(this)===0||Tn(yu,this).call(this)===0)return null;const{row:e,col:t}=Tn(Er,this).getTopStartCorner(),{row:i,col:o}=Tn(Er,this).getBottomEndCorner(),r=ml(Ru,this,zq).call(this,e,i),s=ml(Ru,this,Bp).call(this,t,o);return{isRangeTrimmed:i!==r||o!==s,startRow:e,startCol:t,endRow:r,endCol:s}}getMostBottomColumnHeadersRange(){if(Tn(yu,this).call(this)===0||Tn(Su,this).call(this)===0)return null;const{col:e}=Tn(Er,this).getTopStartCorner(),{col:t}=Tn(Er,this).getBottomEndCorner(),i=ml(Ru,this,Bp).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Tn(yu,this).call(this)===0||Tn(Su,this).call(this)===0)return null;const{col:e}=Tn(Er,this).getTopStartCorner(),{col:t}=Tn(Er,this).getBottomEndCorner(),i=ml(Ru,this,Bp).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-Tn(Su,this).call(this),startCol:e,endRow:-1,endCol:i}}}function Bp(n,e){return Math.min(e,Math.max(n+Tn(Tv,this).call(this)-1,n))}function zq(n,e){return Math.min(e,Math.max(n+Tn(Ev,this).call(this)-1,n))}function RO(n){const e=[],t=[];return M(n,i=>{const o=Math.min(i.startRow,i.endRow),r=Math.max(i.startRow,i.endRow);me(o,r,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);me(s,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function Gq(n,e){EO(n,e),e.add(n)}function Tr(n,e,t){EO(n,e),e.set(n,t)}function EO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eu(n,e,t){return(e=Yq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yq(n){var e=Kq(n,"string");return typeof e=="symbol"?e:e+""}function Kq(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jn(n,e){return n.get(Un(n,e))}function Fi(n,e,t){return n.set(Un(n,e),t),t}function Un(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("afterCopyLimit");le.getSingleton().register("modifyCopyableRange");le.getSingleton().register("beforeCut");le.getSingleton().register("afterCut");le.getSingleton().register("beforePaste");le.getSingleton().register("afterPaste");le.getSingleton().register("beforeCopy");le.getSingleton().register("afterCopy");const pd="copyPaste",Xq=80,qq=["fragmentSelection"],v0=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Mv=new WeakMap,Iv=new WeakMap,Pv=new WeakMap,Ga=new WeakMap,wd=new WeakMap,vd=new WeakMap,Ya=new WeakMap,Zf=new WeakMap,Jn=new WeakSet;class Zq extends nt{constructor(){super(...arguments),Gq(this,Jn),Eu(this,"columnsLimit",1/0),Eu(this,"rowsLimit",1/0),Eu(this,"pasteMode","overwrite"),Eu(this,"uiContainer",this.hot.rootDocument.body),Tr(this,Mv,!1),Tr(this,Iv,!1),Tr(this,Pv,!1),Tr(this,Ga,"cells-only"),Tr(this,wd,!1),Tr(this,vd,!1),Tr(this,Ya,new Uq({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Tr(this,Zf,!1),Eu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return pd}static get SETTING_KEYS(){return[pd,...qq]}static get PLUGIN_PRIORITY(){return Xq}isEnabled(){return!!this.hot.getSettings()[pd]}enablePlugin(){var e=this;if(this.enabled)return;const{[pd]:t}=this.hot.getSettings();if(typeof t=="object"){var i,o;this.pasteMode=(i=t.pasteMode)!==null&&i!==void 0?i:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Fi(Mv,this,!!t.copyColumnHeaders),Fi(Iv,this,!!t.copyColumnGroupHeaders),Fi(Pv,this,!!t.copyColumnHeadersOnly),this.uiContainer=(o=t.uiContainer)!==null&&o!==void 0?o:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",r=>Un(Jn,this,e9).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Un(Jn,e,t9).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Un(Jn,this,n9).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),uI()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Un(Jn,e,i9).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Un(Jn,e,o9).call(e,...s)}),this.addHook("afterSelection",()=>Un(Jn,this,r9).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Fi(Ga,this,e),Fi(wd,this,!0),Un(Jn,this,C0).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Fi(vd,this,!0),Un(Jn,this,C0).call(this,"cut")}getRangedCopyableData(e){return Qu(this.getRangedData(e))}getRangedData(e){const t=[],{rows:i,columns:o}=RO(e);return M(i,r=>{const s=[];M(o,a=>{r<0?s.push(this.hot.getColHeader(a,r)):s.push(this.hot.getCopyableData(r,a))}),t.push(s)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const i=new Wq;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}jn(Ya,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);jn(Ga,this)==="column-headers-only"?t.set("headers",jn(Ya,this).getMostBottomColumnHeadersRange()):(jn(Ga,this)==="with-column-headers"?t.set("headers",jn(Ya,this).getMostBottomColumnHeadersRange()):jn(Ga,this)==="with-column-group-headers"&&t.set("headers",jn(Ya,this).getAllColumnHeadersRange()),t.set("cells",jn(Ya,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(o=>o!==null).map(o=>{let{startRow:r,startCol:s,endRow:a,endCol:l}=o;return{startRow:r,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=t.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:o,startCol:r,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-o+1,a-r+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,o=e[0].length,r=[],{row:s,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;r.length<i||c<=l;){const{skipRowOnPaste:m,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,m===!0)continue;d=w,h=a;const C=[],y=r.length%i;for(;C.length<o||h<=u;){const{skipColumnOnPaste:R,visualCol:E}=this.hot.getCellMeta(s,h);if(h=E+1,R===!0)continue;g=E;const H=C.length%o;C.push(e[y][H])}r.push(C)}return Fi(Zf,this,!0),this.hot.populateFromArray(s,a,r,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),o=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!jn(wd,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(o&&e.target!==i||!o&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Fi(wd,this,!1);const r=this.getRangedData(this.copyableRanges),s=Un(Jn,this,Qq).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",r,this.copyableRanges,s)){const l=Qu(r);if(e&&e.clipboardData){const u=VR(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[v0,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",r,this.copyableRanges,s)}Fi(Ga,this,"cells-only")}onCut(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),o=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!jn(vd,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(o&&e.target!==i||!o&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),Fi(vd,this,!1);const r=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",r,this.copyableRanges)){const a=Qu(r);if(e&&e.clipboardData){const l=VR(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[v0,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",r,this.copyableRanges)}}onPaste(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),o=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(o&&e.target!==i||!o&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let r;if(e&&typeof e.clipboardData<"u"){const c=rC(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?r=aV(c,this.hot.rootDocument).data:r=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(r=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof r=="string"&&(r=kU(r)),r===void 0||r&&r.length===0||this.hot.runHooks("beforePaste",r,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(r);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",r,this.copyableRanges)}destroy(){super.destroy()}}function C0(n){if(uI()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:i}=e.highlight,o=this.hot.getCell(t,i,!0);o&&ck(o,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function Qq(n){const{rows:e}=RO(n);let t=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)t+=1;return{columnHeadersCount:t}}function Jq(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i&&eI(i)}}}function TO(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i!=null&&i.hasAttribute("contenteditable")&&tI(i)}}}function e9(n){n.items.push({name:"---------"},Lq(this)),jn(Mv,this)&&n.items.push(Fq(this)),jn(Iv,this)&&n.items.push(kq(this)),jn(Pv,this)&&n.items.push($q(this)),n.items.push(Vq(this))}function t9(n,e,t,i,o){jn(Zf,this)&&(o.value=!0),Fi(Zf,this,!1)}function n9(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function i9(){Un(Jn,this,TO).call(this)}function o9(){Un(Jn,this,Jq).call(this)}function r9(){Un(Jn,this,TO).call(this)}function MO(n,e){return`border_row${n}col${e}`}function Yu(){return{width:1,color:"#000"}}function lr(){return{hide:!0}}function s9(){return{width:1,color:"#000",cornerVisible:!1}}function Wp(n){if(ce(n.start)||ce(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(ce(n.end)||ce(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Tu(n){return ce(n.start)&&(n.left=n.start),ce(n.end)&&(n.right=n.end),n}function jp(n,e){return{id:MO(n,e),border:s9(),row:n,col:e,top:lr(),bottom:lr(),start:lr(),end:lr()}}function a9(n,e){return _t(e,"border")&&e.border&&(n.border=e.border),_t(e,"top")&&ce(e.top)&&(e.top?(De(e.top)||(e.top=Yu()),n.top=e.top):(e.top=lr(),n.top=e.top)),_t(e,"bottom")&&ce(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=Yu()),n.bottom=e.bottom):(e.bottom=lr(),n.bottom=e.bottom)),_t(e,"start")&&ce(e.start)&&(e.start?(De(e.start)||(e.start=Yu()),n.start=e.start):(e.start=lr(),n.start=e.start)),_t(e,"end")&&ce(e.end)&&(e.end?(De(e.end)||(e.end=Yu()),n.end=e.end):(e.end=lr(),n.end=e.end)),n}function fr(n,e){let t=!1;return M(n.getSelectedRange(),i=>{i.forAll((o,r)=>{if(o<0||r<0)return;const s=n.getCellMeta(o,r).borders;if(s)if(e){if(!_t(s[e],"hide")||s[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function em(n){return`<span class="selected">â</span>${n}`}function l9(n){return n.some(e=>ce(e.left)||ce(e.right))}function u9(n){return n.some(e=>ce(e.start)||ce(e.end))}const c9=new Map([["left","start"],["right","end"]]);function h9(n){var e;return(e=c9.get(n))!==null&&e!==void 0?e:n}function d9(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Cb);return fr(this,"bottom")&&(e=em(e)),e},callback(e,t){const i=fr(this,"bottom");n.prepareBorder(t,"bottom",i)}}}function f9(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(bb);return fr(this,e)&&(t=em(t)),t},callback(t,i){const o=fr(this,e);n.prepareBorder(i,e,o)}}}function g9(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(yb)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!fr(this)}}}function m9(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(vb);return fr(this,e)&&(t=em(t)),t},callback(t,i){const o=fr(this,e);n.prepareBorder(i,e,o)}}}function p9(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(wb);return fr(this,"top")&&(e=em(e)),e},callback(e,t){const i=fr(this,"top");n.prepareBorder(t,"top",i)}}}function w9(n,e){v9(n,e),e.add(n)}function v9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C9(n,e,t){return(e=b9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function b9(n){var e=y9(n,"string");return typeof e=="symbol"?e:e+""}function y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function b0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ff="customBorders",S9=90;var Up=new WeakSet;class R9 extends nt{constructor(){super(...arguments),w9(this,Up),C9(this,"savedBorders",[])}static get PLUGIN_KEY(){return ff}static get PLUGIN_PRIORITY(){return S9}isEnabled(){return!!this.hot.getSettings()[ff]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>b0(Up,this,E9).call(this,e)),this.addHook("init",()=>b0(Up,this,T9).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),o=Wp(t));const r=Tl(e),s=Rc(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(i,c=>{this.prepareBorderFromCustomAdded(l,u,o,h9(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Tl(e),i=Rc(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),o=[];return M(e,r=>{i(r).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&o.push(Tu(l))})})}),o}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,t,i,o){const r=this.hot.countRows(),s=this.hot.countCols();if(e>=r||t>=s)return;let a=jp(e,t);i&&(a=a9(a,i),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Tu(a)),this.insertBorderIntoSettings(a,o)}prepareBorderFromCustomAddedRange(e,t){const i=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,i,r=>{me(e.from.col,o,s=>{const a=jp(r,s);let l=0;r===e.from.row&&_t(t,"top")&&(l+=1,a.top=t.top),r===e.to.row&&_t(t,"bottom")&&(l+=1,a.bottom=t.bottom),s===e.from.col&&_t(t,"start")&&(l+=1,a.start=t.start),s===e.to.col&&_t(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(r,s,"borders",Tu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const i=MO(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,o){let r=this.hot.getCellMeta(e,t).borders;!r||r.border===void 0?r=jp(e,t):r=Wp(r),o?(r[i]=lr(),this.countHide(r)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(r,i,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",Tu(r)))):(r[i]=Yu(),this.checkCustomSelectionsFromContextMenu(r,i,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",Tu(r)))}prepareBorder(e,t,i){M(e,o=>{let{start:r,end:s}=o;if(r.row===s.row&&r.col===s.col)t==="noBorders"?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,i);else switch(t){case"noBorders":me(r.col,s.col,a=>{me(r.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(r.col,s.col,a=>{this.setBorder(r.row,a,t,i)});break;case"bottom":me(r.col,s.col,a=>{this.setBorder(s.row,a,t,i)});break;case"start":me(r.row,s.row,a=>{this.setBorder(a,r.col,t,i)});break;case"end":me(r.row,s.row,a=>{this.setBorder(a,s.col,t,i)});break}})}createCustomBorders(e){M(e,t=>{const i=Wp(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,i):this.prepareBorderFromCustomAdded(t.row,t.col,i)})}countHide(e){const{top:t,bottom:i,start:o,end:r}=e;return Hn([t,i,o,r],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=Ue(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=Ue(this.savedBorders,i=>i.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):M(this.savedBorders,(o,r)=>{if(e.id===o.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let o=!1;return M(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(r);return M(s,a=>{a.toggleHiddenClass(t,i)}),o=!0,!1}}),o}checkCustomSelections(e,t,i){const o=this.countHide(e);let r=!1;return o===4?(this.removeAllBorders(e.row,e.col),r=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=t,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(i,e)})}return r=!0,!1}}),r}changeBorderSettings(){const e=this.hot.getSettings()[ff];if(Array.isArray(e)){const t=xn(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=l9(e),i=u9(e);if(t&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function E9(n){this.hot.getSettings()[ff]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(pb)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[p9(this),m9(this),d9(this),f9(this),g9(this)]}})}function T9(){this.changeBorderSettings()}function M9(n,e){I9(n,e),e.add(n)}function I9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zp(n,e,t){return(e=P9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P9(n){var e=O9(n,"string");return typeof e=="symbol"?e:e+""}function O9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function y0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const S0="dragToScroll",A9=100;var Gp=new WeakSet;class x9 extends nt{constructor(){super(...arguments),M9(this,Gp),zp(this,"boundaries",null),zp(this,"callback",null),zp(this,"listening",!1)}static get PLUGIN_KEY(){return S0}static get PLUGIN_PRIORITY(){return A9}isEnabled(){return!!this.hot.getSettings()[S0]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>y0(Gp,this,R0).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>y0(Gp,this,R0).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",i=>this.onMouseMove(i)),t=Sl(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function R0(n){if(sa(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var o,r;const s=(o=e.scrollLeft)!==null&&o!==void 0?o:e.scrollX,a=(r=e.scrollTop)!==null&&r!==void 0?r:e.scrollY;e.scroll(s+Math.sign(t)*50,a+Math.sign(i)*20)}),this.listen()}function H9(n,e){IO(n,e),e.add(n)}function _9(n,e,t){IO(n,e),e.set(n,t)}function IO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yp(n,e,t){return(e=N9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N9(n){var e=D9(n,"string");return typeof e=="symbol"?e:e+""}function D9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function L9(n,e){return n.get(vi(n,e))}function PO(n,e,t){return n.set(vi(n,e),t),t}function vi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("afterDropdownMenuDefaultOptions");le.getSingleton().register("beforeDropdownMenuShow");le.getSingleton().register("afterDropdownMenuShow");le.getSingleton().register("afterDropdownMenuHide");le.getSingleton().register("afterDropdownMenuExecute");const gf="dropdownMenu",$9=230,Pc="changeType",Kp=gf;var tm=new WeakMap,Bi=new WeakSet;class nm extends nt{static get PLUGIN_KEY(){return gf}static get PLUGIN_PRIORITY(){return $9}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[eh,th,Ne,ih,Ne,Gg,Ne,nh,Ne,wi]}constructor(e){super(e),H9(this,Bi),Yp(this,"commandExecutor",new mO(this.hot)),Yp(this,"itemsFactory",null),Yp(this,"menu",null),_9(this,tm,!1),this.hot.addHook("afterGetColHeader",(t,i)=>vi(Bi,this,F9).call(this,t,i))}isEnabled(){return this.hot.getSettings()[gf]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new pO(this.hot,nm.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return vi(Bi,e,z9).call(e,...r)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return vi(Bi,e,U9).call(e,...r)});const t=this.hot.getSettings()[gf],i={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new kl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>vi(Bi,this,V9).call(this)),this.menu.addLocalHook("afterOpen",()=>vi(Bi,this,B9).call(this)),this.menu.addLocalHook("afterSubmenuOpen",r=>vi(Bi,this,W9).call(this,r)),this.menu.addLocalHook("afterClose",()=>vi(Bi,this,j9).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(o,r=>this.commandExecutor.registerCommand(r.key,r))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),r=zg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,o.col,!0).querySelector(`.${Pc}`),a=s.getBoundingClientRect();this.open({left:a.left+r.left,top:a.top+s.offsetHeight+r.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Kp},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isCell()&&!this.menu.isOpened()},group:Kp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>vi(Bi,this,k9).call(this,e))}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),Le(i,(o,r)=>{this.menu.setOffset(r,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function OO(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function k9(n){if(Re(n.target,Pc)){const e=zg(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),PO(tm,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function F9(n,e){const t=e.parentNode;if(!t)return;const i=t.parentNode.childNodes,o=Array.prototype.indexOf.call(i,t);if(n<0||o!==i.length-1)return;const r=e.querySelector(`.${Pc}`);if(this.enabled&&r)return;if(!this.enabled){r&&r.parentNode.removeChild(r);return}const s=this.hot.rootDocument.createElement("button");s.className=Pc,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ye(s,[Ca(),If(" ")]),ye(e,[BM("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function V9(){this.hot.runHooks("beforeDropdownMenuShow",this)}function B9(){this.hot.runHooks("afterDropdownMenuShow",this),vi(Bi,this,OO).call(this,this.menu)}function W9(n){vi(Bi,this,OO).call(this,n)}function j9(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function U9(n){return L9(tm,this)?null:n}function z9(n){Re(n.target,Pc)&&PO(tm,this,!0)}nm.SEPARATOR={name:Ne};function E0(n,e,t){return(e=G9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G9(n){var e=Y9(n,"string");return typeof e=="symbol"?e:e+""}function Y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class K9{constructor(e){E0(this,"hot",void 0),E0(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:i,endCol:o}=this._getDataRange(),r=this.options,s=[];return me(e,i,a=>{const l=[];!r.exportHiddenRows&&this._isHiddenRow(a)||(me(t,o,u=>{!r.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:i}=this._getDataRange(),o=this.hot.getRowHeader();me(t,i,r=>{!this.options.exportHiddenRows&&this._isHiddenRow(r)||e.push(o[r])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:i}=this._getDataRange(),o=this.hot.getColHeader();me(t,i,r=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(r)||e.push(o[r])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[i=0,o=0,r=t,s=e]=this.options.range;return i=Math.max(i,0),o=Math.max(o,0),r=Math.min(r,t),s=Math.min(s,e),{startRow:i,startCol:o,endRow:r,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function T0(n,e,t){return(e=X9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function X9(n){var e=q9(n,"string");return typeof e=="symbol"?e:e+""}function q9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ay{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){T0(this,"dataProvider",void 0),T0(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Do(this.constructor.DEFAULT_OPTIONS);const i=new Date;return t=zt(Do(Ay.DEFAULT_OPTIONS),t),t=zt(t,e),t.filename=kM(t.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),t}}const Z9="\r",Q9='"',J9=`
`;class e4 extends Ay{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const o=i.length>0,r=this.dataProvider.getRowHeaders(),s=r.length>0;let a=e.bom?"\uFEFF":"";return o&&(i=Ue(i,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),M(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(r[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Bt(e);return i!==""&&(t||i.indexOf(Z9)>=0||i.indexOf(Q9)>=0||i.indexOf(J9)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const t4="csv",Ov={[t4]:e4};function n4(n,e,t){return typeof Ov[n]=="function"?new Ov[n](e,t):null}const i4="exportFile",o4=240;class r4 extends nt{static get PLUGIN_KEY(){return i4}static get PLUGIN_PRIORITY(){return o4}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:o}=this.hot,r=this._createTypeFormatter(e,t),s=this._createBlob(r),a=o.URL||o.webkitURL,l=i.createElement("a"),u=`${r.options.filename}.${r.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ov[e])throw new Error(`Export format type "${e}" is not supported.`);return n4(e,new K9(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Ka(n,e,t){return(e=s4(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s4(n){var e=a4(n,"string");return typeof e=="symbol"?e:e+""}function a4(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class oh{constructor(e,t){let{id:i,stateless:o=!0}=t;Ka(this,"hot",void 0),Ka(this,"id",void 0),Ka(this,"elements",[]),Ka(this,"hidden",!1),Ka(this,"stateId",""),Ka(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new $g)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ht(oh,fn);const Oc={};function Jr(n,e){if(!Oc[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:i}=Oc[n];let o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(r){return t.apply(r.meta.instance,[].concat([r],[o]))}}function Js(n){if(!Oc[n])throw Error(`Filter condition "${n}" does not exist.`);return Oc[n].descriptor}function jt(n,e,t){t.key=n,Oc[n]={condition:e,descriptor:t}}const on="none";function l4(){return!0}jt(on,l4,{name:kg,inputsCount:0,showOperators:!1});const ic="empty";function u4(n){return kt(n.value)}jt(ic,u4,{name:Pb,inputsCount:0,showOperators:!0});const mf="not_empty";function c4(n,e){return!Jr(ic,e)(n)}jt(mf,c4,{name:Ob,inputsCount:0,showOperators:!0});const oc="eq";function h4(n,e){let[t]=e;return Bt(n.value).toLocaleLowerCase(n.meta.locale)===Bt(t)}jt(oc,h4,{name:Ab,inputsCount:1,showOperators:!0});const pf="neq";function d4(n,e){return!Jr(oc,e)(n)}jt(pf,d4,{name:xb,inputsCount:1,showOperators:!0});const AO="gt";function f4(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>i}jt(AO,f4,{name:Lb,inputsCount:1,showOperators:!0});const xO="gte";function g4(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>=i}jt(xO,g4,{name:$b,inputsCount:1,showOperators:!0});const HO="lt";function m4(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<i}jt(HO,m4,{name:kb,inputsCount:1,showOperators:!0});const _O="lte";function p4(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<=i}jt(_O,p4,{name:Fb,inputsCount:1,showOperators:!0});const xy="date_after";function w4(n,e){let[t]=e;const i=Je(n.value,n.meta.dateFormat),o=Je(t,n.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}jt(xy,w4,{name:Wb,inputsCount:1,showOperators:!0});const Hy="date_before";function v4(n,e){let[t]=e;const i=Je(n.value,n.meta.dateFormat),o=Je(t,n.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}jt(Hy,v4,{name:jb,inputsCount:1,showOperators:!0});const Qf="between";function C4(n,e){let[t,i]=e,o=t,r=i;if(n.meta.type==="numeric"){const s=parseFloat(o,10),a=parseFloat(r,10);o=Math.min(s,a),r=Math.max(s,a)}else if(n.meta.type==="date"){const s=Jr(Hy,[r]),a=Jr(xy,[o]);return s(n)&&a(n)}return n.value>=o&&n.value<=r}jt(Qf,C4,{name:Vb,inputsCount:2,showOperators:!0});const NO="not_between";function b4(n,e){return!Jr(Qf,e)(n)}jt(NO,b4,{name:Bb,inputsCount:2,showOperators:!0});const DO="begins_with";function y4(n,e){let[t]=e;return Bt(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Bt(t))}jt(DO,y4,{name:Hb,inputsCount:1,showOperators:!0});const LO="ends_with";function S4(n,e){let[t]=e;return Bt(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Bt(t))}jt(LO,S4,{name:_b,inputsCount:1,showOperators:!0});const _y="contains";function R4(n,e){let[t]=e;return Bt(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Bt(t))>=0}jt(_y,R4,{name:Nb,inputsCount:1,showOperators:!0});const $O="not_contains";function E4(n,e){return!Jr(_y,e)(n)}jt($O,E4,{name:Db,inputsCount:1,showOperators:!0});const kO="date_tomorrow";function T4(n){const e=Je(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Je().subtract(-1,"days").startOf("day"),"d"):!1}jt(kO,T4,{name:zb,inputsCount:0});const FO="date_today";function M4(n){const e=Je(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Je().startOf("day"),"d"):!1}jt(FO,M4,{name:Ub,inputsCount:0});const VO="date_yesterday";function I4(n){const e=Je(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Je().subtract(1,"days").startOf("day"),"d"):!1}jt(VO,I4,{name:Gb,inputsCount:0});Ok();function P4(n,e){let t=n;return t===""&&(t=`(${e})`),t}const Av=new Set([1]).has(1),O4=Av&&typeof Array.from=="function";function rh(n){let e=n;return Av&&(e=new Set(e)),function(t){let i;return Av?i=e.has(t):i=!!~e.indexOf(t),i}}function BO(n){return n??""}function xv(n){let e=n;return O4?e=Array.from(new Set(e)):e=DM(e),e=e.sort((t,i)=>typeof t=="number"&&typeof i=="number"?t-i:t===i?0:t>i?1:-1),e}function M0(n,e,t,i){const o=[],r=n===e;let s;return r||(s=rh(e)),M(n,a=>{let l=!1;(r||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:P4(a,t)};i&&i(u),o.push(u)}),o}const ea="by_value";function A4(n,e){let[t]=e;return t(n.value)}jt(ea,A4,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[rh(e)]},showOperators:!1});const Ac={};function x4(n){if(!Ac[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Ac[n].func;return function(t,i){return e(t,i)}}function H4(n){return Ac[n].name}function Ny(n,e,t){Ac[n]={name:e,func:t}}const qr="conjunction",_4=Xb;function N4(n,e){return n.every(t=>t.func(e))}Ny(qr,_4,N4);const Jf="disjunction",D4=Fg;function L4(n,e){return n.some(t=>t.func(e))}Ny(Jf,D4,L4);const Dy="disjunctionWithExtraCondition",$4=Fg;function k4(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}Ny(Dy,$4,k4);const F4="numeric",WO="text",V4="date",I0={[F4]:[on,Ne,ic,mf,Ne,oc,pf,Ne,AO,xO,HO,_O,Qf,NO],[WO]:[on,Ne,ic,mf,Ne,oc,pf,Ne,DO,LO,Ne,_y,$O],[V4]:[on,Ne,ic,mf,Ne,oc,pf,Ne,Hy,xy,Qf,Ne,kO,FO,VO]};function B4(n){const e=[];let t=n;return I0[t]||(t=WO),M(I0[t],i=>{let o;i===Ne?o={name:Ne}:o=Do(Js(i)),e.push(o)}),e}function Mu(n,e,t){return(e=W4(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W4(n){var e=j4(n,"string");return typeof e=="symbol"?e:e+""}function j4(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Xp="built",qp="building",P0=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ki=class jO{static get DEFAULTS(){return Do({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){Mu(this,"hot",void 0),Mu(this,"eventManager",new qi(this)),Mu(this,"options",void 0),Mu(this,"_element",void 0),Mu(this,"buildState",void 0),this.hot=e,this.options=zt(jO.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===qp?this._element:this.buildState===Xp?(this.update(),this._element):(this.buildState=qp,this.build(),this.buildState=Xp,this._element)}isBuilt(){return this.buildState===Xp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(_n)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,i)=>{this.eventManager.addEventListener(t,i,o=>this.runLocalHooks(i,o,this))};if(this.buildState||(this.buildState=qp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)M(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),Le(this.options,(i,o)=>{t[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(t[o]=this.translateIfPossible(i))}),this._element.appendChild(t),M(P0,i=>e(t,i))}else M(P0,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ht(Ki,fn);function U4(n,e){UO(n,e),e.add(n)}function z4(n,e,t){UO(n,e),e.set(n,t)}function UO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cd(n,e){return n.get(Ly(n,e))}function G4(n,e,t){return n.set(Ly(n,e),t),t}function Ly(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xa=new WeakMap,O0=new WeakSet;class Zr extends Ki{static get DEFAULTS(){return Do({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,zt(Zr.DEFAULTS,t)),U4(this,O0),z4(this,Xa,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Ly(O0,this,Y4).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");G4(Xa,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Cd(Xa,this).type=this.options.type,Cd(Xa,this).placeholder=this.translateIfPossible(this.options.placeholder),Cd(Xa,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Cd(Xa,this).focus()}}function Y4(n){this.options.value=n.target.value}function K4(n,e){zO(n,e),e.add(n)}function Iu(n,e,t){zO(n,e),e.set(n,t)}function zO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(n,e,t){return n.set(rc(n,e),t),t}function Mt(n,e){return n.get(rc(n,e))}function rc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qt=new WeakMap,bd=new WeakMap,yd=new WeakMap,Zp=new WeakMap,Sd=new WeakMap,Rd=new WeakSet;class xc extends Ki{static get DEFAULTS(){return Do({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,zt(xc.DEFAULTS,t)),K4(this,Rd),Iu(this,qt,null),Iu(this,bd,[]),Iu(this,yd,void 0),Iu(this,Zp,void 0),Iu(this,Sd,void 0),this.registerHooks()}getMenu(){return Mt(qt,this)}registerHooks(){this.addLocalHook("click",()=>rc(Rd,this,Z4).call(this))}setItems(e){qa(bd,this,this.translateNames(e)),Mt(qt,this)&&Mt(qt,this).setMenuItems(Mt(bd,this))}translateNames(e){return M(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),qa(qt,this,new kl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Mt(qt,this).setMenuItems(Mt(bd,this));const e=new Ki(this.hot,{className:"htUISelectCaption"}),t=new Ki(this.hot,{className:"htUISelectDropdown"});qa(yd,this,e),qa(Zp,this,e.element),qa(Sd,this,t),this.hot.getSettings().ariaTags&&(ye(t.element,[Ca()]),ye(this._element,[VM()])),M([e,t],i=>this._element.appendChild(i.element)),Mt(qt,this).addLocalHook("select",i=>rc(Rd,this,X4).call(this,i)),Mt(qt,this).addLocalHook("afterClose",()=>rc(Rd,this,q4).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Mt(qt,this).hot.getTranslatedPhrase(kg),Mt(Zp,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Mt(qt,this)&&(Mt(qt,this).open(),Mt(qt,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Mt(qt,this).getNavigator().toFirstItem(),Mt(qt,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Mt(qt,this)&&Mt(qt,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Mt(qt,this)&&(Mt(qt,this).destroy(),qa(qt,this,null)),Mt(yd,this)&&Mt(yd,this).destroy(),Mt(Sd,this)&&Mt(Sd,this).destroy(),super.destroy()}}function X4(n){n.name!==Ne&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function q4(){this.runLocalHooks("afterClose")}function Z4(){this.openOptions()}function Q4(n,e){J4(n,e),e.add(n)}function J4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A0(n,e,t){return(e=e6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e6(n){var e=t6(n,"string");return typeof e=="symbol"?e:e+""}function t6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function x0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Qp=new WeakSet;class Hv extends oh{constructor(e,t){super(e,{id:t.id,stateless:!1}),Q4(this,Qp),A0(this,"name",""),A0(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new xc(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Zr(this.hot,{placeholder:ty})),this.elements.push(new Zr(this.hot,{placeholder:ny})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>x0(Qp,this,n6).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>x0(Qp,this,i6).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=Do(e.command);t.name.startsWith(Nt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),M(e.args,(i,o)=>{if(o>t.inputsCount-1)return!1;const r=this.getInputElement(o);r.setValue(i),r[t.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Js(on),t=[];return M(this.getInputElements(),(i,o)=>{e.inputsCount>o&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){const i=Js(e?e.name:on);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||M(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof xc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Zr)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,o,r,s)=>{X(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Js(on)];if(e!==null){const{visualIndex:i}=e;t=B4(this.hot.getDataType(0,i,this.hot.countRows(),i))}M(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function n6(n){M(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function i6(n){Yc(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ji(n))}function H0(n,e,t){o6(n,e),e.set(n,t)}function o6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pu(n,e){return n.get(GO(n,e))}function _0(n,e,t){return n.set(GO(n,e),t),t}function GO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Za=new WeakMap,Jp=new WeakMap;class eg extends Ki{static get DEFAULTS(){return Do({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,zt(eg.DEFAULTS,t)),H0(this,Za,void 0),H0(this,Jp,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_0(Jp,this,e),_0(Za,this,this._element.firstChild),Pu(Za,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Pu(Jp,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Pu(Za,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Pu(Za,this).checked=e)}focus(){this.isBuilt()&&Pu(Za,this).focus()}}function r6(n,e){s6(n,e),e.add(n)}function s6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a6(n,e,t){return(e=l6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l6(n){var e=u6(n,"string");return typeof e=="symbol"?e:e+""}function u6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function c6(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const N0=0;var D0=new WeakSet;class h6 extends oh{constructor(e,t){super(e,{id:t.id,stateless:!1}),r6(this,D0),a6(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(X(t.parentNode,"htFiltersMenuOperators"),M(this.elements,i=>t.appendChild(i.element)),t)}}buildOperatorsElement(){const e=[qr,Jf];M(e,t=>{const i=new eg(this.hot,{name:"operator",label:{htmlFor:t,textContent:H4(t)},value:t,checked:t===e[N0],id:t});i.addLocalHook("change",o=>c6(D0,this,d6).call(this,o)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(rt`Radio button with index ${e} doesn't exist.`);M(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof eg&&t.isChecked());return e?e.getValue():qr}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qr,t=arguments.length>1?arguments[1]:void 0,i=e;i===Dy&&(i=Jf),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(N0)}}function d6(n){this.setState(n.target.value)}function f6(n,e,t){g6(n,e),e.set(n,t)}function g6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ew(n,e){return n.get(YO(n,e))}function m6(n,e,t){return n.set(YO(n,e),t),t}function YO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ou=new WeakMap;class Hc extends Ki{static get DEFAULTS(){return Do({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,zt(Hc.DEFAULTS,t)),f6(this,Ou,void 0)}build(){super.build(),m6(Ou,this,this._element.firstChild)}update(){this.isBuilt()&&(ew(Ou,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&ew(Ou,this).focus()}activate(){ew(Ou,this).click()}}function p6(n,e){KO(n,e),e.add(n)}function Qa(n,e,t){KO(n,e),e.set(n,t)}function KO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(n,e){return n.get(pl(n,e))}function Ni(n,e,t){return n.set(pl(n,e),t),t}function pl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const L0="multipleSelect.itemBox";var Wi=new WeakMap,Vt=new WeakMap,tw=new WeakMap,Zo=new WeakMap,Mr=new WeakMap,Ir=new WeakMap,Au=new WeakSet;class _c extends Ki{static get DEFAULTS(){return Do({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,zt(_c.DEFAULTS,t)),p6(this,Au),Qa(this,Wi,[]),Qa(this,Vt,void 0),Qa(this,tw,void 0),Qa(this,Zo,void 0),Qa(this,Mr,void 0),Qa(this,Ir,void 0),Ni(Zo,this,new Zr(this.hot,{placeholder:ey,className:"htUIMultipleSelectSearch"})),Ni(Mr,this,new Hc(this.hot,{textContent:qb,className:"htUISelectAll"})),Ni(Ir,this,new Hc(this.hot,{textContent:Zb,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return xe(Vt,this)}registerHooks(){xe(Zo,this).addLocalHook("keydown",e=>pl(Au,this,v6).call(this,e)),xe(Zo,this).addLocalHook("input",e=>pl(Au,this,w6).call(this,e)),xe(Mr,this).addLocalHook("click",e=>pl(Au,this,C6).call(this,e)),xe(Ir,this).addLocalHook("click",e=>pl(Au,this,b6).call(this,e))}setItems(e){var t;Ni(Wi,this,e),(t=xe(Vt,this))===null||t===void 0||t.loadData(xe(Wi,this))}setLocale(e){Ni(tw,this,e)}getLocale(){return xe(tw,this)}getItems(){return[...xe(Wi,this)]}getValue(){return S6(xe(Wi,this))}getSearchInputElement(){return xe(Zo,this)}getSelectAllElement(){return xe(Mr,this)}getClearAllElement(){return xe(Ir,this)}isSelectedAllValues(){return xe(Wi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),i=new Ki(this.hot,{className:"htUISelectionControls",children:[xe(Mr,this),xe(Ir,this)]});this._element.appendChild(xe(Zo,this).element),this._element.appendChild(i.element),this._element.appendChild(t);const o=r=>{var s;if(!this._element)return;(s=xe(Vt,this))===null||s===void 0||s.destroy(),X(r,"htUIMultipleSelectHot"),Ni(Vt,this,new this.hot.constructor(r,{data:xe(Wi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,g,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{xe(Vt,this).listen()},colWidths:()=>xe(Vt,this).container.scrollWidth-sn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),xe(Vt,this).init();const l=xe(Vt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:L0}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{xe(Vt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:L0})};o(t),this.hot._registerTimeout(()=>o(t),100)}focus(){this.isBuilt()&&xe(Vt,this).listen()}reset(){xe(Zo,this).reset(),xe(Mr,this).reset(),xe(Ir,this).reset()}update(){this.isBuilt()&&(xe(Vt,this).loadData(y6(xe(Wi,this),this.options.value)),super.update())}destroy(){var e;(e=xe(Vt,this))===null||e===void 0||e.destroy(),xe(Zo,this).destroy(),xe(Ir,this).destroy(),xe(Mr,this).destroy(),Ni(Zo,this,null),Ni(Ir,this,null),Ni(Mr,this,null),Ni(Vt,this,null),Ni(Wi,this,null),super.destroy()}}function w6(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...xe(Wi,this)]:t=xe(Wi,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),xe(Vt,this).loadData(t)}function v6(n){this.runLocalHooks("keydown",n,this),nI(Yc,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),Ji(n),xe(Vt,this).listen(),xe(Vt,this).selectCell(0,0))}function C6(n){const e=[];n.preventDefault(),xe(Vt,this).getSourceData().forEach((t,i)=>{t.checked=!0,e.push(YI(t,i)[0])}),xe(Vt,this).setSourceDataAtCell(e)}function b6(n){const e=[];n.preventDefault(),xe(Vt,this).getSourceData().forEach((t,i)=>{t.checked=!1,e.push(YI(t,i)[0])}),xe(Vt,this).setSourceDataAtCell(e)}function y6(n,e){const t=rh(e);return n.map(i=>(i.checked=t(i.value),i))}function S6(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function R6(n,e){E6(n,e),e.add(n)}function E6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T6(n,e,t){return(e=M6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M6(n){var e=I6(n,"string");return typeof e=="symbol"?e:e+""}function I6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ed(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xu=new WeakSet;class P6 extends oh{constructor(e,t){super(e,{id:t.id,stateless:!1}),R6(this,xu),T6(this,"name",""),this.name=t.name,this.elements.push(new _c(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ed(xu,this,O6).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>Ed(xu,this,A6).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ea){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?on:ea},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(i,o,r,s,a)=>{const[l]=Qr(o,h=>h.name===ea),u={},c=this.hot.getTranslatedPhrase(Vf);if(l){const h=s(i,a),d=Ue(h,R=>R.value),g=new Map(h.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),m=xv(d);r&&(l.args[0]=r);const w=[],C=M0(m,l.args[0],c,R=>{R.checked&&w.push(R.value),Ed(xu,this,$0).call(this,R,g)}),y=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,y).locale,u.args=[w],u.command=Js(ea),u.itemsSnapshot=C}else u.args=[],u.command=Js(on);this.state.setValueAtIndex(i,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof _c)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,o,r,s)=>{X(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(Vf),t=this._getColumnVisibleValues(),i=t.map(l=>l.value),o=new Map(t.map(l=>[l.value,l.meta])),r=xv(i),s=M0(r,r,e,l=>{Ed(xu,this,$0).call(this,l,o)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(r);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),(t,i)=>({value:BO(t),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function O6(n){Yc(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ji(n))}function $0(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function A6(n,e){switch(e.type){case"numeric":return BP(n,e);default:return n}}var XO;function x6(n,e){H6(n,e),e.add(n)}function H6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _6(n,e,t){return(e=N6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N6(n){var e=D6(n,"string");return typeof e=="symbol"?e:e+""}function D6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function L6(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var k0=new WeakSet;class Nc extends oh{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),x6(this,k0),_6(this,"name",""),this.name=t.name,this.elements.push(new Zr(this.hot,{type:"button",value:Qb,className:"htUIButton htUIButtonOK",identifier:Nc.BUTTON_OK})),this.elements.push(new Zr(this.hot,{type:"button",value:Jb,className:"htUIButton htUIButtonCancel",identifier:Nc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(t,i)=>L6(k0,this,$6).call(this,t,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(X(t.parentNode,"htFiltersMenuActionBar"),M(this.elements,i=>t.appendChild(i.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}XO=Nc;function $6(n,e){e.options.identifier===XO.BUTTON_OK?this.accept():this.cancel()}function Td(n,e,t){return(e=k6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k6(n){var e=F6(n,"string");return typeof e=="symbol"?e:e+""}function F6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const F0="ConditionCollection.filteringStates";class $y{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Td(this,"hot",void 0),Td(this,"isMapRegistrable",void 0),Td(this,"filteringStates",new $g),Td(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(F0,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var i;const o=this.filteringStates.getValueAtIndex(t),r=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(r,e,s)}isMatchInConditions(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qr;return e.length?x4(i)(e,t):!0}addCondition(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qr,o=arguments.length>3?arguments[3]:void 0;const r=this.hot.getCellMeta(0,e).locale,s=Ue(t.args,c=>typeof c=="string"?c.toLocaleLowerCase(r):c),a=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(rt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(vt(Ac[i]))throw new Error(rt`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:Jr(a,s)}]},o):u.push({name:a,args:s,func:Jr(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return(t=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Hn(this.filteringStates.getEntries(),(e,t)=>{let[i,{operation:o,conditions:r}]=t;return e.push({column:i,operation:o,conditions:Ue(r,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),M(e,t=>{M(t.conditions,i=>this.addCondition(t.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const i=this.getConditions(e);return t?i.some(o=>o.name===t):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(F0),this.filteringStates=null,this.clearLocalHooks()}}ht($y,fn);function V0(n,e,t){return(e=V6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function V6(n){var e=B6(n,"string");return typeof e=="symbol"?e:e+""}function B6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];V0(this,"conditionCollection",void 0),V0(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(t,i)=>{let o=this.columnDataFactory(t);i&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return M(t,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&i.push(o)}),i}_getIntersectData(e,t){const i=[];return M(t,o=>{const r=o.meta.visualRow;e[r]!==void 0&&(i[r]=e[r])}),i}}function W6(n,e){j6(n,e),e.add(n)}function j6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(n,e,t){return(e=U6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U6(n){var e=z6(n,"string");return typeof e=="symbol"?e:e+""}function z6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function nw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Md=new WeakSet;class ZO{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];W6(this,Md),xs(this,"hot",void 0),xs(this,"conditionCollection",void 0),xs(this,"columnDataFactory",void 0),xs(this,"changes",[]),xs(this,"grouping",!1),xs(this,"latestEditedColumnPosition",-1),xs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",o=>nw(Md,this,G6).call(this,o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>nw(Md,this,Y6).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>nw(Md,this,K6).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let r=this.conditionCollection.getColumnStackPosition(e);r===-1&&(r=this.latestEditedColumnPosition);const s=o.slice(0,r),a=o.slice(r);a.length&&a[0].column===e&&a.shift();const l=hk(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new $y(i.hot,!1),m=[].concat(c,d);g.importAllConditions(m);const w=i.columnDataFactory(h);let C;g.isEmpty()?C=w:C=new qO(g,R=>i.columnDataFactory(R)).filter(),C=Ue(C,R=>R.meta.visualRow);const y=rh(C);return g.destroy(),Qr(w,R=>y(R.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),Le(this,(e,t)=>{this[t]=null})}}function G6(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function Y6(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function K6(){M(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}ht(ZO,fn);function X6(n){return vO({initialPage:0,size:()=>n.length,onItemSelect:(t,i)=>{const o=n[t];if(o instanceof _c)return i;if(o.element&&!Rl(o.element))return!1;o.focus()}})}const Hu="filters";function q6(n,e){let t=-1;const i=X6(e),o=l=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Hu),i.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof Ki&&(l.addLocalHook("click",o(l)),l.addLocalHook("focus",o(l)),l.addLocalHook("afterClose",o(l)))}),n.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||i.clear()});function r(l){const u=n.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();i.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Hu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Hu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=n.getNavigator();d.getCurrentPage()>-1&&(t=d.getCurrentPage()),d.clear(),h.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[i.getCurrentPage()];d instanceof xc&&(d.openOptions(),h.preventDefault()),d instanceof Hc&&(d.activate(),h.preventDefault()),d instanceof Ki||h.preventDefault()}}],Hu)}n.addLocalHook("afterSubmenuOpen",r),n.addLocalHook("afterOpen",r);function s(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Hu)}function a(){return t}return{...i,listen:s,getLastMenuPage:a}}function Z6(n,e){QO(n,e),e.add(n)}function Q6(n,e,t){QO(n,e),e.set(n,t)}function QO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _u(n,e,t){return(e=J6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J6(n){var e=e8(n,"string");return typeof e=="symbol"?e:e+""}function e8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function t8(n,e,t){return n.set(Qn(n,e),t),t}function Nu(n,e){return n.get(Qn(n,e))}function Qn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _v="filters",n8=250,B0=_v;var Hs=new WeakMap,fi=new WeakSet;class i8 extends nt{static get PLUGIN_KEY(){return _v}static get PLUGIN_PRIORITY(){return n8}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Z6(this,fi),_u(this,"dropdownMenuPlugin",null),_u(this,"conditionCollection",null),_u(this,"conditionUpdateObserver",null),_u(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_u(this,"filtersRowsMap",null),Q6(this,Hs,void 0),this.hot.addHook("afterGetColHeader",(t,i)=>Qn(fi,this,u8).call(this,t,i))}isEnabled(){return!!this.hot.getSettings()[_v]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Zc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,i=s=>(s.addLocalHook("accept",()=>Qn(fi,this,W0).call(this,"accept")),s.addLocalHook("cancel",()=>Qn(fi,this,W0).call(this,"cancel")),s.addLocalHook("change",a=>Qn(fi,this,l8).call(this,s,a)),s),o=()=>`${this.hot.getTranslatedPhrase(Yb)}:`,r=()=>`${this.hot.getTranslatedPhrase(Kb)}:`;if(!this.components.get("filter_by_condition")){const s=new Hv(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});s.addLocalHook("afterClose",()=>Qn(fi,this,j0).call(this)),this.components.set("filter_by_condition",i(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new h6(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new Hv(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});s.addLocalHook("afterClose",()=>Qn(fi,this,j0).call(this)),this.components.set("filter_by_condition2",i(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new P6(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Nc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new $y(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ZO(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Qn(fi,this,c8).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Qn(fi,this,a8).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Qn(fi,this,r8).call(this)),this.addHook("afterDropdownMenuHide",()=>Qn(fi,this,s8).call(this)),this.addHook("afterChange",s=>Qn(fi,this,o8).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Nu(Hs,this)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=Nu(Hs,this).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];t8(Hs,this,q6(s,a));const l=u=>{Nu(Hs,this).listen(),u.preventDefault(),Yc(u.keyCode,"TAB")&&(u.shiftKey?Nu(Hs,this).toPreviousItem():Nu(Hs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,i)=>{t.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:B0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(B0)}addCondition(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:qr;const r=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(r,{command:{key:t},args:i},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let o=[];const r=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",r,this.conditionCollection.previousConditionStack)!==!1)if(i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),o=Ue(t.filter(),u=>u.meta.visualRow);const l=rh(o);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!o.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",r),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),i=[];return M(this.hot.getSourceDataAtCol(t),(o,r)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:m}=this.hot.getCellMeta(r,t),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))!==null&&s!==void 0?s:o;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:m},value:BO(w)})}),i}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),i=xv(t);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var t;const i=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,i,o){let r=e;return r===Jf&&t.command.key!==on&&i.command.key!==on&&o.command.key!==on?r=Dy:o.command.key!==on&&(t.command.key===on||i.command.key===on)&&(r=qr),r}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new qO(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return M(o,s=>{M(t.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,o=i.getPlugin("hiddenRows");for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?o.showRows(l):o.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function o8(n){n&&M(n,e=>{const[,t]=e,i=this.hot.propToCol(t);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function r8(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function s8(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function a8(n){n.items.push({name:Ne}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function W0(n){var e;if(n==="accept"){const i=this.getSelectedColumn();if(i===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:o}=i,r=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(o);u===-1&&(u=void 0),this.conditionCollection.removeConditions(o),r.command.key!==on&&(this.conditionCollection.addCondition(o,r,l,u),s.command.key!==on&&this.conditionCollection.addCondition(o,s,l,u)),a.command.key!==on&&this.conditionCollection.addCondition(o,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(o)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function l8(n,e){this.updateDependentComponentsVisibility(),n.constructor===Hv&&!e.inputsCount&&this.setListeningDropdownMenu()}function j0(){this.setListeningDropdownMenu()}function u8(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?X(e,"htFiltersActive"):Ie(e,"htFiltersActive")}function c8(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:i}}=n,o=t.filter(s=>s.name===ea),r=t.filter(s=>s.name!==ea);if(o.length>=2||r.length>=3)ot(rt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(r[0],i),this.components.get("filter_by_condition2").updateState(r[1],i),this.components.get("filter_operators").updateState(s,i),this.components.get("filter_by_value").updateState(n)}}const JO="internal-use-in-handsontable",Nv={licenseKey:JO,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function eA(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[bn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function tA(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function h8(n){var e;const t=n[bn],i=tA(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=eA(n);return{...Nv,...i,...o}}function d8(n){var e;const t=n[bn],i=tA(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=eA(n);return{...i,...o}}function f8(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function im(){const n="engine_relationship",e=eo(bn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function ky(){const n="shared_engine_usage",e=eo(bn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function g8(n){const e=n.getSettings(),t=e[bn],i=t==null?void 0:t.engine;if(t===!0||vt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var o;return m8((o=i.hyperformula)!==null&&o!==void 0?o:i,e,n)}else if(typeof i=="object"&&vt(i.hyperformula)){const r=im(),s=ky().get(i);return r.has(i)||r.set(i,[]),r.get(i).push(n),s&&s.push(n.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:JO}),(i.getConfig().leapYear1900!==Nv.leapYear1900||dC(i.getConfig().nullDate,Nv.nullDate)===!1)&&ot(rt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function m8(n,e,t){const i=e[bn],o=h8(e),r=im(),s=ky();p8(n,i.functions),w8(n,i.language);const a=n.buildEmpty(o);return r.set(a,[t]),s.set(a,[t.guid]),v8(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function U0(n){var e;const t=im(),i=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(i.map(o=>[o.getPlugin("formulas").sheetId,o]))}function z0(n,e){if(n){const t=im(),i=t.get(n),o=ky(),r=o.get(n);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&t.delete(n)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),r.length===0&&(o.delete(n),n.destroy()))}}function p8(n,e){e&&e.forEach(t=>{const{name:i,plugin:o,translations:r}=t;try{n.registerFunction(i,o,r)}catch(s){ot(s.message)}})}function w8(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(i){ot(i.message)}}}function v8(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:i,expression:o,scope:r,options:s}=t;try{n.addNamedExpression(i,o,r,s)}catch(a){ot(a.message)}}),n.resumeEvaluation())}function C8(n,e){return(vt(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const nA="DD/MM/YYYY";function iA(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function b8(n){return iA(n)?n.substr(1):n}function y8(n){return typeof n=="string"&&n.startsWith("=")}function Fy(n,e){return typeof n=="string"&&e==="date"}function oA(n,e){return Je(n,e,!0).isValid()}function rA(n,e){return Je(n,e,!0).format(nA)}function S8(n,e){return Je(n,nA,!0).format(e)}function sA(n,e){const i=new Date(Date.UTC(0,0,n+-1));return Je(i).format(e)}function R8(n,e,t){const i=Array.from(Array(t).keys()).filter(r=>n.includes(r)===!1);if(e===0){var o;return(o=i[e])!==null&&o!==void 0?o:0}return i[e-1]+1}function E8(n,e){const t=[];return n.forEach(i=>{const o={from:i,to:e};t.forEach(r=>{const s=r.from>r.to,a=r.to<=o.from;r.from>o.from&&a&&s&&(o.from+=1)}),o.from>=e&&(e+=1),t.push(o)}),t}function T8(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(o=>{const r=o.from<o.to;o.from>e.from&&r&&(o.from-=1)})}),n}function Vy(n,e,t){const i=E8(n,R8(n,e,t));return T8(i)}function _s(n,e,t){M8(n,e),e.set(n,t)}function M8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(n,e){return n.get(aA(n,e))}function Pr(n,e,t){return n.set(aA(n,e),t),t}function aA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Du=new WeakMap,Or=new WeakMap,Kn=new WeakMap,Id=new WeakMap,iw=new WeakMap,ow=new WeakMap,Pd=new WeakMap;class G0{constructor(e,t,i){_s(this,Du,void 0),_s(this,Or,void 0),_s(this,Kn,void 0),_s(this,Id,[]),_s(this,iw,[]),_s(this,ow,void 0),_s(this,Pd,[]),Pr(Du,this,e),Pr(Or,this,t),Pr(Kn,this,i)}setRemovedHfIndexes(e){return Pr(Pd,this,e.map(t=>{const i=St(Or,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(i)})),St(Pd,this)}getRemovedHfIndexes(){return St(Pd,this)}getHfIndexFromVisualIndex(e){const t=St(Or,this).getIndexesSequence(),i=St(Or,this).getNotTrimmedIndexes();return t.indexOf(i[e])}syncMoves(e){const i=`move${Xi(St(Du,this))}s`;St(Kn,this).getEngine().batch(()=>{e.forEach(o=>{const r=o.from!==o.to,s=o.from+1!==o.to;r&&s&&St(Kn,this).getEngine()[i](St(Kn,this).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,t,i){i!==!1&&(Pr(iw,this,e.map(o=>this.getHfIndexFromVisualIndex(o))),Pr(ow,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(St(Kn,this).isPerformingUndoRedo()||e===!1||t===!1)return;const i=Vy(St(iw,this),St(ow,this),St(Or,this).getNumberOfIndexes());St(Kn,this).getSheetId()===null?St(Kn,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Xi(St(Du,this))}Order`;return t=>{if(St(Kn,this).isPerformingUndoRedo())return;const i=St(Or,this).getIndexesSequence();if(t==="update"&&i.length>0){const o=St(Id,this).map(l=>i.indexOf(l)),r=St(Kn,this).getEngine().getSheetDimensions(St(Kn,this).getSheetId());let s;St(Du,this)==="row"?s=r.height:s=r.width;const a=o.length;for(let l=a;l<s;l+=1)o.push(l);St(Kn,this).getEngine()[e](St(Kn,this).getSheetId(),o)}Pr(Id,this,i)}}init(){Pr(Id,this,St(Or,this).getIndexesSequence())}}function Ns(n,e,t){I8(n,e),e.set(n,t)}function I8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(n,e){return n.get(lA(n,e))}function Ds(n,e,t){return n.set(lA(n,e),t),t}function lA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Od=new WeakMap,Ad=new WeakMap,rw=new WeakMap,sw=new WeakMap,aw=new WeakMap,lw=new WeakMap,uw=new WeakMap;class P8{constructor(e,t,i){Ns(this,Od,void 0),Ns(this,Ad,void 0),Ns(this,rw,void 0),Ns(this,sw,!1),Ns(this,aw,!1),Ns(this,lw,null),Ns(this,uw,null),Ds(Od,this,new G0("row",e,this)),Ds(Ad,this,new G0("column",t,this)),Ds(rw,this,i)}getForAxis(e){return e==="row"?Qo(Od,this):Qo(Ad,this)}setPerformUndo(e){Ds(sw,this,e)}setPerformRedo(e){Ds(aw,this,e)}isPerformingUndoRedo(){return Qo(sw,this)||Qo(aw,this)}getSheetId(){return Qo(uw,this)}getEngine(){return Qo(lw,this)}getPostponeAction(){return Qo(rw,this)}setupSyncEndpoint(e,t){Ds(lw,this,e),Ds(uw,this,t),Qo(Od,this).init(),Qo(Ad,this).init()}}function O8(n,e){uA(n,e),e.add(n)}function Ja(n,e,t){return(e=A8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A8(n){var e=x8(n,"string");return typeof e=="symbol"?e:e+""}function x8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cw(n,e,t){uA(n,e),e.set(n,t)}function uA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function es(n,e,t){return n.set(lt(n,e),t),t}function Cl(n,e){return n.get(lt(n,e))}function lt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const bn="formulas",H8=["maxRows","maxColumns","language"],_8=260;le.getSingleton().register("afterNamedExpressionAdded");le.getSingleton().register("afterNamedExpressionRemoved");le.getSingleton().register("afterSheetAdded");le.getSingleton().register("afterSheetRemoved");le.getSingleton().register("afterSheetRenamed");le.getSingleton().register("afterFormulasValuesUpdate");const Fl=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var gr=new WeakMap,By=new WeakMap,Lu=new WeakMap,ft=new WeakSet;class N8 extends nt{constructor(){var e;super(...arguments),e=this,O8(this,ft),cw(this,gr,!1),cw(this,By,!1),cw(this,Lu,[["valuesUpdated",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,q8).call(e,...i)}],["namedExpressionAdded",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,Z8).call(e,...i)}],["namedExpressionRemoved",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,Q8).call(e,...i)}],["sheetAdded",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,J8).call(e,...i)}],["sheetRenamed",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,e7).call(e,...i)}],["sheetRemoved",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return lt(ft,e,t7).call(e,...i)}]]),Ja(this,"staticRegister",eo("formulas")),Ja(this,"engine",null),Ja(this,"sheetName",null),Ja(this,"indexSyncer",null),Ja(this,"rowAxisSyncer",null),Ja(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return bn}static get PLUGIN_PRIORITY(){return _8}static get SETTING_KEYS(){return[bn,...H8]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[bn]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=g8(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ot("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,Y0).call(t,...o)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,K0).call(t,...o)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,Y0).call(t,...o)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,K0).call(t,...o)}),this.addHook("modifyData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,k8).call(t,...o)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,F8).call(t,...o)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,D8).call(t,...o)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,V8).call(t,...o)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,X0).call(t,...o)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,X0).call(t,...o)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,B8).call(t,...o)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,W8).call(t,...o)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,z8).call(t,...o)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,G8).call(t,...o)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,j8).call(t,...o)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,U8).call(t,...o)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,Y8).call(t,...o)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,K8).call(t,...o)}),this.indexSyncer=new P8(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,o,r,s)=>{this.rowAxisSyncer.storeMovesInformation(i,o,s)}),this.hot.addHook("beforeColumnMove",(i,o,r,s)=>{this.columnAxisSyncer.storeMovesInformation(i,o,s)}),this.hot.addHook("afterRowMove",(i,o,r,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,o,r,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,o)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(i,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(i,o)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(i,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,$8).call(t,...o)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,X8).call(t,...o)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return lt(ft,t,L8).call(t,...o)}),Cl(Lu,this).forEach(i=>{let[o,r]=i;return this.engine.on(o,r)}),super.enablePlugin()}}disablePlugin(){Cl(Lu,this).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),z0(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=d8(this.hot.getSettings());f8(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const i=this.hot.getSettings()[bn];if(ce(i)&&ce(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[bn].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Cl(Lu,this).forEach(e=>{var t;let[i,o]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(i,o)}),es(Lu,this,null),z0(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(ce(t)&&!Tj(t))return ot("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ot("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(i){return ot(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){wC(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${Xi(bn)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);return o!==null&&r!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(o=>{var r;const s=o==null||(r=o.address)===null||r===void 0?void 0:r.sheet;s!==void 0&&(i.has(s)||i.add(s))}),U0(this.engine).forEach((o,r)=>{if((t||r!==this.sheetId)&&i.has(r)){var s;o.render(),(s=o.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=r=>{var s;const{row:a,col:l,sheet:u}=(s=r==null?void 0:r.address)!==null&&s!==void 0?s:{};return ce(u)?`${u}:${a}x${l}`:""},o=new Set(t.map(r=>i(r)));e.forEach(r=>{var s,a;const{row:l,col:u}=(s=r.address)!==null&&s!==void 0?s:{};if(ce(l)===!1||ce(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=r==null||(a=r.address)===null||a===void 0?void 0:a.sheet,h=i(r);if(c!==void 0&&!o.has(h)){const d=U0(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,i){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){ot(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const r=this.hot.getCellMeta(e,t);return Fy(i,r.type)&&(oA(i,r.dateFormat)?i=rA(i,r.dateFormat):y8(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(o,i)}}function D8(n,e,t){const i=this.hot.propToCol(t);if(this.isFormulaCellType(e,i)){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},r=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(o);return r.type==="date"&&On(s)&&(s=sA(s,r.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return n}function L8(n,e,t){const{row:i,col:o}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:c}=t.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(h,d),{row:m,col:w}=h.start,{row:C,col:y}=h.end,R=C-m+1,E=y-w+1;for(let H=0;H<g.length;H+=1)for(let P=0;P<g[H].length;P+=1){const W=g[H][P],j=m+H%R,G=w+P%E,Y=this.hot.getCellMeta(j,G);Fy(W,Y.type)&&(W.startsWith("'")?g[H][P]=W.slice(1):this.isFormulaCellType(j,G,this.sheetId)===!1&&(g[H][P]=S8(W,Y.dateFormat)))}return g}function Y0(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Xi(bn))||es(By,this,vt(this.hot.getSettings().data))}function $8(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,i)=>{t.forEach((o,r)=>{const s=this.hot.getCellMeta(i,r),a=s.dateFormat;Fy(o,s.type)&&(e=!0,oA(o,a)?n[i][r]=rA(o,a):this.isFormulaCellType(i,r)===!1&&(n[i][r]=`'${o}`))})}),e===!0&&(es(gr,this,!0),this.engine.setSheetContent(this.sheetId,n),es(gr,this,!1))}function K0(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Xi(bn)))if(this.sheetName=C8(this.engine,this.hot.getSettings()[bn].sheetName),Cl(By,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){es(gr,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),es(gr,this,!1)}}}function k8(n,e,t,i){if(i!=="get"||Cl(gr,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(n);if(o===null||e===null)return;if(!this.isFormulaCellType(o,e)&&this.getCellType(o,e)!=="ARRAY"){iA(t.value)&&(t.value=b8(t.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===o&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&On(a)&&(a=sA(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;t.value=u}function F8(n,e,t,i){if(i!=="get"||Cl(gr,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(n),r=this.hot.propToCol(e);if(o===null||r===null||!this.isFormulaCellType(o,r)&&this.getCellType(o,r)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function X0(n,e){if(Fl(e))return;const t=[],i=[],o=this.engine.batch(()=>{n.forEach(r=>{let[s,a,,l]=r;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):t.push([s,u,l]),i.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const r=this.engine.batch(()=>{t.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(r,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,i)}function V8(n,e){if(Fl(e))return;const t=[],i=[];n.forEach(o=>{let[r,s,,a]=o;const l=this.hot.propToCol(s);if(!On(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ot(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),t.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,i)}function B8(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function W8(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function j8(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(r=>this.engine.isItPossibleToRemoveRows(this.sheetId,[r,1]))===!1?!1:void 0}function U8(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(r=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[r,1]))===!1?!1:void 0}function z8(n,e,t){if(Fl(t))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function G8(n,e,t){if(Fl(t))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function Y8(n,e,t,i){if(Fl(i))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),r=this.engine.batch(()=>{o.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(r)}function K8(n,e,t,i){if(Fl(i))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),r=this.engine.batch(()=>{o.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(r)}function X8(n,e,t){var i;es(gr,this,!0);const o=this.hot.getSourceDataArray(t,0,t+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());es(gr,this,!1),o.forEach((r,s)=>{r.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+s,sheet:this.sheetId},[[a]])})})}function q8(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function Z8(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function Q8(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function J8(n){this.hot.runHooks("afterSheetAdded",n)}function e7(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function t7(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function n7(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,i,,o]=e;i-o!==0&&(t=1)}return this.getTranslatedPhrase(Eb,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,t.col),0),o=Math.max(e.col,t.col),r=[];for(let l=i;l<=o;l+=1)r.push(l);n.hideColumns(r);const s=r[r.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function i7(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Tb,t)},callback(){var t,i;if(e.length===0)return;let o=e[0],r=e[e.length-1];o=(t=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,r=(i=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&i!==void 0?i:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),r-o+1===this.countCols()||this.selectColumns(o,r)},disabled:!1,hidden(){const t=Ue(n.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().col,r=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(o),l=s.getRenderableFromVisualIndex(r),u=s.getNotTrimmedIndexes(),c=[];if(o!==r){const h=r-o+1,d=l-a+1;if(h>d){const g=u.slice(o,r+1);c.push(...g.filter(m=>t.includes(m)))}}else if(a===0&&a<o)c.push(...u.slice(0,o));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>r&&c.push(...u.slice(r+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function o7(n,e){cA(n,e),e.add(n)}function q0(n,e,t){cA(n,e),e.set(n,t)}function cA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oi(n,e){return n.get(Dr(n,e))}function $u(n,e,t){return n.set(Dr(n,e),t),t}function Dr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeHideColumns");le.getSingleton().register("afterHideColumns");le.getSingleton().register("beforeUnhideColumns");le.getSingleton().register("afterUnhideColumns");const hw="hiddenColumns",r7=310;var Ho=new WeakMap,ho=new WeakMap,Ls=new WeakSet;class s7 extends nt{constructor(){super(...arguments),o7(this,Ls),q0(this,Ho,{}),q0(this,ho,null)}static get PLUGIN_KEY(){return hw}static get PLUGIN_PRIORITY(){return r7}isEnabled(){return!!this.hot.getSettings()[hw]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[hw];De(t)&&($u(Ho,this,t),vt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),$u(ho,this,new Lg),oi(ho,this).addLocalHook("init",()=>Dr(Ls,this,d7).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oi(ho,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Dr(Ls,e,h7).call(e,...o)}),this.addHook("afterGetCellMeta",(i,o,r)=>Dr(Ls,this,l7).call(this,i,o,r)),this.addHook("modifyColWidth",(i,o)=>Dr(Ls,this,a7).call(this,i,o),2),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Dr(Ls,e,c7).call(e,...o)}),this.addHook("modifyCopyableRange",i=>Dr(Ls,this,u7).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$u(Ho,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let o=t;const r=oi(ho,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{r[u]=!1}),o=Hn(r,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,o,i&&s)!==!1&&(i&&s&&oi(ho,this).setValues(r),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,i&&s,i&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{oi(ho,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",t,o,i,i&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return Ue(oi(ho,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return oi(ho,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){$u(Ho,this,null),$u(ho,this,null),super.destroy()}}function a7(n,e){if(this.isHidden(e))return 0;if(oi(Ho,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function l7(n,e,t){if(oi(Ho,this).copyPasteEnabled===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const i=t.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenColumn");o>-1&&i.splice(o,1),t.className=i.join(" ")}}}function u7(n){if(oi(Ho,this).copyPasteEnabled)return n;const e=[],t=(i,o,r,s)=>{e.push({startRow:i,endRow:o,startCol:r,endCol:s})};return M(n,i=>{let o=!0,r=0;me(i.startCol,i.endCol,s=>{this.isHidden(s)?(o||t(i.startRow,i.endRow,r,s-1),o=!0):(o&&(r=s),s===i.endCol&&t(i.startRow,i.endRow,r,s),o=!1)})}),e}function c7(n,e){if(!oi(Ho,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),X(e,t)}function h7(n){n.items.push({name:Ne},n7(this),i7(this))}function d7(){Array.isArray(oi(Ho,this).columns)&&this.hideColumns(oi(Ho,this).columns)}function f7(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[i,,o]=e;i-o!==0&&(t=1)}return this.getTranslatedPhrase(Mb,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,t.row),0),o=Math.max(e.row,t.row),r=[];for(let l=i;l<=o;l+=1)r.push(l);n.hideRows(r);const s=r[r.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function g7(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Ib,t)},callback(){var t,i;if(e.length===0)return;let o=e[0],r=e[e.length-1];o=(t=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,r=(i=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&i!==void 0?i:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),r-o+1===this.countRows()||this.selectRows(o,r)},disabled:!1,hidden(){const t=Ue(n.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().row,r=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(o),l=s.getRenderableFromVisualIndex(r),u=s.getNotTrimmedIndexes(),c=[];if(o!==r){const h=r-o+1,d=l-a+1;if(h>d){const g=u.slice(o,r+1);c.push(...g.filter(m=>t.includes(m)))}}else if(a===0&&a<o)c.push(...u.slice(0,o));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>r&&c.push(...u.slice(r+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function m7(n,e){hA(n,e),e.add(n)}function Z0(n,e,t){hA(n,e),e.set(n,t)}function hA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(n,e){return n.get(Lr(n,e))}function ku(n,e,t){return n.set(Lr(n,e),t),t}function Lr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeHideRows");le.getSingleton().register("afterHideRows");le.getSingleton().register("beforeUnhideRows");le.getSingleton().register("afterUnhideRows");const dw="hiddenRows",p7=320;var ur=new WeakMap,fo=new WeakMap,$s=new WeakSet;class w7 extends nt{constructor(){super(...arguments),m7(this,$s),Z0(this,ur,{}),Z0(this,fo,null)}static get PLUGIN_KEY(){return dw}static get PLUGIN_PRIORITY(){return p7}isEnabled(){return!!this.hot.getSettings()[dw]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[dw];De(t)&&(ku(ur,this,t),vt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),ku(fo,this,new Lg),bi(fo,this).addLocalHook("init",()=>Lr($s,this,R7).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,bi(fo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Lr($s,e,S7).call(e,...o)}),this.addHook("afterGetCellMeta",(i,o,r)=>Lr($s,this,C7).call(this,i,o,r)),this.addHook("modifyRowHeight",(i,o)=>Lr($s,this,v7).call(this,i,o)),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Lr($s,e,y7).call(e,...o)}),this.addHook("modifyCopyableRange",i=>Lr($s,this,b7).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ku(ur,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let o=t;const r=bi(fo,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{r[u]=!1}),o=Hn(r,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",t,o,i&&s)!==!1&&(i&&s&&bi(fo,this).setValues(r),this.hot.runHooks("afterUnhideRows",t,o,i&&s,i&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{bi(fo,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",t,o,i,i&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return Ue(bi(fo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return bi(fo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){ku(ur,this,null),ku(fo,this,null),super.destroy()}}function v7(n,e){return this.isHidden(e)?0:n}function C7(n,e,t){if(bi(ur,this).copyPasteEnabled===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const i=t.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenRow");o>-1&&i.splice(o,1),t.className=i.join(" ")}}}function b7(n){if(bi(ur,this).copyPasteEnabled)return n;const e=[],t=(i,o,r,s)=>{e.push({startRow:i,endRow:o,startCol:r,endCol:s})};return M(n,i=>{let o=!0,r=0;me(i.startRow,i.endRow,s=>{this.isHidden(s)?(o||t(r,s-1,i.startCol,i.endCol),o=!0):(o&&(r=s),s===i.endRow&&t(r,s,i.startCol,i.endCol),o=!1)})}),e}function y7(n,e){if(!bi(ur,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),X(e,t)}function S7(n){n.items.push({name:Ne},f7(this),g7(this))}function R7(){Array.isArray(bi(ur,this).rows)&&this.hideRows(bi(ur,this).rows)}function E7(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(ab)},callback(e,t){const[{start:{col:i}}]=t;n.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function T7(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(lb)},callback(e,t){const[{start:{col:i}}]=t;n.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function M7(n,e){dA(n,e),e.add(n)}function I7(n,e,t){dA(n,e),e.set(n,t)}function dA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dv(n,e){return n.get(tg(n,e))}function fw(n,e,t){return n.set(tg(n,e),t),t}function tg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeColumnFreeze");le.getSingleton().register("afterColumnFreeze");le.getSingleton().register("beforeColumnUnfreeze");le.getSingleton().register("afterColumnUnfreeze");const Q0="manualColumnFreeze",P7=110;var Ks=new WeakMap,gw=new WeakSet;class O7 extends nt{constructor(){super(...arguments),M7(this,gw),I7(this,Ks,!1)}static get PLUGIN_KEY(){return Q0}static get PLUGIN_PRIORITY(){return P7}isEnabled(){return!!this.hot.getSettings()[Q0]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>tg(gw,this,A7).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>tg(gw,this,x7).call(this,e,t)),super.enablePlugin())}disablePlugin(){fw(Ks,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;Dv(Ks,this)||fw(Ks,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;Dv(Ks,this)||fw(Ks,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function A7(n){n.items.push({name:"---------"},E7(this),T7(this))}function x7(n,e){if(Dv(Ks,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(i=>i<t))return!1}}function xd(n,e,t){return(e=H7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H7(n){var e=_7(n,"string");return typeof e=="symbol"?e:e+""}function _7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const mw=0,J0=1,eT=2,el="px";let fA=class{constructor(e){xd(this,"hot",void 0),xd(this,"_element",null),xd(this,"state",mw),xd(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=eT}build(){this.state===mw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=J0)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=mw}isAppended(){return this.state===eT}isBuilt(){return this.state>=J0}setPosition(e,t){On(e)&&(this._element.style.top=e+el),On(t)&&(this._element.style[this.inlineProperty]=t+el)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){On(e)&&(this._element.style.width=e+el),On(t)&&(this._element.style.height=t+el)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){On(e)&&(this._element.style.marginTop=e+el),On(t)&&(this._element.style[`margin${Xi(this.inlineProperty)}`]=t+el)}getOffset(){const e=this._element.style,t=`margin${Xi(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const N7="ht__manualColumnMove--backlight";let D7=class extends fA{build(){super.build(),X(this._element,N7)}};const L7="ht__manualColumnMove--guideline";let $7=class extends fA{build(){super.build(),X(this._element,L7)}};function k7(n,e){gA(n,e),e.add(n)}function Di(n,e,t){gA(n,e),e.set(n,t)}function gA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(n,e,t){return n.set($r(n,e),t),t}function he(n,e){return n.get($r(n,e))}function $r(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeColumnMove");le.getSingleton().register("afterColumnMove");const pw="manualColumnMove",F7=120,tT="ht__manualColumnMove",ng="show-ui",Lv="on-moving--columns",$v="after-selection--columns";var In=new WeakMap,Vr=new WeakMap,cr=new WeakMap,wf=new WeakMap,Gr=new WeakMap,Mn=new WeakMap,Hd=new WeakMap,mi=new WeakMap,cl=new WeakMap,ig=new WeakMap,sc=new WeakMap,ks=new WeakSet;class V7 extends nt{constructor(){super(...arguments),k7(this,ks),Di(this,In,new D7(this.hot)),Di(this,Vr,new $7(this.hot)),Di(this,cr,[]),Di(this,wf,0),Di(this,Gr,!1),Di(this,Mn,{}),Di(this,Hd,void 0),Di(this,mi,void 0),Di(this,cl,void 0),Di(this,ig,void 0),Di(this,sc,void 0)}static get PLUGIN_KEY(){return pw}static get PLUGIN_PRIORITY(){return F7}isEnabled(){return!!this.hot.getSettings()[pw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return $r(ks,e,B7).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return $r(ks,e,j7).call(e,...i)}),this.addHook("afterScrollVertically",()=>$r(ks,this,z7).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return $r(ks,e,G7).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,tT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ie(this.hot.rootElement,tT),this.unregisterEvents(),he(In,this).destroy(),he(Vr,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const i=he(Hd,this),o=this.isMovePossible(e,t),r=this.hot.runHooks("beforeColumnMove",e,t,i,o);if(zn(Hd,this,void 0),r===!1)return;o&&this.hot.columnIndexMapper.moveIndexes(e,t);const s=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,o,s),s}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const i=this.countFinalIndex(e,t);return zn(Hd,this,t),this.moveColumns(e,i)}isMovePossible(e,t){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>i,r=t<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(o||r||s||a)}isColumnOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}countFinalIndex(e,t){const i=Hn(e,(o,r)=>(r<t&&(o+=1),o),0);return t-i}getColumnsWidth(e,t){const i=this.hot.columnIndexMapper;let o=0;for(let r=e;r<=t;r+=1){const s=i.getRenderableFromVisualIndex(r);r<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[pw];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const i=[];return me(e,t,o=>{i.push(o)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(mi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,o=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(mi,this)-1);const s=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=he(In,this).getOffset().start,u=he(In,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,w=Ct(this.hot.rootElement),C=m.innerWidth-he(cl,this)-w;h=m.innerWidth-he(Mn,this).eventPageX-C-(i.scrollX===void 0?o:0)}else h=he(Mn,this).eventPageX-(he(cl,this)-(i.scrollX===void 0?o:0));if(he(ig,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(mi,this))&&(r+=o),r+=c,he(mi,this)<0)he(sc,this)>0?he(Mn,this).col=0:he(Mn,this).col=e>0?e-1:e;else if(he(Mn,this).TD.offsetWidth/2+r<=h){const m=he(mi,this)>=he(wf,this)?he(wf,this)-1:he(mi,this);he(Mn,this).col=m+1,r+=he(Mn,this).TD.offsetWidth}else he(Mn,this).col=he(mi,this);let d=h,g=r;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),r>=s-1?g=s-1:g===0?g=1:i.scrollX!==void 0&&he(mi,this)<he(sc,this)&&(g-=he(cl,this)<=i.scrollX?he(cl,this):0),he(In,this).setPosition(null,d),he(Vr,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>$r(ks,this,W7).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>$r(ks,this,U7).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(In,this).build(),he(Vr,this).build()}destroy(){he(In,this).destroy(),he(Vr,this).destroy(),super.destroy()}}function B7(n,e,t,i){const o=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Re(n.target,"sortAction");if(!s||!r||he(Gr,this)||n.button!==0||a){zn(Gr,this,!1),he(cr,this).length=0,Ie(this.hot.rootElement,[Lv,ng]);return}const l=he(Vr,this).isBuilt()&&!he(Vr,this).isAppended(),u=he(In,this).isBuilt()&&!he(In,this).isAppended();l&&u&&(he(Vr,this).appendTo(o.hider),he(In,this).appendTo(o.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=g){i.column=!0,zn(Gr,this,!0);const m=t.firstChild?Fk(n,t.firstChild).x:n.offsetX;he(Mn,this).eventPageX=n.pageX,zn(mi,this,e.col),he(Mn,this).TD=t,he(Mn,this).col=e.col,zn(cr,this,this.prepareColumnsToMoving(d,g)),zn(ig,this,!!this.hot.getSettings().rowHeaders),zn(wf,this,this.hot.countCols()),zn(sc,this,this.hot.getSettings().fixedColumnsStart),zn(cl,this,rn(this.hot.rootElement).left);const w=he(ig,this)?-1:0,C=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,y=e.col<he(sc,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),E=Math.abs(m-(this.hot.isRtl()?t.offsetWidth:0)),H=this.getColumnsWidth(d,e.col-1)+E,P=this.getColumnsWidth(w,d-1)+(y?R:0)+H;he(In,this).setPosition(C,P),he(In,this).setSize(this.getColumnsWidth(d,g),o.hider.offsetHeight-C),he(In,this).setOffset(null,-H),X(this.hot.rootElement,Lv)}else Ie(this.hot.rootElement,$v),zn(Gr,this,!1),he(cr,this).length=0}function W7(n){he(Gr,this)&&(he(Mn,this).eventPageX=n.pageX,this.refreshPositions())}function j7(n,e,t,i){!this.hot.getSelectedRangeLast()||!he(Gr,this)||(he(cr,this).indexOf(e.col)>-1?Ie(this.hot.rootElement,ng):X(this.hot.rootElement,ng),i.row=!0,i.column=!0,i.cell=!0,zn(mi,this,e.col),he(Mn,this).TD=t)}function U7(){const n=he(Mn,this).col,e=he(cr,this).length;if(zn(mi,this,void 0),zn(Gr,this,!1),Ie(this.hot.rootElement,[Lv,ng,$v]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,$v),e<1||n===void 0)return;const t=he(cr,this)[0],i=this.hot.toPhysicalColumn(t),o=this.dragColumns(he(cr,this),n);if(he(cr,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const r=this.hot.toVisualColumn(i),s=r+e-1;this.hot.selectColumns(r,s)}}function z7(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,i=e+t;he(In,this).setPosition(i),he(In,this).setSize(null,n.hider.offsetHeight-i)}function G7(){this.moveBySettingsOrLoad()}function Y7(n,e){mA(n,e),e.add(n)}function wn(n,e,t){mA(n,e),e.set(n,t)}function mA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(n,e,t){return n.set(ji(n,e),t),t}function oe(n,e){return n.get(ji(n,e))}function ji(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const og="manualColumnResize",K7=130,nT="manualColumnWidths";var rr=new WeakMap,_d=new WeakMap,ti=new WeakMap,rg=new WeakMap,Oo=new WeakMap,X7=new WeakMap,bl=new WeakMap,Nd=new WeakMap,Bn=new WeakMap,nr=new WeakMap,ha=new WeakMap,sg=new WeakMap,ac=new WeakMap,lc=new WeakMap,ii=new WeakMap,uc=new WeakMap,go=new WeakSet;class q7 extends nt{static get PLUGIN_KEY(){return og}static get PLUGIN_PRIORITY(){return K7}constructor(e){super(e),Y7(this,go),wn(this,rr,null),wn(this,_d,null),wn(this,ti,[]),wn(this,rg,null),wn(this,Oo,null),wn(this,X7,null),wn(this,bl,null),wn(this,Nd,null),wn(this,Bn,this.hot.rootDocument.createElement("DIV")),wn(this,nr,this.hot.rootDocument.createElement("DIV")),wn(this,ha,null),wn(this,sg,!1),wn(this,ac,0),wn(this,lc,null),wn(this,ii,void 0),wn(this,uc,void 0),X(oe(Bn,this),"manualColumnResizer"),X(oe(nr,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[og]}enablePlugin(){this.enabled||($t(ii,this,new os),oe(ii,this).addLocalHook("init",()=>ji(go,this,Z7).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(ii,this)),this.addHook("modifyColWidth",(e,t)=>ji(go,this,i5).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>ji(go,this,o5).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,i)=>ji(go,this,r5).call(this,e,t,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){$t(uc,this,oe(ii,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",nT,oe(ii,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",nT,e),e.value}setManualSize(e,t){const i=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return oe(ii,this).setValueAtIndex(o,i),i}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);oe(ii,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;$t(rr,this,e);const{_wt:t}=this.hot.view,i=t.wtTable.getCoords(oe(rr,this)),o=i.col;if(o<0)return;const r=Wt(oe(rr,this)),s=oe(rr,this).getBoundingClientRect(),a=o<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(rr,this),i.row,i.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(oe(rr,this),i.row,i.col)),$t(_d,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),$t(ti,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;me(d,g,m=>{oe(ti,this).includes(m)||oe(ti,this).push(m)})})}oe(ti,this).includes(oe(_d,this))||$t(ti,this,[oe(_d,this)]),$t(Nd,this,l.start-6),$t(bl,this,parseInt(s.width,10)),oe(Bn,this).style.top=`${l.top}px`,oe(Bn,this).style[this.inlineDir]=`${oe(Nd,this)+oe(bl,this)}px`,oe(Bn,this).style.height=`${r}px`,this.hot.rootElement.appendChild(oe(Bn,this))}refreshHandlePosition(){oe(Bn,this).style[this.inlineDir]=`${oe(Nd,this)+oe(rg,this)}px`}setupGuidePosition(){const e=parseInt(Wt(oe(Bn,this)),10),t=parseInt(oe(Bn,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);X(oe(Bn,this),"active"),X(oe(nr,this),"active"),oe(nr,this).style.top=`${t}px`,this.refreshGuidePosition(),oe(nr,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(oe(nr,this))}refreshGuidePosition(){oe(nr,this).style[this.inlineDir]=oe(Bn,this).style[this.inlineDir]}hideHandleAndGuide(){Ie(oe(Bn,this),"active"),Ie(oe(nr,this),"active")}checkIfColumnHeader(e){const t=oa(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,o.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,o)=>{const r=this.hot.runHooks("beforeColumnResize",oe(Oo,this),i,!0);r!==void 0&&$t(Oo,this,r),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,oe(Oo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Oo,this),i,!0),o&&e()};oe(ac,this)>=2&&(oe(ti,this).length>1?(M(oe(ti,this),o=>{t(o)}),e()):M(oe(ti,this),o=>{t(o,!0)})),$t(ac,this,0),$t(lc,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",i=>ji(go,this,Q7).call(this,i)),this.eventManager.addEventListener(t,"mousedown",i=>ji(go,this,J7).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>ji(go,this,e5).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ji(go,this,t5).call(this)),this.eventManager.addEventListener(oe(Bn,this),"contextmenu",()=>ji(go,this,n5).call(this))}destroy(){super.destroy()}}function Z7(){const n=this.hot.getSettings()[og],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,i)=>{oe(ii,this).setValueAtIndex(i,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,i)=>{oe(ii,this).setValueAtIndex(i,t)})},!0),$t(uc,this,n)):n===!0&&Array.isArray(oe(uc,this))&&this.hot.batchExecution(()=>{oe(uc,this).forEach((t,i)=>{oe(ii,this).setValueAtIndex(i,t)})},!0)}function Q7(n){if(!JM(n.target)&&oe(sg,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(oe(ha,this)||this.setupHandlePosition(e))}}function J7(n){n.target.parentNode===this.hot.rootElement&&Re(n.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(rr,this)),this.setupGuidePosition(),$t(ha,this,!0),oe(lc,this)===null&&($t(lc,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(lc,this))),$t(ac,this,oe(ac,this)+1),this.startX=n.pageX,$t(Oo,this,oe(bl,this)))}function e5(n){if(oe(ha,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();$t(rg,this,oe(bl,this)+e),M(oe(ti,this),t=>{$t(Oo,this,this.setManualSize(t,oe(rg,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function t5(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeColumnResize",oe(Oo,this),t,!1),i&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Oo,this),t,!1)};oe(ha,this)&&(this.hideHandleAndGuide(),$t(ha,this,!1),oe(Oo,this)!==oe(bl,this)&&(oe(ti,this).length>1?(M(oe(ti,this),i=>{e(i)}),n()):M(oe(ti,this),i=>{e(i,!0)})),this.setupHandlePosition(oe(rr,this)))}function n5(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(Bn,this)),this.hot.rootElement.removeChild(oe(nr,this)),$t(ha,this,!1),$t(sg,this,!0),this.hot._registerImmediate(()=>{$t(sg,this,!1)})}function i5(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalColumn(e),o=oe(ii,this).getValueAtIndex(i);this.hot.getSettings()[og]&&o&&(t=o)}return t}function o5(n,e){let t=oe(ii,this).getValueAtIndex(e);return t===null&&(t=n),t}function r5(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function ww(n,e,t){return(e=s5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s5(n){var e=a5(n,"string");return typeof e=="symbol"?e:e+""}function a5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vw=0,iT=1,oT=2,tl="px";let pA=class{constructor(e){ww(this,"hot",void 0),ww(this,"_element",null),ww(this,"state",vw),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=oT}build(){this.state===vw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=vw}isAppended(){return this.state===oT}isBuilt(){return this.state>=iT}setPosition(e,t){e!==void 0&&(this._element.style.top=e+tl),t!==void 0&&(this._element.style.left=t+tl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+tl),t&&(this._element.style.height=t+tl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+tl),t&&(this._element.style.marginLeft=t+tl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const l5="ht__manualRowMove--backlight";class u5 extends pA{build(){super.build(),X(this._element,l5)}}const c5="ht__manualRowMove--guideline";class h5 extends pA{build(){super.build(),X(this._element,c5)}}function d5(n,e){wA(n,e),e.add(n)}function nl(n,e,t){wA(n,e),e.set(n,t)}function wA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(n,e,t){return n.set(kr(n,e),t),t}function Pe(n,e){return n.get(kr(n,e))}function kr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeRowMove");le.getSingleton().register("afterRowMove");const Cw="manualRowMove",f5=140,rT="ht__manualRowMove",ag="show-ui",kv="on-moving--rows",Fv="after-selection--rows";var Pn=new WeakMap,Br=new WeakMap,hr=new WeakMap,Yr=new WeakMap,Gn=new WeakMap,Dd=new WeakMap,Fs=new WeakSet;class g5 extends nt{constructor(){super(...arguments),d5(this,Fs),nl(this,Pn,new u5(this.hot)),nl(this,Br,new h5(this.hot)),nl(this,hr,[]),nl(this,Yr,void 0),nl(this,Gn,{}),nl(this,Dd,void 0)}static get PLUGIN_KEY(){return Cw}static get PLUGIN_PRIORITY(){return f5}isEnabled(){return!!this.hot.getSettings()[Cw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return kr(Fs,e,m5).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return kr(Fs,e,w5).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>kr(Fs,this,C5).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return kr(Fs,e,b5).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,rT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ie(this.hot.rootElement,rT),this.unregisterEvents(),Pe(Pn,this).destroy(),Pe(Br,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const i=Pe(Dd,this),o=this.isMovePossible(e,t),r=this.hot.runHooks("beforeRowMove",e,t,i,o);if(ta(Dd,this,void 0),r===!1)return;o&&this.hot.rowIndexMapper.moveIndexes(e,t);const s=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,o,s),s}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const i=this.countFinalIndex(e,t);return ta(Dd,this,t),this.moveRows(e,i)}isMovePossible(e,t){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>i,r=t<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(o||r||s||a)}isRowOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}countFinalIndex(e,t){const i=Hn(e,(o,r)=>(r<t&&(o+=1),o),0);return t-i}getRowsHeight(e,t){const i=this.hot.rowIndexMapper;let o=0;for(let r=e;r<=t;r++){const s=i.getRenderableFromVisualIndex(r);s!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Cw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:i,to:o}=e,r=Math.min(i.row,o.row),s=Math.max(i.row,o.row);return me(r,s,a=>{t.push(a)}),t}refreshPositions(){const e=Pe(Gn,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&i<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const r=this.hot.view._wt.wtTable,s=Pe(Gn,this).TD,a=this.hot.rootElement,l=rn(a),u=El(a),c=r.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,g=Pe(Gn,this).eventPageY-d+c,m=r.hider.offsetHeight,w=r.TBODY.offsetTop,C=Pe(Pn,this).getOffset().top,y=Pe(Pn,this).getSize().height,R=s.offsetHeight/2,E=s.offsetHeight;let H=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=g>=H+R;this.isFixedRowTop(e.row)&&(H+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Pe(Gn,this).row=t>0?t-1:t:P?(Pe(Gn,this).row=e.row+1,H+=e.row===0?E-1:E):Pe(Gn,this).row=e.row;let W=g,j=H;g+y+C>=m?W=m-y-C:g+C<w&&(W=w+Math.abs(C)),H>=m-1&&(j=m-1),Pe(Pn,this).setPosition(W),Pe(Br,this).setPosition(j)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>kr(Fs,this,p5).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>kr(Fs,this,v5).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Pe(Pn,this).build(),Pe(Br,this).build()}destroy(){Pe(Pn,this).destroy(),Pe(Br,this).destroy(),super.destroy()}}function m5(n,e,t,i){const{wtTable:o,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Pe(Yr,this)||n.button!==0){ta(Yr,this,!1),Pe(hr,this).length=0,Ie(this.hot.rootElement,[kv,ag]);return}const l=Pe(Br,this).isBuilt()&&!Pe(Br,this).isAppended(),u=Pe(Pn,this).isBuilt()&&!Pe(Pn,this).isAppended();l&&u&&(Pe(Br,this).appendTo(o.hider),Pe(Pn,this).appendTo(o.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=g){i.row=!0,ta(Yr,this,!0),Pe(Gn,this).eventPageY=n.pageY,Pe(Gn,this).coords=e,Pe(Gn,this).TD=t,ta(hr,this,this.prepareRowsToMoving());const m=o.holder.scrollLeft+r.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+n.offsetY;Pe(Pn,this).setPosition(null,m),Pe(Pn,this).setSize(o.hider.offsetWidth-m,this.getRowsHeight(d,g)),Pe(Pn,this).setOffset(-w,null),X(this.hot.rootElement,kv),this.refreshPositions()}else Ie(this.hot.rootElement,Fv),ta(Yr,this,!1),Pe(hr,this).length=0}function p5(n){Pe(Yr,this)&&(Pe(Gn,this).eventPageY=n.pageY,this.refreshPositions())}function w5(n,e,t,i){!this.hot.getSelectedRangeLast()||!Pe(Yr,this)||(Pe(hr,this).indexOf(e.row)>-1?Ie(this.hot.rootElement,ag):X(this.hot.rootElement,ag),i.row=!0,i.column=!0,i.cell=!0,Pe(Gn,this).coords=e,Pe(Gn,this).TD=t)}function v5(){const n=Pe(Gn,this).row,e=Pe(hr,this).length;if(ta(Yr,this,!1),Ie(this.hot.rootElement,[kv,ag,Fv]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,Fv),e<1||n===void 0)return;const t=Pe(hr,this)[0],i=this.hot.toPhysicalRow(t),o=this.dragRows(Pe(hr,this),n);if(Pe(hr,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const r=this.hot.toVisualRow(i),s=r+e-1;this.hot.selectRows(r,s)}}function C5(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,i=e+t;Pe(Pn,this).setPosition(null,i),Pe(Pn,this).setSize(n.hider.offsetWidth-i)}function b5(){this.moveBySettingsOrLoad()}function y5(n,e){vA(n,e),e.add(n)}function vn(n,e,t){vA(n,e),e.set(n,t)}function vA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(n,e,t){return n.set(sr(n,e),t),t}function ie(n,e){return n.get(sr(n,e))}function sr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const lg="manualRowResize",S5=30,sT="manualRowHeights";var Ro=new WeakMap,Ld=new WeakMap,ni=new WeakMap,cc=new WeakMap,Wr=new WeakMap,Wy=new WeakMap,yl=new WeakMap,$d=new WeakMap,En=new WeakMap,yo=new WeakMap,da=new WeakMap,ug=new WeakMap,hc=new WeakMap,dc=new WeakMap,Ui=new WeakMap,fc=new WeakMap,Ar=new WeakSet;class R5 extends nt{static get PLUGIN_KEY(){return lg}static get PLUGIN_PRIORITY(){return S5}constructor(e){super(e),y5(this,Ar),vn(this,Ro,null),vn(this,Ld,null),vn(this,ni,[]),vn(this,cc,null),vn(this,Wr,null),vn(this,Wy,null),vn(this,yl,null),vn(this,$d,null),vn(this,En,this.hot.rootDocument.createElement("DIV")),vn(this,yo,this.hot.rootDocument.createElement("DIV")),vn(this,da,!1),vn(this,ug,!1),vn(this,hc,0),vn(this,dc,null),vn(this,Ui,void 0),vn(this,fc,void 0),X(ie(En,this),"manualRowResizer"),X(ie(yo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[lg]}enablePlugin(){this.enabled||(Ot(Ui,this,new os),ie(Ui,this).addLocalHook("init",()=>sr(Ar,this,A5).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ie(Ui,this)),this.addHook("modifyRowHeight",(e,t)=>sr(Ar,this,O5).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ot(fc,this,ie(Ui,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",sT,ie(Ui,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",sT,e),e.value}setManualSize(e,t){const i=this.hot.toPhysicalRow(e),o=Math.max(t,AI);return ie(Ui,this).setValueAtIndex(i,o),o}getLastDesiredRowHeight(){return ie(cc,this)}setupHandlePosition(e){Ot(Ro,this,e);const{view:t}=this.hot,{_wt:i}=t,o=i.wtTable.getCoords(ie(Ro,this)),r=o.row;if(r<0)return;const s=Ct(ie(Ro,this)),a=ie(Ro,this).getBoundingClientRect(),l=r<i.getSetting("fixedRowsTop"),u=r>=t.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Ro,this),o.row,o.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ie(Ro,this),o.row,o.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ie(Ro,this),o.row,o.col)),Ot(Ld,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(r)),Ot(ni,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,g=>{const m=g.getTopStartCorner().row,w=g.getBottomStartCorner().row;me(m,w,C=>{ie(ni,this).includes(C)||ie(ni,this).push(C)})})}ie(ni,this).includes(ie(Ld,this))||Ot(ni,this,[ie(Ld,this)]),Ot($d,this,c.top-6),Ot(yl,this,parseInt(a.height,10)),ie(En,this).style.top=`${ie($d,this)+ie(yl,this)}px`,ie(En,this).style[this.inlineDir]=`${c.start}px`,ie(En,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ie(En,this))}refreshHandlePosition(){ie(En,this).style.top=`${ie($d,this)+ie(cc,this)}px`}setupGuidePosition(){const e=parseInt(Ct(ie(En,this)),10),t=parseInt(ie(En,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);X(ie(En,this),"active"),X(ie(yo,this),"active"),ie(yo,this).style.top=ie(En,this).style.top,ie(yo,this).style[this.inlineDir]=`${t}px`,ie(yo,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(ie(yo,this))}refreshGuidePosition(){ie(yo,this).style.top=ie(En,this).style.top}hideHandleAndGuide(){Ie(ie(En,this),"active"),Ie(ie(yo,this),"active")}checkIfRowHeader(e){const t=oa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,o.clone.wtTable.TBODY,r.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&ie(Wr,this)<t?t:ie(Wr,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,o)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);r!==void 0&&Ot(Wr,this,r),this.setManualSize(i,ie(Wr,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),o&&e()};ie(hc,this)>=2&&(ie(ni,this).length>1?(M(ie(ni,this),o=>{t(o)}),e()):M(ie(ni,this),o=>{t(o,!0)})),Ot(hc,this,0),Ot(dc,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>sr(Ar,this,E5).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>sr(Ar,this,T5).call(this,i)),this.eventManager.addEventListener(t,"mousemove",i=>sr(Ar,this,M5).call(this,i)),this.eventManager.addEventListener(t,"mouseup",()=>sr(Ar,this,I5).call(this)),this.eventManager.addEventListener(ie(En,this),"contextmenu",()=>sr(Ar,this,P5).call(this))}destroy(){super.destroy()}}function E5(n){if(!JM(n.target)&&ie(ug,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(ie(da,this)||this.setupHandlePosition(e))}}function T5(n){Re(n.target,"manualRowResizer")&&(this.setupHandlePosition(ie(Ro,this)),this.setupGuidePosition(),Ot(da,this,!0),ie(dc,this)===null&&(Ot(dc,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(dc,this))),Ot(hc,this,ie(hc,this)+1),Ot(Wy,this,n.pageY),Ot(Wr,this,ie(yl,this)))}function M5(n){ie(da,this)&&(Ot(cc,this,ie(yl,this)+(n.pageY-ie(Wy,this))),M(ie(ni,this),e=>{Ot(Wr,this,this.setManualSize(e,ie(cc,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function I5(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),i&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};ie(da,this)&&(this.hideHandleAndGuide(),Ot(da,this,!1),ie(Wr,this)!==ie(yl,this)&&(ie(ni,this).length>1?(M(ie(ni,this),i=>{e(i)}),n()):M(ie(ni,this),i=>{e(i,!0)})),this.setupHandlePosition(ie(Ro,this)))}function P5(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(En,this)),this.hot.rootElement.removeChild(ie(yo,this)),Ot(da,this,!1),Ot(ug,this,!0),this.hot._registerImmediate(()=>{Ot(ug,this,!1)})}function O5(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalRow(e),o=ie(Ui,this).getValueAtIndex(i);this.hot.getSettings()[lg]&&o&&(t=o)}return t}function A5(){const n=this.hot.getSettings()[lg],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,i)=>{ie(Ui,this).setValueAtIndex(i,t)}):Array.isArray(n)?(n.forEach((t,i)=>{ie(Ui,this).setValueAtIndex(i,t)}),Ot(fc,this,n)):n===!0&&Array.isArray(ie(fc,this))&&ie(fc,this).forEach((t,i)=>{ie(Ui,this).setValueAtIndex(i,t)})},!0)}function x5(n,e,t){H5(n,e),e.set(n,t)}function H5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vs(n,e,t){return(e=_5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _5(n){var e=N5(n,"string");return typeof e=="symbol"?e:e+""}function N5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function aT(n,e){return n.get(CA(n,e))}function kd(n,e,t){return n.set(CA(n,e),t),t}function CA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Bs=new WeakMap;class Eo{constructor(e,t,i,o,r,s){Vs(this,"row",void 0),Vs(this,"col",void 0),Vs(this,"rowspan",void 0),Vs(this,"colspan",void 0),Vs(this,"removed",!1),Vs(this,"cellCoordsFactory",void 0),Vs(this,"cellRangeFactory",void 0),x5(this,Bs,null),this.row=e,this.col=t,this.rowspan=i,this.colspan=o,this.cellCoordsFactory=r,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:i,rowspan:o,colspan:r}=e;return rt`The merged cell declared with {row: ${t}, col: ${i},\x20
      rowspan: ${o}, colspan: ${r}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:i}=e;return rt`The merged cell declared at [${t}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:i}=e;return rt`The merged cell declared at [${t}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:i}=e;return rt`The merged cell declared at [${t}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:i,rowspan:o,colspan:r}=e;return t<0||i<0||o<0||r<0}static isSingleCell(e){let{rowspan:t,colspan:i}=e;return i===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:i}=e;return i===0||t===0}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),kd(Bs,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const i=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,r=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(t,o),l=Math.max(t,o),u=this[s],c=this[s]+this[r]-1;if(u>=t&&(this[s]+=i),i>0)t<=c&&t>u&&(this[r]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,kd(Bs,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[r]-=h}else if(u<=a&&c>=l)this[r]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[r]-=h}}return kd(Bs,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return aT(Bs,this)||kd(Bs,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),aT(Bs,this)}}function D5(n,e){L5(n,e),e.add(n)}function L5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fd(n,e,t){return(e=$5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $5(n){var e=k5(n,"string");return typeof e=="symbol"?e:e+""}function k5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ws(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xr=new WeakSet;class cg{constructor(e){D5(this,xr),Fd(this,"plugin",void 0),Fd(this,"mergedCells",[]),Fd(this,"mergedCellsMatrix",new Map),Fd(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:i}=e;return rt`The merged cell declared at [${t}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(t))!==null&&i!==void 0?i:!1}getByRange(e){let t=!1;return M(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(t=i,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(o=>{const{row:r,col:s,colspan:a,rowspan:l}=o;for(let u=r;u<r+l;u++)for(let c=s;c<s+a;c++)t.add(`r${u},c${c}`)}),e.filter(o=>{const{row:r,col:s,colspan:a,rowspan:l}=o,u=new Set;let c=!1;for(let h=r;h<r+l;h++){for(let d=s;d<s+a;d++){const g=`r${h},c${d}`;if(t.has(g)){ot(cg.IS_OVERLAPPING_WARNING(o)),c=!0;break}u.add(g)}if(c)break}return c||t.add(...u),!c})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:o}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=r;l++)for(let u=o;u<=s;u++){const c=this.get(l,u);c&&(t||!t&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,o=e.col,r=e.rowspan,s=e.colspan,a=new Eo(i,o,r,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,o),u=t?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ws(xr,this,lT).call(this,a),a):(ot(cg.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const i=this.get(e,t),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(this.mergedCells.splice(o,1),Ws(xr,this,F5).call(this,i),i):!1}clear(){M(this.mergedCells,e=>{let{row:t,col:i,rowspan:o,colspan:r}=e;me(t,t+o,s=>{me(i,i+r,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const i=this.get(e,t);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===t}getFirstRenderableCoords(e,t){const i=this.get(e,t);if(!i||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,r)}getStartMostColumnIndex(e,t){const i=Ws(xr,this,Vd).call(this,e,"col",-1);let o=t;for(let r=0;r<i.length;r++)if(i[r]<=t){o=i[r];break}return o}getEndMostColumnIndex(e,t){const i=Ws(xr,this,Vd).call(this,e,"col",1);let o=t;for(let r=0;r<i.length;r++)if(i[r]>=t){o=i[r];break}return o}getTopMostRowIndex(e,t){const i=Ws(xr,this,Vd).call(this,e,"row",-1);let o=t;for(let r=0;r<i.length;r++)if(i[r]<=t){o=i[r];break}return o}getBottomMostRowIndex(e,t){const i=Ws(xr,this,Vd).call(this,e,"row",1);let o=t;for(let r=0;r<i.length;r++)if(i[r]>=t){o=i[r];break}return o}shiftCollections(e,t,i){const o=[0,0];switch(e){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}const r=[];this.mergedCells.forEach(s=>{s.shift(o,t),s.removed&&r.push(s)}),r.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ws(xr,this,lT).call(this,s)})}}function Vd(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,o=t===1?n.getTopStartCorner():n.getBottomEndCorner(),r=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let s=o.row;t===1?s<=r.row:s>=r.row;s+=t)for(let a=o.col;t===1?a<=r.col:a>=r.col;a+=t){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=t===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function lT(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function F5(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function bw(n,e,t){return(e=V5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function V5(n){var e=B5(n,"string");return typeof e=="symbol"?e:e+""}function B5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class W5{constructor(e){bw(this,"plugin",void 0),bw(this,"mergedCellsCollection",void 0),bw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?i="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?i="up":t[1]===e[1]&&t[2]===e[2]?i="right":i="left",i}snapDragArea(e,t,i,o){const r=t.slice(0),s=this.getAutofillSize(e,t,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,g=Math.floor(s/d)*d,m=s-g,w=this.getFarthestCollection(e,t,i,o);if(w){if(i==="down"){const C=w.row+w.rowspan-a-m;r[2]+C>=this.plugin.hot.countRows()?r[2]-=m:r[2]+=m?C:0}else if(i==="right"){const C=w.col+w.colspan-l-m;r[3]+C>=this.plugin.hot.countCols()?r[3]-=m:r[3]+=m?C:0}else if(i==="up"){const C=u-m-w.row+1;r[0]+C<0?r[0]+=m:r[0]-=m?C:0}else if(i==="left"){const C=c-m-w.col+1;r[1]+C<0?r[1]+=m:r[1]-=m?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:o,fillSize:s,dragArea:r,cycleLength:d}),r}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,e)}getAutofillSize(e,t,i){const[o,r,s,a]=e,[l,u,c,h]=t;switch(i){case"up":return o-l;case"down":return c-s;case"left":return r-u;case"right":return h-a;default:return null}}getDragArea(e,t,i){const[o,r,s,a]=e,[l,u,c,h]=t;switch(i){case"up":return[l,u,o-1,a];case"down":return[s+1,r,c,a];case"left":return[l,u,s,r-1];case"right":return[o,a+1,c,h];default:return null}}getFarthestCollection(e,t,i,o){const[r,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?r:s,d=this.getAutofillSize(e,t,i),g=u?a-r+1:l-s+1,m=Math.floor(d/g)*g,w=d-m;let C=null,y=null,R=null;switch(i){case"up":C="includesVertically",R=c-w+1;break;case"left":C="includesHorizontally",R=c-w+1;break;case"down":C="includesVertically",R=h+w-1;break;case"right":C="includesHorizontally",R=h+w-1;break}return M(o,E=>{E[C](R)&&E.isFarther(y,i)&&(y=E)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,r=(u,c)=>{switch(o){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,r(a,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===i.length-1&&(l+=1)}while(r(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},i={min:null,max:null};return M(e,o=>{const r=o[0],s=this.plugin.hot.propToCol(o[1]);(t.min===null||r<t.min)&&(t.min=r),(t.max===null||r>t.max)&&(t.max=r),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){const o=this.getDragArea(e,t,i),[r,s,a,l]=o,u=this.plugin.hot._createCellCoords(r,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function yw(n,e,t){return(e=j5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function j5(n){var e=U5(n,"string");return typeof e=="symbol"?e:e+""}function U5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class z5{constructor(e){yw(this,"plugin",void 0),yw(this,"hot",void 0),yw(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,i,o){const r=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(r<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const i=[];if(!t||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let r=0;r<e.colspan;r+=1)i.push(this.hot._createCellCoords(e.row+o,e.col+r));for(let o=0;o<i.length;o+=1){const r=[];for(let s=0;s<t.length;s+=1)r[s]=t[s].includes(i[o]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function G5(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(cb)}return this.getTranslatedPhrase(ub)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Eo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function gc(n,e,t){return(e=Y5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Y5(n){var e=K5(n,"string");return typeof e=="symbol"?e:e+""}function K5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uT{constructor(e){gc(this,"data",void 0),gc(this,"next",null),gc(this,"prev",null),this.data=e}}class Bd{constructor(){gc(this,"first",null),gc(this,"last",null)}push(e){const t=new uT(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.last;this.last=t,t.prev=i,i.next=t}return t}unshift(e){const t=new uT(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.first;this.first=t,t.next=i,i.prev=t}}inorder(e){let t=this.first;for(;t;){const i=e(t);if(t===this.last||i===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,i,o;for(;t;){if(t.data===e)return i=t.next,o=t.prev,i&&(i.prev=o),o&&(o.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=o),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,o){o&&(e(o,o.next),o.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,i;for(;e;)i=e.next,e.next=t,t.prev=e,t=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=t,this.last=i}}function X5(n,e){bA(n,e),e.add(n)}function js(n,e,t){bA(n,e),e.set(n,t)}function bA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(n,e){return n.get(hg(n,e))}function Xn(n,e,t){return n.set(hg(n,e),t),t}function hg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mo=new WeakMap,po=new WeakMap,wo=new WeakMap,vo=new WeakMap,Vv=new WeakMap,Wd=new WeakMap,jd=new WeakMap,Sw=new WeakSet;class q5{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:i,columnIndexMapper:o}=e;X5(this,Sw),js(this,mo,new Bd),js(this,po,new Bd),js(this,wo,null),js(this,vo,null),js(this,Vv,null),js(this,Wd,null),js(this,jd,null),Xn(Vv,this,t),Xn(Wd,this,i),Xn(jd,this,o)}getCurrentVerticalNode(){return tt(vo,this).data}getFirstVerticalNode(){return tt(po,this).first.data}getNextVerticalNode(){return tt(vo,this).next.data}getPrevVerticalNode(){return tt(vo,this).prev.data}getCurrentHorizontalNode(){return tt(wo,this).data}getFirstHorizontalNode(){return tt(mo,this).first.data}getNextHorizontalNode(){return tt(wo,this).next.data}getPrevHorizontalNode(){return tt(wo,this).prev.data}setPrevNodeAsActive(){Xn(vo,this,tt(vo,this).prev),Xn(wo,this,tt(wo,this).prev)}setNextNodeAsActive(){Xn(vo,this,tt(vo,this).next),Xn(wo,this,tt(wo,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),i=e.getBottomEndCorner(),o=new WeakSet;Xn(mo,this,new Bd);for(let s=t.row;s<=i.row;s++)if(!tt(Wd,this).isHidden(s))for(let a=t.col;a<=i.col;a++){if(tt(jd,this).isHidden(a))continue;const l=hg(Sw,this,cT).call(this,e,tt(mo,this),o,s,a);l&&Xn(wo,this,l)}tt(mo,this).first&&(tt(mo,this).first.prev=tt(mo,this).last,tt(mo,this).last.next=tt(mo,this).first);const r=new WeakSet;Xn(po,this,new Bd);for(let s=t.col;s<=i.col;s++)if(!tt(jd,this).isHidden(s))for(let a=t.row;a<=i.row;a++){if(tt(Wd,this).isHidden(a))continue;const l=hg(Sw,this,cT).call(this,e,tt(po,this),r,a,s);l&&Xn(vo,this,l)}tt(po,this).first&&(tt(po,this).first.prev=tt(po,this).last,tt(po,this).last.next=tt(po,this).first)}setActiveNode(e,t){return tt(mo,this).inorder(i=>{const{rowStart:o,rowEnd:r,colStart:s,colEnd:a}=i.data;if(e>=o&&e<=r&&t>=s&&t<=a)return Xn(wo,this,i),!1}),tt(po,this).inorder(i=>{const{rowStart:o,rowEnd:r,colStart:s,colEnd:a}=i.data;if(e>=o&&e<=r&&t>=s&&t<=a)return Xn(vo,this,i),!1}),this}}function cT(n,e,t,i,o){const r=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=n.highlight.clone().normalize(),l=tt(Vv,this).call(this,i,o);if(l&&t.has(l))return null;const u={colStart:o,colEnd:o,rowStart:i,rowEnd:i};if(l){if(t.add(l),l.row<r.row||l.row+l.rowspan-1>s.row||l.col<r.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&o===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function Z5(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:i}=e;function o(){}function r(s,a,l){const u=n.mergedCellsCollection.get(a,l);if(!De(u)){s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="";return}const{row:c,col:h,colspan:d,rowspan:g}=u,[m,w]=n.translateMergedCellToRenderable(c,g,h,d),C=t.getRenderableFromVisualIndex(a),y=i.getRenderableFromVisualIndex(l),R=m-C+1,E=w-y+1,H=t.getNearestNotHiddenIndex(c,1),P=i.getNearestNotHiddenIndex(h,1),W=Math.min(g,R),j=Math.min(d,E);H===a&&P===l?(s.setAttribute("rowspan",W),s.setAttribute("colspan",j)):(s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="none")}return{before:o,after:r}}function Q5(n,e){yA(n,e),e.add(n)}function Ud(n,e,t){yA(n,e),e.set(n,t)}function yA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rw(n,e,t){return(e=J5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J5(n){var e=eZ(n,"string");return typeof e=="symbol"?e:e+""}function eZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Dc(n,e,t){return n.set(it(n,e),t),t}function mt(n,e){return n.get(it(n,e))}function it(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeMergeCells");le.getSingleton().register("afterMergeCells");le.getSingleton().register("beforeUnmergeCells");le.getSingleton().register("afterUnmergeCells");const mc="mergeCells",tZ=150,hT=mc;var yi=new WeakMap,Si=new WeakMap,Ao=new WeakMap,dT=new WeakMap,at=new WeakSet;class nZ extends nt{constructor(){super(...arguments),Q5(this,at),Rw(this,"mergedCellsCollection",null),Rw(this,"autofillCalculations",null),Rw(this,"selectionCalculations",null),Ud(this,yi,null),Ud(this,Si,{row:0,col:0}),Ud(this,Ao,new q5({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Ud(this,dT,Z5(this))}static get PLUGIN_KEY(){return mc}static get PLUGIN_PRIORITY(){return tZ}isEnabled(){return!!this.hot.getSettings()[mc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new cg(this),this.autofillCalculations=new W5(this),this.selectionCalculations=new z5(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,iZ).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,rZ).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,sZ).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,aZ).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,lZ).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,fT).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,fT).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,hZ).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,dZ).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,fZ).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,uZ).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,oZ).call(e,...i)}),this.addHook("afterRenderer",function(){return mt(dT,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,cZ).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,gZ).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,mZ).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,pZ).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,wZ).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,vZ).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,CZ).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,bZ).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,yZ).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,SZ).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,RZ).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,EZ).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,TZ).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,MZ).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return it(at,e,IZ).call(e,...i)}),this.addHook("beforeUndoStackChange",(t,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[mc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!lI())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:o,rowspan:r}=i;for(let s=o+1;s<o+r;s++)t.push(s)}),t=[...new Set(t)],t.forEach(i=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(r=>(r==null?void 0:r.name)==="master"?r:r.clone.wtTable).forEach(r=>{const s=r.getRow(o);s&&(s.style.background=Cc(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=Cc(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Eo.containsNegativeValues(e)?(ot(Eo.NEGATIVE_VALUES_WARNING(e)),!1):Eo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ot(Eo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Eo.isSingleCell(e)?(ot(Eo.IS_SINGLE_CELL(e)),!1):Eo.containsZeroSpan(e)?(ot(Eo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(r=>this.validateSetting(r)),i=this.mergedCellsCollection.filterOverlappingMergeCells(t),o=[];i.forEach(r=>{const{row:s,col:a,rowspan:l,colspan:u}=r,c=this.hot._createCellCoords(s,a),h=this.hot._createCellCoords(s+l-1,a+u-1),d=this.hot._createCellRange(c,c,h);this.mergeRange(d,!0,!0);for(let g=s;g<s+l;g++)for(let m=a;m<a+u;m++)(g!==s||m!==a)&&o.push([g,m,null])}),o.length!==0&&this.hot.setDataAtCell(o,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),r=e.getBottomEndCorner(),s={row:o.row,col:o.col,rowspan:r.row-o.row+1,colspan:r.col-o.col+1},a=[];let l=null;return this.canMergeRange(s,t)?(this.hot.runHooks("beforeMergeCells",e,t),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,t)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),M(i,o=>{this.mergedCellsCollection.remove(o.row,o.col),me(0,o.rowspan-1,r=>{me(0,o.colspan-1,s=>{this.hot.removeCellMeta(o.row+r,o.col+s,"hidden"),this.hot.removeCellMeta(o.row+r,o.col+s,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,o){const r=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(i,o);this.mergeRange(this.hot._createCellRange(r,r,s))}unmerge(e,t,i,o){const r=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(i,o);this.unmergeRange(this.hot._createCellRange(r,r,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:hT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hT)}modifyViewportRowStart(e,t){const i=this.hot.rowIndexMapper,o=i.getVisualFromRenderableIndex(e.startRow);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(o,r);if(De(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const i=this.hot.rowIndexMapper,o=i.getVisualFromRenderableIndex(e.endRow);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(o,r);if(De(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const i=this.hot.columnIndexMapper,o=i.getVisualFromRenderableIndex(e.startColumn);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(r,o);if(De(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const i=this.hot.columnIndexMapper,o=i.getVisualFromRenderableIndex(e.endColumn);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(r,o);if(De(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,o){const{rowIndexMapper:r,columnIndexMapper:s}=this.hot;let a,l;t===0?a=r.getNearestNotHiddenIndex(e,1):a=r.getNearestNotHiddenIndex(e+t-1,-1),o===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+o-1,-1);const u=e>=0?r.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function iZ(){this.generateFromSettings(this.hot.getSettings()[mc]),this.hot.render()}function oZ(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner(),o=t.getBottomEndCorner();for(let r=0;r<e.length;r+=1)if(i.row===e[r].row&&i.col===e[r].col&&o.row===e[r].row+e[r].rowspan-1&&o.col===e[r].col+e[r].colspan-1)return!1}return n}function rZ(n){mt(Si,this).row=n.row,mt(Si,this).col=n.col}function sZ(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot;mt(yi,this)&&(o.getRenderableFromVisualIndex(mt(yi,this).row)!==null&&(t.row=mt(yi,this).row),i.getRenderableFromVisualIndex(mt(yi,this).col)!==null&&(t.col=mt(yi,this).col),Dc(yi,this,null));const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const s=r.col,a=r.col+r.colspan-1;if(n.col<0){const c=t.col>=s&&t.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,t.col)-1,1)}else if(n.col>0){const c=t.col>=s&&t.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,h)-1,1)}const l=r.row,u=r.row+r.rowspan-1;if(n.row<0){const c=t.row>=l&&t.row<=u?l-1:u,h=o.getNearestNotHiddenIndex(c,-1);h===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,t.row)-1,1)}else if(n.row>0){const c=t.row>=l&&t.row<=u?u+1:l,h=o.getNearestNotHiddenIndex(c,1);h===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,h)-1,1)}}function aZ(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:i}=e,{columnIndexMapper:o,rowIndexMapper:r}=this.hot,s=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+n.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+n.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+n.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+n.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function lZ(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Dc(yi,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);Dc(yi,this,e.clone()),t&&e.assign(t)}function uZ(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:i,col:o,colspan:r,rowspan:s}=t;return[i,o,i+s-1,o+r-1]}function cZ(n){n.items.push({name:"---------"},G5(this))}function fT(){Dc(yi,this,null)}function hZ(){if(mt(yi,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),i=mt(yi,this).clone().normalize();mt(Ao,this).setActiveNode(i.row,i.col),mt(Si,this).row>0||mt(Si,this).col>0?mt(Ao,this).setPrevNodeAsActive():(t==="E-W"&&mt(Si,this).col<0||e==="S-N"&&mt(Si,this).row<0)&&mt(Ao,this).setNextNodeAsActive()}function dZ(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:o}=this.hot;let r=null,s=null;if(mt(Si,this).col<0){const{rowEnd:a,colEnd:l}=mt(Ao,this).getPrevHorizontalNode();s=i.getNearestNotHiddenIndex(l,-1),r=o.getNearestNotHiddenIndex(a,-1)}else if(mt(Si,this).col>0){const{rowStart:a,colStart:l}=mt(Ao,this).getNextHorizontalNode();s=i.getNearestNotHiddenIndex(l,1),r=o.getNearestNotHiddenIndex(a,1)}else if(mt(Si,this).row<0){const{rowEnd:a,colEnd:l}=mt(Ao,this).getPrevVerticalNode();s=i.getNearestNotHiddenIndex(l,-1),r=o.getNearestNotHiddenIndex(a,-1)}else if(mt(Si,this).row>0){const{rowStart:a,colStart:l}=mt(Ao,this).getNextVerticalNode();s=i.getNearestNotHiddenIndex(l,1),r=o.getNearestNotHiddenIndex(a,1)}if(r!==null||s!==null){const a=this.hot._createCellCoords(r,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();n=a.row,e=a.col,l?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):t.highlight.assign(a),u.clear(),u.add(a).commit()}mt(Ao,this).setActiveNode(n,e),Dc(Si,this,{row:0,col:0})}function fZ(){this.hot.getSelectedRangeLast().isHeader()||mt(Ao,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function gZ(n,e,t){const i=this.mergedCellsCollection.get(n,e);i&&(i.row!==n||i.col!==e?t.copyable=!1:(t.rowspan=i.rowspan,t.colspan=i.colspan))}function mZ(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function pZ(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function wZ(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let i=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,t))return i=e,i;const o=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(o,o,r),a=this.mergedCellsCollection.getWithinRange(s);return a.length===0||(i=this.autofillCalculations.snapDragArea(e,i,t,a)),i}function vZ(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function CZ(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function bZ(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function yZ(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function SZ(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function RZ(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(t);M(i,o=>{t.getBottomEndCorner().row===o.getLastRow()&&t.getBottomEndCorner().col===o.getLastColumn()&&(n[2]=o.row,n[3]=o.col)})}}function EZ(n,e,t,i){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,i)}function TZ(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function MZ(n,e,t,i){if(!(i instanceof MouseEvent))return;const o=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getByRange(o);if(!r)return;const s=this.hot._createCellCoords(r.row,r.col),a=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);return this.hot.selection.getLayerLevel()===0&&o.isEqual(this.hot._createCellRange(s,s,a))}function IZ(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let i,o;if(t==="master")i=this.hot.view.getFirstRenderedVisibleColumn(),o=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return n;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,o),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l),c=u.reduce((d,g)=>{let{rowspan:m}=g;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var g;let{rowspan:m}=d,w=0;t==="top"||t==="top_inline_start_corner"?w=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):w=m-h,n=Math.max((g=n)!==null&&g!==void 0?g:0,it(at,this,PZ).call(this,e,w))}),n}function PZ(n,e){const t=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),i=this.hot.getPlugin("autoRowSize");let o=0;for(let s=n;s<n+e;s++)if(!this.hot.rowIndexMapper.isHidden(s)){var r;o+=(r=i==null?void 0:i.getRowHeight(s))!==null&&r!==void 0?r:t}return o}function OZ(n,e){return function(t,i){const[,...o]=t,[,...r]=i;return function s(a){const l=n[a],u=e[a],c=o[a],h=r[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:QP(u.type))(l,u,d)(c,h);if(m===_o){const w=a+1;if(typeof e[w]<"u")return s(w)}return m}(0)}}function gT(){ot(rt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const SA="sort";function AZ(n,e,t){const i=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&i.push(`${SA}-${n.getIndexOfColumnInSortQueue(e)+1}`),i}function xZ(n){const e=n.className.split(" "),t=new RegExp(`^${SA}-[0-9]{1,2}$`);return e.filter(i=>t.test(i))}function HZ(n,e,t){return(e=_Z(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _Z(n){var e=NZ(n,"string");return typeof e=="symbol"?e:e+""}function NZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const dg="multiColumnSorting",DZ=170,Ew="columnSorting",mT=dg;ZP(dg,OZ);class LZ extends aO{constructor(){super(...arguments),HZ(this,"pluginKey",dg)}static get PLUGIN_KEY(){return dg}static get PLUGIN_PRIORITY(){return DZ}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ew]&&(gT(),this.hot.getPlugin(Ew).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Kf)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:rs,position:"before",group:mT})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mT)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];super.updateHeaderClasses(e,...i),Ie(e,xZ(e)),this.enabled!==!1&&X(e,AZ(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ew]&&gT(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){Py(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Kf))):this.sort(this.getColumnNextConfig(t.col)))}}function pT(n,e,t){return(e=$Z(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $Z(n){var e=kZ(n,"string");return typeof e=="symbol"?e:e+""}function kZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const FZ="multipleSelectionHandles",VZ=160;class BZ extends nt{constructor(){super(...arguments),pT(this,"dragged",[]),pT(this,"lastSetCell",null)}static get PLUGIN_KEY(){return FZ}static get PLUGIN_PRIORITY(){return VZ}isEnabled(){return jr()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function i(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const r=e.dragged.indexOf(o);if(r===-1)return!1;r===0?e.dragged=e.dragged.slice(0,1):r===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",o=>{let r;if(Re(o.target,"topSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},o.preventDefault(),!1;if(Re(o.target,"bottomSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",o=>{if(Re(o.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(Re(o.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",o=>{const{rootDocument:r}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=r.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),o.preventDefault())})}getCurrentRangeCoords(e,t,i,o,r){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":r==="top"?c={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SE-NW":r==="bottom"&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,s.col)});break}break;case"NW-SE":switch(o){case"NE-SW":r==="top"?c={start:t,end:l}:c.end=t;break;case"NW-SE":r==="top"?c={start:t,end:a}:c.end=t;break;case"SE-NW":r==="top"?c={start:t,end:s}:c.end=t;break;case"SW-NE":r==="top"?c={start:t,end:u}:c.end=t;break}break;case"SW-NE":switch(o){case"NW-SE":r==="bottom"?c={start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":r==="top"?c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:c={start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(s.row,t.col)};break;case"SE-NW":r==="bottom"?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(s.row,t.col)}:r==="top"&&(c={start:l,end:t});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":r==="top"&&(c.end=t);break;case"SE-NW":r==="top"?c.end=t:c={start:t,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function Bv(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:i=!1,crossHiddenColumns:o=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:i,isCollapsed:r,crossHiddenColumns:o,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function RA(){return{label:"",isPlaceholder:!0}}function WZ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;M(n,o=>{const r=[];let s=0;t.push(r),M(o,a=>{const l=Bv();if(De(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Bt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Bt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),r.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)r.push(RA());return!u})});const i=Math.max(...Ue(t,o=>o.length));return M(t,o=>{if(o.length<i){const r=Ue(new Array(i-o.length),()=>Bv());o.splice(o.length,0,...r)}}),t}function Tw(n,e,t){jZ(n,e),e.set(n,t)}function jZ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Li(n,e){return n.get(EA(n,e))}function Fu(n,e,t){return n.set(EA(n,e),t),t}function EA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wT=["label","collapsible"];var Jo=new WeakMap,Us=new WeakMap,Mw=new WeakMap;class UZ{constructor(){Tw(this,Jo,[]),Tw(this,Us,0),Tw(this,Mw,1/0)}setColumnsLimit(e){Fu(Mw,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Fu(Jo,this,WZ(e,Li(Mw,this))),Fu(Us,this,Li(Jo,this).length)}getData(){return Li(Jo,this)}mergeWith(e){M(e,t=>{let{row:i,col:o,...r}=t;const s=this.getHeaderSettings(i,o);s!==null&&zt(s,r,wT)})}map(e){M(Li(Jo,this),t=>{M(t,i=>{const o=e({...i});De(o)&&zt(i,o,wT)})})}getHeaderSettings(e,t){var i;if(e>=Li(Us,this)||e<0)return null;const o=Li(Jo,this)[e];return Array.isArray(o)===!1||t>=o.length?null:(i=o[t])!==null&&i!==void 0?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=Li(Us,this)||e<0)return o;const r=Li(Jo,this)[e];let s=0;for(let a=t;a<r.length;a++){const l=r[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,o.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return Li(Us,this)}getColumnsCount(){return Li(Us,this)>0?Li(Jo,this)[0].length:0}clear(){Fu(Jo,this,[]),Fu(Us,this,0)}}function Iw(n,e,t){return(e=zZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zZ(n){var e=GZ(n,"string");return typeof e=="symbol"?e:e+""}function GZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const TA="DF-pre-order";function MA(n,e){let t=n.call(e,this);for(let i=0;i<this.childs.length;i++){if(t===!1)return!1;t=MA.call(this.childs[i],n,e)}return t}const YZ="DF-post-order";function IA(n,e){for(let t=0;t<this.childs.length;t++)if(IA.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const PA="BF";function KZ(n,e){const t=[this];function i(){if(t.length===0)return;const o=t.shift();t.push(...o.childs),n.call(e,o)!==!1&&i()}i()}const XZ=PA,vT=new Map([[TA,MA],[YZ,IA],[PA,KZ]]);class fg{constructor(e){Iw(this,"data",{}),Iw(this,"parent",null),Iw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new fg({...e.data});for(let i=0;i<e.childs.length;i++)t.addChild(this.cloneTree(e.childs[i]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XZ;if(!vT.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);vT.get(t).call(this,e,this)}walkUp(e){const t=this,i=o=>{e.call(t,o)!==!1&&o.parent!==null&&i(o.parent)};i(this)}}function Pw(n,e,t){qZ(n,e),e.set(n,t)}function qZ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rn(n,e){return n.get(OA(n,e))}function ZZ(n,e,t){return n.set(OA(n,e),t),t}function OA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var il=new WeakMap,zs=new WeakMap,ol=new WeakMap;class QZ{constructor(e){Pw(this,il,new Map),Pw(this,zs,new Map),Pw(this,ol,null),ZZ(ol,this,e)}getRoots(){return Array.from(Rn(il,this).values())}getRootByColumn(e){let t;return Rn(zs,this).has(e)&&(t=Rn(il,this).get(Rn(zs,this).get(e))),t}getNode(e,t){const i=this.getRootByColumn(t);if(!i)return;const o=t-Rn(zs,this).get(t);let r=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(o>=r&&o<=r+l-1)return s=a,s.data.isRoot=t===s.data.columnIndex,!1;r+=l}}),s}rebuildTreeIndex(){let e=0;Rn(zs,this).clear(),M(Rn(il,this),t=>{let[,{data:{colspan:i}}]=t;for(let o=e;o<e+i;o++)Rn(zs,this).set(o,e);e+=i})}buildTree(){this.clear();const e=Rn(ol,this).getColumnsCount();let t=0;for(;t<e;){const i=Rn(ol,this).getHeaderSettings(0,t),o=new fg;Rn(il,this).set(t,o),this.buildLeaves(o,t,0,i.origColspan),t+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const r=Rn(ol,this).getHeadersSettings(i,t,o);i+=1,M(r,s=>{const a={...s,headerLevel:i-1,columnIndex:t};let l;i===1?(e.data=a,l=e):(l=new fg(a),e.addChild(l)),i<Rn(ol,this).getLayersCount()&&this.buildLeaves(l,t,i,s.origColspan),t+=s.origColspan})}clear(){Rn(il,this).clear(),Rn(zs,this).clear()}}function AA(n,e){n.walkDown(t=>{let{data:i,childs:o}=t;if(!i.isHidden&&(e(i.columnIndex),o.length===0))for(let r=1;r<i.colspan;r++)e(i.columnIndex+r)})}function gg(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function mg(n){return gg(n,"origColspan")===n.data.origColspan}function jy(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(mg(n))return jy(t[0]);e.isCollapsed=!1;const o=t.slice(1),r=new Set;let s=0;if(o.length>0)M(o,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,AA(a,u=>{r.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)r.add(u+c)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):mg(a)&&(l.isCollapsed=gg(a,"isCollapsed"))}),{rollbackModification:()=>Uy(n),affectedColumns:Array.from(r),colspanCompensation:s}}function Uy(n){var e;const{data:t,childs:i}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(mg(n))return Uy(i[0]);t.isCollapsed=!0;const r=i.slice(1),s=new Set;if(r.length>0)M(r,l=>{AA(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=t.colspan-((e=gg(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):mg(l)&&(u.isCollapsed=gg(l,"isCollapsed"))}),{rollbackModification:()=>jy(n),affectedColumns:Array.from(s),colspanCompensation:a}}function JZ(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(rt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let i=!1;n.walkUp(o=>{const{data:{collapsible:r}}=o;if(r)return i=!0,!1}),!i&&n.walkUp(o=>{const{data:r}=o;r.crossHiddenColumns.push(e),r.colspan>1?r.colspan-=1:r.isHidden=!0})}function eQ(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(rt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let i=!1;n.walkUp(o=>{const{data:{collapsible:r}}=o;if(r)return i=!0,!1}),!i&&n.walkUp(o=>{const{data:r}=o;r.crossHiddenColumns.splice(r.crossHiddenColumns.indexOf(e),1),!r.isHidden&&r.colspan<r.origColspan&&(r.colspan+=1),r.isHidden=!1})}const CT=new Map([["collapse",Uy],["expand",jy],["hide-column",JZ],["show-column",eQ]]);function tQ(n,e,t){if(!CT.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return CT.get(n)(e,t)}function zd(n){const e=[];return M(n,t=>{t.walkDown(i=>{const o=i.data,{origColspan:r,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=o,u=iQ(e,a);let c=!1;for(let h=s;h<s+r;h++)if(l.includes(h)||c)u.push(RA());else{const g=nQ(o);g.isRoot=!0,u.push(g),c=!0}})}),e}function nQ(n){const{crossHiddenColumns:e,...t}=Bv(n);return t}function iQ(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function Ow(n,e,t){oQ(n,e),e.set(n,t)}function oQ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(n,e,t){return n.set(xA(n,e),t),t}function It(n,e){return n.get(xA(n,e))}function xA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Co=new WeakMap,Fn=new WeakMap,Gs=new WeakMap;class rQ{constructor(){Ow(this,Co,new UZ),Ow(this,Fn,new QZ(It(Co,this))),Ow(this,Gs,[[]])}setState(e){It(Co,this).setData(e);let t=!1;try{It(Fn,this).buildTree()}catch{It(Fn,this).clear(),It(Co,this).clear(),t=!0}return Vu(Gs,this,zd(It(Fn,this).getRoots())),t}setColumnsLimit(e){It(Co,this).setColumnsLimit(e)}mergeStateWith(e){const t=Ue(e,i=>{let{row:o,...r}=i;return{row:o<0?this.rowCoordsToLevel(o):o,...r}});It(Co,this).mergeWith(t),It(Fn,this).buildTree(),Vu(Gs,this,zd(It(Fn,this).getRoots()))}mapState(e){It(Co,this).map(e),It(Fn,this).buildTree(),Vu(Gs,this,zd(It(Fn,this).getRoots()))}mapNodes(e){return Hn(It(Fn,this).getRoots(),(t,i)=>(i.walkDown(o=>{const r=e(o.data);r!==void 0&&t.push(r)}),t),[])}triggerNodeModification(e,t,i){t<0&&(t=this.rowCoordsToLevel(t));const o=It(Fn,this).getNode(t,i);let r;return o&&(r=tQ(e,o,i),Vu(Gs,this,zd(It(Fn,this).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(o=It(Gs,this)[e])===null||o===void 0?void 0:o[t])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,t){const i=this.getHeaderTreeNode(e,t);return i?{...i.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=It(Fn,this).getNode(e,t);return i||null}findTopMostEntireHeaderLevel(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const o=i-e+1;let r=!1,s=null;for(let a=e;a<=i;a++){const l=It(Fn,this).getRootByColumn(a);if(!l)break;r=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:g}=u.data;g||d<=o&&c>=e&&c+d-1<=i&&(s===null||h<s)&&(s=h)},TA)}return r&&s===null?-1:this.levelToRowCoords((t=s)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var i;const{isRoot:o}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0};if(o)return t;let r=t-1;for(;r>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,r))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;r-=1}return r}findRightMostColumnIndex(e,t){var i;const{isRoot:o,origColspan:r}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(o)return t+r-1;let s=t+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return It(Co,this).getLayersCount()}getColumnsCount(){return It(Co,this).getColumnsCount()}clear(){Vu(Gs,this,[]),It(Co,this).clear(),It(Fn,this).clear()}}function Bu(n,e,t){return(e=sQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sQ(n){var e=aQ(n,"string");return typeof e=="symbol"?e:e+""}function aQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lQ{constructor(e,t){Bu(this,"hot",void 0),Bu(this,"nestedHeaderSettingsGetter",void 0),Bu(this,"layersCount",0),Bu(this,"container",void 0),Bu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let i=0;i<t;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),r=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(r,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:i}=this.hot,o=t.createDocumentFragment(),r=t.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=t.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let m=g.label;s&&(m+='<button class="changeType"></button>'),Nl(d,m),d.colSpan=g.colspan,u.appendChild(d)}}r.appendChild(u)}o.appendChild(r),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}function uQ(n,e){HA(n,e),e.add(n)}function bT(n,e,t){return(e=cQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cQ(n){var e=hQ(n,"string");return typeof e=="symbol"?e:e+""}function hQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gd(n,e,t){HA(n,e),e.set(n,t)}function HA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function na(n,e,t){return n.set(Pt(n,e),t),t}function Ke(n,e){return n.get(Pt(n,e))}function Pt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yT="nestedHeaders",dQ=280;var ct=new WeakMap,Hr=new WeakMap,pc=new WeakMap,om=new WeakMap,Dt=new WeakSet;class fQ extends nt{constructor(){super(...arguments),uQ(this,Dt),Gd(this,ct,new rQ),Gd(this,Hr,null),Gd(this,pc,null),Gd(this,om,!1),bT(this,"ghostTable",new lQ(this.hot,(e,t)=>this.getHeaderSettings(e,t))),bT(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return yT}static get PLUGIN_PRIORITY(){return dQ}isEnabled(){return!!this.hot.getSettings()[yT]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&ot(rt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Pt(Dt,this,OQ).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,AQ).call(e,...o)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,wQ).call(e,...o)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,vQ).call(e,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,CQ).call(e,...o)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,bQ).call(e,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,yQ).call(e,...o)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,SQ).call(e,...o)}),this.addHook("afterSelection",()=>Pt(Dt,this,Yd).call(this)),this.addHook("afterSelectionFocusSet",()=>Pt(Dt,this,Yd).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,gQ).call(e,...o)}),this.addHook("afterGetColumnHeaderRenderers",i=>Pt(Dt,this,EQ).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,MQ).call(e,...o)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,IQ).call(e,...o)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,mQ).call(e,...o)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,pQ).call(e,...o)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,RQ).call(e,...o)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,TQ).call(e,...o)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return Pt(Dt,e,PQ).call(e,...o)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Pt(Dt,this,Yd).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Pt(Dt,this,Yd).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ke(ct,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ke(ct,this).setState(e)),this.detectedOverlappedHeaders&&ot(rt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,i)=>{const o=t===!0?"hide-column":"show-column";Ke(ct,this).triggerColumnModification(o,i)}),!Ke(Hr,this)&&this.enabled&&na(Hr,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(i=>{let{op:o,index:r,newValue:s}=i;if(o==="replace"){const a=s===!0?"hide-column":"show-column";Ke(ct,this).triggerColumnModification(a,r)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ke(ct,this).clear(),Ke(Hr,this).unsubscribe(),na(Hr,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ke(ct,this)}getLayersCount(){return Ke(ct,this).getLayersCount()}getHeaderSettings(e,t){return Ke(ct,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,r=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<t;s++){const a=i.childNodes[s];if(!a)break;const l=o.childNodes[s],u=r?r.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Ie(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Ie(l.childNodes[c],"hiddenHeader")),r&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Ie(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,r)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(o);u===null&&(u=o),r.removeAttribute("colspan"),Ie(r,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:g}=(s=Ke(ct,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)X(r,"hiddenHeader");else if(c>1){var m,w;const{wtOverlays:C}=l._wt,y=(m=C.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(r),R=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(r),E=y||R?Math.min(c,i-o):c;E>1&&r.setAttribute("colspan",E)}if(this.hot.view.appendColHeader(u,r,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!h){const C=r.querySelector("div.relative");C&&g&&g.length>0&&(Ie(C,this.hot.getColumnMeta(u).headerClassName),X(C,g))}}}getColumnHeaderValue(e,t){var i;const{isHidden:o,isPlaceholder:r}=(i=Ke(ct,this).getHeaderSettings(t,e))!==null&&i!==void 0?i:{};return r||o?"":this.hot.getColHeader(e,t)}destroy(){na(ct,this,null),Ke(Hr,this)!==null&&(Ke(Hr,this).unsubscribe(),na(Hr,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ke(ct,this).getHeaderTreeNodeData(e.row,e.col)}}function Yd(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const o=Ke(ct,this).findLeftMostColumnIndex(t.row,t.col),r=this.hot.selection.highlight.getFocus();r.visualCellRange.highlight.col=o,r.visualCellRange.from.col=o,r.visualCellRange.to.col=o,r.commit()}}function gQ(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const o=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),s=Ke(ct,this).findLeftMostColumnIndex(t.row,t.col),a=Ke(ct,this).findRightMostColumnIndex(t.row,t.col);return s<o&&a>r?n:s<o?s:a}function mQ(n,e,t){const i=Ke(ct,this).getHeaderTreeNodeData(e,n);if(!i)return n;const{columnCursor:o,selectionType:r,selectionWidth:s}=t,{isRoot:a,colspan:l}=Ke(ct,this).getHeaderSettings(e,n);if(r===OC){if(!a)return i.columnIndex}else if(r===VI&&(l>s-o||!a))return null;return n}function pQ(n,e,t){let{columnHeadersCount:i}=t;if(i!==0)for(let r=0;r<e.length;r++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[r],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let g=s;g<=l;g++){var o;const m=c+g,w=d-a;if(w===0)continue;((o=Ke(ct,this).getHeaderTreeNodeData(g,d))===null||o===void 0?void 0:o.isRoot)===!1&&(n[m][w]="")}}}function wQ(n,e,t,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function vQ(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;na(pc,this,e.clone()),na(om,this,!0);const{selection:i}=this.hot,o=i.isSelected()?i.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:a}=t,l=!i.inInSelection(e);n.shiftKey&&o?e.col<o.from.col?r.push(o.getTopEndCorner().col,s,e.row):e.col>o.from.col?r.push(o.getTopStartCorner().col,s+a-1,e.row):r.push(s,s+a-1,e.row):(mC(n)||sa(n)&&l||kk(n))&&r.push(s,s+a-1,e.row),i.selectColumns(...r)}function CQ(n,e,t,i){if(!this.hot.view.isMouseDown())return;const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;const{columnIndex:r,origColspan:s}=o,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=ut(e.row,-1/0,-1);e.col<c.col?h.push(u.col,r,d):e.col>c.col?h.push(l.col,r+s-1,d):h.push(r,r+s-1,d),this.hot.selection.selectColumns(...h)}function bQ(){na(om,this,!1)}function yQ(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ke(om,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:o,origColspan:r}=Ke(ct,this).getHeaderTreeNodeData(Ke(pc,this).row,Ke(pc,this).col);if(e.setHighlight(Ke(pc,this)),r>e.getWidth()||o<t||o+r-1>i){const s=Ke(ct,this).findTopMostEntireHeaderLevel(ut(t,o,o+r-1),ut(i,o,o+r-1));e.highlight.row=s,e.highlight.col=e.from.col}}function SQ(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const o=Ke(ct,this).findLeftMostColumnIndex(t.row,t.col),r=Ke(ct,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const s=e.col>=o&&e.col<=r?o-1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const s=e.col>=o&&e.col<=r?r+1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function RQ(n,e){const t=n.row,i=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),o=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(i&&(n.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=n.col&&(i&&(n.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function EQ(n){n.length=0;for(let e=0;e<Ke(ct,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function TQ(n){const e=Ke(ct,this).getLayersCount();let t=n.startColumn,i=!!e;for(let o=0;o<e;o++){const r=Ke(ct,this).findLeftMostColumnIndex(o,n.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(r);if(r>=0&&(i=!1),On(s)&&s<n.startColumn){t=s;break}}n.startColumn=i?Ke(ct,this).getHeaderTreeNodeData(0,t).columnIndex:t}function MQ(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function IQ(n,e,t){var i;const{label:o}=(i=Ke(ct,this).getHeaderTreeNodeData(t,e))!==null&&i!==void 0?i:{label:""};return o}function PQ(n,e){if(n<0)return this.hot.getCell(n,Ke(ct,this).findLeftMostColumnIndex(n,e),!0)}function OQ(){this.updatePlugin()}function AQ(n,e){e||this.updatePlugin()}function Wu(n,e,t){return(e=xQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xQ(n){var e=HQ(n,"string");return typeof e=="symbol"?e:e+""}function HQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _Q{constructor(e,t){Wu(this,"hot",void 0),Wu(this,"data",null),Wu(this,"plugin",void 0),Wu(this,"parentReference",new WeakMap),Wu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&M(e.__children,o=>{this.cacheNode(o,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,i,o){let r=!1,s=t;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},r=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:o!=null&&a===o?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,r?null:a),s=this.readTreeNodes(l,s,i,o),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Le(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(M(i.__children,o=>{t+=1,o.__children&&(t+=this.countChildren(o))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var i;return((i=e.__children)===null||i===void 0?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((t=i.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),i||(i=this.mockNode()),r.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let o=i,r;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,o,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),o=this.getRowParent(i),r=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(o,r+1,null);break;case"above":this.addChildAtIndex(o,r,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const o=[];Array.isArray(e)?(me(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);o.push(this.getDataObject(g))}),me(0,o.length-2,d=>{this.detachFromParent(o[d],!1)}),i=o[o.length-1]):i=e;const r=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(r+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",r,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",r,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){const o=[];M(i,r=>{o.push(this.getDataObject(r))}),M(o,r=>{const s=this.getRowIndexWithinParent(r),a=this.getRowParent(r);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,t,i){const o=this.getDataObject(e-1);let r=null,s=e;o&&o.__children&&o.__children.length===0?(r=o,s=0):e<this.countAllRows()&&(r=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),r?i?r.__children.splice(s,t,...i):r.__children.splice(s,t):i?this.data.splice(s,t,...i):this.data.splice(s,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=null;do i=this.getRowParent(i),i!==null&&(t=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,o){const r=t===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>t;let c=r?this.getRowParent(t-1):this.getRowParent(t);c==null&&(c=this.getRowParent(t-1)),c==null&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const h=r||i||o?c.__children.length:this.getRowIndexWithinParent(t),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function ST(n,e,t){return(e=NQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NQ(n){var e=DQ(n,"string");return typeof e=="symbol"?e:e+""}function DQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zy{constructor(e,t){ST(this,"hot",void 0),ST(this,"plugin",void 0),this.hot=t,this.plugin=e}}class Io extends zy{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const i=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(i),r=this.dataManager.getDataObject(i),s=t.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),X(t,Io.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",me(0,o-1,()=>{const d=c.createElement("SPAN");X(d,Io.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(r)){const c=this.hot.rootDocument.createElement("DIV");u&&ye(c,[Ca()]),X(t,Io.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(X(c,`${Io.CSS_CLASSES.button} ${Io.CSS_CLASSES.expandButton}`),u&&ye(t,[Ri(!1)])):(X(c,`${Io.CSS_CLASSES.button} ${Io.CSS_CLASSES.collapseButton}`),u&&ye(t,[Ri(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class LQ extends zy{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,o)},shiftStash:function(o,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;r==null&&(r=1/0),M(i.lastCollapsedRows,(a,l)=>{a>=o&&a<r&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,o),i.lastCollapsedRows=void 0},trimStash:(o,r)=>{me(o,o+r-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let r=null,s=null,a=null;return isNaN(e)?(r=e,s=this.dataManager.getRowIndex(r)):(r=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(r)&&M(r.__children,l=>{o.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(o,!0,!1),i&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];M(e,r=>{o.push(...this.collapseChildren(r,!1,!1))}),i&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return M(e,r=>{o.push(r),t&&this.collapseChildRows(r,o)}),i&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);M(o.__children,r=>{const s=this.dataManager.getRowIndex(r);t.push(s),this.collapseChildRows(s,t)})}i&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return M(e,r=>{o.push(r),t&&this.expandChildRows(r,o)}),i&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);M(o.__children,r=>{if(!this.isAnyParentCollapsed(r)){const s=this.dataManager.getRowIndex(r);t.push(s),this.expandChildRows(s,t)}})}i&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let r=null,s=null,a=null;return isNaN(e)?(r=e,s=this.dataManager.getRowIndex(e)):(r=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(r)&&M(r.__children,l=>{const u=this.dataManager.getRowIndex(l);o.push(u)}),a=this.expandRows(o,!0,!1),i&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];M(e,r=>{o.push(...this.expandChildren(r,!1,!1))}),i&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];M(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];M(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&M(t.__children,o=>{const r=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(r))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const i=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const i=this.translateTrimmedRow(t.row);Re(e.target,Io.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Ji(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function $Q(n,e,t){kQ(n,e),e.set(n,t)}function kQ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FQ(n,e,t){return(e=VQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VQ(n){var e=BQ(n,"string");return typeof e=="symbol"?e:e+""}function BQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function WQ(n,e){return n.get(jQ(n,e))}function jQ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var RT=new WeakMap;class UQ extends zy{constructor(){super(...arguments),FQ(this,"dataManager",this.plugin.dataManager),$Q(this,RT,{row_above:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Sb)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(i);this.dataManager.addChild(o)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Rb)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(o)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,i=>{if(i===0)return M(t,(o,r)=>{e.items.splice(i+r,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,t=>{const i=WQ(RT,this)[e.items[t].key];i!=null&&(e.items[t].callback=i)}),e}}function Kd(n,e,t){return(e=zQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zQ(n){var e=GQ(n,"string");return typeof e=="symbol"?e:e+""}function GQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class YQ{constructor(e){Kd(this,"plugin",void 0),Kd(this,"hot",void 0),Kd(this,"dataManager",void 0),Kd(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:o}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(m=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),g=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:i,dropIndex:o,movePossible:r}=e;let s=!1;return vt(o)&&(ot(rt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,o,r,!1),s=!0),s}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return i==null&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){const o=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(r=>{this.dataManager.moveRow(r,t,this.movedToCollapsed,o)})})}moveCellsMeta(e,t){const i=[],o=Math.max(...e)<t;e.forEach(r=>{i.push(this.hot.getCellMetaAtRow(r))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?i.length:0),0,...i)}selectCells(e,t){const i=e.length;let o=0,r=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[i-1]<t?l=this.dataManager.translateTrimmedRow(t-i):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);o=this.dataManager.untranslateTrimmedRow(c),r=o}else e[i-1]<t?(r=t-1,o=r-i+1):(o=t,r=o+i-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(r,a),!0)}isRowOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}}function KQ(n,e){_A(n,e),e.add(n)}function ET(n,e,t){_A(n,e),e.set(n,t)}function _A(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aw(n,e,t){return(e=XQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XQ(n){var e=qQ(n,"string");return typeof e=="symbol"?e:e+""}function qQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vf(n,e){return n.get(Qt(n,e))}function pg(n,e,t){return n.set(Qt(n,e),t),t}function Qt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wg="nestedRows",ZQ=300,TT=wg,QQ="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var rm=new WeakMap,rl=new WeakMap,tn=new WeakSet;class JQ extends nt{constructor(){super(...arguments),KQ(this,tn),Aw(this,"dataManager",null),Aw(this,"headersUI",null),Aw(this,"collapsedRowsMap",null),ET(this,rm,!1),ET(this,rl,!1)}static get PLUGIN_KEY(){return wg}static get PLUGIN_PRIORITY(){return ZQ}isEnabled(){return!!this.hot.getSettings()[wg]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Zc),this.dataManager=new _Q(this,this.hot),this.collapsingUI=new LQ(this,this.hot),this.headersUI=new Io(this,this.hot),this.contextMenuUI=new UQ(this,this.hot),this.rowMoveController=new YQ(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,fJ).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,gJ).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,nJ).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,iJ).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,oJ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,tJ).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,aJ).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,sJ).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,lJ).call(e,...i)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,uJ).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,cJ).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,hJ).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,rJ).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,dJ).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Qt(tn,e,eJ).call(e,...i)}),this.addHook("beforeLoadData",t=>Qt(tn,this,MT).call(this,t)),this.addHook("beforeUpdateData",t=>Qt(tn,this,MT).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:TT,relativeToGroup:rs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TT)}disableCoreAPIModifiers(){pg(rl,this,!0)}enableCoreAPIModifiers(){pg(rl,this,!1)}onModifyRowData(e){if(!vf(rl,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!vf(rl,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return vf(rl,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,i),!1)}destroy(){super.destroy()}}function eJ(n,e,t,i){return this.rowMoveController.onBeforeRowMove(n,e,t,i)}function tJ(n,e,t){this.collapsingUI.toggleState(n,e,t)}function nJ(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),pg(rm,this,!0),this.dataManager.getData().slice()}function iJ(n){return this.contextMenuUI.appendOptions(n)}function oJ(n,e){this.headersUI.appendLevelIndicators(n,e)}function rJ(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function sJ(n,e,t,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{pg(rm,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function aJ(n,e,t){const i=Array.from(t.reduce((o,r)=>{if(this.dataManager.isParent(r)){const s=this.dataManager.getDataObject(r).__children;return o.add(r),Array.isArray(s)&&s.forEach(a=>o.add(this.dataManager.getRowIndex(a))),o}return o.add(r)},new Set));t.length=0,t.push(...i)}function lJ(){this.collapsingUI.collapsedRowsStash.stash()}function uJ(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function cJ(){this.collapsingUI.collapsedRowsStash.stash()}function hJ(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function dJ(){this.dataManager.rewriteCache()}function fJ(){this.headersUI.updateRowHeaderWidth()}function gJ(n,e){vf(rm,this)&&(e.skipRender=!0)}function MT(n){if(!Mj(n)){wC(QQ),this.hot.getSettings()[wg]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function xw(n,e,t){return(e=mJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mJ(n){var e=pJ(n,"string");return typeof e=="symbol"?e:e+""}function pJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wJ{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;xw(this,"rootWindow",void 0),xw(this,"prefix",void 0),xw(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const i=typeof e>"u"?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function vJ(n,e,t){return(e=CJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CJ(n){var e=bJ(n,"string");return typeof e=="symbol"?e:e+""}function bJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}le.getSingleton().register("persistentStateSave");le.getSingleton().register("persistentStateLoad");le.getSingleton().register("persistentStateReset");const IT="persistentState",yJ=0;class SJ extends nt{constructor(){super(...arguments),vJ(this,"storage",void 0)}static get PLUGIN_KEY(){return IT}static get PLUGIN_PRIORITY(){return yJ}isEnabled(){return!!this.hot.getSettings()[IT]}enablePlugin(){this.enabled||(this.storage||(this.storage=new wJ(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function RJ(n,e){EJ(n,e),e.add(n)}function EJ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hw(n,e,t){return(e=TJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TJ(n){var e=MJ(n,"string");return typeof e=="symbol"?e:e+""}function MJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function PT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _w="search",IJ=190,PJ="htSearchResult",OJ=function(n,e,t,i,o){n.getCellMeta(e,t).isSearchResult=o},AJ=function(n,e,t){return vt(n)||n===null||!n.toLocaleLowerCase||n.length===0||vt(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var Nw=new WeakSet;class xJ extends nt{constructor(){super(...arguments),RJ(this,Nw),Hw(this,"callback",OJ),Hw(this,"queryMethod",AJ),Hw(this,"searchResultClass",PJ)}static get PLUGIN_KEY(){return _w}static get PLUGIN_PRIORITY(){return IJ}isEnabled(){return this.hot.getSettings()[_w]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[_w];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return PT(Nw,e,OT).call(e,...o)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return PT(Nw,e,OT).call(e,...o)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),r=this.hot.countCols(),s=[],a=this.hot;return me(0,o-1,l=>{me(0,r-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||t,m=(h.search.queryMethod||i)(e,c,h);if(m){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function OT(n,e,t,i,o,r){const s=r.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&r.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),r.className=a.join(" ")}function HJ(n,e){_J(n,e),e.add(n)}function _J(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xd(n,e,t){return(e=NJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NJ(n){var e=DJ(n,"string");return typeof e=="symbol"?e:e+""}function DJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Dw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const LJ="touchScroll",$J=200;var qd=new WeakSet;class kJ extends nt{constructor(){super(...arguments),HJ(this,qd),Xd(this,"scrollbars",[]),Xd(this,"clones",[]),Xd(this,"lockedCollection",!1),Xd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return LJ}static get PLUGIN_PRIORITY(){return $J}static get SETTING_KEYS(){return!0}isEnabled(){return aI()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Dw(qd,this,FJ).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Dw(qd,this,VJ).call(this)),this.addHook("afterMomentumScroll",()=>Dw(qd,this,BJ).call(this))}}function FJ(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),i&&this.scrollbars.push(i),o&&o.clone&&this.scrollbars.push(o),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function VJ(){this.freezeOverlays=!0,M(this.clones,n=>{X(n,"hide-tween")})}function BJ(){this.freezeOverlays=!1,M(this.clones,n=>{Ie(n,"hide-tween"),X(n,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,n=>{Ie(n,"show-tween")})},400),M(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function WJ(n,e){jJ(n,e),e.add(n)}function jJ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UJ(n,e,t){return(e=zJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zJ(n){var e=GJ(n,"string");return typeof e=="symbol"?e:e+""}function GJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function YJ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Cf="trimRows",KJ=330;var AT=new WeakSet;class XJ extends nt{constructor(){super(...arguments),WJ(this,AT),UJ(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Cf}static get PLUGIN_PRIORITY(){return KJ}isEnabled(){return!!this.hot.getSettings()[Cf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Zc),this.trimmedRowsMap.addLocalHook("init",()=>YJ(AT,this,qJ).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Cf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",t,o,i,i&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let o=t;const r=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(M(e,l=>{r[l]=!1}),o=Hn(r,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",t,o,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(r),this.hot.runHooks("afterUntrimRow",t,o,i&&s,i&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<t)}destroy(){super.destroy()}}function qJ(){const n=this.hot.getSettings()[Cf];Array.isArray(n)&&this.hot.batchExecution(()=>{M(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var NA={},ZJ=ts,QJ=NA,JJ=ZJ("iterator"),eee=Array.prototype,tee=function(n){return n!==void 0&&(QJ.Array===n||eee[JJ]===n)},nee=uM,xT=Tg,iee=bg,oee=NA,ree=ts,see=ree("iterator"),DA=function(n){if(!iee(n))return xT(n,see)||xT(n,"@@iterator")||oee[nee(n)]},aee=Qi,lee=$c,uee=mr,cee=Eg,hee=DA,dee=TypeError,fee=function(n,e){var t=arguments.length<2?hee(n):e;if(lee(t))return uee(aee(t,n));throw new dee(cee(n)+" is not iterable")},gee=TM,mee=Qi,pee=mr,wee=Eg,vee=tee,Cee=Bc,HT=Sg,bee=fee,yee=DA,_T=tC,See=TypeError,bf=function(n,e){this.stopped=n,this.result=e},NT=bf.prototype,Ree=function(n,e,t){var i=t&&t.that,o=!!(t&&t.AS_ENTRIES),r=!!(t&&t.IS_RECORD),s=!!(t&&t.IS_ITERATOR),a=!!(t&&t.INTERRUPTED),l=gee(e,i),u,c,h,d,g,m,w,C=function(R){return u&&_T(u,"normal",R),new bf(!0,R)},y=function(R){return o?(pee(R),a?l(R[0],R[1],C):l(R[0],R[1])):a?l(R,C):l(R)};if(r)u=n.iterator;else if(s)u=n;else{if(c=yee(n),!c)throw new See(wee(n)+" is not iterable");if(vee(c)){for(h=0,d=Cee(n);d>h;h++)if(g=y(n[h]),g&&HT(NT,g))return g;return new bf(!1)}u=bee(n,c)}for(m=r?n.next:u.next;!(w=mee(m,u)).done;){try{g=y(w.value)}catch(R){_T(u,"throw",R)}if(typeof g=="object"&&g&&HT(NT,g))return g}return new bf(!1)},Eee=Zi,Tee=ns,Mee=Cg,Iee=function(n,e,t){Eee?Tee.f(n,e,Mee(0,t)):n[e]=t},Pee=dn,Oee=Ree,Aee=Iee;Pee({target:"Object",stat:!0},{fromEntries:function(e){var t={};return Oee(e,function(i,o){Aee(t,i,o)},{AS_ENTRIES:!0}),t}});const LA="undoRedo",xee="undoRedo";function te(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(i,o){const r=i&&i.length;if(!r||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);M(l,c=>{c[1]=n.propToCol(c[1])});const u=r>1?this.getSelected():[[l[0][0],l[0][1]]];return new te.ChangeAction(l,u)};e.done(a,o)}),n.addHook("afterCreateRow",(i,o,r)=>{e.done(()=>new te.CreateRowAction(i,o),r)});const t=(i,o,r,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return me(r,s,c=>{me(i,o,h=>{const d=n.getCellMeta(h,c);if(Object.keys(d).length!==l){const g=Object.fromEntries(Object.entries(d).filter(m=>{let[w]=m;return a.includes(w)===!1}));u.push([d.visualRow,d.visualCol,g])}})}),u};n.addHook("beforeRemoveRow",(i,o,r,s)=>{const a=()=>{const l=n.toPhysicalRow(i),u=l+o-1,c=xn(e.instance.getSourceData(l,0,l+o-1,e.instance.countSourceCols()-1));return new te.RemoveRowAction(l,c,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(l,u,0,n.countCols()-1))};e.done(a,s)}),n.addHook("afterCreateCol",(i,o,r)=>{e.done(()=>new te.CreateColumnAction(i,o),r)}),n.addHook("beforeRemoveCol",(i,o,r,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+i)%e.instance.countCols(),c=u+o-1,h=[],d=[],g=[];me(l.length-1,C=>{const y=[],R=l[C];me(u,c,E=>{y.push(R[n.toPhysicalColumn(E)])}),h.push(y)}),me(o-1,C=>{g.push(n.toPhysicalColumn(u+C))}),Array.isArray(n.getSettings().colHeaders)&&me(o-1,C=>{d.push(n.getSettings().colHeaders[n.toPhysicalColumn(u+C)]||null)});const m=n.columnIndexMapper.getIndexesSequence(),w=n.rowIndexMapper.getIndexesSequence();return new te.RemoveColumnAction(u,g,h,d,m,w,n.getSettings().fixedColumnsStart,t(0,n.countRows(),u,c))};e.done(a,s)}),n.addHook("beforeCellAlignment",(i,o,r,s)=>{e.done(()=>new te.CellAlignmentAction(i,o,r,s))}),n.addHook("beforeFilter",(i,o)=>{e.done(()=>new te.FiltersAction(i,o))}),n.addHook("beforeRowMove",(i,o)=>{i!==!1&&e.done(()=>new te.RowMoveAction(i,o))}),n.addHook("beforeColumnMove",(i,o)=>{i!==!1&&e.done(()=>new te.ColumnMoveAction(i,o))}),n.addHook("beforeMergeCells",(i,o)=>{o||e.done(()=>new te.MergeCellsAction(n,i))}),n.addHook("afterUnmergeCells",(i,o)=>{o||e.done(()=>new te.UnmergeCellsAction(n,i))}),n.addHook("beforeColumnSort",(i,o,r)=>{r&&e.done(()=>new te.ColumnSortAction(i,o))}),n.addHook("afterInit",()=>{e.init()})}te.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const r=n(),s=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};te.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=xn(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const o=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};te.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=xn(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const o=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};te.prototype.isUndoAvailable=function(){return this.doneActions.length>0};te.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};te.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};te.prototype.isEnabled=function(){return this.enabled};te.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,Nee(n),this.registerShortcuts(),n.addHook("afterChange",$A)};te.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,Dee(n),this.unregisterShortcuts(),n.removeHook("afterChange",$A)};te.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};te.Action=function(){};te.Action.prototype.undo=function(){};te.Action.prototype.redo=function(){};te.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};Vo(te.ChangeAction,te.Action);te.ChangeAction.prototype.undo=function(n,e){const t=xn(this.changes),i=n.countEmptyRows(!0),o=n.countEmptyCols(!0);for(let s=0,a=t.length;s<a;s++)t[s].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let s=0,a=t.length;s<a;s++){const[l,u]=t[s];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&i===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u+1+n.getSettings().minSpareCols===n.countCols()&&o===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const r=n.getSelectedLast();if(r!==void 0){const[s,a]=t[0],[l,u]=r,c=n.view.getFirstFullyVisibleRow(),h=n.view.getFirstFullyVisibleColumn(),d=s>=c,g=a>=h;if((d&&g)===!1&&(l!==s||u!==a)===!0){const C={row:s,col:a};d===!1&&(C.verticalSnap="top"),g===!1&&(C.horizontalSnap="start"),n.scrollViewportTo(C)}}n.selectCells(this.selected,!1,!1)};te.ChangeAction.prototype.redo=function(n,e){const t=xn(this.changes);for(let i=0,o=t.length;i<o;i++)t[i].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};te.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};Vo(te.CreateRowAction,te.Action);te.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),i=n.getSettings().minSpareRows;this.index>=t&&this.index-i<t&&(this.index-=i),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};te.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};te.RemoveRowAction=function(n,e,t,i,o,r){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=r};Vo(te.RemoveRowAction,te.Action);te.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),i=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,r)=>{Object.keys(o).forEach(s=>{const a=parseInt(s,10);i.push([this.index+r,isNaN(a)?s:a,o[s]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[r,s,a]=o;n.setCellMetaObject(r,s,a)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};te.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};te.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};Vo(te.CreateColumnAction,te.Action);te.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};te.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};te.RemoveColumnAction=function(n,e,t,i,o,r,s,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=i,this.columnPositions=o.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};Vo(te.RemoveColumnAction,te.Action);te.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(u,c,h)=>h[this.indexes.indexOf(i[c])],r=this.data.length,s=[];for(let u=0;u<r;u++)s.push(Ue(this.data[u],o));const a=Ue(this.headers,o),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),M(n.getSourceDataArray(),(u,c)=>{M(i,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&M(a,(u,c)=>{n.getSettings().colHeaders[i[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;n.setCellMetaObject(c,h,d)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};te.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};te.CellAlignmentAction=function(n,e,t,i){this.stateBefore=n,this.range=e,this.type=t,this.alignment=i};te.CellAlignmentAction.prototype.undo=function(n,e){M(this.range,t=>{t.forAll((i,o)=>{i>=0&&o>=0&&n.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};te.CellAlignmentAction.prototype.redo=function(n,e){_r(this.range,this.type,this.alignment,(t,i)=>n.getCellMeta(t,i),(t,i,o,r)=>n.setCellMeta(t,i,o,r)),n.addHookOnce("afterViewRender",e),n.render()};te.FiltersAction=function(n,e){this.previousConditionsStack=e,this.conditionsStack=n,this.actionType="filter"};Vo(te.FiltersAction,te.Action);te.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};te.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class Hee extends te.Action{constructor(e,t){super(),this.cellRange=t;const i=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,o.row,o.col)}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}}te.MergeCellsAction=Hee;class _ee extends te.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}}te.UnmergeCellsAction=_ee;te.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalRowIndex=e,this.actionType="row_move"};Vo(te.RowMoveAction,te.Action);te.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),Vy(this.rows,this.finalRowIndex,n.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:r,to:s}=o;r<s&&(s-=1),t.moveRow(s,r)}),n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};te.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),n.render(),n.deselectCell(),n.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};te.ColumnMoveAction=function(n,e){this.columns=n.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Vo(te.ColumnMoveAction,te.Action);te.ColumnMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),Vy(this.columns,this.finalColumnIndex,n.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:r,to:s}=o;r<s&&(s-=1),t.moveColumn(s,r)}),n.render(),n.deselectCell(),n.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};te.ColumnMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),n.render(),n.deselectCell(),n.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};te.ColumnSortAction=function(n,e){this.previousSortState=n,this.nextSortState=e};Vo(te.ColumnSortAction,te.Action);te.ColumnSortAction.prototype.undo=function(n,e){const t=n.getPlugin("columnSorting"),i=n.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:t;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),e()};te.ColumnSortAction.prototype.redo=function(n,e){const t=n.getPlugin("columnSorting"),i=n.getPlugin("multiColumnSorting");(i.isEnabled()?i:t).sort(this.nextSortState),e()};te.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};te.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:LA};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};te.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)};function $A(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function Nee(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function Dee(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const sh=le.getSingleton();sh.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});sh.register("beforeUndo");sh.register("afterUndo");sh.register("beforeRedo");sh.register("afterRedo");te.PLUGIN_KEY=xee;te.SETTING_KEYS=!0;function Lee(){Qe(Ju),Qe(hK),Qe(ec),Qe(zK),Qe(JK),Qe(aO),Qe(Y3),Qe(HX),Qe(Jg),Qe(Zq),Qe(R9),Qe(x9),Qe(nm),Qe(r4),Qe(i8),Qe(N8),Qe(s7),Qe(w7),Qe(O7),Qe(V7),Qe(q7),Qe(g5),Qe(R5),Qe(nZ),Qe(LZ),Qe(BZ),Qe(fQ),Qe(JQ),Qe(SJ),Qe(xJ),Qe(kJ),Qe(XJ),Qe(te)}function $ee(){VY(),o2(),f2(),_2(),Lee()}$ee();function ote({data:n,onDataChange:e}){const[t,i]=as.useState(n),[o,r]=as.useState(Array(n.length).fill("A")),s=["Há»","TÃªn","Há» vÃ  TÃªn","MÃ£ nhÃ¢n viÃªn","Sá» CCCD","NgÃ y vÃ o","PhÃ¢n loáº¡i nhÃ¢n viÃªn","NgÃ y sinh","XÆ°á»ng","Bá» pháº­n","Ghi chÃº"],[a,l]=as.useState(!1),u=as.useRef(null),c=as.useMemo(()=>[0,1,4,5,6],[]),h=as.useMemo(()=>[2],[]);as.useEffect(()=>{n&&(i(n),r(Array(n.length).fill("A")))},[n]);const d=(w,C)=>{if(w&&C!=="loadData"){const y=[...t],R=[...o];w.forEach(([E,H,P,W])=>{W!==P&&(R[E]==="A"&&(R[E]="U"),(H===0||H===1)&&(y[E][2]=`${y[E][0]} ${y[E][1]}`.trim()))}),r(R),i(y),e&&e(y)}};return um.jsxs("div",{children:[a?um.jsx("div",{children:"Loading..."}):null,um.jsx(xP,{ref:u,data:t,rowHeaders:w=>o[w]||w+1,colHeaders:s,stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",contextMenu:!0,manualColumnResize:!0,autoColumnSize:!0,manualRowResize:!0,autoRowSize:!0,outsideClickDeselects:!0,persistentState:!0,viewportRowRenderingOffset:50,viewportColumnRenderingOffset:5,afterChange:d,cells:(w,C)=>{const y={};return h.includes(C)&&(y.readOnly=!0,y.renderer=(R,E,H,P,W,j,G)=>(E.style.backgroundColor="#d3d3d3",E.innerHTML=j,E)),y},afterGetColHeader:(w,C)=>{c.includes(w)?C.style.color="red":C.style.color=""}})]})}export{ote as default};
